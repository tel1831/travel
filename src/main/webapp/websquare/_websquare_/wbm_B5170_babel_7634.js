"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[7634],{7634:function(t,e,i){i.r(e),i.d(e,{cellInfo:function(){return N},drilldown:function(){return A},gridView:function(){return H},headerInfo:function(){return S},linkedMappingController:function(){return M},mappingController:function(){return E.v}});var o=i(9122),s=i(1160),a=i(7827),r=i(8754),n=i(5316),l=i(1002),h=function(){};h.prototype._notifySettedGridDataAll=function(t,e){try{this.dataList.clearFilter(!0),t||(this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.extraData={grid:{},row:[],col:[],cell:[]},e=0,this._removeAllTDCellClass(),this._cellSelectedIndex=[],this.hiddenRowObj.init&&this.clearRowVisible({noDraw:!0})),this.hasFooter&&(this.footerTempSum=[]),this.beforeDataLength=-1,1==this.isDrillDown&&(this.setCellInfo(),1==this.isPaste?this.initPasteDrilldown():this.initDrilldown()),this.initStyleArr(e),this.lastTopRowIndex=null,this.loadFlag=!0,this.settedData=!0}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySettedGridData=function(t,e,i,o,a,r){try{if(this.options.scrollFix&&this.settedData){for(var n=this.getTopRowIndex(),l=0;l<=this.lastIndex;l++){var h=n+l;this.drawRowData(h-this.rowIndex,h)}return}this.dataList.clearFilter(!0),this._oldFilterArrStr||this.notifyClearFilter(!0),this.settedData=!1;i=i;var d=[];if(!(e=e||!1)&&this.hiddenRowObj.init)for(var u in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[u]&&d.push(u);this._notifySettedGridDataAll(e,i),0==this.loadFlag&&e?this.loadFlag=!1:this.loadFlag=!0,this.lastTopRowIndex=null;var p={gridData:!0!==r};if(e&&(p.append=!0,p.keepTop=!0),this.notifyDataChanged(p),!e)for(l=0;l<d.length;l++)this.setRowVisible(d[l]);this.loadFlag=!0,0==this.getTotalRow()&&this.removeFocusedCell(),this.options.focusOnSetData&&this._setFocusedCell(0,0),!0!==this._isBrowserScroll()&&this.setScrollYHeight(),this.settedData=!0,this.options.fixedRightColumn>0&&this._handleScrollX(),(!e&&this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0),(!0===a||this.options.instanceBindBySetData)&&this.options.ref&&this._refreshInstance(t,e),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeSettedCellData=function(){try{if(null!=this.editedCell)return this.options.keepEditMode&&"onclick"==this.options.editModeEvent&&(this._reEditCell={_editTd:this.editedCell.editTd,_rowIndex:this.editedCell.editRowIndex}),void this.editedCell.handleEndEdit()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySettedCellData=function(t,e,i,o){try{this.hasFooter&&(this.footerTempSum=[]);var a=this.getColumnIndex(e);t=this._getGroupbyGroupedRowIndex(t);this.notifyCellChanged(t,a,o),null==a&&null!=this._dataList.getColumnIndex(e)&&this._refreshExpression(t,e),this.isDrillDown&&(null==a&&this._dataList.options.depthColumn&&(a=this._dataList.getColumnIndex(e)),this.drilldown.options.depthColumn==a&&(this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight()));var n=r.D.getDataPrefix("colMerged"),l=this.getCellInfo(e),h=t,d=this.getTotalRow();if(l&&l.options.colMerge&&l.options.colMergeEdit&&!this.groupbyStatus.grouped){var u=this.data_td_list[(h-this.rowIndex)*this.oneRowDataLength+a];if(u){var p,c=u.getAttribute(n);if("1"==c&&i!=this.dataList.getCellData(h-1,a))if(u.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex,h,a),h<d-1)(p=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+a])&&(i==this.dataList.getCellData(h+1,a)?p.setAttribute(n,"1"):p.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,a))
;if("0"==c)if(h>=1&&i==this.dataList.getCellData(h-1,a)&&(u.setAttribute(n,"1"),this.drawCellData(h-this.rowIndex,h,a)),h<d-1)(p=this.data_td_list[(h-this.rowIndex+1)*this.oneRowDataLength+a])&&(i==this.dataList.getCellData(h+1,a)?p.setAttribute(n,"1"):p.setAttribute(n,"0"),this.drawCellData(h-this.rowIndex+1,h+1,a))}}this._reEditCell&&this._reEditCell._editTd&&(this.editMode=!0,this.setCellEditMode(this._reEditCell._editTd,this._reEditCell._rowIndex),this._reEditCell={}),this.moveDirection=null,!0===this._isHybridScroll()&&this._setHybridVisibleHeight()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeInsertedRow=function(t){try{!this.isDrillDown&&t>this.getDataLength()&&(t=this.getDataLength());var e=!1,i=[];if(this.isDrillDown){for(var o=this.drilldown.getParentRowIndex(t);o>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(o))||(e=!0,i.push(o)),o=this.drilldown.getParentRowIndex(o);if(e)for(var a=i.length-1;a>=0;a--)if(!this.drilldown.isOpen(i[a])){var r=this.drilldown.getDisplayRowIndex(i[a]);this._toggle(r)}}}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterInsertedRow=function(t,e){try{var i=function(t,e,i){var o=i,s=[],a=t.length;for(var r in t)if(!isNaN(r)){var n=Number(r);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=a+o};this.settedData=!1;var o=this.dataList.getRealRowIndex(t),a=this.getTotalCol();this.resetExpressionFunc();var r=o*a;i(this.cellStyleArr,r,a),i(this.cellClassArr,r,a),i(this.cellReadOnlyArr,r,a),i(this.cellDisabledArr,r,a),i(this._cellSelectedIndex,r,a),this.extraData.row.splice(t,0,null),this.extraData.cell.splice(t,0,null);for(var n=this.getColumnCount(),l=0;l<n;l++){var h=this.getCellInfo(l);if("custom"==h.options.inputType){var d=this.getDataLength();h.isValidTypeGetter||(h.cellManagerHashByRowIndex.splice(o,0,null),h.cellManagerIDByRowIndex.splice(o,0,null),h.cellManagerInfoByRowIndex.splice(o,0,null));for(var u=d;u>o;u--){if(h.cellManagerHashByRowIndex[u]){var p,c=h.cellManagerIDByRowIndex[u];p=this.options.senseReader||h.options.embeddedInput?this.id+"_"+c:h.mainGridId+c,this._removeDom(p),h.isValidTypeGetter||(h.cellManagerHashByRowIndex[u]=null,h.cellManagerIDByRowIndex[u]=null)}}}}if(this.isDrillDown&&this.drilldown.statusArr.splice(o,0,!0),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("insertRow",t),!0!==e&&(this.notifyRowInserted(t),this.notifyStatusChanged({rowIndex:[t]})),this.options.ref&&1!=this.insertRowByInstance&&!0!==e&&this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){var g;g=1==this.repeatNodeTagNameFilter&&1==this.repeatNodeTagName.length?this.filteredRepeatNodeTagName[0]:this.repeatNodeTagName[0];var f,m=WebSquare.xml.parse("<"+g+"></"+g+">").documentElement,y=m,b=g;this.repeatNodeTagName.length>1&&(b=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(l=1;l<this.repeatNodeTagName.length;l++)y=WebSquare.xml.createNode(y,this.repeatNodeTagName[l],!1);f=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(m,b):m;for(l=0;l<this.repeatNodeChildTagName.length;l++)WebSquare.xml.createNode(f,this.repeatNodeChildTagName[l],!1);t>=this.maxRowLength?WebSquare.ModelUtil.setInstanceNode(m,this.options.ref,null,"append",!1,this.scope_id):WebSquare.ModelUtil.setInstanceNode(m,this.options.ref+"/"+g+"["+(t+1)+"]",null,"insertBeforeSibling",!1,this.scope_id)}return this.settedData=!0,this.loadFlag=null==this.loadFlag||this.loadFlag,this._refreshColumnClass(),this._autoFitRefreshNative(),t}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeRemovedRow=function(t){try{if(this.options.ref&&1!=this.removeRowByInstance){var e=this.getRealRowIndex(t)+1;WebSquare.ModelUtil.removeInstanceNode(this.options.ref+"/"+this.repeatNodeTagName[0]+"["+e+"]",!1,this.scope_id)}if(this.isDrillDown&&this._dataList.options.depthColumn){
for(var i=!1,o=[],a=this.drilldown.getParentRowIndex(t);a>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(a))||(i=!0,o.push(a)),a=this.drilldown.getParentRowIndex(a);if(i)for(var r=o.length-1;r>=0;r--)if(!this.drilldown.isOpen(o[r])){var n=this.drilldown.getDisplayRowIndex(o[r]);this._toggle(n)}t=this.drilldown.getDisplayRowIndex(t)}}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeKeepFilter=function(){try{var t=this._dataList.getFilterList();if(t.length<=0||isNaN(t.length))return;this._oldFilterArrStr=JSON.stringify(t,(function(t,e){return"function"==typeof e||e&&"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})),this.customFilterStatusObj&&(this._oldStatusObj=JSON.stringify(this.customFilterStatusObj)),this.customFilterList&&this.customFilterList.customFilterListFilterInfo?this._oldFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})):this.groupbyStatus.grouped&&this.groupbyStatus.filter&&(this._oldFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})))}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterKeepFilter=function(){try{if(!this._oldFilterArrStr)return;this._refreshCustomFilterHistory(this._oldFilterArrStr,this._oldFilterInfo,this._oldStatusObj),this._oldFilterArrStr=null,this._oldFilterInfo=null,this._oldStatusObj=null,this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterRemovedRow=function(t,e,i,o){try{var a=function(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var a in t)if(!isNaN(a)){var r=Number(a);r>=e&&r<e+o?delete t[a]:r>=e+o&&s.push(r)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}};this.removed=!0,this.isDrillDown&&this.drilldown.statusArr.splice(i,1);var n=this.getTotalCol(),l=n*i;a(this.cellStyleArr,l,n),a(this.cellClassArr,l,n),a(this.cellReadOnlyArr,l,n),a(this.cellDisabledArr,l,n),a(this._cellSelectedIndex,l,n);for(var h=this.getColumnCount(),d=0;d<h;d++){var u=this.getCellInfo(d);if("custom"==u.options.inputType){var p=this.getDataLength();if(u.cellManagerHashByRowIndex[i]){var c,g=u.cellManagerIDByRowIndex[i];if(c=this.options.senseReader||u.options.embeddedInput?this.id+"_"+g:u.mainGridId+g,this._removeDom(c),u.isValidTypeGetter&&(delete u.cellManagerHashByID[g],delete u.cellManagerHashByRowIndex[i],delete u.cellManagerIDByRowIndex[i],i<p)){for(var f=i;f<p;f++)u.cellManagerHashByRowIndex[f]=u.cellManagerHashByRowIndex[f+1],u.cellManagerIDByRowIndex[f]=u.cellManagerIDByRowIndex[f+1];delete u.cellManagerHashByRowIndex[p],delete u.cellManagerIDByRowIndex[p]}}u.isValidTypeGetter||(u.cellManagerInfoByRowIndex.splice(i,1),u.cellManagerHashByRowIndex.splice(i,1),u.cellManagerIDByRowIndex.splice(i,1))}}if(this.itemValueObj)for(var m in this.itemValueObj){var y=o.split(",")[this._dataList.bodyIdColIndexMap[m]];for(var b in this.itemValueObj[m])-1!=b.indexOf("auto")&&this.itemValueObj[m][b]===y&&(this.itemValueObj[m][b]="")}if(!0!==e){var w=this.checkScrollEnd,v=this.scrollEvent;if(this.checkScrollEnd=!1,this.scrollEvent=!1,this._getFocusedRowIndex()==this.getDataLength()){var C=this._getFocusedRowIndex(),I=this.getFocusedColumnIndex();this.removeRowFocus(this.getDataLength()),this._setFocusedCell(C-1,I)}this.resetExpressionFunc(),this.hasFooter&&(this.footerTempSum=[]),this._mergeNotifyRowChanged("removeRow",t),this.notifyRowChanged(t),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.notifyStatusChanged({rowindex:[t]}),r.D.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e,this._autoFitRefreshNative()}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[w,v]})}}catch(t){s.w.printStackTrace(t,null,this)}},
h.prototype.notifyRemovedRows=function(t,e){try{if(!0!==e){var i=this.checkScrollEnd,o=this.scrollEvent;this.checkScrollEnd=!1,this.scrollEvent=!1,this.resetExpressionFunc();for(var a=t.split(","),n=0;n<a.length;n++)this._mergeNotifyRowChanged("removeRow",a[n]);this.notifyRowChanged(),r.D.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[i,o]}),this._autoFitRefreshNative()}}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRemovedAll=function(t){try{this.removed=!0;var e=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.loadFlag=!0,this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.cellReadOnlyArr=[],this.cellDisabledArr=[],this.extraData={grid:{},row:[],col:[],cell:[]},this._removeAllTDCellClass(),this._cellSelectedIndex=[],this.resetExpressionFunc();for(var i=this.getTotalCol(),o=0;o<i;o++){var a=this.getCellInfo(o);if(a&&a.options&&"expression"==a.options.inputType)for(var r=this.drawedRowLength,n=0;n<r;n++)a.options.expressionFunc&&a.options.expressionFunc[n]&&(a.options.expressionFunc[n]={});else if("custom"==a.options.inputType){for(var l=0;l<a.cellManagerIDByRowIndex.length;l++){a.cellManagerHashByRowIndex[l];var h,d=a.cellManagerIDByRowIndex[l];h=this.options.senseReader||a.options.embeddedInput?this.id+"_"+d:a.mainGridId+d,this._removeDom(h)}a.isValidTypeGetter?(a.cellManagerHashByID={},a.cellManagerHashByRowIndex={},a.cellManagerIDByRowIndex={}):(a.cellManagerInfoByRowIndex=[],a.cellManagerHashByRowIndex=[],a.cellManagerIDByRowIndex=[])}}this.removeFocusedCell();for(o=0;o<this.dataRowList.length;o++){var u=this.dataRowList[o];u.style.display="none",this.__addClass(u,"w2grid_hidedRow"),this.__hasClass(u,"w2grid_lastRow")&&this.__removeClass(u,"w2grid_lastRow")}this.lastDisplayedRow=-1,this.subtotalHidden(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.maxRowLength=0,this.displayNoResultMessage(),this.drawFooter();var p={sortIcon:this.options.hideSortIconOnNoData};this.drawHeader(void 0,p),this._setCheckboxHead(),0==this.getDataLength()&&(this.removeFocusedCell(),"all"===this.options.visibleRowNum&&this.setSize(null,this.defaultDataLayerHeight)),this.setScrollYHeight(),this.displayFixedColumnLine(),this.options.ref&&1!=this.removeRowByInstance&&WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],gridNoRefresh:!0,scopeId:this.scope_id}),this.options.groupbyFilterBox&&!1!==t&&this.clearFilterHistory(),1==this.isDrillDown&&this.initDrilldown(),this.itemValueObj={},this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRemovedRange=function(t){try{this.removed=!0,this.notifyRowChanged(t)}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyCreatedRowStatus=function(t){try{var e=function(t,e,i){var o=i,s=[],a=t.length;for(var r in t)if(!isNaN(r)){var n=Number(r);n>=e&&s.push(n)}s.sort((function(t,e){return e-t}));for(var l=0;l<s.length;l++){var h=s[l];t[h+o]=t[h],delete t[h]}t.length=a+o};e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyRemovedRowStatus=function(t){try{var e=function(t,e,i){if(!(e>t.length)){var o=Math.min(i,t.length-e),s=[];for(var a in t)if(!isNaN(a)){var r=Number(a);r>=e&&r<e+o?delete t[a]:r>=e+o&&s.push(r)}s.sort((function(t,e){return t-e}));for(var n=0;n<s.length;n++){var l=s[n];t[l-o]=t[l],delete t[l]}t.length-=o}};e(this.rowStyleArr,t,1),e(this.rowReadOnlyArr,t,1),e(this.rowDisabledArr,t,1),e(this.rowStyleFixedArr,t,1),e(this.rowStyleDataArr,t,1)}catch(t){s.w.printStackTrace(t)}},
h.prototype.notifyDeleteRow=function(t){try{this._drawRowStatus(t-this.rowIndex,t);for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e);this.displayNoResultMessage(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),a=this.expressionAssArr[o];if(null!=a)for(e=0;e<a.length;e++){var r=this.getColumnIndex(a[e]);this.drawCellData(t-this.rowIndex,t,r)}}}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyUndeleteRow=function(t){try{this._drawRowStatus(t-this.rowIndex,t);for(var e=0;e<this.oneRowDataLength;e++)this._drawCellStatus(t-this.rowIndex,t,e);this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var i=0;i<this.getColCnt();i++){var o=this.getColumnID(i),a=this.expressionAssArr[o];if(null!=a)for(e=0;e<a.length;e++){var r=this.getColumnIndex(a[e]);this.drawCellData(t-this.rowIndex,t,r)}}}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyReformed=function(){try{if(this.options.rowStatusVisible)for(var t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)this._drawRowStatus(e,this.rowIndex+e);if(this.options.cellStatusVisible)for(t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)for(var i=0;i<this.oneRowDataLength;i++)this._drawCellStatus(e,this.rowIndex+e,i)}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyModifyAllStatus=function(t){try{for(var e=0;e<this.getDataLength();e++)this._drawRowStatus(e-this.rowIndex,e);this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:"all"})}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyModifyRangeStatus=function(t,e,i){try{var o=this.getDataLength();if(0<=t&&e<=o)for(var a=t;a<=e;a++)this._drawRowStatus(a-this.rowIndex,a);this.displayNoResultMessage(),this.notifyStatusChanged({startIndex:t,endIndex:e})}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyModifyRowStatus=function(t,e){try{t>-1&&t<this.getDataLength()&&(this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:[t]}))}catch(t){s.w.printStackTrace(t)}},h.prototype.notifyModifyMatchedStatus=function(t,e,i){try{for(var o=[],a=this.getDataLength(),r=0;r<a;r++){var n=this.getColumnID(t),l=this.dataList.getRealRowIndex(r);if(this.dataList._getCellData(l,n)+""==e+"")i!=this.dataList._setRowStatus(l,i)&&o.push(r),this._drawRowStatus(r-this.rowIndex,r),this.displayNoResultMessage()}this.notifyStatusChanged({rowIndex:o})}catch(t){s.w.printStackTrace(t)}},h.prototype.notifySetColumnDefaultValue=function(t,e){try{this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySettedData=function(t){try{this.groupbyStatus.grouped&&this.clearGroupby(),this.loadCheck=[],t||this.options.focusOnSetData||this.removeFocusedCell()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySetRowXML=function(t,e){e?this.notifyRowChanged(t):this.notifyRowInserted(t)},h.prototype.notifyRowMoveUp=function(t){try{var e=this.extraData.row[t-1];this.extraData.row[t-1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t-1],this.extraData.cell[t-1]=this.extraData.cell[t],this.extraData.cell[t]=e,this._getFocusedRowIndex()==t&&this._setFocusedCell(t-1,this.getFocusedColumnIndex()),this.notifyRowChanged(t-1)}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRowMoveDown=function(t){try{var e=this.extraData.row[t+1];this.extraData.row[t+1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t+1],this.extraData.cell[t+1]=this.extraData.cell[t],this.extraData.cell[t]=e,
this._getFocusedRowIndex()==t&&this._setFocusedCell(t+1,this.getFocusedColumnIndex()),this.notifyRowChanged(t)}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRowModified=function(t){try{this.changeCount++,this.drawRowData(t-this.rowIndex,t),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyStatusChanged=function(t){try{var e,i,o=!1;"object"==(0,l.Z)(t.rowIndex)?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getDataLength()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var a=e;a<i;a++){var r;if(r=o?t.rowIndex[a]:a,null!=this.rowStatusColIDArr)for(var n=0;n<this.rowStatusColIDArr.length;n++){var h=this.getColumnIndex(this.rowStatusColIDArr[n]);this.drawCellData(r-this.rowIndex,r,h)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySaveFocusedCell=function(){try{this.focusedCellInfo.beforeFocusedCell=!(0==this.focusedCell.length),this.focusedCellInfo.beforeFocusedCell&&(this.focusedCellInfo.beforeFocusedCellRealRowIndex=this.dataList.getRealRowIndex(this.focusedCell[0].focusedRowIndex),this.focusedCellInfo.beforeFocusedCellRealColumnIndex=this.focusedCell[0].focusedColIndex)}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySetFocusedCell=function(t){try{var e=this.options.filterFocusMode,i=this.focusedCellInfo.beforeFocusedCellRealRowIndex;if("outfocus"!==e&&"infocus"!==e){if(this.focusedCellInfo.beforeFocusedCell)for(var o=0;o<this.getDataLength();o++)if(this.dataList.getRealRowIndex(o)==i){this._setFocusedCell(o,this.focusedCellInfo.beforeFocusedCellRealColumnIndex,!1,{isSort:t});break}}else"outfocus"==e&&this.outFocusedCell();this.focusedCellInfo={}}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySettedFilter=function(t){try{var e=t&&t.isSort,i=t&&t.fiteredColID;if(this.notifySetFocusedCell({isSort:e}),e&&this.syncWithSortStatus(),this.groupbyStatus.grouped)for(var o in this.customFilterStatusObj)if(this.customFilterStatusObj[o]){this.rowNumArr=[];for(var a=0;a<this.getDataLength();a++)this.rowNumArr.push(a);break}1==this.isDrillDown&&this._linkedDataList&&(this.setCellInfo(),this.initDrilldown());var r=!t||!1!==t.keepTop,n=[];if(this.hiddenRowObj.init){for(var l in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[l]&&n.push(l);this.clearRowVisible({noDraw:!0})}if(this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:r}),0==this.getDataLength()&&this.removeFocusedCell(),!0!==(r&&!0===this._isHybridScroll())&&this.setScrollYHeight(),e&&!this.groupbyStatus.grouped&&this.drawHeaderSortImages(),i&&!e&&this.options.useFilterList){var h=this.bodyToHeaderRelation[i];if(h){var d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}}for(a=0;a<n.length;a++)this.setRowVisible(n[a]);this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifySettedFilterByUser=function(t){try{if(this.options.useFilterListSync){var e=t.colID,i=JSON.parse(t.oldFilteredRowIndexArr),o=JSON.parse(t.newFilteredRowIndexArr);if(this.groupbyStatus.grouped);else if(this.options.useFilterList){this.customFilterList||this.createCustomFilterList(null,!0),this.customFilterList.filterHistory.column[0]!==e&&(this.customFilterList.filterHistory.column.unshift(e),this.customFilterList.filterHistory.filteredRowIndexArr.unshift(i));var a=this.dataList.getColData(e,o),r=this.getUniqueValueOfArray(a),n=this.changeItemValue("label",e,r);this.customFilterList.customFilterListFilterInfo||(this.customFilterList.customFilterListFilterInfo={}),this.customFilterList.customFilterListFilterInfo[e]=[];for(var l=0;l<n.length;l++){
var h=n[l],d=this;"string"==typeof h&&(h=h.replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return d.replacechar(t)}))),this.customFilterList.customFilterListFilterInfo[e].push(h)}}}}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeClearSort=function(){try{this.notifySaveFocusedCell(),this.clearHeaderSort()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyClearSortFilter=function(){try{var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex();this.syncWithSortStatus(),this.rowNumArr=null,this.removeFocusedCell(),this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),"infocus"==this.options.filterFocusMode&&this._setFocusedCell(t,e)}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeSettedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterSettedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeRemovedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterRemovedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox(),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRemovedFilter=function(t){try{!0===t&&this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null,!0!==this._isHybridScroll()&&this.setScrollYHeight(),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyClearFilter=function(t){try{this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),t||(this.adjustDraw_keepTop=!0,this.notifyDataChanged({keepTop:!0}),this.adjustDraw_keepTop=null),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null;var e={};for(var i in!0===t&&!0===this._isHybridScroll()&&(e.skipResize=!0),this.setScrollYHeight(e),this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.itemValueObj={},this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterList.customFilterListFilterInfo={}),this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyMultisort=function(){try{this.syncWithSortStatus(),this.drawHeaderSortImages()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyBeforeInitDataList=function(){try{this.removeAllFinish=!0}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyAfterInitDataList=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj(),1==this.isDrillDown&&this.initDrilldown(),this.removeAllFinish=!1,this.initColumns(),this._autoFitRefreshNative()}catch(t){s.w.printStackTrace(t,null,this)}},h.prototype.notifyRefresh=function(t){try{!this.startedDisplayNone&&this.rowIndex>=0&&(t&&this.setDataTable(),this._mergeRefresh(),this.drawData(this.rowIndex,0),t&&this.setScrollYHeight(),this.displayNoResultMessage(),this.displayFixedColumnLine())}catch(t){s.w.printStackTrace(t,null,this)}},
h.prototype.notifyBroadcast=function(t){try{this.isDrillDown&&this.initDrilldown(),this.notifyDataChanged(t)}catch(t){s.w.printStackTrace(t,null,this)}};var d,u=i(5841),p=i(6079),c=(i(3386),function(){});c.prototype.toHTML=function(){try{var t=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/mainZIndex/@value")||"10",e=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/xScrollZIndex/@value")||"20",i=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/yScrollZIndex/@value")||"15";if(this.uncompleted)return;var o=[],r="scroll"===this.options.overflowY,n=(this._isHybridScroll(),"overflow:hidden"),l=!0===this.options.scrollXNative?"display:none;":"",h=!0===this._isNativeScroll()?"visibility:hidden;":"",d=this.options.title?" title='"+this.options.title.wq_replaceAll("'","&#39;")+"'":"",u=this.options.moreButtonTitle?this.options.moreButtonTitle.wq_replaceAll("'","&#39;"):WebSquare.language.getMessage("Grid_more_Button")||"more",p=u?" title='"+u+"'":"",c="none"==this.options.focusMode||"linear"==this.options.focusFlow?"":" tabIndex='0'",g=this.options.scrollFocus?" tabIndex='0'":"",f=""==this.options.style?"style='"+n+";'":"style='"+this.options.style+";"+n+";'",m=this.options.readOnly?" w2grid_readonly_outer":"",y=function(t){return this._useRole()?" role='"+t+"' ":""};if(o.push("<div id='"+this.id+"' class='w2grid "+this.options.className+m+"' "+f+d+c+">"),this.options.senseReader&&this.options.useStartEndDiv){var b=WebSquare.language.getMessage("Grid_dom_start")||"Grid start";o.push("<div id='"+this.id+"_gridstart_div' class='w2grid_start_div' tabindex='0'>"+b+"</div>")}if(this.options.groupbyZone&&this.options.groupbyFilterBox&&"top"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='top:0px;left:0px; right:"+(r?this.scrollLayerWidthSize:"0")+"px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete" />'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),this.options.groupbyZone){var w="<div id='"+this.id+"_groupbyZone_div' class='w2grid_groupbyZone' style='width:0px; height:0px;'>",v="";this.options.groupbyZoneSearch&&(v="<div id='"+this.id+"_groupbyZone_search' class='w2grid_groupbyZone_search'></div>"),o.push(w+v+"</div>")}if(o.push("<div id='"+this.id+"_main_div' class='w2grid_main' style='z-index:"+t+";"+n+";position:absolute;left:0px; right:"+(r?this.scrollLayerWidthSize:"0")+"px; top:0px; bottom:"+this.scrollLayerWidthSize+"px;float:left;'>"),o.push(this.mainDataGridLayout()),this.options.useMoreButton&&o.push("<button id='"+this.id+"_grid_more_button' class='w2_grid_more_button'"+p+"></button>"),o.push("</div>"),this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='left:0px; right:"+(r?this.scrollLayerWidthSize:"0")+"px; bottom:0px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main' >"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete"/>'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),
o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+y.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),o.push("<div id='"+this.id+"_scrollX_div' class='w2grid_scrollX' style='z-index:"+e+";overflow-x:hidden;overflow-y:hidden;position:absolute; height:0px; left:0px; right:"+(r?this.scrollWidthSize:"0")+"px; bottom:0px;"+l+"'>"),o.push(this.getScrollX()),o.push("</div>"),o.push("<div id='"+this.id+"_scrollY_div' class='w2grid_scrollY' style='z-index:"+i+";position:absolute; overflow-x:hidden;overflow-y:scroll;width:"+(r||!0===this._isNativeScroll()?this.scrollLayerWidthSize:"0")+"px; height: 100%;right:0px;"+h+"'"+g+">"),o.push(this.getScrollY()),o.push("</div>"),o.push("<div id='"+this.id+"_iScrollX' class='w2grid_iScrollX' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_iScrollY' class='w2grid_iScrollY' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_resize_line' class='w2grid_resize_line' style='display:none;position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px;'></div>"),this.options.useNoResultMessageURL?o.push("<div id='"+this.id+"_noresult' style='display:none;' class='w2grid_noresult'></div>"):o.push("<div id='"+this.id+"_noresult' style='display:none;position:absolute;"+this.options.noResultMessageStyle+"' class='"+this.options.noResultMessageClass+"'>"+this.options.noResultMessage+"</div>"),this.options.senseReader&&this.options.useStartEndDiv||1==this.options.moveKeyEditModeAll){var C=WebSquare.language.getMessage("Grid_dom_end")||"Grid end";o.push("<div id='"+this.id+"_gridend_div' class='w2grid_end_div' tabindex='0'>"+C+"</div>")}return o.push("</div>"),o.join("")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getScrollY=function(){try{return"<div id='"+this.id+"_size_y' style='height:0px; position:absolute; top:0px; left:0px; width:18px;'></div>"}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getScrollX=function(){try{for(var t=this.getFixedColumnLastIndex(),e=0,i=0;i<t;i++)this.hiddenList[i]||(e+=this.colWidthList[i]);var o=this.getFixedRightColumnLastIndex(),a=0;for(i=this.colWidthList.length-1;i>=o;i--)this.hiddenList[i]||(a+=this.colWidthList[i]);var r=this.options.scrollFocus?" tabIndex='0'":" tabIndex='-1'",n=[],l=this.options.fixedColumnScrollHidden?"hidden":"scroll";return n.push("<table id='"+this.id+"_scrollX_table' style='height:18px;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:100%'>"),n.push("<tr>"),n.push("<td id='"+this.id+"_scrollX_left' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+e+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:"+l+";overflow-y:hidden'></div>"),n.push("</td>"),n.push("<td style='border:0px solid orange;padding:0px 0px 0px 0px;height:18px;'>"),n.push("<div id='"+this.id+"_scrollX_right' style='height:18px;border:0px solid blue; overflow-x:scroll;overflow-y:hidden;padding:0px 0px 0px 0px;'"+r+">"),n.push("<div id='"+this.id+"_scroll_size' style='height:1px;width:"+parseInt(this.gridWidth-e-a)+"px'></div>"),n.push("</div>"),n.push("</td>"),n.push("<td id='"+this.id+"_scrollX_fixedRight' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+a+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:scroll;overflow-y:hidden'></div>"),n.push("</td>"),n.push("</tr>"),n.push("</table>"),n.join("")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.mainDataGridLayout=function(){try{this.setTableStruct();var t=[];return t.push(this.getBodyTable()),t.push(this.getFooterTable()),this.setInitialCSS(),t.join("")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setColArr=function(){try{this.colGroupArr=[],this.setColWidth(),this.gridWidth=0
;var t,e,i=-1;if(this.options.rowStatusVisible){var o=40;this.options.rowStatusWidth.length>0&&(this.options.rowStatusWidth.indexOf("*")>-1?(o=this.options.rowStatusWidth,i++):this.options.rowStatusWidth-0>-1&&(o=this.options.rowStatusWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(this.options.rowNumVisible){o=40;this.options.rowNumWidth.length>0&&(this.options.rowNumWidth.indexOf("*")>-1?(o=this.options.rowNumWidth,i++):this.options.rowNumWidth-0>-1&&(o=this.options.rowNumWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(i>-1){this.autofitColumn=!0;for(var a=0;a<2;a++)this.colWidthList[a]&&"string"==typeof this.colWidthList[a]&&this.colWidthList[a].indexOf("*")>-1&&(this.autofitColumnIndexArr.push(a),this.autofitColumnWidthArr[a]=this.colWidthList[a])}if(this.isIE6or7){t=[],e=this.colIndexes.bodyColInfo.colSpanArr;var r=this.colIndexes.bodyColInfo.colIndexArr.length;for(a=0;a<r;a++)if(e[a])for(var n=0;n<e[a];n++)t[n]=!0}this.colGroupArr.push("<colgroup>");for(a=0;a<this.colWidthList.length;a++){null==this.colWidthList[a]&&(this.colWidthList[a]=70);var l=isNaN(this.colWidthList[a])?0:this.colWidthList[a];this.hiddenList[a]?l=0:(this.gridWidth+=l,this.isIE6or7&&(a<this.defaultColCnt||!t[a])&&(l--,a==this.defaultColCnt&&l--)),this.colGroupArr.push("<col id='colGroupID_"+a+"' style='width:"+l+"px;white-space:nowrap' />")}this.colGroupArr.push("</colgroup>")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setCss=function(){try{if(this.options.headerTableClass=this.struct.head.attr.class||"gridHeaderTableDefault",this.options.headerTrClass=this.struct.head.attr.rowClass||"gridHeaderTRDefault",this.options.headerTdClass=this.struct.head.attr.columnClass||"gridHeaderTDDefault",this.options.bodyTableClass=this.struct.body.attr.class||"gridBodyTableDefault",this.options.bodyTrClass=this.struct.body.attr.rowClass||"gridBodyTRDefault",this.options.bodyTdClass=this.struct.body.attr.columnClass||"gridBodyDefault",r.D.isIEAllVersion()&&!0===this._isNativeScroll()?this.options.gridNativeClass="gridNativeIE":this.options.gridNativeClass="gridNative",this.options.gridHybridClass="gridHybrid",this.hasFooter&&(this.options.footerTableClass=this.struct.foot.attr.class||"gridFooterTableDefault",this.options.footerTrClass=this.struct.foot.attr.rowClass||"gridFooterTRDefault",this.options.footerTdClass=this.struct.foot.attr.columnClass||"gridFooterTDDefault"),this.hasSubtotal){this.options.subtotalTrClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.rowClass||"gridSubtotalTRDefault",this.options.subtotalTdClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.columnClass||"gridSubtotalDefault";for(var t=0;t<this.struct.subtotalArr.length;t++)if(this.struct.subtotalArr[t].attr.subtotalClass){this.subtotalClassList=[];break}if(this.subtotalClassList)for(t=0;t<this.struct.subtotalArr.length;t++){var e=this.struct.subtotalArr[t].attr.subtotalClass||"gridSubtotalDefault";this.subtotalClassList.push(e)}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setInitialCSS=function(){try{this.options.oddEvenColorDisplay&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" .evenTd","background-color:"+this.options.evenRowBackgroundColor),WebSquare.cssStyleSheet.addRule("#"+this.id+" .oddTd","background-color:"+this.options.oddRowBackgroundColor)),this.rowStyleIndex=0,this.cellStyleIndex=0,this.readOnlyTdStyle="",this.readOnlyTdImg="",this.disabledTdStyle="",this.rowOverStyle="",""!=this.options.readOnlyBackgroundColor&&(this.readOnlyTdStyle="background-color:"+this.options.readOnlyBackgroundColor),""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(this.options.readOnlyBackgroundImgCSS?this.readOnlyTdImg=this.options.readOnlyBackgroundImgCSS:this.readOnlyTdImg="background:url("+this.options.readOnlyBackgroundImg+") no-repeat center center; background-size: cover"),
""!=this.options.disabledBackgroundColor&&(this.disabledTdStyle="background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(this.disabledTdStyle=""!=this.disabledTdStyle?this.disabledTdStyle+";":"",this.disabledTdStyle+="color:"+this.options.disabledFontColor),""!=this.options.rowNumBackgroundColor&&WebSquare.cssStyleSheet.addRule("#"+this.id+" ."+this.options.bodyTdClass+"_rowNumber","background-color:"+this.options.rowNumBackgroundColor),this.options.rowMouseOver&&(this.rowOverStyle="background-color:"+this.options.rowMouseOverColor),-1!=this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultHeaderCellHeight+"px"),-1!=this.options.defaultCellHeight&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" td."+this.options.bodyTdClass,"height:"+this.options.defaultCellHeight+"px"),-1==this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultCellHeight+"px"))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getGridClassName=function(t,e){try{return null==t||""==t?e:t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.grid2TableXml=function(t){try{var e=WebSquare.Elem.api.getElementsByTagName(this.element,t,a.v._XML_NAMESPACE.W2);return e.length>0?this.oneGrid2TableXml(e[0]):null}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.xml2JSON=function(t){try{var e={attr:{},rowArr:[],rowAttrArr:[]};e.attr=WebSquare.Parser.parseAttribute(t);for(var i=WebSquare.Elem.api.getElementsByTagName(t,"row",a.v._XML_NAMESPACE.W2),o=0;o<i.length;o++){e.rowAttrArr[o]=WebSquare.Parser.parseAttribute(i[o]);for(var r=WebSquare.Elem.api.getElementsByTagName(i[o],"column",a.v._XML_NAMESPACE.W2),n=[],l=0;l<r.length;l++){var h=WebSquare.Parser.parseAttribute(r[l]);h["@xml"]=r[l],n.push(h)}e.rowArr.push(n)}return e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.oneGrid2TableXml=function(t){try{var e=WebSquare.xml.serialize(t),i=e.indexOf("w2:header")>=0?"th":"td";return e=(e=(e=(e=(e=e.wq_replaceAll("w2:header",this.options.fixPrint?"tbody":"thead")).wq_replaceAll("w2:gBody","tbody")).wq_replaceAll("w2:footer","tbody")).wq_replaceAll("w2:row","tr")).wq_replaceAll("w2:column",i),WebSquare.xml.parse(e)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setColWidth=function(){try{var t=this.getColCnt();this.colWidthList=[],this.autoFitColWidthList=null,this.hiddenList=[],this.hiddenAdaptiveList=[];for(var e=0;e<t;e++)this.colWidthList[e]=null,this.hiddenList[e]=!1,this.hiddenAdaptiveList[e]=!1;this.initializeTableInfo()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getColCnt=function(){try{for(var t=0,e=this.htmlInfo?this.htmlInfo.head.rowArr[0]:this.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.initializeTableInfo=function(){try{var t=this,e=function(e){if(null==e)return null;for(var i=[],o=[],s=[],a=[],r=[],n=e.rowArr,l=[],h=0;h<n.length;h++){for(var d=[],u=0;u<t.colWidthList.length;u++)d.push(!1);l.push(d)}var p=0;t.options.rowNumVisible&&(i.push(0),s.push(0),a.push(n.length),r.push([p++])),t.options.rowStatusVisible&&(i.push(!0===t.options.rowNumVisible?1:0),s.push(0),a.push(n.length),r.push([p++]));for(h=0;h<n.length;h++){var c=n[h],g=0;for(u=0;u<c.length;u++){for(var f=c[u],m=parseInt(f.colSpan||1),y=parseInt(f.rowSpan||1);void 0!==l[h][g]&&l[h][g];)g++;f.colIndex=g+t.defaultColCnt,i.push(g+t.defaultColCnt),s.push(h),a.push(y);var b=f.width||"";if(m>1){if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;for(var w=0;w<m;w++){var v=g+w;t.colWidthList[v]=b,t.autofitColumnWidthArr[v+t.defaultColCnt]=b,t.autofitColumnIndexArr.push(v+t.defaultColCnt)}}o[i.length-1]=m}if(1==m&&null==t.colWidthList[g])if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;v=g;t.colWidthList[v]=b,
t.autofitColumnIndexArr.push(v+t.defaultColCnt),t.autofitColumnWidthArr[v+t.defaultColCnt]=b}else t.colWidthList[g]=parseInt(b||0);for(var C=0;C<m;C++){r[g+t.defaultColCnt+C]||(r[g+t.defaultColCnt+C]=[]),r[g+t.defaultColCnt+C].push(p),l[h][g+C]=!0,"true"==f.hidden&&(t.hiddenList[g+C]=!0);for(var I=1;I<y;I++)l[h+I][g+C]=!0}p++,delete f.hidden}}return{colIndexArr:i,colSpanArr:o,trIndexArr:s,rowSpanArr:a,colIndexMatch:r}};if(this.colIndexes={headerColInfo:e(this.struct.head),bodyColInfo:e(this.struct.body),footerColInfo:e(this.struct.foot)},this.hasSubtotal){this.colIndexes.subtotalColInfo=[];for(var i=0;i<this.struct.subtotalArr.length;i++){var o=e(this.struct.subtotalArr[i]);this.colIndexes.subtotalColInfo.push(o),this.colIndexes.subtotalColInfo[this.struct.subtotalArr[i].attr.targetColumnID]=o}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getFooterTable=function(){try{if(!this.hasFooter)return"";this.hasFooter=!0;var t="";this.options.footerSummary?t=this.options.footerSummary?" summary='"+this.options.footerSummary.wq_replaceAll("'","&#39;")+"'":"":this.options.captionTitle&&this.options.footerSummaryAuto&&(t=" summary='"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"'"),"html5"==WebSquare.docType&&(t="");var e="";if(e="<table id='"+this.id+"_foot_table' class='"+this.options.footerTableClass+"' style='position:absolute; bottom:0px; table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px;'"+t+">",this.options.footerCaption?e+="<caption>"+this.options.footerCaption+"</caption>":this.options.captionTitle&&this.options.footerCaptionAuto&&(e+="<caption>"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"</caption>"),e+=this.getColGroup(this.id+"_col_footer"),r.D.isSafari()||r.D.isChrome()&&r.D._getChromeVersion()<94)this._checkHeaderColSpan(this.htmlInfo.foot.rowArr)||(e+="<thead><tr></tr></thead>");else if(r.D.isIE()){for(var i="",o=0;o<this.getColCnt();o++)i+="<td></td>";e+="<thead style='visibility:collapse;'><tr>"+i+"</tr></thead>"}e+=this.getTableHtml(this.htmlInfo.foot,"tbody","td",this.options.footerTdClass),e+="</table>";var a=r.D.getDataPrefix("or_wd="),n=r.D.getDataPrefix("dis="),l=r.D.getDataPrefix("width=");return e=(e=e.wq_replaceAll(l,a)).wq_replaceAll("disabled=",n)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getBodyTable=function(){try{var t="width:"+this.gridWidth+"px;'";this.isIE6or7&&(t="'");var e="";this.options.summary&&"html5"!=WebSquare.docType&&(e=" summary = '"+(this.element.getAttribute("summary")||"").wq_replaceAll("'","&#39;")+"' ");var i="",o=!0===this._isNativeScroll()?"auto":"hidden",a=!0===this.options.scrollXNative?"auto":"hidden",n="";!0===this._isNativeScroll()?n=" "+this.options.gridNativeClass:!0===this._isHybridScroll()&&(n=" "+this.options.gridNativeClass+" "+this.options.gridHybridClass);var l=!0===this._isBrowserScroll()?"":" border-collapse:collapse";if(this.options.fixedColumnLineDiv?(i="<div id='"+this.id+"_fixedColumnDiv' style='display:none;' class='w2grid_fixedcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_fixedRightColumnDiv' style='display:none;' class='w2grid_fixedrightcolumn_line_div' tabindex='-1'></div>",i+="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+a+";overflow-y:"+o+";'>"):i="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:"+a+";overflow-y:"+o+";'>",i+=this.getGridHeaderFillerTable(this.headerXml,this.options.headerTdClass,this.options.headerTrClass,this.id+"_head_table",this.options.headerTableClass),i+="<table id='"+this.id+"_body_table' class='"+this.options.headerTableClass+n+"' style='position:absolute;left:0px;top:0px;table-layout:fixed;"+l+"; border-spacing:0px;"+t+e+">",this.captionXml){
var h=WebSquare.xml.parse("<caption/>"),d=null,u=WebSquare.Parser.parseAttribute(this.captionXml);for(var p in u){if("id"==p){var c=u[p];c&&h.documentElement.setAttribute("id",this.id+"_"+c)}else h.documentElement.setAttribute(p,u[p]);"value"==p&&(d=u[p])}if(d)h.documentElement.appendChild(h.createTextNode(d)),h.documentElement.removeAttribute("value");else for(var g=this.captionXml.getChildNodes(),f=0;f<g.length;f++)if(3===g[f].getNodeType()){var m=h.createTextNode(g[f].getNodeValue());h.documentElement.appendChild(m)}i+=WebSquare.xml.noNameSpaceSerialize(h)}if(this.isWebKit){if(!this.captionXml){var y="transparent",b="0";try{for(f=0;f<document.styleSheets.length;f++){var w=document.styleSheets[f];try{w.cssRules}catch(t){continue}for(var v=0;w.cssRules&&v<w.cssRules.length;v++){var C=w.cssRules[v];if(C.selectorText=="."+this.options.headerTableClass){y=C.style["border-top-color"],b=parseInt(C.style["border-top-width"])/2,f=document.styleSheets.length;break}}}}catch(t){s.w.printStackTrace(t,null,this)}i+="<caption style='height:"+b+"px;background-color:"+y+";'></caption>"}r.D.isSafari()||r.D.isChrome()&&r.D._getChromeVersion()<94?(i+=this.getColGroup(this.id+"_col_body"),this._checkHeaderColSpan(this.htmlInfo.head.rowArr)||(i+="<thead><tr></tr></thead>")):i+=this.getColGroup(this.id+"_col_body")}else i+=this.getColGroup(this.id+"_col_body");i+=this.getTableHtml(this.htmlInfo.head,"thead","th",this.options.headerTdClass),n="",!0===this._isBrowserScroll()&&(n=" class='"+this.options.gridNativeClass+"'"),i+="<tbody id='"+this.id+"_body_tbody'"+n+"></tbody>",i+="</table>",i+="</div>";var I=r.D.getDataPrefix("or_wd="),_=r.D.getDataPrefix("width=");return i=i.wq_replaceAll(_,I)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._checkHeaderColSpan=function(t){try{var e=!0;if(1==t.length)for(var i=t[0],o=0;o<i.length;o++){if((parseInt(i[o].colspan)||parseInt(i[o].colSpan)||1)>1)return!1}else e=!1;return e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getTableInfo=function(t,e,i){try{var a=o.x.extend({},t.attr),r=[],n=t.rowAttrArr||[{}],l=t.rowArr;a.id=this.id+"_"+e+"_tbody",a.style="";for(var h=0;h<l.length;h++){r.push([]);for(var d=0;d<l[h].length;d++){var u=o.x.extend({},l[h][d]);if(u.class=e+" "+e+"_data",this.isIE6or7){var p=parseInt(u.colSpan||"1"),c=parseInt(u.colIndex);if(p>1){for(var g=1;g<p;g++)0!=this.hgap[i+"_"+c]&&(this.hgap[i+"_"+(c+g)]=!0);this.hgap[i+"_"+c]=!0}else this.hgap[i+"_"+c]=!1}var f=u.textAlign,m=u.style?u.style+";":"";m=m+"text-align:"+(f||"center"),u.style=m,r[h].push(u)}}return{attr:a,rowArr:r,rowAttrArr:n}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getBodyHtmlInfo=function(){try{var t=this.options.bodyTdClass,e=this.options.bodyTrClass,i=this.getTableInfo(this.struct.body,t,e),o=i.attr,r=i.rowArr,n=i.rowAttrArr;this.oneRowLength=r.length,this.oneRowDataLength=0,this.tdIdList=[],this.bodyIdColIndexMap={},this._bodyIdMultiRowIndexMap={},this.colMoveIndexMap={};for(var l=0,h={},d=0;d<r.length;d++){n[d].trIndex=d,this.oneRowDataLength+=r[d].length;for(var u=0;u<r[d].length;u++){var c=r[d][u],g=c.style.split(";");if(g.length>0)for(var f=0;f<g.length;f++)if(g[f].indexOf(":")>-1){try{var m=g[f].split(":")[0].wq_trim(),y=g[f].split(":")[1].wq_trim();this.options.useDefaultStyle?this.setDefaultStyle(l,m,y):"text-align"!==m||c.textAlign?this.setColumnStyle(l,m,y):this._setInitStyle(l,m,y)}catch(t){s.w.printStackTrace(t,null,this)}if(!this.options.applyAllColumnStyle)break}var b=this.options.adaptiveStyle||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/adaptiveStyle/@value");if("none"==this.options.adaptiveStyle&&(b=""),b=c.adaptiveStyle||b,"none"==c.adaptiveStyle&&(b=""),b){var w=b.split(";");if(w.length>0)for(var v=0;v<w.length;v++)if(w[v].indexOf(":")>-1)try{var C=w[v].split(":")[0].wq_trim(),I=w[v].split(":")[1].wq_trim();this.setAdaptiveColumnStyle(l,C,I)}catch(t){s.w.printStackTrace(t,null,this)}}
"textarea"==c.inputType&&"all"==c.displayType&&(c.style+=";word-break:break-all;white-space:normal;");var _=c.id;if(null==c.col_id?(c.col_id=_,c.id=this.id+"_"+_,c["@xml"]=c["@xml"].cloneNode(!0),c["@xml"].setAttribute("col_id",_),c["@xml"].setAttribute("id",this.id+"_"+_)):_=c.col_id,this._setCellInfo(_,c["@xml"]),this.bodyIdColIndexMap[_]=l,this._bodyIdMultiRowIndexMap[_]=d,0==d&&(this.colMoveIndexMap[_]=l),h[_]){var x=WebSquare.language.getMessage("E_comp_duplicated_Msg",_)||"id["+_+"] was used repeatedly. Check the source code.";$l(x)}else h[_]=_;this.tdIdList.push(_),""===_&&p.k.printLog("warning : The "+this.id+" column name for column index "+l+" is missing."),l++}}return{attr:o,rowArr:r,rowAttrArr:n}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getHeaderHtmlInfo=function(){try{var t=this.options.headerTdClass,e=this.options.headerTrClass,i=this.getTableInfo(this.struct.head,t,e),o=i.attr,a=i.rowArr,r=i.rowAttrArr,n=[];this.thIdList=[],this.colMoveHeaderIndexMap={},o.id=this.id+"_head_table",o.class=this.options.headerTableClass;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.head.attr.style);l&&2==l.length&&(this.headerHeight=parseInt(l[1])),o.style=this.options.hideHeader?"display:none":"",this.headCellInfoHash={};for(var h=0;h<a.length;h++){n.push([]);for(var d=0;d<a[h].length;d++){var u=a[h][d],p=null,c=u.inputType,g=u.dataType,f=u.value;if(void 0!==f&&null!=f||void 0!==(f=u.defaultValue)&&null!=f||(f=""),"checkbox"==c)p="<input type='checkbox' style='border:0px solid blue;background-color:transprent;' />";else if("select"==c){var m="";if(this.options.chooseOption){if(m=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(b=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(m=b)}else if(this.options.allOption){m=WebSquare.language.getMessage("Grid_all")||"-all-"}else if("json"!==u["@xml"]._elementType){var y=(WebSquare.xml.serialize(u["@xml"]).match(/label\s*>[^<]+<\//)||"").toString();""!==y&&(m=y.slice(y.toString().indexOf(">")+1,-2))}p="<div style='width:100%;height:20px;top:0px;left:0px;position:relative;background-color:#ffffff' class='w2selectbox "+this.options.headerTdClass+" "+this.options.headerTdClass+"_data'><span style='display:none'></span><table class='w2selectbox_table_main'><tr class='w2selectbox_row w2selectbox_row_main'><td class='w2selectbox_col_label'><div class='w2selectbox_label'>"+m+"</div></td><td class='w2selectbox_col_button'></td></tr></table></div>"}else if("text"==c&&"own"==g)p="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";else{var b;if(this.options.useLocale&&u.localeRef)(b=this.getLocaleValue(u.localeRef))&&(f=b);f=null!=f?f:"";var w="";"span"==this.options.dataTag&&(w="class='w2grid_span'"),p="<"+this.options.dataTag+" "+w+" style='padding-top:0px; padding-left:4px;padding-right:4px' >"+f+this.dataTagClose}n[h].push(p),this.thIdList.push(u.id),this.headCellInfoHash[u.id]=u["@xml"],this._setHeaderInfo(u.id,u["@xml"]),null==u.col_id&&(u.col_id=u.id)}}return{attr:o,rowArr:a,rowAttrArr:r,headerTdHtml:n}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getFooterHtmlInfo=function(){try{for(var t=this.options.footerTdClass,e=this.options.footerTrClass,i=this.getTableInfo(this.struct.foot,t,e),o=i.attr,a=i.rowArr,r=i.rowAttrArr,n=0;n<a.length;n++)r[n]["data-trindex"]=n;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.foot.attr.style);return l&&2==l.length&&(this.footerHeight=parseInt(l[1])),{attr:o,rowArr:a,rowAttrArr:r}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getSubtotalHtmlInfo=function(t){try{var e=this.options.subtotalTdClass;this.subtotalClassList&&(e=t.attr.subtotalClass||"gridSubtotalDefault");for(var i=this.options.subtotalTrClass,o=this.getTableInfo(t,e,i),a=o.attr,r=o.rowArr,n=o.rowAttrArr,l=0;l<r.length;l++){n[l].trIndex=l,n[l].targetColumnID=a.targetColumnID
;for(var h=0;h<r[l].length;h++)r[l][h].class=r[l][h].class+" "+this.id+"_subtotal__column"+h,delete r[l][h].hidden}return{attr:a,rowArr:r,rowAttrArr:n}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getTableHtml=function(t,e,i,a){try{var n=t.attr,l=t.rowArr,h=t.rowAttrArr,d=[],u="";if(!0===this._isBrowserScroll()){var p={};o.x.extend(p,n);var c=this.options.gridNativeClass;!0===this._isHybridScroll()&&"string"==typeof e&&"thead"===e.toLowerCase()&&(c=this.options.gridHybridClass),p.class?p.class+=" "+c:p.class=c,u=this.getAttributesString(p)}else u=this.getAttributesString(n);d.push("<"+e+u+">");var g="",f="";l.length>=2&&(g=!1===this.options.rowNumRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'",f=!1===this.options.rowStatusRowSpan?" rowSpan='1'":" rowSpan='"+l.length+"'");var m="";!0===this._isBrowserScroll()&&t===this.htmlInfo.head&&(m=" "+this.options.gridNativeClass);for(var y=r.D.getDataPrefix("colIndex"),b=r.D.getDataPrefix("value"),w=0;w<l.length;w++){if(t==this.htmlInfo.head?d.push("<tr"+this.getAttributesString(h[w])+" class='gridHeaderStyle_"+w+m+"'>"):t==this.htmlInfo.foot?d.push("<tr"+this.getAttributesString(h[w])+" class='gridFooterStyle_"+w+"'>"):d.push("<tr"+this.getAttributesString(h[w])+">"),0==this.options.rowNumRowSpan&&this.options.rowNumVisible)if(w===l.length-1){var v="";t==this.htmlInfo.head&&(v=this.options.rowNumHeaderValue),d.push("<"+i+g+" class='"+a+" "+a+"_rowNumber' "+b+"='"+v+"' "+y+"='0' id='_headerRowNumber'></"+i+">")}else d.push("<"+i+g+" class='"+a+" "+a+"_rowNumber' "+b+"='' "+y+"='0' id='_headerRowNumber'></"+i+">");else if(0===w){v="";t==this.htmlInfo.head&&(v=this.options.rowNumHeaderValue),this.options.rowNumVisible&&d.push("<"+i+g+" class='"+a+" "+a+"_rowNumber' "+b+"='"+v+"' "+y+"='0' id='_headerRowNumber'></"+i+">")}if(!1===this.options.rowStatusRowSpan){if(w===l.length-1){var C="";t==this.htmlInfo.head&&(C=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+a+" "+a+"_rowStatus' "+b+"='"+C+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else if(this.options.rowStatusVisible)if(this.options.rowStatusColSpan&&0==w){var I=1;l[w][0].colSpan?I+=Number(l[w][0].colSpan):I++;var _=" colSpan='"+I+"'",x=l[w][0].value;d.push("<"+i+f+_+" class='"+a+" "+a+"_rowStatus' "+b+"='"+x+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else d.push("<"+i+f+" class='"+a+" "+a+"_rowStatus' "+b+"='' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else if(0==w){C="";t==this.htmlInfo.head&&(C=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&d.push("<"+i+f+" class='"+a+" "+a+"_rowStatus' "+b+"='"+C+"' "+y+"='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}for(var S=0;S<l[w].length;S++){if(a!==this.options.subtotalTdClass&&a!==this.options.footerTdClass||null==l[w][S].columnClass)if(this.subtotalClassList&&l[w][S].columnClass){for(var D=0;D<this.subtotalClassList.length;D++)if(this.subtotalClassList[D]&&a===this.subtotalClassList[D]){R=l[w][S].class;l[w][S].class=l[w][S].columnClass+" "+l[w][S].class,d.push("<"+i+this.getAttributesString(l[w][S])+">"),l[w][S].class=R;break}}else d.push("<"+i+this.getAttributesString(l[w][S])+">");else{var R=l[w][S].class;l[w][S].class=l[w][S].columnClass+" "+l[w][S].class,d.push("<"+i+this.getAttributesString(l[w][S])+">"),l[w][S].class=R}t.headerTdHtml&&t.headerTdHtml[w][S]&&d.push(t.headerTdHtml[w][S]),d.push("</"+i+">")}d.push("</tr>")}return d.push("</"+e+">"),d.join("")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getGridHeaderFillerTable=function(t,e,i,o,a){try{if(!this.options.headFiller)return"";var r=[],n="";return this.options.hideHeader&&(n="display:none"),r.push("<table class='"+this.options.headerTableClass+"' style='z-index:-1;position:absolute;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px; '>"),
r.push("<tbody id='"+this.id+"_"+e+"_tbody_tmp' style='"+n+"' class='"+a+"'>"),r.push("<tr class='"+i+"'>"),r.push("<td style='' id='"+this.id+"_header_bg_td' class='"+e+" "+e+"_rowNumber'>&nbsp;</td>"),r.push("</tr>"),r.push("</tbody>"),r.push("</table>"),r.join("")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getColGroup=function(t){try{return this.colGroupArr.join("").wq_replaceAll("colGroupID",t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.initializeLayoutEvents=function(){try{if(!0!==this.options.scrollXNative&&this.event.addListener2(this.getElementById(this.id+"_scrollX_right"),"onscroll",this.handleScrollX,this),!0!==this._isBrowserScroll()&&(this.event.addListener2(this.render,"onmousewheel",this.handleWheel,this),this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollY,this)),!0===this._isHybridScroll())if(this.event.addListener2(document.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollYHybrid,this),r.D.isMobile())this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchstart",this.handleTouchStartHybrid,this),this.event.addListener2(document.getElementById(this.id+"_main_div"),"ontouchmove",this.handleTouchMoveHybrid,this);else{var t="onwheel"in window?"onwheel":"onmousewheel";this.event.addListener2(document.getElementById(this.id+"_main_div"),t,this.handleWheelHybrid,this)}this.options.groupbyZone&&(this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onclick",this.handleGroupbyZoneClick,this),this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onmousedown",this.handleChangeGroupDepth,this)),this.options.resize&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousemove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endColumnResize)),this.options.rowResize&&(this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousemove",this.event.bindAsEventListener(this,this.handleRowResize)),this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousedown",this.event.bindAsEventListener(this,this.doRowResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endRowResize))),r.D.isIE()&&a.v.browserVersion()<=8&&this.event.addListener(this.render,"onmousemove",this.event.bindAsEventListener(this,(function(t){(this.resizeStarted||this.options.rowResize&&this.rowResizeStarted||null!=this.columnMoveTarget)&&u.B.preventDefault(t)})))),this.options.resize&&r.D.isTouchDevice()&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchmove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchstart",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"ontouchend",this.event.bindAsEventListener(this,this.endColumnResize)))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleScrollX=function(t){try{var e=u.B.getTarget(t);e&&(this._scrollXPrev||(this._scrollXPrev={}),this._scrollXPrev.scrollLeft===e.scrollLeft&&this._scrollXPrev.scrollTop===e.scrollTop&&this._scrollXPrev.scrollWidth===e.scrollWidth&&this._scrollXPrev.scrollHeight===e.scrollHeight&&(this.scrollXPreventEndEdit=!0),this._scrollXPrev.scrollLeft=e.scrollLeft,this._scrollXPrev.scrollTop=e.scrollTop,this._scrollXPrev.scrollWidth=e.scrollWidth,this._scrollXPrev.scrollHeight=e.scrollHeight),a.v.clearTimer(this.id+"_completiveDrawData",!0),a.v.clearTimer(this.id+"_applyStyleOptions",!0),null==this.editedCell||this.scrollXPreventEndEdit||this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t]),this._handleScrollX(),
this.scrollXPreventEndEdit&&this.editedCell&&this.editedCell.setPosition&&this.editedCell.setPosition(),this.scrollXPreventEndEdit=!1,u.B.fireEvent(this,"onscrollx",t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._handleScrollX=function(){try{this.body_table||(this.head_table=this.getElementById(this.id+"_head_table"),this.body_table=this.getElementById(this.id+"_body_table"),this.hasFooter&&(this.foot_table=this.getElementById(this.id+"_foot_table")),this.scrollX_right=this.getElementById(this.id+"_scrollX_right")),void 0!==this.colGroup&&null!=this.colGroup||(this.colGroup={},this.colGroup.bodyColList=this.body_table.getElementsByTagName("col"),this.hasFooter?this.colGroup.footerColList=this.foot_table.getElementsByTagName("col"):this.colGroup.footerColList=null);var t=0;if(this.options.scrollByColumn){var e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;e>1?t=1+Math.round(e):e<1&&(t=1+Math.round(1/e))}var i=this.getFixedColumnLastIndex(),o=this.scrollX_right.scrollLeft,a=this.gridWidth-o-t-this.fixedWidth-1-this.fixedWidthRight,n=a;a=a>0?a:0;var l=this.options.fixedRightColumn>0;if(!l){if(this.head_table.style.width=a+"px",this.isWebKit){for(var h=[],d=this.defaultColCnt;d<this.hiddenList.length;d++)1==this.hiddenList[d]&&h.push(d-this.defaultColCnt);(A=a-this.colGroup.bodyColList.length-h.length-1)<0&&(A=0),this.body_table.style.width=A+"px",this.hasFooter&&(this.foot_table.style.width=A+"px")}else this.body_table.style.width=a+"px",this.hasFooter&&(this.foot_table.style.width=a+"px");this.hasFooter&&(this.foot_table.style.width=a+"px")}var u=[],p=[],c=0,g=-1,f=0;if(l||this.options.scrollByColumn||r.D.isIE(8)){var m=this._getScrollYWidth()-1;if(c=(f=this.resizeObj&&this.resizeObj.clientWidth?this.resizeObj.clientWidth:this.render.clientWidth)-1-this.fixedWidth-this.fixedWidthRight,r.D.isChrome()&&(c+=1),-1!=m&&(c-=m),l){this.options.scrollByColumn=!1;var y=f-1-m;y<this.gridWidth&&(this.head_table.style.width=f-1-m+"px",this.body_table.style.width=f-1-m+"px",this.hasFooter&&(this.foot_table.style.width=f-1-m+"px"))}}var b=this.getFixedRightColumnLastIndex(),w=l,v=-1;for(d=this.colWidthList.length-1;d>=b;d--)this.hiddenList[d]||(this.colGroup.bodyColList[d].style.width=this.colWidthList[d]+"px");for(d=b-1;d>=0;d--){var C=0,I=parseInt(this.colWidthList[d],10)||0;if(this.hiddenList[d]&&(I=0),l&&w)if(a>c+I)a-=I,I=0;else{var _=I;y<this.gridWidth&&(I-=a-c),a-=_,w=!1,v=d}else a>I?a-=I:(a>0&&n<=c&&(g=d,this.options.scrollByColumn&&(C=a)),I=a,a=0),d<i&&!this.hiddenList[d]&&(I=parseInt(this.colWidthList[d],10)||0);var x=0,S=0;if(this.isIE6or7&&0!=I&&(1==this.hgap[this.options.headerTrClass+"_"+d]?0:1,x=1==this.hgap[this.options.bodyTrClass+"_"+d]?0:1,this.hasFooter&&(S=1==this.hgap[this.options.footerTrClass+"_"+d]?0:1)),r.D.isIE(8)&&0==this.defaultColCnt&&0==d&&0==I&&(I=1,g>=0&&(u[g]=u[g]-1,this.colGroup.bodyColList[g].style.width=u[g]+"px",this.hasFooter&&(p[g]=p[g]-1,this.colGroup.footerColList[g].style.width=p[g]+"px"))),this.options.scrollByColumn){var D=this.colWidthList[d];1==I&&r.D.isIE(8)&&0==this.defaultColCnt&&0==d&&(D=1),0==I&&(D=0),C>0&&(D=C),v===d&&(D=0),(0==D||1==D||D==this.colWidthList[d]||C>0||v===d)&&(this.colGroup.bodyColList[d].style.width=D-x+"px",u[d]=D-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=D-S+"px",p[d]=D-S))}else this.hiddenList[d]&&(I=0),this.colGroup.bodyColList[d].style.width=I-x+"px",u[d]=I-x,this.hasFooter&&(this.colGroup.footerColList[d].style.width=I-S+"px",p[d]=I-S)}m=this._getScrollYWidth("offsetWidth");if(this.isWebKit&&-1==this.options.className.indexOf("w2gridViewItemTable")&&0===m&&"allColumn"===this.options.autoFit&&!this.options.autoFitMinWidth){var R=WebSquare.style.getSize(this.render,"outerwidth")-WebSquare.style.getSize(this.render,"width"),L=this.render.getBoundingClientRect().width-R,T=!0;this.head_table.getBoundingClientRect().width<=0&&(T=!1);for(d=b-1;d>=0;d--){
var k=L-(T?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width),F=1;if(!(k>=0))break;if(!this.hiddenList[d]){if(k<2)break;var A=parseInt(this.colGroup.bodyColList[d].style.width);this.colGroup.bodyColList[d].style.width=A+F+"px",u[d]=A+F,(k=L-(T?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width))<1&&(F=-1,this.colGroup.bodyColList[d].style.width=A+F+"px",u[d]=A+F),this.hasFooter&&(this.colGroup.footerColList[d].style.width=A+F+"px",p[d]=A+F)}}}this.setColIndexInfo(u,p),this._setGridBorder(),(this.groupbyZoneStatus.groupbyZoneRender||this.options.useFilterList)&&(this.resizeGroupbyZone(),this.resizeGridList()),r.D.setTimeout(this.displayFixedColumnLine,{key:this.id+"_displayFixedColumnLine",caller:this,delay:10})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.redrawTable=function(){try{if(this.isWebKit)if(!0===this._isBrowserScroll()){var t=this.colGroup.bodyColList[0],e=t.offsetWidth,i=t.id;t.style.width=e+1+"px",r.D.setTimeout((function(){document.getElementById(i).style.width=e+"px"}),{key:this.id+"_redrawTable",delay:20})}else{null==this._redrawTable_transform&&(this._redrawTable_transform=this.body_table.style.webkitTransform),this.body_table.style.webkitTransform="rotateZ(0deg)";var o=this.uuid;r.D.setTimeout((function(){var t=WebSquare.idCache[o];t.body_table.style.webkitTransform=t._redrawTable_transform,delete t._redrawTable_transform}),{key:this.id+"_redrawTable",delay:20})}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setColIndexInfo=function(t,e){try{if(void 0===this.colGroup||null==this.colGroup){this.colGroup={},this.colGroup.bodyColList=this.getElementById(this.id+"_body_table").getElementsByTagName("col");var i=this.getElementById(this.id+"_foot_table");this.colGroup.footerColList=i?i.getElementsByTagName("col"):null}this.colIndexInfo={};var o=this.getVisibleColRange(this.colGroup.bodyColList,t),a=this.getVisibleTds(this.colIndexes.bodyColInfo,o);if(this.colIndexInfo.body={colInfo:this.colIndexes.bodyColInfo,visibleTds:a.visibleTds,invisibleTds:a.invisibleTds,visibilityArr:a.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.isIE6or7){var r=this.getVisibleTds(this.colIndexes.headerColInfo,o);if(this.colIndexInfo.header={colInfo:this.colIndexes.headerColInfo,visibleTds:r.visibleTds,invisibleTds:r.invisibleTds,visibilityArr:r.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.hasFooter){var n=this.getVisibleColRange(this.colGroup.footerColList,e),l=this.getVisibleTds(this.colIndexes.footerColInfo,n);this.colIndexInfo.footer={colInfo:this.colIndexes.footerColInfo,visibleTds:l.visibleTds,invisibleTds:l.invisibleTds,visibilityArr:l.visibilityArr,firstCoveredColIndex:n.firstCoveredColIndex}}if(this.hasSubtotal)for(var h in this.colIndexInfo.subtotal={},this.subtotalRowHash){var d=this.getVisibleTds(this.colIndexes.subtotalColInfo[h],o);this.colIndexInfo.subtotal[h]={colInfo:this.colIndexes.subtotalColInfo[h],visibleTds:d.visibleTds,invisibleTds:d.invisibleTds,visibilityArr:d.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex}}}this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideInvisibleTds=(d=!0,function(){try{if(d){if(d=!1,this.groupbyStatus.grouped){this.options.lazyDrawHiddenColumn=!1;var t=WebSquare.language.getMessage("Grid_warning6",this.id)||this.id+" The groupby is enabled and the lazyDrawHiddenColumn is disabled.";return void $l(t)}for(var e=this.defaultColCnt;e<this.colIndexes.bodyColInfo.rowSpanArr.length;e++)if(this.colIndexes.bodyColInfo.rowSpanArr[e]>=2){this.options.lazyDrawHiddenColumn=!1;var i=WebSquare.language.getMessage("Grid_warning7",this.id)||this.id+" : rowSpan is enabled the lazyDrawHiddenColumn is disabled.";return void $l(i)}}var o=this.colIndexInfo.body.visibilityArr,a=[]
;for(e=0;e<this.drawedRowLength;e++)if("none"!=this.dataRowList[e].style.display)for(var r=0,n=0,l=this.defaultColCnt;l<o.length;l++){this.colIndexes.bodyColInfo.trIndexArr[l]>r&&(n=0,r++);var h=this._getColumnMoveIndex(l-this.defaultColCnt),u=this.data_td_list[h+e*this.oneRowDataLength],p=this.colIndexes.bodyColInfo.colSpanArr[l]||1;o[l]?(this.initVisibilityArr[l]||(this.drawCellData(e,e+this.rowIndex,h),this.applyCellStyleOptions(e+this.rowIndex,h),a[l]=!0),u.style.display="",p+n>1?(u.setAttribute("colSpan",p+n),u.setAttribute("data-lazydrawtd","true")):(u.removeAttribute("colSpan"),u.removeAttribute("data-lazydrawtd")),n=0):(u.style.display="none",n+=p)}for(e=0;e<a.length;e++)a[e]&&(this.initVisibilityArr[e]=!0)}catch(t){s.w.printStackTrace(t,null,this)}}),c.prototype.getVisibleColRange=function(t,e){try{for(var i=this.render.clientWidth,o=[],a=0,r=-1,n=-1,l=e?e.length:t.length,h=0;h<l;h++){var d=e?e[h]:parseInt(t[h].style.width);if((a+=d)>i){r>=0?(d<3?o.push([r,h]):o.push([r,h+1]),n=h+1,r=-1):(o.push([h,h+1]),n=h+1);break}d<3?-1!=r&&(o.push([r,h]),r=-1):-1==r&&(r=h)}return-1!=r&&r<h&&o.push([r,h]),o.firstCoveredColIndex=-1!==n?n:l,-1==n&&(n=l),o}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getVisibleTds=function(t,e){try{for(var i=[],o=[],a=[],r=0;r<t.colIndexArr.length;r++){for(var n=t.colIndexArr[r],l=t.colSpanArr[r]||1,h=0;h<e.length;h++)if(e[h][0]<=n&&n<e[h][1]||e[h][0]<=n+l-1&&n+l-1<e[h][1]||n<=e[h][0]&&e[h][0]<n+l||n<=e[h][1]-1&&e[h][1]-1<n+l){i[i.length]=r,a[a.length]=!0;break}h==e.length&&(o[o.length]=r,a[a.length]=!1)}return{visibleTds:i,invisibleTds:o,visibilityArr:a}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setGridBorder=function(){try{var t=r.D.getDataPrefix("colIndex");if(r.D.isIE(8)){if(0==this.defaultColCnt){var e=this.colGroup.bodyColList[0].style.width,i="1px"==e||"0px"==e?"0px":"";if(!this.leftMostTds){this.leftMostTds=[];for(var o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),a=this.hasFooter?this.getElementById(this.id+"_foot_table").getElementsByTagName("td"):[],n=0;n<o.length;n++)0==o[n].getAttribute(t)&&this.leftMostTds.push(o[n]);for(n=0;n<a.length;n++)0==a[n].getAttribute(t)&&this.leftMostTds.push(a[n])}for(n=0;n<this.leftMostTds.length;n++)this.leftMostTds[n].style.borderLeftWidth=i,this.leftMostTds[n].style.borderRightWidth=i;if(this.all_data_td_list.length>0){if(!this.leftMostIndexArr){this.leftMostIndexArr=[];for(n=0;n<this.oneRowDataLength;n++)0==this.all_data_td_list[n].getAttribute(t)&&this.leftMostIndexArr.push(n)}for(n=0;n<this.leftMostIndexArr.length;n++)for(var l=0;l<this.drawedRowLength;l++){(h=this.all_data_td_list[this.leftMostIndexArr[n]+l*this.oneRowDataLength]).style.borderLeftWidth=i,h.style.borderRightWidth=i}}if(this.hasSubtotal&&this.drawedSubtotal)for(n=0;n<this.drawedSubtotal.length;n++)for(l=0;l<this.drawedSubtotal[n].length;l++){var h;0==(h=this.drawedSubtotal[n][l].cells[0]).cellIndex&&(h.style.borderLeftWidth=i,h.style.borderRightWidth=i)}}if(!this._setGridBorderNoRefresh){var d=(p=this.getElementById(this.id+"_dataLayer")).style.display,u=document.activeElement;p.style.display="none",p.offsetHeight,p.style.display=d,document.activeElement!=u&&this.hasClass(u,this.options.bodyTdClass)&&u.focus()}}if(this.isIE6or7&&(this.colIndexInfo||this.setColIndexInfo(),this.colGroup&&(this._setBorderFolding(this.all_data_td_list,this.colIndexInfo.body,this.drawedRowLength),this.headerTds||(this.headerTds=this.getElementById(this.id+"_head_table").getElementsByTagName("th")),this._setBorderFolding(this.headerTds,this.colIndexInfo.header)),this.hasFooter&&(this.footerTds||(this.footerTds=this.getElementById(this.id+"_foot_table").getElementsByTagName("td")),this._setBorderFolding(this.footerTds,this.colIndexInfo.footer)),this.hasSubtotal&&this._setSubtotalBorder(),!this._setGridBorderNoRefresh)){var p,c=(p=this.getElementById(this.id+"_dataLayer")).style.filter;u=document.activeElement;p.style.filter="alpha(opacity=99)",
p.style.filter=c,document.activeElement!=u&&this.hasClass(u,this.options.bodyTdClass)&&u.focus()}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setBorderFolding=function(t,e,i){try{if(this.groupbyStatus.grouped)return;if(!t||0==i)return;i=i||1;for(var o=e.firstCoveredColIndex,a=this.oneRowDataLength+this.defaultColCnt,r=0,n=e.visibilityArr.length;r<n;r++){var l=e.colInfo.colIndexArr[r],h=e.visibilityArr[r],d="0px"===t[r].style.borderWidth;if(i>1&&(d=d||"0px"===t[r+a].style.borderWidth),l<o&&!h&&!d)for(var u=0;u<i;u++)t[r+u*a].style.borderWidth="0px";else if((l>=o||h)&&d)for(u=0;u<i;u++)t[r+u*a].style.borderWidth="",t[r+u*a].style.borderStyle=""}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setSubtotalBorder=function(){try{if(!this.drawedSubtotal)return;for(var t={},e=0;e<this.drawedSubtotal.length;e++){var i=this.drawedSubtotal[e];if(!t[i.targetID]){t[i.targetID]=!0;for(var o=this.colIndexInfo.subtotal[i.targetID],a=o.firstCoveredColIndex,r=0,n=0;n<i.length;n++)for(var l=i[n],h=0;h<l.cells.length;h++,r++){var d=o.colInfo.colIndexArr[r],u=o.visibilityArr[r],p="0px"===l.cells[h].style.borderWidth;if(d<a&&!u&&!p)for(var c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="0px");else if((d>=a||u)&&p)for(c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="")}}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleWheel=function(t){try{if(this.options.groupbyZone||this.options.useFilterList)for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone_scrollView")||e.match("w2grid_customFilter_scrollView"))return void u.B.stopPropagation(t);var i=u.B.getMouseWheelDelta(t),o=t.wheelDeltaY,a=t.wheelDeltaX,n=Math.floor(this.options.wheelRows*Math.abs(i));if("wheelDeltaX"in t&&Math.abs(a)>Math.abs(o))return this.getElementById(this.id+"_scrollX_right").scrollLeft-=a,void u.B.stopEvent(t);var l=this.getElementById(this.id+"_scrollY_div");if(this.scrollEvent=!0,i>0){if(0==l.scrollTop)return void(this.options.wheelStop&&u.B.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)-n)}else if(i<0){var h=this.getElementById(this.id+"_scrollY_div"),d=this._getEpsilon(),p=h.scrollHeight-h.clientHeight,c=Math.min(Math.round(h.scrollTop)+d,p);if(this.rowIndex<0||0==h.clientHeight||c==p)return void(this.options.wheelStop&&u.B.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)+n)}r.D.isMobile()&&this.moveYScroll(0),this.hideTooltip(),u.B.stopEvent(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleWheelHybrid=function(t){try{if(!0!==this._useHybridScroll())return;u.B.preventDefault(t);var e=0;if("wheel"===t.type)e=t.deltaY;else e=-100*u.B.getMouseWheelDelta(t);this._setHybridWheelDeltaY(e)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleTouchStartHybrid=function(t){try{this._hybridMobileStartX=t.touches[0].clientX,this._hybridMobileStartY=t.touches[0].clientY}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleTouchMoveHybrid=function(t){try{if(!0!==this._useHybridScroll())return;var e=this._hybridMobileStartX-t.touches[0].clientX,i=this._hybridMobileStartY-t.touches[0].clientY;Math.abs(e)>Math.abs(i)?this._setHybridWheelDeltaX(e):this._setHybridWheelDeltaY(i),u.B.preventDefault(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleColumnResize=function(t){try{if(2==t.button)return;var e,i,o,a,n,l,h=r.D.getDataPrefix("colIndex"),d=r.D.getDataPrefix("header_id");if("drag"!==this.resizeStatus){for(var p=this.event.getTargetIterator(t,this.render),c=null;p.next();){var g=p.getElement();if("TH"!=g.tagName&&"TD"!=g.tagName||(c=g),"NOBR"==g.tagName||"SPAN"==g.tagName&&g.className.indexOf("w2grid_span")>-1){c=null;break}}if(null!=c){e=u.B.getMouseX(t),i=WebSquare.style.getAbsoluteLeft(c),
o=parseInt(c.getAttribute("colSpan")||1,10),a=parseInt(c.getAttribute(h),0),n=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;var f=WebSquare.style.getComputedStyle(document.body,"zoom");1==n&&f&&(n=parseFloat(f)),e/=n,l=i;var m=a,y=c.getAttribute(d);"_headerRowNumber"!=y&&"_headerRowStatus"!=y&&(m=this._getRealColIndex("head",y)+this.defaultColCnt),m=this._getMouseColumnIndex({colIndex:a,offsetX:e,offsetLeft:l,colSpan:o}),"col-resize"===this.resizeStatus&&!1===this.isColumnResizable(m)&&(this.resizeStatus="init")}}switch(this.resizeStatus){case"init":this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="";break;case"col-resize":this.getElementById(this.id+"_head_table").style.cursor="col-resize",this.getElementById(this.id+"_head_table").cursor="col-resize";break;case"drag":return this.resizeStatus="drag",this.handleResizeLine(t),void(r.D.isMobile()&&u.B.stopEvent(t))}if(null!=this.columnMoveTarget)return;if(null==c)return void(this.resizeStatus="init");if(e-l<(w=.3*this.colWidthList[a]>10?10:parseInt(.3*this.colWidthList[a],10))&&0!=a){if("init"===this.resizeStatus||"col-resize"===this.resizeStatus)return void(this.isColumnResizable(a)&&(this.resizeStatus="col-resize"))}else this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus;if("_headerRowNumber"!=y&&"_headerRowStatus"!=y)for(var b=0;b<o;b++){if(1==this.options.columnMove){c.getAttribute(d);a=this._getRealColIndex("head",y)+this.defaultColCnt}var w,v=parseInt(this.colGroup.bodyColList[a+b].style.width,10);if((l+=v)-(w=.3*v>10?10:parseInt(.3*v,10))<e&&e<l+w)return void("init"!==this.resizeStatus&&"col-resize"!==this.resizeStatus||this.isColumnResizable(a)&&(this.resizeStatus="col-resize"));this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.doColumnResize=function(t){try{if(2==t.button)return;if(r.D.isMobile()&&this.handleColumnResize(t),!this.options.columnMove&&!this.options.groupbyZone&&"init"==this.resizeStatus||"drag"==this.resizeStatus)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_colIndex=null,this.resize_colId=null;e.next();)e.match(this.options.headerTdClass)&&(i=e.getElement());if(null==i)return;this.startResizeX=u.B.getScreenX(t);var o=r.D.getDataPrefix("header_id"),a=r.D.getDataPrefix("colindex"),n=r.D.getDataPrefix("value"),l=i.getAttribute(o);if("col-resize"==this.resizeStatus){u.B.preventDefault(t),this.resizeStarted=!0,this.resizeStatus="drag";var h=u.B.getMouseX(t),d=WebSquare.style.getAbsoluteLeft(i),p=parseInt(i.getAttribute("colSpan")||1,10),c=this._getRealColIndex("head",l)+this.defaultColCnt;"_headerRowNumber"!=l&&"_headerRowStatus"!=l||(c=parseInt(i.getAttribute(a),10));var g=d;this.resizeColIndex=this._getMouseColumnIndex({colIndex:c,offsetX:h,offsetLeft:g,colSpan:p})}else if(this.options.columnMove&&(0===this.getHeaderRowIndex(l)||this.options.allColumnMove)){this.resizeStatus="drag";var f=null,m=this.htmlInfo.head.rowArr[0],y=!0;if(0!=parseInt(this.options.stopColumnMoveRow,10))for(var b=0;b<m.length;b++)if(m[b].id==l){y=!1;break}if(this.options.allColumnMove)for(b=1;b<this.htmlInfo.head.rowArr.length;b++)if(parseInt(this.options.stopColumnMoveRow,10)!=b)for(var w=0;w<this.htmlInfo.head.rowArr[b].length;w++)if(this.htmlInfo.head.rowArr[b][w].id==l){y=!1,f=l,l=this.htmlInfo.head.rowArr[0][w].id;break}if(y)return;this.resizeStauts="init","_headerRowNumber"!=l&&"_headerRowStatus"!=l&&(null!=f&&(this.realColumnMoveTarget=this.getHeaderIndex(f)),this.columnMoveTarget=this.getHeaderIndex(l),this.columnMoveTargetId=l,this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),r.D.emptySelection())}else if(this.options.groupbyZone&&(this.resizeStatus="drag","_headerRowNumber"!=l&&"_headerRowStatus"!=l)){if(this.groupbyZoneStatus.clickedHeaderInfo={},
this.groupbyZoneStatus.clickedHeaderInfo.index=this._getRealHeaderColIndex(l),this.groupbyZoneStatus.clickedHeaderInfo.value=i.getAttribute(n),this.groupbyZoneStatus.clickedHeaderInfo.headerID=l,null==this.groupbyStatus.sortIndexArr||null==this.groupbyStatus.sortOrderArr||this.options.groupbyFilterIcon)this.showGroupbyHeaderGhost(t,l);else{this.resizeStatus="init";var v=!1,C={};C.render=i,C.parentRender=this.render.getElementsByTagName("div")[0],C.headerID=i.getAttribute(o),C.headerIndex=this.getHeaderIndex(C.headerID);for(b=0;b<this.groupbyStatus.sortIndexArr.length;b++)if(C.headerIndex==this.groupbyStatus.sortIndexArr[b]){v=!0;break}v?this.groupbyFilterList?this.toggleGroupbyFilterList(C):this.createGroupbyFilterList(C):(this.hideGroupbyFilterList(),this.showGroupbyHeaderGhost(t,l))}this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),r.D.emptySelection()}this.handleResizeLine(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.endColumnResize=function(t){try{if(2==t.button)return;if("drag"!==this.resizeStatus&&(this.resizeStatus="init"),this.options.columnMove&&null!=this.columnMoveTarget){var e=this.event.getTargetIterator(t,this.render),i=null;if(this.event.isMe(t,this.render))for(;e.next();)e.match(this.options.headerTdClass)&&(e.match(this.options.headerTdClass+"_rowNumber")||e.match(this.options.headerTdClass+"_rowStatus")||(i=e.getElement()),e.stop());var o=this.resize_colId;if(null!=i){var a=r.D.getDataPrefix("header_id");o=i.getAttribute(a)||this.resize_colId}this.moveColumnByHeaderId(this.columnMoveTargetId,o),this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),r.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo){for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone")){e.getElement(),null==this.groupbyStatus.sortIndexArr&&(this.groupbyStatus.sortIndexArr=[]),null==this.groupbyStatus.sortOrderArr&&(this.groupbyStatus.sortOrderArr=[]);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)if(this.groupbyZoneStatus.clickedHeaderInfo.index==this.groupbyStatus.sortIndexArr[n])return this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<=this.groupbyStatus.sortIndexArr.length)return p.k.printLog("groupby max column count has been exceeded.["+this.id+"]"),this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);this.groupbyStatus.sortIndexArr.push(this.groupbyZoneStatus.clickedHeaderInfo.index),this.groupbyStatus.sortOrderArr.push(1);var l={};if(l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,null!=this.groupbyStatus.filter&&(l.filter=this.groupbyStatus.filter),!1===u.B.fireEvent(this,"ongroupby",l)){var h=this.getColCnt()+this.defaultColCnt,d=WebSquare.language.getMessage("Grid_cases")||"cases";l.rowNumHeader={colSpan:h,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+d+" ] ' ",align:"left"},l.footerVisible=!1,l.rowNumFooter={colSpan:h},this.groupby(l)}this.groupbyFilterList&&this.hideGroupbyFilterList();break}this.groupbyZoneStatus.clickedHeaderInfo=null,this.resizeStatus="init",this.handleResizeLine(t),r.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if("drag"===this.resizeStatus){this.endResizeX=u.B.getScreenX(t);for(var c=this.resizeColIndex;1==this.hiddenList[c]&&!(--c<0););var g=this.colWidthList[c];if(c>=0&&this.isColumnResizable(c)){g=this.colWidthList[c];var f=this.getElementById(this.id+"_dataLayer").offsetWidth,m=g+this.endResizeX-this.startResizeX,y=0;if(this.options.fixedColumn>0){var b=this.getFixedColumnLastIndex();if(b>=c){for(n=0;n<b;n++)this.hiddenList[n]||(y+=n==c?m:this.colWidthList[n])
;var w=30;null==this.colWidthList[b]&&(w=1),y>f-w&&(m=m-(y-f)-w-1)}}var v=this.cellInfoHash[this.getColumnID(this.columnOrder[c-this.defaultColCnt])];(m=v&&m<v.options.minWidth?v.options.minWidth:m)&&g&&this.resizeObj.width&&(this.resizeObj.width=this.resizeObj.width+m-g),0!=Math.abs(g-m)&&(this.setColumnWidth(c,m,!0),u.B.fireEvent(this,"onaftercolumnresize",c-this.defaultColCnt,g,m))}this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),r.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");if(this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.options.columnMove&&null!=this.columnMoveTarget){for(var i=this.event.getTargetIterator(t,this.render),o=null;i.next();)i.match(this.options.headerTdClass)&&(o=i.getElement());if(null!=o){this.columnBlock||this.createBlockedHeaderInfo();var a=this.columnMoveTargetId,n=this.getHeaderColIndex(a);n=this.columnBlock.hash[n-this.defaultColCnt],a=this.getHeaderColID(n+this.defaultColCnt);var l=r.D.getDataPrefix("header_id"),h=o.getAttribute(l),d=this.getHeaderColIndex(h);d=this.columnBlock.hash[d-this.defaultColCnt],h=this.getHeaderColID(d+this.defaultColCnt);var p=this.getHeaderIndex(a),c=this.getHeaderIndex(h);if(p<c)for(var g=this.columnBlock.info[d],f=g.length-1;f>=0;f--){var m=this.getHeaderColID(g[f]+this.defaultColCnt,{firstRow:!0});if(m){h=m,c=this.getHeaderIndex(h);break}}var y=this._getRealColIndex("head",h),b=this.htmlInfo.head.rowArr[0],w=!0;for(f=0;f<b.length;f++)if(b[f].id==h){w=!1;break}if(this.options.allColumnMove)for(f=1;f<this.htmlInfo.head.rowArr.length;f++)for(var v=0;v<this.htmlInfo.head.rowArr[f].length;v++)if(this.htmlInfo.head.rowArr[f][v].id==h){w=!1,h=this.htmlInfo.head.rowArr[0][v].id,c=this.getHeaderIndex(h),y=this.colMoveHeaderIndexMap[h];break}if(w)return;if("_headerRowNumber"==h||"_headerRowStatus"==h||p==c)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else{if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>p+this.defaultColCnt||this.getFixedColumnLastIndex()>c+this.defaultColCnt))return e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",void(!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor=""));this.resize_colIndex=c,this.resize_colId=h;var C=null;for(f=0;f<this.htmlInfo.body.rowArr.length;f++){for(v=0;v<this.htmlInfo.body.rowArr[f].length;v++)if(this.htmlInfo.body.rowArr[f][v]["@col"]==y){C=this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[f][v].col_id];break}if(null!==C)break}var I=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),_=WebSquare.style.getAbsoluteTop(this.render),x=WebSquare.style.getAbsoluteLeft(this.render),S=I[c+this.defaultColCnt],D=S.offsetLeft,R=S.offsetWidth,L=D+(p<c?R:0);null!=this.realColumnMoveTarget?this.resize_ghost.innerHTML=I[this.realColumnMoveTarget+this.defaultColCnt].innerHTML:this.resize_ghost.innerHTML=I[this.columnMoveTarget+this.defaultColCnt].innerHTML,this.resize_ghost.style.display="block",this.resize_ghost.style.top=_+I[this.columnMoveTarget].offsetHeight+5+"px",this.resize_ghost.style.left=x+L+5+"px",
!this.resize_ghost.firstChild||!this.resize_ghost.firstChild.tagName||"NOBR"===this.resize_ghost.firstChild.tagName.toUpperCase()||"SPAN"==this.resize_ghost.firstChild.tagName.toUpperCase()&&this.resize_ghost.firstChild.className.indexOf("w2grid_span")>-1?this.resize_ghost.style.width="auto":this.resize_ghost.style.width=R+"px",this.resize_arrow.style.display="block",this.resize_arrow.style.top=_-this.resize_arrow.offsetHeight+"px",this.resize_arrow.style.left=x+L-parseInt(this.resize_arrow.offsetWidth/2,10)+1+"px",e.style.display="block",e.style.zIndex=9999,e.style.border="1px solid #3a3f44",e.style.top=0,e.style.left=L+"px",e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px"),r.D.emptySelection()}}}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else if("drag"==this.resizeStatus&&this.resizeStarted&&this.isColumnResizable(this.resizeColIndex)){e.style.cssText="position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px; cursor:col-resize;",e.style.display="block",e.style.zIndex=100,e.style.top=0,e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px");var T=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1,k=WebSquare.style.getComputedStyle(document.body,"zoom");1==T&&k&&(T=parseFloat(k)),e.style.left=(u.B.getMouseX(t)-WebSquare.style.getAbsoluteLeft(this.render)*T)/T+"px",this.resize_ghost.style.display="none"}else e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return void(this.rowResizeTarget&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""));if(this.handleRowResizeLine(t),null!=this.rowMoveTarget)return;for(var e=this.event.getTargetIterator(t,this.render),i=null;e.next();){var o=e.getElement();if("TD"==o.tagName&&(i=o),"TH"==o.tagName){i=null;break}}if(null==i)return;i.style.cursor="",i.cursor="";var a=u.B.getMouseY(t),n=WebSquare.style.getAbsoluteTop(i),l=r.D.getDataPrefix("tdIndex"),h=parseInt(i.getAttribute(l),0),d=parseInt(h/this.realRowDataLength)+this.rowIndex;if(a-n<10&&0!=d)return i.style.cursor="row-resize",i.cursor="row-resize",this.rowResizeTarget&&this.rowResizeTarget!=i&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""),void(this.rowResizeTarget=i)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.doRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_rowIndex=null;e.next();)e.match(this.options.bodyTdClass)&&(i=e.getElement());if(null==i)return;if(this.startResizeY=u.B.getScreenY(t),"row-resize"==i.cursor){u.B.preventDefault(t),this.rowResizeStarted=!0,this.rowResizeTarget=i;var o=r.D.getDataPrefix("tdIndex"),a=parseInt(i.getAttribute(o),0),n=parseInt(a/this.realRowDataLength)+this.rowIndex;this.resizeRowIndex=n-1}this.handleRowResizeLine(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.endRowResize=function(t){try{if(this.rowResizeStarted){this.endResizeY=u.B.getScreenY(t);var e=this.resizeRowIndex||0;if(e>=0){var i=this.rowResizeTarget.offsetHeight+this.endResizeY-this.startResizeY;i=i<20?20:i,this.rowStyleArr[e]="rowResizeStyle_"+e,
this.rowStyleValueObj[this.rowStyleArr[e]]||(this.rowStyleValueObj[this.rowStyleArr[e]]={}),this.rowStyleValueObj[this.rowStyleArr[e]].style="height:"+i+"px;",this.applyRowStyleOptions(e),this.drawData(this.rowIndex,e+1,"async")}if(this.rowResizeStarted=!1,this.rowResized=!0,this.rowMoveTarget=null,this.handleRowResizeLine(t),window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)try{document.selection.empty()}catch(t){s.w.printStackTrace(t,null,this)}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleRowResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.rowResizeStarted?(e.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",e.style.display="block",e.style.zIndex=100,e.style.top=u.B.getMouseY(t)-WebSquare.style.getAbsoluteTop(this.render)+"px",e.style.width=this.render.offsetWidth+"px",e.style.left=0,this.resize_ghost.style.display="none"):(e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none")}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setColumnWidth=function(t,e){try{if(this.autoFitColWidthList=null,this.hiddenList[t])this.colWidthList[t]=e;else{var i=isNaN(this.colWidthList[t])?0:this.colWidthList[t];if(this.colWidthList[t]=e,this.gridWidth+=e-i,this.options.senseReader){var o=document.activeElement;if(o&&o.className.match("w2grid_embedded_input")){var a=this.getLastFocusedCell();a&&a.focusedTd&&o.blur()}}this.arrangeOverflowXScroll(),this.setOverflowX(),this.handleScrollX();var r=t-this.defaultColCnt;if(r>=0){var n=this.getCellInfo(r);if("textarea"==n.options.inputType)this.drawColumnData(r);else if(("text"==n.options.inputType||"secret"==n.options.inputType||"calendar"==n.options.inputType)&&n.options.embeddedInput&&!this.groupbyStatus.grouped)for(var l=this.struct.body.rowArr,h=0,d=0;d<l.length;d++){for(var u=0,p=0,c=0;c<l[d].length;c++){var g=l[d][c].id;if((u+=(n=this.getCellInfo(g)).options.colSpan-0)-1==r){p=this.getColumnIndex(g),h+=l[d].length;break}if(u-1>r){p=h+r;break}}this.embeddedWidthObj[p]&&(this.embeddedWidthObj[p].isChanged=!0),this.drawColumnData(p)}}this.handlerResize_drawInitializer()}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setColumnVisible=function(t,e){try{e=r.D.getBoolean(e);var i=this.getCellInfo(t);if(null==(t=this.getColumnIndex(t)))return;var o=this._getRealColIndex("body",i.options.col_id)+this.defaultColCnt;if(this.hiddenList[o]!=e)return;for(var n=0;n<this.getColumnCount();n++){var l=this.getCellInfo(n);"textarea"==l.options.inputType&&"all"==l.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>t){var h=0,d=this.getFixedColumnLastIndex();for(n=0;n<d;n++)this.hiddenList[n]&&n-this.defaultColCnt!=t||(h+=this.colWidthList[n]);if(h>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(n=0;n<i.options.colSpan;n++)this.hiddenList[o+n]=!e;this.gridWidth=0;for(n=0;n<this.colWidthList.length;n++)this.hiddenList[n]||(this.gridWidth+=this.colWidthList[n]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),""!=this.options.hiddenClass||""!=i.options.hiddenClass){this.drawData(this.rowIndex,0);var u=this.getColumnID(t),p=this.options.hiddenClass
;""!=i.options.hiddenClass&&(p=i.options.hiddenClass);var c=null!=this.bodyToHeaderRelation[u]?this.getHeaderLayer(this.bodyToHeaderRelation[u]):null;e?null!=c&&this.hasClass(c,p)&&this.removeClass(c,p):null==c||this.hasClass(c,p)||this.addClass(c,p)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var g=this.colIndexInfo.body.colInfo.colIndexArr;for(n=0;n<g.length;n++)if(g[n]==o)for(var f=0;f<=this.lastIndex;f++)this.drawCellData(f,f+this.rowIndex,n-this.defaultColCnt),this.applyCellStyleOptions(f+this.rowIndex,n-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),a.v.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.w.printStackTrace(t,null,this)}}),{key:this.id+"_setColumnVisible",caller:this})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setRowVisible=function(t,e,i){try{if((t=parseInt(t,10))<0||t>=this.getTotalRow()||isNaN(t))return void p.k.printLog(this.id+" setRowVisible error : invalid rowIndex "+t);var o=r.D.getBoolean(e);if(this.hiddenRowObj.row[t]===!o||null==this.hiddenRowObj.row[t]&&!0===o)return;this.hiddenRowObj.row[t]=!o,this.hiddenRowObj.init=!0;var a=this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)});if(!1===o?(this.hiddenRowObj.length++,"all"===this.options.visibleRowNum||a||this.hiddenRowObj.extraRow<this.hiddenRowObj.length&&this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.length-1)):(delete this.hiddenRowObj.row[t],this.hiddenRowObj.length--),a)return;r.D.setTimeout((function(){this.lastTopRowIndex=null,this.initHeightCompleted=!1;var t=this.getDataLength();if(t-this.hiddenRowObj.length<=this.lastIndex+1&&0!==this.rowIndex)return this.bScrollY=0,this.setScrollTop(0),void this.drawData(0);var e=t-this._getVisibleLastIndex(this.lastIndex+1);if(e<this.rowIndex){var i=this.getLastFocusedCell();return this.removeFocusedCell(),this.rowIndex=e,e<this.bScrollTop&&(this.bScrollTop=e),this.setScrollYHeight({restRowCnt:this._getScrollRowIndex(e),skipScrollEnd:!0}),this.drawData(e),void(i.focusedRowIndex>-1&&null!=i.focusedColIndex&&!0===this.getRowVisible(i.focusedRowIndex)&&this.setFocusedCell(i.focusedRowIndex,i.focusedColIndex))}this._applyRowVisible({applyStyle:!0,refreshColumn:!0}),this.setScrollYHeight(),this.dynamicMergeHTML(),this._setRedrawTextAreaColumn(!0)}),{key:this.id+"_setRowVisible",caller:this,delay:100})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setRowNumVisible=function(t){this.options.rowNumVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowNum",t)},c.prototype.setRowStatusVisible=function(t){this.options.rowStatusVisible&&0===Object.keys(this.groupbyStatus).length&&this._setRowNumStatusVisible("rowStatus",t)},c.prototype._setRowNumStatusVisible=function(t,e){try{var i,o;if(null==t||"rowNum"!==t&&"rowStatus"!==t)return;this.options.rowNumVisible&&this.options.rowStatusVisible?(i="rowNum"===t?0:1,o="rowNum"===t?0:1):(this.options.rowNumVisible&&!this.options.rowStatusVisible||!this.options.rowNumVisible&&this.options.rowStatusVisible)&&(i=0,o=0);e=r.D.getBoolean(e);var n=this.getCellInfo(i);if(this.hiddenList[o]!=e)return;for(var l=0;l<this.getColumnCount();l++){var h=this.getCellInfo(l);"textarea"==h.options.inputType&&"all"==h.options.displayType&&(this.setScrollTop(0),this.setScrollLeft(0))}if(this.options.fixedColumn>0&&e&&this.options.fixedColumn>i){var d=0,u=this.getFixedColumnLastIndex();for(l=0;l<u;l++)this.hiddenList[l]&&l-this.defaultColCnt!=i||(d+=this.colWidthList[l])
;if(d>this.getElementById(this.id+"_dataLayer").offsetWidth-30)return void WebSquare.logger.printLog(this.id+" setColumnVisible error : not enough space to show the column.  ")}for(l=0;l<n.options.colSpan;l++)this.hiddenList[o+l]=!e;this.gridWidth=0;for(l=0;l<this.colWidthList.length;l++)this.hiddenList[l]||(this.gridWidth+=this.colWidthList[l]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),""!=this.options.hiddenClass||""!=n.options.hiddenClass){this.drawData(this.rowIndex,0);var p=this.getColumnID(i),c=this.options.hiddenClass;""!=n.options.hiddenClass&&(c=n.options.hiddenClass);var g=null!=this.bodyToHeaderRelation[p]?this.getHeaderLayer(this.bodyToHeaderRelation[p]):null;e?null!=g&&this.hasClass(g,c)&&this.removeClass(g,c):null==g||this.hasClass(g,c)||this.addClass(g,c)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var f=this.colIndexInfo.body.colInfo.colIndexArr;for(l=0;l<f.length;l++)if(f[l]==o)for(var m=0;m<=this.lastIndex;m++)this.drawCellData(m,m+this.rowIndex,l-this.defaultColCnt),this.applyCellStyleOptions(m+this.rowIndex,l-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),a.v.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit(),e&&this._setRedrawTextAreaColumn()}catch(t){s.w.printStackTrace(t,null,this)}}),{key:this.id+"_setRowNumStatusVisible",caller:this})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.clearRowVisible=function(t){try{var e=this.hiddenRowObj.extraRow;if(this.hiddenRowObj.init&&(this.lastTopRowIndex=null),this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),t&&!0===t.noDraw)return;0!==this.rowIndex?(this.bScrollY=0,this.setScrollTop(0),this.drawData(0),this.setScrollYHeight()):(this.setScrollYHeight(),this.dynamicMergeHTML(),this.applyStyleOptions(this.lastIndex))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&!0!==this.hiddenRowObj.row[t]}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&(!(this.hiddenRowObj.length>0)||this.getRowVisible(this.dataList.getRealRowIndex(t)))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHiddenRowCount=function(t){try{var e=this.hiddenRowObj.length;if(this.isDrillDown&&isNaN(t)&&(t=0),this.hiddenRowObj.length>0&&(t||this.isDrillDown)){e=0;for(var i=this.getDataLength(),o=t;o<i;o++)this._getRowVisible(o)||e++}return e}catch(t){return s.w.printStackTrace(t,null,this),0}},c.prototype._getVisibleRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;var e=this.getDataLength();if(t>=e)return e;for(var i=t,o=0;i>=0&&o<e;)this._getRowVisible(o)&&i--,i>=0&&o++;return o}catch(e){return s.w.printStackTrace(e,null,this),t}},c.prototype._getVisibleTrRowIndex=function(t,e){try{if(this._getHiddenRowCount()<=0)return t;for(var i=this.getDataLength(),o=0,a=this.drawedRowLength+this.hiddenRowObj.extraRow-1,r=t,n=e;r>=0&&n<i&&a>o;n++)this._getRowVisible(n)&&r--,r>=0&&o++;return o}catch(e){return s.w.printStackTrace(e,null,this),t}},c.prototype._getScrollRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;if(t<=0)return 0;for(var e=0,i=this._getScrollMaxRowIndex(),o=t-1;o>=0&&i>e;o--)this._getRowVisible(o)&&e++;return e}catch(e){return s.w.printStackTrace(e,null,this),t}},c.prototype._getScrollMaxRowIndex=function(){try{
var t=parseInt(document.getElementById(this.id+"_size_y").style.height,10)-document.getElementById(this.id+"_scrollY_div").offsetHeight;return Math.floor((t+this._getEpsilon())/this.oneRowScrollHeight)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getEpsilon=function(){try{var t=Math.min(2,Math.round(this.oneRowScrollHeight/10)),e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;return e<1&&(t=Math.min(Math.round(t/e),Math.round(this.oneRowScrollHeight/2.4))),t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getVisibleLastIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;for(var e=t,i=this.getDataLength(),o=0,a=i-1;a>=0&&e>0;a--)this._getRowVisible(a)&&e--,o++;return o}catch(e){return s.w.printStackTrace(e,null,this),t}},c.prototype._getTrIndex=function(t){try{var e=t;return this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>t||this.options.lastFixedRow>0&&t>this.lastIndex-this.options.lastFixedRow||(e-=this.rowIndex)),e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getTdElem=function(t,e){try{for(var i=0,o=this.rowIndex;o<t&&this.hiddenRowObj.length>0;o++)this._getRowVisible(o)||i++;var a=this._getTrIndex(t);if(a<0||a-i>=this.drawedRowLength)return;return this.data_td_list[a*this.oneRowDataLength+e]}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._addHiddenRow=function(t){try{var e=[];0==this.drawedRowLength&&this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(-1)));for(var i=[],o=0;o<this.oneRowLength;o++){var a=this.tempTr.rows[o].cloneNode(!0);i[o]=a,e.push(a)}this.addBodyRow(t,i),this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(t)));var r=this.getElementById(this.id+"_body_table"),n=this.getElementById(this.id+"_body_tbody");0==this.drawedRowLength?r.style.borderWidth="0px":r.style.borderWidth="";for(o=0;o<e.length;o++)n.appendChild(e[o]);this._setRowDisplay(t,"none"),this.hiddenRowObj.extraRow++}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._applyRowVisible=function(t){try{if(void 0!==t&&null!=t||(t={}),this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)}))return;var e=0,i=!0,o=this._getLastSubtotalCount();t.subtotalDraw&&-1==this.options.initFixedHeightByRowNum&&(o=0);var a=this.getDataLength()+o,r=this.lastIndex;r=""===this.options.visibleRowNum?Math.min(this.drawedRowLength,a-this.rowIndex)-1:"all"===this.options.visibleRowNum?t.subtotalDraw?Math.min(this.drawedRowLength,this.getDataLength())-1:this.drawedRowLength:Math.min(parseInt(this.options.visibleRowNum,10),a)-1;var n=a-this._getVisibleLastIndex(r+1),l=this.rowIndex;this.subtotalHidden();for(var h=!1,d={skipSubtotal:!0,refreshColumn:t.refreshColumn},u=0,p=r,c=0;c<=r;c++){var g=c+this.rowIndex;if(!0===t.drawRow&&(this.options.fixedRow>0&&this.options.fixedRow>c?(g=c,this.fastDrawRowData(c,g,d)):this.options.lastFixedRow>0&&c>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(c,g,d)),this._getRowVisible(c+this.rowIndex)?(this._setRowDisplay(c,""),i=!1,h=!0):(this._setRowDisplay(c,"none"),e++,i&&l<n&&l++),this.hasSubtotal&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:r-c+e}),(b=this.drawSubtotalRow(c+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(c>=(r-=b)&&(e-=c-r),u+=b));p=c}var f=this.hiddenRowObj.extraRow+u,m=0;for(c=0;c<f&&r>=0;c++){var y,b,w=c+p+1;g=w+this.rowIndex;if(this._getRowVisible(g)&&e>0&&g<a?(this._setRowDisplay(w,""),this.fastDrawRowData(w,g,d),e--,i=!1,h=!0):(this._setRowDisplay(w,"none"),i&&l<n&&l++,e<=0&&(h=l>=n),!0===t.drawRow&&this.fastDrawRowData(w,g,d)),this.hasSubtotal&&w+this.rowIndex<a&&h)this.options.initFixedHeightByRowNum>-1&&(y={maxCount:e}),(b=this.drawSubtotalRow(w+1,g,y))>0&&(h=!1,this.options.initFixedHeightByRowNum>-1&&(m+=b,e-=b))}l!==this.rowIndex&&!0!==t.noDraw?this.drawData(l):""===this.options.visibleRowNum?(!0===t.applyStyle&&this.applyStyleOptions(r),this.cutGridBottom()):this.lastIndex=r-m}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setCellVisible=function(t,e,i){
try{if(!0!==i&&!1!==i)return;e=this.getColumnIndex(e);var o,a=!0===this.hiddenCellObj[t+"_"+e],n=!1;if(!0===i&&a?(this.hiddenCellObj[t+"_"+e]=!1,o=!0,this.hiddenCellObj.length--):!1!==i||a||(this.hiddenCellObj[t+"_"+e]=!0,o=!0,this.hiddenCellObj.length++,this.hiddenCellObj.init||(n=!0),this.hiddenCellObj.init=!0),!0===o){var l=this._getTdElem(t,e);null!=l&&(l.style.display=!0===i?"":"none")}n&&(""!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&(this.options.visibleRowNum=""),this.setDataTable()),!0!==this._isBrowserScroll()&&"all"!==this.options.visibleRowNum&&r.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:100})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setCellVisibleRefresh=function(){try{if(!0===this._isBrowserScroll()||"all"===this.options.visibleRowNum)return;this.lastTopRowIndex=null;var t=this.rowIndex,e=Math.max(this.getDataLength()-this.drawedRowLength,0);this.rowIndex=e,this.subtotalHidden();var i=this.completiveDrawData(0,{extraRowByCellHidden:!0});if(this.lastTopRowIndex=e+i,0===e&&0===i){0!==(o=this.getElementById(this.id+"_size_y")).offsetHeight&&(o.style.height="0px",this.handlerResize_drawInitializer())}else{var o=this.getElementById(this.id+"_size_y"),a=this.getElementById(this.id+"_scrollY_div"),r=o.offsetHeight;if(r<1e6&&(r=parseInt(o.style.height,10)),o.style.height=a.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",t=Math.min(t,this.lastTopRowIndex),this.hasSubtotal&&this.struct.subtotalArr&&this.struct.subtotalArr.length>0)this.lastTopRowIndex+=this.struct.subtotalArr.length,this.drawData(t);else{var n=this.oneRowScrollHeight*t;t!==this.rowIndex?this.drawData(t):a.scrollTop!==n&&(this.bScrollY=n,a.scrollTop=n),this.handlerResize_drawInitializer()}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getCellVisible=function(t,e){try{e=this.getColumnIndex(e);return!0!==this.hiddenCellObj[t+"_"+e]}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.clearCellVisible=function(t){try{for(var e in void 0!==t&&null!=t||(t={}),this.hiddenCellObj)if(!0===this.hiddenCellObj[e]){var i=e.split("_"),o=Number(i[0]),a=Number(i[1]),r=this._getTdElem(o,a);null!=r&&(r.style.display="")}this.hiddenCellObj={length:0,init:!1},!0!==t.skipDraw&&this.cutGridBottom(this.lastIndex)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._moveCellVisible=function(t,e,i){try{if(!(this.hiddenCellObj.length>0))return;void 0!==i&&null!=i||(i={});var a=[];t.sort((function(t,e){return t-e}));for(var r={},n=0;n<t.length;n++)r[t[n]]=!0;var l=this.getRowCount();for(n=0;n<l;n++)!0===i.remove&&!0===r[n]||a.push(n);!0===i.insert&&(a=a.slice(0,e).concat(t).concat(a.slice(e)));var h={};for(n=0;n<a.length;n++)a[n]!==n&&(h[a[n]]=n);var d=o.x.extend({},this.hiddenCellObj),u=this.getColumnCount();for(var p in h){var c=Number(p),g=h[c];if(c!==g)for(var f=0;f<u;f++)this.setCellVisible(g,f,!d[c+"_"+f])}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._refreshRowVisible=function(t){try{this._applyRowVisible(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setScrollLeft=function(t){t=parseInt(t,10);try{this.getElementById(this.id+"_scrollX_right").scrollLeft=t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setScrollTop=function(t){t=parseInt(t,10);try{this.scrollEvent=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getScrollLeft=function(){try{return this.getElementById(this.id+"_scrollX_right").scrollLeft}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getScrollTop=function(){try{return this.getElementById(this.id+"_scrollY_div").scrollTop}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setGridStyle=function(t){try{if(!t)return;if("string"==typeof t){t=t.match(/"\s*N\s*"\s*:\s*"\s*w2:gridView\s*"/)?JSON.parse(t):WebSquare.xml.parse(t)}t instanceof WebSquare.Elem&&(t=t._element),
!0===WebSquare.convertPageXML&&a.v.isXML(t)&&(t=WebSquare.xmljs.xml2json(t).E[0]),!0===a.v.isXML(t)&&9==t.nodeType&&(t=t.documentElement);var e=this.getParent();e&&e.parentControl&&"wframe"==e.parentControl.options.pluginName&&(e=e.parentControl);var i,o=this.scope_obj,r=this.parentFrame;this.options.groupbyFilterBox&&this.options.customFilterBox&&this.groupbyFilterBox_history.length>0&&(i=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo),this.remove(),this.__removed_object__=!0;var n=WebSquare.controlFactory.create(null,null,t,o,r);n.options&&isNaN(n.options.fixedRightColumn)&&(n.options.fixedRightColumn=0),n.writeTo(e),n.activate(),n.onComplete(),n.options.groupbyFilterBox&&n.options.customFilterBox&&(n.refreshGroupbyFilterBox(),n.applyFilterHistory(),i?(n.customFilterList.customFilterListFilterInfo=JSON.parse(i,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:"object"===(0,l.Z)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})),n.groupbyFilterBox_history[n.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo=i):n.customFilterList&&(n.customFilterList.customFilterListFilterInfo={}));var h=n.options._sortStatus;if(h){for(var d=JSON.parse(h),u=[],p=[],c=[],g=0;g<d.length;g++){var f=d[g];u.push(f.colID),p.push(f.sortOrder),c.push(f.dataType)}n.dataList.setFilter({type:"sort",sortIndex:u.join(" "),sortOrder:p.join(" "),dataType:c.join(" "),focuseMode:n.options.filterFocusMode,ignoreEmptyStringOnSort:n.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:n.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:n.options.setEmptyStringSortableOnSort}),n.drawHeaderSortImages()}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getGridStyle=function(){try{return"json"===this.element._elementType?WebSquare.jsonUtil.serialize(this.element._element):WebSquare.xml.serialize(this.element._element)}catch(t){s.w.printStackTrace(t)}},c.prototype.getCurrentGridStyle=function(){try{var t=this.element.cloneNode(!0);t.setAttribute("columnOrder",this.getColumnOrder()),t.setAttribute("fixedColumn",this.options.fixedColumn),t.setAttribute("fixedRow",this.options.fixedRow),t.setAttribute("fixedRightColumn",this.options.fixedRightColumn);for(var e=t.getChildNodes(),i=0;i<e.length;i++){if("w2:header"==e[i].getTagName())for(var o=e[i].getChildNodes(),a={},n=0,l=this.htmlInfo.head.rowAttrArr.length,h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){for(var d=o[h].getChildNodes(),u=[],p=0;p<d.length;p++)"w2:column"==d[p].getTagName()&&u.push(d[p]);for(var c=0,g=0,f={},m=0;m<u.length;m++){for(;null!=a[i]&&null!=a[i][m+c+g];)g+=a[i][m+c+g];f[m+c-0+g]=m;var y=parseInt(u[m].getAttribute("colSpan"),10)||1,b=parseInt(u[m].getAttribute("rowSpan"),10)||1;if(b>1)for(var w=n;w<n+b-1;w++)null==a[w+1]&&(a[w+1]={}),null==a[w+1][m-0+c+g]?a[w+1][m-0+c+g]=y:a[w+1][m-0+c+g]+=y;y>1&&(c+=y-1)}if(n===l-1){var v=0,C=0;for(m=0;m<u.length;m++){for(;null!=a[n]&&null!=a[n][this.columnOrder[m+C+v]];)C+=a[n][this.columnOrder[m+C+v]];var I=f[[this.columnOrder[m-0+v+C]]];null==I&&(I=0);var _=u[I];(y=parseInt(_.getAttribute("colSpan"),10))>1&&(v+=y-1),_.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v+C]),this.hiddenList[m+this.defaultColCnt+v+C]?_.setAttribute("hidden","true"):_.setAttribute("hidden","false")}}n++}if("w2:gBody"==e[i].getTagName())for(o=e[i].getChildNodes(),h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){var x=o[h].getChildNodes(),S=[];for(p=0;p<x.length;p++)"w2:column"==x[p].getTagName()&&S.push(x[p]);for(c=0,f={},m=0;m<S.length;m++){f[m+c]=m,(y=parseInt(S[m].getAttribute("colSpan"),10))>1&&(c+=y-1)}for(v=0,m=0;m<S.length;m++){_=S[f[[this.columnOrder[m+v]]]];(y=parseInt(_.getAttribute("colSpan"),10))>1&&(v+=y-1),_.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v]),
r.D.isChrome()?_.setAttribute("hidden",this.hiddenList[m+this.defaultColCnt+v]):this.hiddenList[m+this.defaultColCnt+v]?_.setAttribute("hidden","true"):_.setAttribute("hidden","false");var D=_.getAttribute("col_id");D&&(_.setAttribute("id",D),_.removeAttribute("col_id"))}}}var R=this.getSortableStatus();return R&&R.length>0&&t.setAttribute("_sortStatus",JSON.stringify(R)),t.serialize()}catch(t){s.w.printStackTrace(t)}},c.prototype.setTableStruct=function(){try{if(this.headerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"header",a.v._XML_NAMESPACE.W2)[0],this.bodyXml=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",a.v._XML_NAMESPACE.W2)[0],this.struct={head:this.xml2JSON(this.headerXml),body:this.xml2JSON(this.bodyXml)},this.updateStruct(this.struct.head.rowArr),this.updateStruct(this.struct.body.rowArr),this.changeRowID(this.struct.head.rowAttrArr),this.changeRowID(this.struct.body.rowAttrArr),this.footerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0],this.footerXml&&(this.hasFooter=!0,this.struct.foot=this.xml2JSON(this.footerXml),this.updateStruct(this.struct.foot.rowArr)),this.subtotalXmlArr=WebSquare.Elem.api.getElementsByTagName(this.element,"subTotal",a.v._XML_NAMESPACE.W2),this.subtotalXmlArr.length>0){this.options.showLastRow=!1,this.hasSubtotal=!0,this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0,this.struct.subtotalArr=[];for(var t=0;t<this.subtotalXmlArr.length;t++){var e=this.xml2JSON(this.subtotalXmlArr[t]);this.struct.subtotalArr.push(e),this.struct.subtotalArr[e.attr.id]=e,this.updateStruct(e.rowArr)}}if(this.setCss(),this.setColArr(),this.htmlInfo={head:this.getHeaderHtmlInfo(),body:this.getBodyHtmlInfo()},this.footerXml&&(this.htmlInfo.foot=this.getFooterHtmlInfo()),this.subtotalXmlArr.length>0){this.htmlInfo.subtotalArr=[],this.subtotalStrList={};for(t=0;t<this.struct.subtotalArr.length;t++){e=this.getSubtotalHtmlInfo(this.struct.subtotalArr[t]);this.htmlInfo.subtotalArr.push(e),this.htmlInfo.subtotalArr[e.attr.id]=e,this.subtotalStrList[e.attr.targetColumnID]=e}}this.captionXml=WebSquare.Elem.api.getElementsByTagName(this.element,"caption",a.v._XML_NAMESPACE.W2)[0];var i=this.getColCnt();this.columnOrder=[];for(t=0;t<i;t++)this.columnOrder.push(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.updateStruct=function(t){try{for(var e=0,i=[],o=this.getColCnt(),a=0;a<t.length;a++){for(var r=[],n=0;n<o;n++)r.push(null);i.push(r)}for(a=0;a<t.length;a++)for(n=0;n<t[a].length;n++){var l;for(l=0;l<i[a].length&&null!==i[a][l];l++);var h=t[a][n];h["@col"]=l;for(var d=h.colSpan||h.colspan||1,u=h.rowSpan||h.rowspan||1,p=0;p<u;p++)for(var c=0;c<d;c++)i[a+p][l+c]=e;e++}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.changeRowID=function(t){try{for(var e=0;e<t.length;e++){var i=t[e];null!=i.id&&(i["data-tr-id"]=i.id,delete i.id)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getRealColIndex=function(t,e){try{for(var i=0;i<this.htmlInfo[t].rowArr.length;i++)for(var o=0;o<this.htmlInfo[t].rowArr[i].length;o++)if(this.htmlInfo[t].rowArr[i][o].col_id==e)return this.htmlInfo[t].rowArr[i][o]["@col"];return null}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getRealHeaderColIndex=function(t){try{return this.getColumnIndex(this.headerToBodyRelation[t])}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getDataColIndex=function(t){try{return this._dataList.getColumnIndex(this.getColumnID(t))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._moveColumn=function(t,e,i,o,a,r){try{e=e||"td";for(var n=[],l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&n.push(t[i].childNodes[l]);var h=n[o];h.parentNode.removeChild(h);var d=[];for(l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&d.push(t[i].childNodes[l]);if(r<d.length){var u=d[r];u.parentNode.insertBefore(h,u)}else t[a].appendChild(h)}catch(t){s.w.printStackTrace(t,null,this)}},
c.prototype.moveBodyColumn=function(t,e,i,o){try{var a=this.htmlInfo.body.rowArr[t].splice(e,1);this.htmlInfo.body.rowArr[i].splice(o,0,a[0]),this.updateStruct(this.htmlInfo.body.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var r=this.getElementById(this.id+"_body_tbody"),n=0;this.hasSubtotal&&this.drawedSubtotal&&this.drawedSubtotal.length>0&&(n=this.drawedSubtotal[0].length);for(var l=0;l<this.drawedRowLength;l++){for(var h=[],d=0;d<this.oneRowLength;d++)h.push(r.rows[l*(this.oneRowLength+n)+d+n]);this._moveColumn(h,"td",t,e,i,o);for(d=0;d<n;d++)if(0===t&&0===i){var u=d>0?this.defaultColCnt:0;this._moveColumn([r.rows[l*(this.oneRowLength+n)+d]],"td",0,e-u,0,o-u)}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.moveHeadColumn=function(t,e,i,o){try{var a=this.htmlInfo.head.rowArr[t].splice(e,1);this.htmlInfo.head.rowArr[i].splice(o,0,a[0]),this.updateStruct(this.htmlInfo.head.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var r=this.getElementById(this.id+"_head_table");this._moveColumn(r.rows,"th",t,e,i,o)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._moveFooterColumn=function(t,e,i,o){try{var a=this.htmlInfo.foot.rowArr[t].splice(e,1);this.htmlInfo.foot.rowArr[i].splice(o,0,a[0]),this.updateStruct(this.htmlInfo.foot.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var r=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumn(r.rows,"td",t,e,i,o)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.moveFooterColumn=function(t,e){try{var i,o,a=parseInt(t,10),r=[];"string"==typeof t&&isNaN(a)?(o="id",i=t):(o="@col",i=this.colIndexes.footerColInfo.colIndexArr[a+this.defaultColCnt]-this.defaultColCnt);for(var n=0;n<this.htmlInfo.foot.rowArr.length;n++)for(var l=0;l<this.htmlInfo.foot.rowArr[n].length;l++)this.htmlInfo.foot.rowArr[n][l][o]==i&&r.push({row:n,col:l});var h,d,u=parseInt(e,10);"string"==typeof e&&isNaN(u)?(d="id",h=e):(d="@col",h=this.colIndexes.footerColInfo.colIndexArr[u+this.defaultColCnt]-this.defaultColCnt);for(n=0;n<r.length;n++){var p=null;for(l=0;l<this.htmlInfo.foot.rowArr[r[n].row].length;l++)if(this.htmlInfo.foot.rowArr[r[n].row][l][d]==h){p=l;break}null!==p?this._moveFooterColumn(r[n].row,r[n].col,r[n].row,p):this._moveFooterColumn(r[n].row,r[n].col,r[n].row,u)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.moveColumnByHeaderId=function(t,e){try{if(!t||!e||t===e)return!1;var i=this.getHeaderColIndex(t),o=this.getHeaderColIndex(e);if(isNaN(i)||isNaN(o))return!1;var a=this.columnBlock.hash[i-this.defaultColCnt],r=this.columnBlock.hash[o-this.defaultColCnt];if(a===r)return!1;var n=this.getFixedColumnLastIndex();if(this.options.fixedColumnNoMove&&(n>a||n>r))return!1;for(var l=-1,h=-1,d=0;d<this.columnOrder.length;d++){var p=this.columnOrder[d];if(p===a&&(l=d),p===r&&(h=d),l>-1&&h>-1)break}var c=this.headerToBodyRelation[t],g=this.headerToBodyRelation[e];if(!1===u.B.fireEvent(this,"onbeforecolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}))return!1;this.columnBlock||this.createBlockedHeaderInfo();var f=this.getColumnOrder(),m=-1,y=-1;for(d=0;d<f.length;d++){var b=f[d];if(b===a?m=d:b===r&&(y=d),-1!==m&&-1!==y)break}var w=this.columnBlock.info[a],v=this.columnBlock.info[r],C=f.slice(0);C.splice(m,w.length);var I=y+(m<y?v.length-w.length:0),_=C.slice(0,I).concat(w).concat(C.slice(I)),x=this.setColumnOrder(_);return u.B.fireEvent(this,"onaftercolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}),x}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.moveColumn=function(t,e){try{if(t==e)return;if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>t+this.defaultColCnt||this.getFixedColumnLastIndex()>e+this.defaultColCnt))return;var i=this.getHeaderID(t),o=this._getRealColIndex("head",i)+this.defaultColCnt,a=this.headerToBodyRelation[i];if(!a||this.colMoveBolockedHeaderObj[i])return
;var r=this.colMoveIndexMap[a],n=this._getRealColIndex("body",a)+this.defaultColCnt,l=this.getHeaderID(e),h=this.headerToBodyRelation[l];if(!h||this.colMoveBolockedHeaderObj[l])return;var d=this._getRealColIndex("head",l)+this.defaultColCnt,p=this.colMoveIndexMap[h],c=this.colIndexes.bodyColInfo.colIndexArr[p+this.defaultColCnt];if(!1===u.B.fireEvent(this,"onbeforecolumnmove",{startColumnID:a,startColumnIndex:r,endColumnID:h,endColumnIndex:p}))return!1;for(var g=[],f=n-this.defaultColCnt,m=0;m<this.htmlInfo.body.rowArr.length;m++)for(var y=0;y<this.htmlInfo.body.rowArr[m].length;y++)this.htmlInfo.body.rowArr[m][y]["@col"]==f&&g.push({row:m,col:y});var b=c-this.defaultColCnt;for(m=0;m<g.length;m++){var w=null;for(y=0;y<this.htmlInfo.body.rowArr[g[m].row].length;y++)if(this.htmlInfo.body.rowArr[g[m].row][y]["@col"]==b){w=y;break}null!==w?this.moveBodyColumn(g[m].row,g[m].col,g[m].row,w):this.moveBodyColumn(g[m].row,g[m].col,g[m].row,p)}g=[];var v=o-this.defaultColCnt;for(m=0;m<this.htmlInfo.head.rowArr.length;m++)for(y=0;y<this.htmlInfo.head.rowArr[m].length;y++)this.htmlInfo.head.rowArr[m][y]["@col"]==v&&g.push({row:m,col:y});var C=d-this.defaultColCnt;for(m=0;m<g.length;m++){for(w=null,y=0;y<this.htmlInfo.head.rowArr[g[m].row].length;y++)if(this.htmlInfo.head.rowArr[g[m].row][y]["@col"]==C){w=y;break}null!==w?this.moveHeadColumn(g[m].row,g[m].col,g[m].row,w):this.moveHeadColumn(g[m].row,g[m].col,g[m].row,e)}this.hasFooter&&this.options.columnMoveWithFooter&&this.moveFooterColumn(t,e);var I=function(t,e,i){var o=t.splice(e,1);t.splice(i,0,o[0])};if(null!=this.initVisibilityArr)for(m=0;m<this.htmlInfo.body.rowArr.length;m++)I(this.initVisibilityArr,n+m*this.getColCnt(),c+m*this.getColCnt());for(var _ in I(this.columnOrder,n-this.defaultColCnt,c-this.defaultColCnt),I(this.colIndexInfo.body.colInfo.colIndexMatch,n,c),I(this.colWidthList,n,c),I(this.hiddenList,o,d),this.colMoveIndexMap)this.colMoveIndexMap[_]==r?this.colMoveIndexMap[_]=p:r<p?r<this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]<=p&&(this.colMoveIndexMap[_]-=1):r>p&&r>this.colMoveIndexMap[_]&&this.colMoveIndexMap[_]>=p&&(this.colMoveIndexMap[_]+=1);for(var _ in this.colMoveHeaderIndexMap)this.colMoveHeaderIndexMap[_]==r?this.colMoveHeaderIndexMap[_]=p:r<p?r<this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]<=p&&(this.colMoveHeaderIndexMap[_]-=1):r>p&&r>this.colMoveHeaderIndexMap[_]&&this.colMoveHeaderIndexMap[_]>=p&&(this.colMoveHeaderIndexMap[_]+=1);this.arrangeOverflowXScroll(),this._handleScrollX(),u.B.fireEvent(this,"onaftercolumnmove",{startColumnID:a,startColumnIndex:r,endColumnID:h,endColumnIndex:p})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.resetMoveColumn=function(){try{for(var t=this.getColCnt(),e=[],i=0;i<t;i++)e.push(i);this.setColumnOrder(e)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setColumnOrder=function(t){try{if(!r.D.isEmptyObject(this.cellMergeInfo))return void p.k.printLog("warning : setColumnOrder refused due to mergeCells. ["+this.id+"]");t=t.slice();if(!this.render||0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0},this.setRedrawStatus("stop"),void this.delayedDraw({newColumnOrder:t});var e=this.getColCnt(),i=[];"string"==typeof t&&(t=t.split(","));for(var o=0;o<t.length;o++){if(null!=this.bodyIdColIndexMap[t[o]]&&(t[o]=this.bodyIdColIndexMap[t[o]]),t[o]=Number(t[o]),"number"!=typeof t[o])return void $l(this.id+".setColumnOrder : wrong column order array.");i[t[o]]=!0}if(e>t.length){for(o=0;o<t.length;o++)t[o]=this.colIndexes.headerColInfo.colIndexArr[t[o]+this.defaultColCnt]-this.defaultColCnt;for(o=0;o<t.length;o++){var a=this.getCellInfo(t[o]).options.colSpan;if(a>1)for(var n=1;n<a;n++)t.splice(o+n,0,t[o]+n)}for(o=0;o<t.length;o++)i[t[o]]=!0}for(o=t.length-1;o>=0;o--)for(n=o-1;n>=0;n--)t[o]===t[n]&&t.splice(o,1);for(o=0;o<e;o++)i[o]||t.push(o);if(e!=t.length)return $l(this.id+".setColumnOrder : wrong column order array."),!1;var l=[]
;for(o=0;o<t.length;o++)for(n=0;n<this.columnOrder.length;n++)if(this.columnOrder[n]==t[o]){l[o]=n;break}if(!0===this.checkRefreshAdaptive()&&this.removeAdaptive(),this.columnOrder=l.slice(0),this.drawedRowLength<=0&&this.drawDataTable(),this._moveColumnByOrder(this.id+"_body_tbody",this.htmlInfo.body.rowArr),this._moveColumnByOrder(this.id+"_head_table",this.htmlInfo.head.rowArr),this.hasFooter&&this.options.columnMoveWithFooter){var h=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumnByOrder(h.getAttribute("id"),this.htmlInfo.foot.rowArr)}if(null!=this.initVisibilityArr){var d=[];for(o=0;o<this.initVisibilityArr.length-this.defaultColCnt;o++){var u=Math.floor(o/this.columnOrder.length),c=o%this.columnOrder.length,g=u*this.columnOrder.length+this.columnOrder[c]+this.defaultColCnt;d.push(this.initVisibilityArr[g])}for(o=0;o<d.length;o++)this.initVisibilityArr[o+this.defaultColCnt]=d[o]}this._swapItem(this.colIndexInfo.body.colInfo.colIndexMatch,this.columnOrder,this.defaultColCnt),this._swapItem(this.colWidthList,this.columnOrder,this.defaultColCnt),this.initialColWidthList=this.colWidthList.slice(),this._swapItem(this.hiddenList,this.columnOrder,this.defaultColCnt),"allColumn"===this.options.autoFit&&this._swapItem(this.autoFitColWidthList,this.columnOrder,this.defaultColCnt);for(o=0;o<this.tdIdList.length;o++)for(n=0;n<t.length;n++)if(o==t[n]){this.colMoveIndexMap[this.tdIdList[o]]=n,this.colMoveHeaderIndexMap[this.thIdList[o]]=n;break}return this.columnOrder=t.slice(0),this.arrangeOverflowXScroll(),this._handleScrollX(),!0===this.checkRefreshAdaptive()&&this.addAdaptive(),!0}catch(t){return s.w.printStackTrace(t,null,this),!1}},c.prototype._moveColumnByOrder=function(t,e){try{var i=document.getElementById(t),o=[],a={},n=e.length;(isNaN(n)||n<=0)&&(n=1);for(var l=0;l<n;l++){if(!(I=i.rows[l]))break;var h=0;0===l&&(h=this.defaultColCnt);for(var d={},u=0,p=0,c=h;c<I.childNodes.length;c++){for(;null!=a[l]&&null!=a[l][c+u+p];)p+=a[l][c+u+p];d[c+u-h+p]=c;var g=parseInt(I.childNodes[c].getAttribute("colSpan"),10)||1;this.options.lazyDrawHiddenColumn&&"true"==I.childNodes[c].getAttribute("data-lazydrawtd")&&(g=1);var f=parseInt(I.childNodes[c].getAttribute("rowSpan"),10)||1;if(f>1)for(var m=l;m<l+f-1;m++)null==a[m+1]&&(a[m+1]={}),null==a[m+1][c-h+u+p]?a[m+1][c-h+u+p]=g:a[m+1][c-h+u+p]+=g;g>1&&(u+=g-1)}var y=0,b=0;o[l]=[];for(c=h;c<I.childNodes.length;c++){for(;null!=a[l]&&null!=a[l][this.columnOrder[c+b+y]];)b+=a[l][this.columnOrder[c+b+y]];var w=d[[this.columnOrder[c-h+y+b]]];null==w&&(w=0),o[l].push(w-h);var v=I.childNodes[w];g=parseInt(v.getAttribute("colSpan"),10);this.options.lazyDrawHiddenColumn&&"true"==v.getAttribute("data-lazydrawtd")&&(g=1),g>1&&(y+=g-1)}}for(l=0;l<i.rows.length;l++){h=0;var C=l%n;0===C&&(h=this.defaultColCnt);var I=i.rows[l];r.D.isIEAllVersion()&&"11"==r.D.browserVersion()&&l>=(this.lastIndex+1)*this.oneRowLength&&(I.style.backgroundColor="");var _=[];for(c=0;c<o[C].length;c++)_.push(I.childNodes[o[C][c]+h]);for(c=0;c<_.length;c++)I.appendChild(_[c])}for(var x,S=n-o.length;S>0;)x||(x=this.columnOrder.slice(0)),o.push(x),S--;for(l=0;l<n;l++)this._swapItem(e[l],o[l],0);this.updateStruct(e)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._swapItem=function(t,e,i){try{for(var o=[],a=null==i?0:i,r=0;r<e.length;r++)o.push(t[e[r]+a]);for(r=0;r<o.length;r++)t[r+a]=o[r]}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getColumnOrder=function(t){try{if(t){for(var e=[],i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.defaultColCnt;o<i.length;o++){if(0==i[o].length)return void $l(this.id+".getColumnOrder : use getColumnOrder(false). cannot express column order by name.");for(var a=this.tdIdList[i[o][0]-this.defaultColCnt],r=!1,n=0;n<e.length;n++)if(e[n]===a){r=!0;break}r||e.push(a)}return e}return this.columnOrder.slice(0)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getDisplayColumnIndex=function(t){try{
for(var e=parseInt(t,10),i=0;i<this.columnOrder.length;i++)if(e===this.columnOrder[i])return i;return t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getColumnMoveIndex=function(t){try{if(t<0||isNaN(t))return t;for(var e=this.colIndexInfo.body.colInfo.colIndexArr[t+this.defaultColCnt],i=this.colIndexInfo.body.colInfo.trIndexArr[t+this.defaultColCnt],o=this.colIndexInfo.body.colInfo.colIndexMatch[e],a=0;a<o.length;a++){var r=o[a];if(r>=t+this.defaultColCnt)break;var n=this.colIndexInfo.body.colInfo.rowSpanArr[r];n>1&&(i=i-n+1)}return o[i]-this.defaultColCnt}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleGroupbyZoneClick=function(t){try{for(var e=r.D.getDataPrefix("header_id"),i=r.D.getDataPrefix("col_id"),o=this.event.getTargetIterator(t,this.render);o.next()&&(!this.options.groupbyZoneSearch||!o.match("w2grid_groupbyZone_search"));){if(o.match("w2grid_groupbyZone_column")){var a=o.getElement(),n={};n.render=a,n.parentRender=this.render.getElementsByTagName("div")[0],n.headerID=a.getAttribute(e);var l=this.headerToBodyRelation[n.headerID],h=this.getColumnIndex(l);n.headerIndex=this._getColumnMoveIndex(h),n.dataIndex=this._getDataColIndex(this._getRealHeaderColIndex(n.headerID)),this.toggleGroupbyFilterList(n),u.B.stopEvent(t);break}if(o.match("w2grid_groupbyZone_column_closeButtonImg")){a=o.getElement();this.hideGroupbyFilterList(),this.ungroupColumn(a.getAttribute(i));break}if(o.match("w2grid_groupbyZone")){this.hideGroupbyFilterList(),u.B.stopEvent(t);break}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.toggleGroupbyFilterList=function(t){try{var e=t.render.tagName,i=t.headerIndex;"number"==typeof this.groupbyZoneStatus.beforeOpenedColIndex?(this.groupbyFilterList.saveState(this.groupbyZoneStatus.beforeOpenedColIndex.toString()),i==this.groupbyZoneStatus.beforeOpenedColIndex&&e==this.groupbyZoneStatus.beforeOpenedColTagName?"block"==this.groupbyFilterList.render.style.display?this.hideGroupbyFilterList():this.showGroupbyFilterList(t,!0):this.showGroupbyFilterList(t,!0,!0)):this.createGroupbyFilterList(t)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.applyFilterListFormat=function(t,e){try{var i=this.headerToBodyRelation[e],o=this.getCellInfo(i);if(this.options.displayValueOnUseFilterList)for(var a=0;a<t.length;a++)null!=t[a].id3&&(this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(a,"id2",t[a].id3):this.customFilterList.setCellDataNM(a,"id2",t[a].id3));else if(this.options.useFilterListFormat&&!this.options.useFilterSearch&&!this.options.useSearchFilter&&!o.useCustomFormatter){var r=0,n=this.headerInfoHash[e];if(n&&n.options.hideCustomFilter&&(r=1),o.options.displayFormat||o.options.displayFormatter||o.options.ioFormat)for(a=2-r;a<t.length;a++){var l=o.formatter.format(t[a].id2);this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(a,"id2",l):this.customFilterList.setCellDataNM(a,"id2",l)}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.createGroupbyFilterList=function(t){try{var e=t.render,i=t.parentRender,o=t.headerIndex,a=t.headerID;if(!this.groupbyFilterList){this.groupbyStatus.filter={};"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >","        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>","        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>","    </w2:listRow>","</w2:list>"
;var n=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>    </w2:listRow></w2:list>",!0).documentElement;this.groupbyFilterList=new WebSquare.uiplugin.list(this.id+"_groupbyZone_list","",n),this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]};var l=this;this.groupbyFilterList._handleClickEvent=this.groupbyFilterList.handleClickEvent,this.groupbyFilterList.handleClickEvent=function(t){try{u.B.stopPropagation(t);var e=u.B.getTarget(t),i=e;if((e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")||e.className.match("w2grid_groupbyZone_list_listColumn_text"))&&(i=e.parentElement),!i.className.match("w2grid_groupbyZone_list_listRow"))return;var o=i.children[0],a=l.getHeaderID(this.headerIndex),n=l.getColumnID(this.headerIndex);0==this.isGroupbyColumn&&(a=this.currentHeaderID,n=l.headerToBodyRelation[a]);var h=r.D.getDataPrefix("unique_id"),d=i.getAttribute(h),p=this.getAllData(),c=l.getCellInfo(n);if(this.options.useFilterSearch&&this.options.useFilterListFormat&&c.formatter&&(c.options.displayFormat||c.options.displayFormatter||c.options.ioFormat))for(var g=2;g<p.length;g++)p[g].id2=c.formatter.unformat(p[g].id2);p[0].customerFilter&&p[0][h]==d?e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")&&this._handleClickEvent(t):this._handleClickEvent(t);var f=o.checked,m=!1,y=!1,b=!1;if(p[0].customerFilter&&p[0][h]==d){if(!e.className.match("w2grid_groupbyZone_list_listColumn_checkbox"))return l.firstOpenCustomFilter[a]||(l.firstOpenCustomFilter[a]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(a):l.showCustomFilter(a));if(f)return l.firstOpenCustomFilter[a]?(l._dataList.filterManager.headerID=a,l._dataList.filterManager.targetColID=n,void l.setCustomFilterExpression()):(l.hideGroupbyFilterList(),l.firstOpenCustomFilter[a]||(l.firstOpenCustomFilter[a]=!0),void(l.options.groupbyFilterIcon?l._showCustomFilter(a):l.showCustomFilter(a)));for(var w in l.customFilterStatusObj[a]=!1,l.dataList.removeColumnFilter(n),l.customFilterStatusObj)if(l.customFilterStatusObj[w])return;m=!0,y=!0,b=!0;for(g=1;g<p.length;g++)p[g].id1=!0}else if(p[1].gridCheckedAll&&p[1][h]==d){y=!0,f&&(b=!0);for(g=2;g<p.length;g++)p[g].id1=f}if(!m&&!b&&p.length-2>0){l.groupbyStatus.filter[n]=[];for(g=2;g<p.length;g++)p[g].id1&&l.groupbyStatus.filter[n].push(p[g].id2);l.groupbyStatus.filter[n]=l.changeItemValue("value",n,l.groupbyStatus.filter[n]);var v=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(g=0;g<l.groupbyStatus.filter[n].length;g++){var C=l.groupbyStatus.filter[n][g];"string"==typeof C&&(l.groupbyStatus.filter[n][g]=C.replace(v,(function(t){return l.replacechar(t)})))}}if(y){if(b&&this.filterHistory.column[0]===n)this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),delete l.groupbyStatus.filter[n];else if(!b&&this.filterHistory.column[0]!==n&&p.length-2>0){for(g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else{var I=p.length-2;if(I>l.groupbyStatus.filter[n].length){if(p[1].id1=!1,this.filterHistory.column[0]!==n){for(var g=1;g<this.filterHistory.column.length;g++)if(this.filterHistory.column[g]===n){l.dataList.removeColumnFilter(n,{noRefresh:!0,noRefreshAfter:!0});break}
this.filterHistory.column.unshift(n),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else l.groupbyStatus.filter[n].length==I&&(p[1].id1=!0,delete l.groupbyStatus.filter[n],this.filterHistory.column[0]===n&&(this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()))}this.setFirstRowIndex(this.firstListIndex,!0);var _={};if(_.sortIndex=l.groupbyStatus.sortIndexArr,_.sortOrder=l.groupbyStatus.sortOrderArr,null!=l.groupbyStatus.filter&&(_.filter=l.groupbyStatus.filter,l.groupbyStatus.filter[n]&&2*l.groupbyStatus.filter[n].length>p.length)){var x=[],S="*";for(g=2;g<p.length;g++)if(!p[g].id1){if(p[g].id2===l.filterEmptyStr){S="+";continue}x.push(p[g].id2)}((c=l.getCellInfo(n)).itemsetObj||c.itemArr)&&(x=l.changeItemValue("value",n,x));var D="^\\n*(?:(?!^";for(v=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,g=0;g<x.length;g++){var R=x[g];"string"==typeof R&&(R=R.replace(v,(function(t){return l.replacechar(t)}))),D+=R+="$)(?!^"}D+="$).)"+S+"\\n*$",_.filterRegExp={},_.filterRegExp[n]=new RegExp(D,"gi")}if(_.noRefreshAfter=!0,!1===u.B.fireEvent(l,"ongroupby",_)){var L=l.getColCnt()+l.defaultColCnt,T=WebSquare.language.getMessage("Grid_cases")||"cases";_.rowNumHeader={colSpan:L,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' "+T+" ] ' ",align:"left"},_.footerVisible=!1,_.rowNumFooter={colSpan:L},l.groupby(_)}l.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.w.printStackTrace(t,null,this)}},this.groupbyFilterList.writeTo(this),this.groupbyFilterList.activate()}if(!0===t.noDraw)return;var h=e.clientWidth,d=WebSquare.style.getRelativeTop(e,i)+e.offsetHeight,p=WebSquare.style.getRelativeLeft(e,i);this.groupbyFilterList.setPosition(p,d),this.groupbyFilterList.render.style.width=h+"px";var c=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(c/21);var g=this.getGroupbyDepthInfo(t);if(this.groupbyFilterList.setJSON(g),this.applyFilterListFormat(g,a),this.groupbyFilterList.currentHeaderID=a,this.groupbyFilterList.headerIndex=o,this.groupbyFilterList.isGroupbyColumn=t.isGroupbyColumn,WebSquare.style.show(this.groupbyFilterList.render),r.D.getBoolean(this.headerInfoHash[a].options.autoFitFilterList)||r.D.getBoolean(this.options.autoFitFilterList)){var f=this.groupbyFilterList.getMaxItemWidth();f>h&&(this.groupbyFilterList.render.style.width=f+"px")}this.groupbyFilterList.focus(),this.groupbyZoneStatus.beforeOpenedColIndex=o,this.groupbyZoneStatus.beforeOpenedColTagName=e.tagName}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showGroupbyFilterList=function(t,e,i){try{var o=t.render,a=t.parentRender,n=t.headerIndex,l=t.headerID;if(this.groupbyFilterList.currentHeaderID=t.headerID,this.groupbyFilterList.headerIndex=n,this.groupbyZoneStatus.beforeOpenedColIndex=n,this.groupbyZoneStatus.beforeOpenedColTagName=o.tagName,WebSquare.style.show(this.groupbyFilterList.render),this.groupbyFilterList.focus(),e){var h,d=WebSquare.style.getRelativeTop(o,a)+o.offsetHeight,u=WebSquare.style.getRelativeLeft(o,a),p=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(p/21);var c=this.getGroupbyDepthInfo(t);this.groupbyFilterList.setJSON(c),!0===i&&this.groupbyFilterList.loadState(n),r.D.getBoolean(this.headerInfoHash[l].options.autoFitFilterList)||r.D.getBoolean(this.options.autoFitFilterList)?(h=this.groupbyFilterList.getMaxItemWidth(),o.clientWidth>h&&(h=o.clientWidth)):h=o.clientWidth,this.groupbyFilterList.setPosition(u,d),this.groupbyFilterList.render.style.width=h+"px",this.applyFilterListFormat(c,l)}else if(!0===i){this.groupbyFilterList.loadState(n);c=this.getGroupbyDepthInfo(t);this.applyFilterListFormat(c,l)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideGroupbyFilterList=function(){try{this.groupbyFilterList&&(WebSquare.style.hide(this.groupbyFilterList.render),this.groupbyFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),
this.groupbyFilterList.isChanged=!1))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getGroupbyDepthInfo=function(t){try{t.headerIndex;var e,i=t.headerID,o=this.headerToBodyRelation[i];0==t.isGroupbyColumn&&(o=this.headerToBodyRelation[i]),e=this.groupbyFilterList.filterHistory.column[0]===o?this.groupbyFilterList.filterHistory.filteredRowIndexArr[0]:this._dataList.filteredRowIndexArr;var a=this.dataList.getColData(o,e),r=this.getCellInfo(o),n=this.getUniqueValueOfArray(a),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,u=this.changeItemValue("label",o,n.slice(0)),p=this.customFilterStatusObj[i]||!1,c=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",g=WebSquare.language.getMessage("Grid_checked_all")||"choose all",f=[];f.push({id1:p,id2:c,customerFilter:!0}),f.push({id1:!p,id2:g,gridCheckedAll:!0}),!p&&this.groupbyStatus.filter&&o in this.groupbyStatus.filter&&(d=(h=this.groupbyStatus.filter[o]).slice(0));for(var m=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,y=this,b=0;b<u.length;b++){var w={};if(d){var v=!1,C=r.itemArr?r.itemHash[u[b]]:u[b];"string"==typeof C&&(C=C.replace(m,(function(t){return y.replacechar(t)})));for(var I=d.length-1;I>-1;I--){if(C==d[I]){v=!0,d.splice(I,1);break}if("string"==typeof d[I]){for(var _=!1,x=0;x<l.length;x++)if(l[x]==d[I]){_=!0;break}if(_&&(u[b]==this.options.useFilterEmptyMsg||u[b]==this.filterEmptyStr)){v=!0;break}}}w.id1=v}else w.id1=!p;w.id2=u[b],this.options.displayValueOnUseFilterList&&(w.id3=n[b]),f.push(w)}if(h){var S=!0,D=f;for(b=2;b<D.length;b++)if(!D[b].id1){S=!1;break}f[1].id1=!!S}return this._dataList.getDataLength()||(f[1].id1=!1),f}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(this.groupbyZoneStatus.groupbyZoneRender.offsetHeight>0)return;if(WebSquare.style.show(this.groupbyZoneStatus.groupbyZoneRender),this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.w.printStackTrace(t,null,this)}this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(0==this.groupbyZoneStatus.groupbyZoneRender.offsetHeight)return;if(this.dom[this.id+"_main_div"].style.top="0px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight+this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.w.printStackTrace(t,null,this)}WebSquare.style.hide(this.groupbyZoneStatus.groupbyZoneRender),this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showGroupbyZoneMessage=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.show(t)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideGroupbyZoneMessage=function(){try{if(this.options.groupbyZone&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.hide(t)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.syncWithGroupbyZone=function(){try{if(this.groupbyStatus.grouped&&this.options.groupbyZone){this.clearGroupbyZone();for(var t=r.D.getDataPrefix("header_id"),e=r.D.getDataPrefix("col_id"),i=this.groupbyStatus.sortIndexArr,o=0;o<i.length;o++){var a=i[o],n=this.getColumnID(a),l=this.bodyToHeaderRelation[n],h=document.createElement("div");h.setAttribute(t,l),h.className="w2grid_groupbyZone_column";var d=document.createElement("div");d.className="w2grid_groupbyZone_column_closeButtonDiv"
;var u=document.createElement("div");u.className="w2grid_groupbyZone_column_closeButtonImg",u.setAttribute(e,n);var p=document.createElement("div");p.className="w2grid_groupbyZone_column_labelDiv";var c=document.createElement("span"),g="textContent"in c?"textContent":"innerText";c[g]=this.getHeaderValue(l).replace(/<(\/)?br(\\s)*(\/)?>/gi," "),c.setAttribute("title",c[g]),p.appendChild(c),d.appendChild(u),h.appendChild(p),h.appendChild(d),this.groupbyZoneStatus.groupbyZoneRender.appendChild(h),c.className="w2grid_groupbyZone_column_value"}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.clearGroupbyZone=function(){try{if((this.groupbyStatus.grouped||this.clearGrouping)&&this.options.groupbyZone){for(var t=this.groupbyZoneStatus.groupbyZoneRender,e=t.childNodes,i=[],o=0;o<e.length;o++)null!=e[o].className.match("w2grid_groupbyZone_column")&&i.push(e[o]);for(o=0;o<i.length;o++)t.removeChild(i[o])}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.handleChangeGroupDepth=function(t){try{for(var e=r.D.getDataPrefix("header_id"),i=this.event.getTargetIterator(t);i.next();)if(i.match("w2grid_groupbyZone_column")){this.addClass("w2noselect"),r.D.emptySelection();var o=i.getElement().getAttribute(e),a=this.getHeaderIndex(o),n=this.getHeaderValue(o),l=this;return void WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_column_drag",contents:n,delay:15,applyMousePosition:!0,onDrop:function(t,i,o,s,r,n,h){var d,u=null;for(this.isMobile?(u=new WebSquare.targetIterator(document.elementFromPoint(h.changedTouches[0].clientX,h.changedTouches[0].clientY)),h.preventDefault()):u=l.event.getTargetIterator(h);u.next();){if(u.match("w2grid_groupbyZone_column")){d=l.getHeaderIndex(u.getElement().getAttribute(e));break}if(u.match("w2grid_groupbyZone")){var p=l.groupbyStatus.sortIndexArr;d=p[p.length-1];break}if(u.match(null,null,"body"))return}a!=d&&(!1===l.options.noSelect&&!1===l.options.preventCopy&&l.removeClass("w2noselect"),l.hideGroupbyFilterList(),l.changeGroupDepth(a,d))}})}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.createContextMenu=function(t,e){try{if("object"===(0,l.Z)(e)&&!0===e.hideSystemMenu)return;"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>","        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>","    </w2:listRow>","</w2:list>";var i=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>    </w2:listRow></w2:list>",!0).documentElement;this.contextMenu=new WebSquare.uiplugin.list(this.id+"_contextMenu_list","",i),this.contextMenu.writeTo(WebSquare.getBody()),this.contextMenu.activate();var o=this;this.contextMenu.event.addListener(this.contextMenu.render,"onclick",(function(t){try{u.B.stopPropagation(t);for(var e,i,a=o.event.getTargetIterator(t,this.render),r=o.contextMenu;a.next();){if(a.match("w2grid_contextMenu_column")){e=a.getElement().parentNode;break}if(a.match("w2grid_contextMenu_row")){e=a.getElement();break}if(a.match("w2grid_contextMenu"))break}for(var n=0;n<r.getLength();n++)if(e==r.render.childNodes[n]){i=n;break}o.callSelectedAPI(r.getRowData(n).col1,r.info),o.hideContextMenu();var l=o.contextMenu.getAllData()[i],h={row:r.info.rowIndex,col:r.info.colIndex,focusedCell:r.info.focusedCell,userMenuId:l.userMenuId,isSystemMenu:l.isSystemMenu,systemMenu:l.systemMenu};r.info=null,u.B.fireEvent(o,"oncontextclick",h.row,h.col,h.userMenuId,h.isSystemMenu,h.systemMenu,h.focusedCell)}catch(t){
s.w.printStackTrace(t,null,this)}}));var a=this.getContextMenuData(t);if(e&&e.hideSystemMenu&&"object"===(0,l.Z)(e.hideSystemMenu)&&e.hideSystemMenu.indexOf)for(var r=0;r<a.length;r++){var n=a[r].systemMenu;e.hideSystemMenu.indexOf(n)>-1&&(a.splice(r,1),r--)}if(e&&e.appendMenu&&"object"===(0,l.Z)(e.appendMenu)&&e.appendMenu.length)for(r=0;r<e.appendMenu.length;r++){var h=e.appendMenu[r];h.col1=h.label,h.isSystemMenu=!1,a.push(h)}if(a.length>0){this.showContextMenu(t,a);for(r=0;r<a.length;r++){var d=a[r];d.className&&(this.contextMenu.render.children[r].className=this.contextMenu.render.children[r].className+" "+d.className)}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getContextMenuData=function(t){try{var e=[],i=!0;if(this.groupbyStatus.grouped)for(var o=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",a=0;a<this.groupbyStatus.sortIndexArr.length;a++)if(t.focusedCell&&t.focusedCell.length>1){for(var r=0;r<t.focusedCell.length;r++)if(this.groupbyStatus.sortIndexArr[a]==t.focusedCell[r].focusedColIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(!i)break}else if(this.groupbyStatus.sortIndexArr[a]==t.colIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(i){var n=WebSquare.language.getMessage("Grid_group")||"Group";e.push({col1:n,isSystemMenu:!0,systemMenu:"Group"})}var l=WebSquare.language.getMessage("Grid_column_hide")||"Hide";if(e.push({col1:l,isSystemMenu:!0,systemMenu:"ColumnHide"}),0==this.options.fixedColumn||this.options.fixedColumn-1<t.colIndex){var h=WebSquare.language.getMessage("Grid_column_fix")||"Fix";e.push({col1:h,isSystemMenu:!0,systemMenu:"ColumnFix"})}if(this.options.fixedColumn>0){var d=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns";e.push({col1:d,isSystemMenu:!0,systemMenu:"ColumnUnfixAll"})}var u=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",p=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns";e.push({col1:u,isSystemMenu:!0,systemMenu:"ColumnAdjustWidth"});for(a=0;a<this.hiddenList.length;a++)if(this.hiddenList[a]){e.push({col1:p,isSystemMenu:!0,systemMenu:"ColumnShowAll"});break}var c=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths";e.push({col1:c,isSystemMenu:!0,systemMenu:"ColumnAdjustAuto"});var g=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths";if(e.push({col1:g,isSystemMenu:!0,systemMenu:"ColumnAdjustAutoNone"}),this.groupbyStatus.grouped){var f=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",m=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",y=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All";e.push({col1:f,isSystemMenu:!0,systemMenu:"FoldAll"}),e.push({col1:m,isSystemMenu:!0,systemMenu:"UnfoldAll"}),e.push({col1:y,isSystemMenu:!0,systemMenu:"UngroupAll"})}return e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showContextMenu=function(t,e){try{e||(e=this.getContextMenuData(t),this.contextMenu.setPosition(0,0));var i=e.length*(this.options.contextMenuRowHeight+1);this.contextMenu.show(),this.contextMenu.setSize(null,i),this.contextMenu.setJSON(e);var o=u.B.getMouseX(t.event),a=u.B.getMouseY(t.event),r=document.body.scrollTop;r<document.documentElement.scrollTop&&(r=document.documentElement.scrollTop);var n=(a-r)*WebSquare.style.getScale(),l=document.documentElement.clientHeight-n,h=Math.max(l,n),d=WebSquare.style.getSize(this.contextMenu.render,"outerheight");(h<d&&e.length>0||l<d&&n>d)&&(a-=d),document.documentElement.clientWidth<o+this.contextMenu.render.offsetWidth&&(o-=this.contextMenu.render.offsetWidth)<0&&(o=WebSquare.style.getAbsoluteLeft(this.render)),this.contextMenu.setPosition(o,a),this.contextMenu.info=t}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideContextMenu=function(){try{this.contextMenu&&this.contextMenu.hide()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.callSelectedAPI=function(t,e){try{
var i=WebSquare.language.getMessage("Grid_column_hide")||"Hide",a=WebSquare.language.getMessage("Grid_column_showAll")||"Show All Columns",r=WebSquare.language.getMessage("Grid_column_fix")||"Fix",n=WebSquare.language.getMessage("Grid_column_unfix")||"Unfix All Columns",l=WebSquare.language.getMessage("Grid_column_adjustWidth")||"Adjust Width",h=WebSquare.language.getMessage("Grid_column_adjustAuto")||"Adjust All Column Widths",d=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"UnAdjust All Column Widths",p=WebSquare.language.getMessage("Grid_fold_all")||"Fold All",c=WebSquare.language.getMessage("Grid_unfold_all")||"Unfold All",g=WebSquare.language.getMessage("Grid_ungroup_all")||"Ungroup All",f=WebSquare.language.getMessage("Grid_ungroup")||"Ungroup",m=WebSquare.language.getMessage("Grid_group")||"Group",y=e.focusedCell||[],b=[];if(y.length>0){for(var w=0;w<e.focusedCell.length;w++)b.push(e.focusedCell[w].colIndex);b.sort((function(t,e){return t-e}));for(w=0;w<b.length-1;)b[w]===b[w+1]?b.splice(w,1):w++}switch(t){case i:if(-1===e.colIndex)break;if(b.length>1)for(w=0;w<b.length;w++)this.setColumnVisible(b[w],!1),this.groupbyStatus.grouped&&this.ungroupColumn(b[w]);else this.setColumnVisible(e.colIndex,!1),this.groupbyStatus.grouped&&this.ungroupColumn(e.colIndex);break;case a:for(w=0;w<this.hiddenList.length;w++)this.hiddenList[w]&&this.setColumnVisible(this.columnOrder[w-this.defaultColCnt],!0);break;case r:if(-1===e.colIndex)break;if(b.length>1)for(w=0;w<b.length;w++)this.setFixedColumn(parseInt(b[w],10)+1);else this.setFixedColumn(parseInt(e.colIndex,10)+1);break;case n:if(-1===e.colIndex)break;this.setFixedColumn(0);break;case l:if(-1===e.colIndex)break;if(!this.autofitColumn){var v={type:"selectedColumn",colIndex:e.colIndex};this.setAutoFit(v)}break;case h:v={type:"allColumn"};this.setAutoFit(v);break;case d:this.clearAutoFit();break;case p:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.foldAll();break;case c:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.unfoldAll();break;case g:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.clearGroupby();break;case f:if(-1===e.colIndex)break;if(b.length>1)for(w=0;w<b.length;w++)this.ungroupColumn(b[w]);else this.ungroupColumn(e.colIndex);break;case m:if(-1===e.colIndex)break;if(this.groupbyStatus.grouped){if((v={}).sortIndex=this.groupbyStatus.sortIndexArr,v.sortOrder=this.groupbyStatus.sortOrderArr,b.length>1)for(w=0;w<b.length;w++)v.sortIndex.push(b[w]),v.sortOrder.push(1);else v.sortIndex.push(e.colIndex),v.sortOrder.push(1);!1===u.B.fireEvent(this,"ongroupby",v)&&((v=o.x.extend({},this.groupbyDisplayOptions)).sortIndex=this.groupbyStatus.sortIndexArr,v.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(v,!0))}else{v={};if(b.length>1){v.sortIndex=b,v.sortOrder=[];for(w=0;w<b.length;w++)v.sortOrder.push(1)}else v.sortIndex=[e.colIndex],v.sortOrder=[1];if(!1===u.B.fireEvent(this,"ongroupby",v)){var C=this.getColCnt()+this.defaultColCnt;v.rowNumHeader={colSpan:C,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' 건 ] ' ",align:"left"},v.rowNumFooter={colSpan:C},this.groupby(v,!0)}}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.createCustomFilterList=function(t,e){try{var i;!0!==e&&(i=this.headerToBodyRelation[t]);var o=this.options.filterListRowHeight+1,a=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum,n=WebSquare.language.getMessage("Grid_filter_search")||"search",l=this.getElementById(this.id+"_head_table");this._dataLayerHeight=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight,this._dataLayerHeight=this._dataLayerHeight-l.offsetHeight;var h=0;this.options.useFilterSearch?(h=Math.min(parseInt(this._dataLayerHeight/o),a),this.customFilterScrollViewRenderHeight=h*o):this.customFilterScrollViewRenderHeight=a*o
;"<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'>","</w2:scrollView>";var d=WebSquare.xml.parse("<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'></w2:scrollView>",!0).documentElement;WebSquare.xml.setAttribute(d,"bounce",!1),WebSquare.xml.setAttribute(d,"paging",!1),r.D.isMobile()||(WebSquare.xml.setAttribute(d,"horizontalScroll",!1),WebSquare.xml.setAttribute(d,"scrollType","auto"),WebSquare.xml.setAttribute(d,"showHorizontalScroll",!1),WebSquare.xml.setAttribute(d,"showVerticalScroll",!1),WebSquare.xml.setAttribute(d,"verticalScroll",!1)),this.customFilterScrollView=new WebSquare.uiplugin.scrollView(this.id+"_customFilter_scrollView","",d);var p="";if(this.options.useFilterSearch)p+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list' placeholder='"+n+"' virtualized='true' visibleRowNum='"+(h-1)+"' useSearch='true' wheelRows='1' _listRowHeight='"+o+"'>";else{this.options.useSearchFilter&&(useSearchFilterStr=" useSearchFilter='true'"),p+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list'>"}p+="    <w2:listRow tagName='div' style='height: "+this.options.filterListRowHeight+"px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_customFilter_list_listRow'>",p+="        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_customFilter_list_listColumn_checkbox'/>",p+="        <w2:listColumn id='id2' inputType='text' style='' class='w2grid_customFilter_list_listColumn_text'/>",p+="        <w2:listColumn id='id3' inputType='text' style='display:none;'/>",p+="    </w2:listRow>",p+="</w2:list>";var c=WebSquare.xml.parse(p,!0).documentElement;if(this.customFilterList=new WebSquare.uiplugin.list(this.id+"_customFilter_list","",c),this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterScrollView.addControl(this.customFilterList),this.customFilterScrollView.writeTo(this),this.customFilterScrollView.activate(),this.options.useSearchFilter){this.customFilterList.myhelper=new WebSquare.korHelper;var g=WebSquare.document.createElement("div");g.id=this.id+"_filter_Search_div",g.style.position="relative",g.style.backgroundColor="white",g.style.boxSizing="border-box",this._filter_searchInput=WebSquare.document.createElement("input"),this._filter_searchInput.id=this.id+"_filter_search_input",this._filter_searchInput.className="w2grid_filter_search_input",this._filter_searchInput.name=this.id+"_filter_search_input",this._filter_searchInput.style.height=o-3+"px",r.D.isIEAllVersion(),this._filter_searchInput.placeholder=n,g.appendChild(this._filter_searchInput),this.customFilterScrollView.render.insertBefore(g,this.customFilterScrollView.render.firstChild);var f=this.uuid,m=this.id;u.B.addListener(g,"onkeydown",(function(t){u.B.stopPropagation(t),r.D.setTimeout((function(){WebSquare.idCache[f].customFilterList.find()}),{key:m+"_customFilterList_search",delay:100})})),u.B.addListener(g,"onkeyup",(function(t){u.B.stopPropagation(t);var e=WebSquare.idCache[f],i=e.getHeaderDIV(e.customFilterList.currentHeaderID).getElementsByClassName("w2grid_customFilter_open")[0];if(13==t.keyCode){(e.options.useFilterSearch?this.dom.input.value:e._filter_searchInput.value)&&(e.hideCustomFilterList(),i&&i.focus())}else 27==t.keyCode&&(e.hideCustomFilterList(),i&&i.focus())})),this.customFilterScrollViewRenderHeight+=o}var y=this;if(this.customFilterScrollView.event.addListener(this.customFilterScrollView.render,"onclick",this.customFilterScrollView.event.bindAsEventListener(this.customFilterList,(function(t){try{u.B.stopPropagation(t);var e=u.B.getTarget(t)
;if(e.className.match("w2list_input")||e.className.match("w2list_scroll_thumb")||e.className.match("w2grid_filter_search_input")||e.className.match("w2grid_customFilter_scrollView"))return;var i,o=e.parentNode,a=0;if(this.options.virtualized?(i=this.getElementById(this.id+"_items_main").childNodes,a=this.firstListIndex):i=this.render.childNodes,e.className.match("w2grid_customFilter_list_listRow")){e=(o=e).firstChild;for(var r=0;r<this.getLength();r++)if(o==i[r]){this.setCellData(r+a,"id1",!e.checked);break}}if(e.className.match("w2grid_customFilter_list_listColumn_text")&&(i[0]!=o||this.options.virtualized&&a>0)){e=o.firstChild;for(r=0;r<this.getLength();r++)if(o==i[r]){this.setCellData(r+a,"id1",!e.checked);break}}var n=this.currentHeaderID,l=y.headerToBodyRelation[n],h=y._dataList.getColumnIndex(l),d=y.headerInfoHash[n],p=0;if(d&&d.options.hideCustomFilter&&(p=1),1!==p&&o==i[0]&&0===a){if(e.className.match("w2grid_customFilter_list_listColumn_checkbox")){if(e.checked){if(y.firstOpenCustomFilter[n]){y.headerID=n,y.targetColID=l,(y.options.useFilterSearch||y.options.useSearchFilter)&&y.setAutoCompleteItem(l,n),y.setCustomFilterExpression();for(r=1;r<this.getLength();r++)this.setCellData(r,"id1",!1);if(y.options.useFilterSearch||y.options.useSearchFilter){var c=y.getCustomFilterListJSON({colID:l,headerID:n});y._setFilterListHeight(n,c.length)}return}return y.hideCustomFilterList(),y.firstOpenCustomFilter[n]||(y.firstOpenCustomFilter[n]=!0),void y._showCustomFilter(n)}if(y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],y.dataList.removeColumnFilter(l),y.options.useFilterSearch||y.options.useSearchFilter){(c=y.getCustomFilterListJSON({colID:l,headerID:n}))[0].id1=!1;for(r=1-p;r<c.length;r++)c[r].id1=!0}for(r=1;r<this.getLength();r++)this.setCellData(r,"id1",!0);y.options.useFilterSearch&&(this.setJSON(c),y._setFilterListHeight(n,c.length))}else if(e.className.match("w2grid_customFilter_list_listColumn_text"))return void y._showCustomFilter(n)}else if(1!==p&&this.setCellData(0,"id1",!1),y.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],o==i[1-p-a]){var g=e.checked;if(e.className.match("w2grid_customFilter_list_listColumn_text"))g=!i[1-p].firstChild.checked;for(r=1-p;r<this.getLength();r++)this.setCellData(r,"id1",g)}var f=[],m=[],b=[],w=this.getLength();for(r=2-p;r<w;r++)this.getCellData(r,"id1")?m.push(r):b.push(r);var v=m.length>b.length,C=(y._dataList.getFilterList(),this.getLength()-2+p),I=y.getCellInfo(l),_=v?b:m,x="*";for(r=0;r<_.length;r++){var S=this.getCellData(_[r],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&""===(S=this.getCellData(_[r],"id3"))&&(x="+"),v&&S===y.filterEmptyStr?x="+":f.push(S)}y.options.useFilterListFormat&&I.useCustomFormatter||(f=y.changeItemValue("value",l,f));var D=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(r=0;r<f.length;r++){var R=f[r];"string"==typeof R&&(f[r]=R.replace(D,(function(t){return y.replacechar(t)})))}var L="";0==m.length?L+="/^[a-z0-9_-]{3,16}$/":L+=v?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+x+"\\n*$":"^"+f.join("$|^")+"$";var T,k="";if(I&&(k=y.getColumnOption(I.options.col_id,"dataType")),T="number"==k?new RegExp(L):new RegExp(L,"gi"),u.B.fireEvent(y._dataList,"onbeforecolumnfilterchange"),m.length<C&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(l,{noRefreshAfter:!0}),this.filterHistory.column[0]!==l&&(this.filterHistory.column.unshift(l),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<C){if(WebSquare.DataCollection.stopBroadCast=!1,v){this.customFilterListFilterInfo[l]=[];for(r=0;r<m.length;r++){S=this.getCellData(m[r],"id2")
;(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&I.formatter&&(I.options.displayFormat||I.options.displayFormatter||I.options.ioFormat)&&(S=I.formatter.unformat(S)),y.options.useFilterListFormat&&I.useCustomFormatter&&(S=this.getCellData(m[r],"id3")),this.customFilterListFilterInfo[l].push(S)}(I.itemsetObj||I.itemArr)&&(y.options.useFilterListFormat&&I.useCustomFormatter||(this.customFilterListFilterInfo[l]=y.changeItemValue("value",l,this.customFilterListFilterInfo[l])));for(r=0;r<this.customFilterListFilterInfo[l].length;r++){var F=this.customFilterListFilterInfo[l][r];F===y.filterEmptyStr?this.customFilterListFilterInfo[l][r]="":"string"==typeof F&&(F=F.replace(D,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[l][r]=F)}}else this.customFilterListFilterInfo[l]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:h,key:T,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[l];var A=y.getElementById(y.id+"_"+n+"_filter");1!==p&&this.getCellData(0,"id1")||WebSquare.style.removeClass(A,"w2grid_customFilter_filter");var E=!0,M=(C=this.getLength()-2+p,this.getAllData());for(r=2-p;r<M.length;r++)if(!M[r].id1){E=!1;break}E?(this.setCellData(1-p,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()):(this.setCellData(1-p,"id1",!1),WebSquare.style.addClass(A,"w2grid_customFilter_filter")),u.B.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){s.w.printStackTrace(t,null,this)}}))),(this.options.useFilterSearch||this.options.useSearchFilter)&&(this.customFilterList.find=function(){this.search="contain";var t="";t=y.options.useFilterSearch?this.dom.input.value:y._filter_searchInput.value,!y.options.caseSensitive&&t&&(t=t.toLowerCase());var e=[],i=this.currentHeaderID,o=y.headerToBodyRelation[i],s=y._dataList.getColumnIndex(o),a=y.getCellInfo(o),r=y.headerInfoHash[i],n=0;r&&r.options.hideCustomFilter&&(n=1);for(var l=0;l<2-n;l++)e.push({id1:l-n==1,id2:b[l].id2});if(""!=t){y.itemValueObj={},y.customFilterStatusObj[i]=!1,y.firstOpenCustomFilter[i]=!1;var h=e.length;y.dataList.removeColumnFilter(o),delete this.customFilterListFilterInfo[o];for(N=y.getCustomFilterListJSON({colID:o,headerID:i,useFormat:!1}),l=2-n;l<N.length;l++){var d=!1,p=N[l].id2+"";if(y.options.caseSensitive||(p=p.toLowerCase()),"contain"==this.search?d=this.myhelper.containWith(p,t):"start"==this.search?d=this.myhelper.startWith(p,t):"none"==this.search&&(d=p==t),d){var c,g=N[l].id2;(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.formatter&&(a.options.displayFormat||a.options.displayFormatter||a.options.ioFormat)&&(g=a.formatter.format(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.useCustomFormatter&&(g=N[l].id2,c=N[l].id3),e.push({id1:!0,id2:g,id3:c})}}h===e.length&&e.splice(1-n,1),this.setJSON(e),y._setFilterListHeight(i,N.length,e.length);var f=[],m=[],w=[],v=this.getLength();for(l=2-n;l<v;l++)this.getCellData(l,"id1")?m.push(l):w.push(l);if(0!=m.length||0!=w.length){var C=m.length>w.length;0===w.length&&(C=!1);var I=C?w:m,_="*";for(l=0;l<I.length;l++){g=this.getCellData(I[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.formatter&&(a.options.displayFormat||a.options.displayFormatter||a.options.ioFormat)&&(g=a.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.useCustomFormatter&&(g=this.getCellData(I[l],"id3")),C&&g===y.filterEmptyStr?_="+":f.push(g)}y.options.useFilterListFormat&&a.useCustomFormatter||(f=y.changeItemValue("value",o,f));var x=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(l=0;l<f.length;l++){var S=f[l];"string"==typeof S&&(f[l]=S.replace(x,(function(t){return y.replacechar(t)})))}var D=""
;0==m.length?D+="/^[a-z0-9_-]{3,16}$/":D+=C?"^\\n*(?:(?!^"+f.join("$)(?!^")+"$).)"+_+"\\n*$":"^"+f.join("$|^")+"$";var R,L="";(a=y.getCellInfo(o))&&(L=y.getColumnOption(a.options.col_id,"dataType")),R="number"==L?new RegExp(D):new RegExp(D,"gi"),u.B.fireEvent(y._dataList,"onbeforecolumnfilterchange");var T=this.getLength()-2+n;if(m.length<T&&(WebSquare.DataCollection.stopBroadCast=!0),y.dataList.removeColumnFilter(o,{noRefreshAfter:!0}),this.filterHistory.column[0]!==o&&(this.filterHistory.column.unshift(o),this.filterHistory.filteredRowIndexArr.unshift(y._dataList.filteredRowIndexArr.slice(0))),m.length<=T){if(WebSquare.DataCollection.stopBroadCast=!1,C){this.customFilterListFilterInfo[o]=[];for(l=0;l<m.length;l++){g=this.getCellData(m[l],"id2");(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.formatter&&(a.options.displayFormat||a.options.displayFormatter||a.options.ioFormat)&&(g=a.formatter.unformat(g)),(y.options.useFilterSearch||y.options.useSearchFilter)&&y.options.useFilterListFormat&&a.useCustomFormatter&&(g=this.getCellData(m[0],"id3")),this.customFilterListFilterInfo[o].push(g)}(a.itemsetObj||a.itemArr)&&(this.customFilterListFilterInfo[o]=y.changeItemValue("value",o,this.customFilterListFilterInfo[o]));for(l=0;l<this.customFilterListFilterInfo[o].length;l++){var k=this.customFilterListFilterInfo[o][l];k===y.filterEmptyStr?this.customFilterListFilterInfo[o][l]="":"string"==typeof k&&(k=k.replace(x,(function(t){return y.replacechar(t)})),this.customFilterListFilterInfo[o][l]=k)}}else this.customFilterListFilterInfo[o]=f;y.dataList.setColumnFilter({type:"regExp",colIndex:s,key:R,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[o];O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");var F=!0,A=(T=this.getLength()-2+n,this.getAllData());for(l=2-n;l<A.length;l++)if(!A[l].id1){F=!1;break}F?(this.setCellData(1-n,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),this.listRowObjArr.length!==b.length&&WebSquare.style.addClass(O,"w2grid_customFilter_filter")):(this.setCellData(1-n,"id1",!1),WebSquare.style.addClass(O,"w2grid_customFilter_filter")),u.B.fireEvent(y._dataList,"onaftercolumnfilterchange"),y.options.groupbyFilterBox&&(this.isChanged=!0)}}else{for(var E=y._dataList.getFilterList(),M=!1,l=0;l<E.length;l++)if(E[l]&&E[l].colIndex===s&&"func"!==E[l].type){M=!0;break}if(this.listRowObjArr.length!==b.length&&M){y.itemValueObj={},y.customFilterStatusObj[i]=!1,delete this.customFilterListFilterInfo[o],y.firstOpenCustomFilter[i]=!1,y.dataList.removeColumnFilter(o);var O=y.getElementById(y.id+"_"+i+"_filter");1!==n&&this.getCellData(0,"id1")||WebSquare.style.removeClass(O,"w2grid_customFilter_filter");for(var N=y.getCustomFilterListJSON({colID:o,headerID:i}),l=2-n;l<N.length;l++)e.push({id1:!0,id2:N[l].id2});this.setJSON(e),y._setFilterListHeight(i,e.length)}else M||e.length-(2-n)!=0||(this.setJSON(b),y._setFilterListHeight(i,b.length))}},this.customFilterList._inputKeyDown=this.customFilterList.inputKeyDown,this.customFilterList.inputKeyDown=function(t,e){var i=this;this.mytime=setTimeout((function(t){i.find()}),100,t)}),!0===e)return;var b=this.getCustomFilterListJSON({colID:i,headerID:t});if(this.customFilterList.setJSON(b),this.applyFilterListFormat(b,t),this._setFilterListSize({headerID:t,dataLen:b.length,type:"create"}),this.options.useFilterSearch){this.removeFocusedCell();var w=this.customFilterList.getElementById(this.customFilterList.id+"_input");WebSquare.style.getSize(w,"innerwidth"),WebSquare.style.getSize(w,"width");this.customFilterList.dom.input.focus()}else if(this.options.useSearchFilter){this.removeFocusedCell();w=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(w,"innerwidth"),WebSquare.style.getSize(w,"width");w.focus()}
this.customFilterList.currentHeaderID=t,this.customFilterList.customFilterListFilterInfo={},this.customFilterList.customFilterListAction=!1,this.customFilterList.customUserFilterListAction=!1,WebSquare.style.show(this.customFilterScrollView.render)}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setFilterListSize=function(t){try{var e,i,o=t.headerID,a=t.dataLen,n=t.type,l=this.getElementById(this.id+"_"+o),h=this.options.filterListRowHeight+1,d=(this.options.useFilterSearch?a+1:a)*h-1,u=d;if("height"!=n){var p=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum;if(this.options.useFilterSearch){var c=Math.min(parseInt(this._dataLayerHeight/h),p);this.customFilterScrollViewRenderHeight=c*h}else this.customFilterScrollViewRenderHeight=p*h}var g=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),f=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),m=WebSquare.style.getRelativeTop(l,this.render)+l.offsetHeight+1,y=WebSquare.style.getRelativeLeft(l,this.render),b=0,w=this.getElementById(this.id+"_head_table"),v=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight;v-=w.offsetHeight,this.options.useSearchFilter&&(b=h);var C=Math.min(this.customFilterScrollViewRenderHeight+b,d+b,v-f),I=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useFilterSearch?d=C:WebSquare.style.setStyle(I,"overflow-x","auto");var _=this.getElementById(this.id+"_size_y").clientWidth,x=this.getElementById(this.id+"_body_table"),S=WebSquare.style.getSize(x,"outerwidth")-WebSquare.style.getSize(x,"width"),D=this.getElementById(this.id+"_dataLayer").clientWidth-l.offsetLeft-g-S,R=e=this.customFilterList.getMaxItemWidth();if(r.D.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||r.D.getBoolean(this.options.autoFitFilterList))l.clientWidth>e&&(e=l.clientWidth),i=Math.min(D,e),this.options.useSearchFilter||(this.options.useFilterSearch?u>C&&(e+=_,i+=_):C<d&&i+_<=D&&(i+=_)),this.options.useSearchFilter?e>R&&WebSquare.style.setStyle(I,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(I,"overflow-x","hidden");else{var L=parseInt(this.headerInfoHash[o].options.filterListWidth);L>0?e<(i=L-g)&&(e=i):this.options.filterListWidth>0?e<(i=this.options.filterListWidth-g)&&(e=i):(i=l.clientWidth,l.clientWidth>e&&(e=l.clientWidth)),D<i&&(i=D),(this.options.useFilterSearch||e>R)&&WebSquare.style.setStyle(I,"overflow-x","hidden")}"height"!=n&&this.customFilterScrollView.setPosition(y,m-1);var T=0;if(this.options.useSearchFilter){var k=this.customFilterScrollView.getElementById(this.id+"_filter_search_input");T=k.offsetHeight,I.style.height=C-T+"px"}this.customFilterScrollView.setSize(i,C),this.customFilterList.setSize(e,d);var F,A,E=0;if(this.options.useFilterSearch||(I.clientWidth<R?(E=I.offsetHeight-I.clientHeight,this._dataLayerHeight>C+E&&(this.customFilterScrollView.setSize(null,C+E),this.options.useSearchFilter&&(I.style.height=I.offsetHeight+E+"px"))):WebSquare.style.setStyle(I,"overflow-x","hidden")),this.options.useResizeFilterList)this.customFilterScrollView.addClass("w2scrollView_resize"),r.D.getBoolean(this.headerInfoHash[o].options.autoFitFilterList)||r.D.getBoolean(this.options.autoFitFilterList)?(F=l.clientWidth,A=i):(F=i,A=Math.min(D,e)),this.customFilterScrollView.render.style.minWidth=F+"px",this.customFilterScrollView.render.style.maxWidth=A+"px",this.customFilterScrollView.render.style.minHeight=I.offsetHeight+T+"px",this.customFilterScrollView.render.style.maxHeight=Math.min(this._dataLayerHeight,d+T)+E+"px","create"==n&&(scrollViewObserver=new ResizeObserver((function(t){var e=t[0].contentRect.height-T;I.offsetHeight!=e&&(I.style.height=e+"px")})),scrollViewObserver.observe(this.customFilterScrollView.render))}catch(t){
s.w.printStackTrace(t)}},c.prototype._setFilterListHeight=function(t,e,i){try{var o=i||e;this._setFilterListSize({headerID:t,dataLen:o,type:"height"})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.toggleCustomFilterList=function(t){try{this.customFilterScrollView&&this.customFilterList&&("none"==this.customFilterScrollView.render.style.display||this.customFilterList.currentHeaderID!=t?this.moveCustomFilterList(t):this.hideCustomFilterList())}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showCustomFilterList=function(t,e){try{if(this.customFilterScrollView&&this.customFilterList){if(e){WebSquare.style.show(this.customFilterScrollView.render),this.options.useResizeFilterList&&(this.customFilterScrollView.render.style.minWidth="",this.customFilterScrollView.render.style.maxWidth="",this.customFilterScrollView.render.style.minHeight="",this.customFilterScrollView.render.style.maxHeight="");var i=t.headerID,o=t.dataLength;this._setFilterListSize({headerID:i,dataLen:o})}var a=this.getElementById(this.id+"_customFilter_scrollView_container");if(this.customFilterList.currentHeaderID=i,a.scrollLeft=0,a.scrollTop=0,this.options.useFilterSearch){this.removeFocusedCell(),this.customFilterList.dom.input.value="";var r=this.customFilterList.getElementById(this.customFilterList.id+"_input");WebSquare.style.getSize(r,"innerwidth"),WebSquare.style.getSize(r,"width");this.customFilterList.dom.input.focus()}else if(this.options.useSearchFilter){this.removeFocusedCell();r=this.customFilterScrollView.getElementById(this.id+"_filter_search_input"),WebSquare.style.getSize(r,"innerwidth"),WebSquare.style.getSize(r,"width"),a.offsetWidth,a.clientWidth;WebSquare.style.getSize(r,"outerwidth")-WebSquare.style.getSize(r,"width"),r.value="",r.focus()}WebSquare.style.show(this.customFilterScrollView.render)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.moveCustomFilterList=function(t){try{if(this.customFilterScrollView&&this.customFilterList){var e=this.headerToBodyRelation[t];WebSquare.style.show(this.customFilterScrollView.render);var i=this.getCustomFilterListJSON({colID:e,headerID:t});this.customFilterList.setJSON(i),this.applyFilterListFormat(i,t),this.customFilterList.currentHeaderID=t,this.showCustomFilterList({headerID:t,dataLength:i.length},!0)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.hideCustomFilterList=function(){try{this.customFilterScrollView&&this.customFilterList&&(WebSquare.style.hide(this.customFilterScrollView.render),this.customFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.customFilterList.isChanged=!1))}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.getCustomFilterListJSON=function(t){try{var e;if(this.customFilterList.filterHistory.column[0]!==t.colID||this.options.showAllFilterList)if(this.options.useFilterSearch||this.options.useSearchFilter){var i=this._dataList.getFilterList();if(i.length>0){var o=!1;1==i.length&&this.getColumnID(i[0].colIndex)===t.colID&&(o=!0)}e=o?this._dataList.filterManager.allRowIndexArr:this._dataList.filteredRowIndexArr}else this.options.showAllFilterList?(this.customFilterList.customFilterListFilterInfo,e=this._dataList.filterManager.firstFiltering?this._dataList.filteredRowIndexArr:this._dataList.filterManager.allRowIndexArr):e=this._dataList.filteredRowIndexArr;else e=this.customFilterList.filterHistory.filteredRowIndexArr[0];var a=this.dataList.getColData(t.colID,e),r=this.getCellInfo(t.colID),n=this.getUniqueValueOfArray(a,r.options.dataType),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("")
;var h,d,u=("select"==r.options.inputType||"text"==r.options.inputType)&&this.options.useFilterListFormat&&r.useCustomFormatter?"customFormatted":"label",p=this.changeItemValue(u,t.colID,n.slice(0)),c=this.customFilterStatusObj[t.headerID]||!1,g=WebSquare.language.getMessage("Grid_Customized_Filter")||"Customized Filter",f=WebSquare.language.getMessage("Grid_checked_all")||"choose all",m=!c;if(!c)if(this.customFilterList.customFilterListFilterInfo&&Object.keys(this.customFilterList.customFilterListFilterInfo).length>0)t.colID in this.customFilterList.customFilterListFilterInfo&&(d=(h=this.customFilterList.customFilterListFilterInfo[t.colID]).slice(0));else if(this.options.showAllFilterList){var y=this._dataList.getFilteredColData(t.colID);d=this.getUniqueValueOfArray(y).slice(0),c||a.length==y.length||(m=!1)}for(var b=[{id1:c,id2:g},{id1:m,id2:f}],w=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,v=this,C=0;C<p.length;C++){var I={};if(d){var _,x=!1;"string"==typeof(_=r.useCustomFormatter&&r.mainGrid.options.useFilterListFormat?n[C]:r.itemArr?r.itemHash[p[C]]:p[C])&&(_=_.replace(w,(function(t){return v.replacechar(t)})));for(var S=d.length-1;S>-1;S--){if(_==d[S]){x=!0,d.splice(S,1);break}if("string"==typeof d[S]){for(var D=!1,R=0;R<l.length;R++)if(l[R]==d[S]){D=!0;break}if(D&&(p[C]==this.options.useFilterEmptyMsg||p[C]==this.filterEmptyStr)){x=!0;break}}}I.id1=x}else I.id1=!c;var L=p[C],T=n[C];(this.options.useFilterSearch||this.options.useSearchFilter)&&this.options.useFilterListFormat&&r.useCustomFormatter&&(L=this._applyFormatter(r,T)),I.id2=L,(this.options.displayValueOnUseFilterList||this.options.useFilterListFormat&&r.useCustomFormatter)&&(I.id3=n[C]),b.push(I)}var k=0,F=this.headerInfoHash[t.headerID];if(F&&F.options.hideCustomFilter&&(b.shift(),k=1),h){var A=!0,E=b;for(C=2-k;C<E.length;C++)if(!E[C].id1){A=!1;break}b[1-k].id1=!!A}return this._dataList.getDataLength()||(b[1-k].id1=!1),b}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.changeItemValue=function(t,e,i,o){try{var a,n=[],l=!1,h=this.getCellInfo(e),d=h.options.inputType;if("custom"==d&&(h=h.cellManagerHashByRowIndex[h.editRowIndex]?h.cellManagerHashByRowIndex[h.editRowIndex]:h),h.itemHash={},!1===o||(a=h.options.filterDisplayMode?h.options.filterDisplayMode:"label"),h.itemsetObj&&""!=h.itemsetObj.nodeset&&h.itemsetObj.nodeset.wq_replaceAll(" ","").indexOf("data:")>=0&&(!h.itemArr||h.itemArr.length<1)){h.itemArr=[];var u=h.itemsetObj.nodeset.replace("data:",""),p=this.modelControl.getDataComp(u),c=function(t,e){var i=t,o=h.options.delimiter?h.options.delimiter:"";switch(a){case"value delim label":i=e+o+i;break;case"label delim value":i=i+o+e;break;case"value":i=e}return i};if(p&&WebSquare.idCache[p.uuid])switch(p.initializeType){case"linkedDataList":for(var g=[],f={},m=p.getAllNoFilteredData(),y=0;y<p._dataList.getDataLength();y++){var b=m[y*p.cellIdList.length+p.bodyIdColIndexMap[h.itemsetObj.label]],w=m[y*p.cellIdList.length+p.bodyIdColIndexMap[h.itemsetObj.value]];r.D.isNumber(w)&&(w+=""),f[b]!=w&&(f[b]=w,g.push({orgLabel:b,label:c(b,w),value:w}))}h.itemArr=g;break;case"dataList":for(g=[],f={},y=0;y<p.getDataLength();y++){b=p.getCellData(y,h.itemsetObj.label),w=p.getCellData(y,h.itemsetObj.value);r.D.isNumber(w)&&(w+=""),f[b]!=w&&(f[b]=w,g.push({orgLabel:b,label:c(b,w),value:w}))}h.itemArr=g;break;case"dataMap":for(g=[],f={},y=0;y<p.getCount();y++){b=p.get(h.itemsetObj.label),w=p.get(h.itemsetObj.value);r.D.isNumber(w)&&(w+=""),f[b]!=w&&(f[b]=w,g.push({orgLabel:b,label:c(b,w),value:w}))}h.itemArr=g}}if(h.itemArr){if("customFormatted"==t){for(y=0;y<i.length;y++){var v=this._applyFormatter(h,i[y]);n.push(v),h.itemHash[v]=i[y]}return n}var C="label"==t?"value":"label";"label"==t&&!1===o&&h.itemArr.length>0&&h.itemArr[0].orgLabel&&(t="orgLabel");var I=h.itemArr.slice(0);for(y=0;y<i.length;y++){var _=i[y];if(r.D.isNumber(_)&&(_+=""),"custom"==d)-1==this.modelControl.getDataComp(h.dataComp).dataArr.indexOf(i[y])&&n.push(i[y]);for(var x=I.length-1;x>-1;x--){var S=I[x]
;if(S[C]==_){n.push(S[t]),I.splice(x,1),"label"==t&&(h.itemHash[S[t]]=S[C]);break}if("label"==t||"orgLabel"==t){if(!_||this.useFilterEmptyValueInfo[_]){l||(l=!0,n.push(this.filterEmptyStr));break}}else if("value"==t&&_==this.filterEmptyStr){for(var D in this.useFilterEmptyValueInfo)n.push(D);break}}}}else{if("customFormatted"==t){for(y=0;y<i.length;y++){v=this._applyFormatter(h,i[y]);n.push(v),h.itemHash[v]=i[y]}return n}for(y=0;y<i.length;y++){if("label"==t){if(!i[y]&&0!==i[y]||this.useFilterEmptyValueInfo[i[y]]){l||(l=!0,n.push(this.filterEmptyStr));continue}}else if("value"==t&&i[y]==this.filterEmptyStr){for(var D in this.useFilterEmptyValueInfo)n.push(D);continue}n.push(i[y]),h.itemHash[i[y]]=i[y]}}return n}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.resizeGridList=function(){try{var t,e;if(this.groupbyFilterList)return;if(!this.customFilterList)return;t=this.customFilterList,e=this.customFilterScrollView;var i=document.getElementById(this.id+"_"+t.currentHeaderID);if(i){var o,a=i.clientWidth,n=(this.options.useFilterSearch?t.listRowObjArr.length+1:t.listRowObjArr.length)*(this.options.filterListRowHeight+1)-1,l=e.render.clientHeight,h=WebSquare.style.getSize(this.customFilterScrollView.render,"outerwidth")-WebSquare.style.getSize(this.customFilterScrollView.render,"width"),d=WebSquare.style.getRelativeTop(i,this.render)+i.offsetHeight+1,u=WebSquare.style.getRelativeLeft(i,this.render),p=this.getElementById(this.id+"_customFilter_scrollView_container");this.options.useSearchFilter&&WebSquare.style.setStyle(p,"overflow-x","auto");var c=this.getElementById(this.id+"_size_y").clientWidth,g=this.getElementById(this.id+"_body_table"),f=WebSquare.style.getSize(g,"outerwidth")-WebSquare.style.getSize(g,"width"),m=this.getElementById(this.id+"_dataLayer").clientWidth-i.offsetLeft-h-f,y=a=this.customFilterList.getMaxItemWidth();if(r.D.getBoolean(this.getHeaderInfo(t.currentHeaderID).options.autoFitFilterList)||r.D.getBoolean(this.options.autoFitFilterList))this.customFilterList?(i.clientWidth>a&&(a=i.clientWidth),o=Math.min(m,a),this.options.useSearchFilter||(this.options.useFilterSearch?n>l&&(a+=c,o+=c):l<t.render.clientHeight&&o+c<=m&&(o+=c)),this.options.useSearchFilter?a>y&&WebSquare.style.setStyle(p,"overflow-x","hidden"):this.options.useFilterSearch&&WebSquare.style.setStyle(p,"overflow-x","hidden")):this.groupbyFilterList&&(o=a=y);else if(this.customFilterList){var b=parseInt(this.headerInfoHash[t.currentHeaderID].options.filterListWidth);b>0?a<(o=b-h)&&(a=o):this.options.filterListWidth>0?a<(o=this.options.filterListWidth-h)&&(a=o):(o=i.clientWidth,i.clientWidth>a&&(a=i.clientWidth)),m<o&&(o=m),(this.options.useFilterSearch||a>y)&&WebSquare.style.setStyle(p,"overflow-x","hidden")}e.setPosition(u,d-1),t.setSize(a,null),e.setSize(o,l)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.showGroupbyHeaderGhost=function(t,e){try{var i=this.getHeaderValue(e);WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_header_drag",contents:i,delay:15,applyMousePosition:!0,onDrop:function(t,e,i,o,s,a,r){}})}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.setAdaptiveColumnVisible=function(t,e){try{if(this.hiddenAdaptiveList[t]==!e||t>=this.hiddenAdaptiveList.length)return;var i=this,o=function t(e){var o=i.getColumnID(e),s=null!=i.bodyToHeaderRelation[o]?i.getHeaderLayer(i.bodyToHeaderRelation[o]):null;return null!=s?s:t(e-1)}(t),a=document.getElementsByClassName(this.id+"_columnstyle_"+(t-this.defaultColCnt)+"_"),n=this.getColumnStyleValue(t-this.defaultColCnt,"height");if(null==this.oldOptions.headerColBorder&&null!=o&&(this.oldOptions.headerColBorder=WebSquare.style.getStyle(o,"border-top")),null==this.oldOptions.headerPaddingTop&&null!=o&&(this.oldOptions.headerPaddingTop=WebSquare.style.getStyle(o,"padding-top")),null==this.oldOptions.headerPaddingBottom&&null!=o&&(this.oldOptions.headerPaddingBottom=WebSquare.style.getStyle(o,"padding-bottom")),
a.length>0&&""!=this.oldOptions.bodyColBorder&&(this.oldOptions.bodyColBorder=WebSquare.style.getStyle(a[0],"border-top")),this.hasSubtotal)for(var l=0,h=0,d=this.drawedSubtotal[0][0].childNodes,u=0;u<d.length&&((v=parseInt(d[u].getAttribute("colSpan")))||(v=1),!(h<=t&&t<h+v));u++)h+=v,l++;if(this.hasFooter){var p=0,c=0,g=this.htmlInfo.foot.rowArr;for(u=0;u<g.length;u++)for(var f=g[u],m=0;m<f.length;m++){var y=f[m];if((v=parseInt(y.colSpan))||(v=1),c<=t-this.defaultColCnt&&t-this.defaultColCnt<c+v)break;c+=v,p++}}if(e){o.style.height=n,o.style.removeProperty("padding"),o.style.borderTop=this.oldOptions.headerColBorder;for(u=0;u<a.length;u++)a[u].style.height=n,a[u].style.removeProperty("padding"),a[u].style.borderTop=this.oldOptions.bodyColBorder;if(this.setAdaptiveColumnStyle(t,"height",n),this.setAdaptiveColumnStyle(t,"padding",""),this.setAdaptiveColumnStyle(t,"border-top",this.oldOptions.bodyColBorder),this.hasFooter)for(u=0;u<g.length;u++){y=g[u][p];var b=parseInt(this.getFooterStyle(y.id,"height"))+parseInt(o.offsetHeight);!(v=parseInt(y.colSpan))||parseInt(this.getFooterStyle(y.id,"height"))<=0?(this.setFooterStyle(y.id,"height",o.style.height),this.setFooterStyle(y.id,"padding",o.style.padding),this.setFooterStyle(y.id,"borderTop",o.style.borderTop)):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(u=0;u<this.drawedSubtotal.length;u++)for(m=0;m<this.drawedSubtotal[u].length;m++){var w=this.drawedSubtotal[u][m].childNodes;b=parseInt(w[l].style.height)+parseInt(o.offsetHeight);!(v=parseInt(w[l].getAttribute("colSpan")))||parseInt(w[l].style.height)<=0?(w[l].style.height=o.style.height,w[l].style.padding=o.style.padding,w[l].style.borderTop=o.style.borderTop):w[l].style.height=b+"px"}}else{if(this.hasFooter)for(u=0;u<g.length;u++){y=g[u][p],b=parseInt(this.getFooterStyle(y.id,"height"))-parseInt(o.offsetHeight);!(v=parseInt(y.colSpan))||b<=0?(this.setFooterStyle(y.id,"height","0px"),this.setFooterStyle(y.id,"padding","0px"),this.setFooterStyle(y.id,"borderTop","0px")):this.setFooterStyle(y.id,"height",b+"px")}if(this.hasSubtotal)for(u=0;u<this.drawedSubtotal.length;u++)for(m=0;m<this.drawedSubtotal[u].length;m++){var v;w=this.drawedSubtotal[u][m].childNodes,b=parseInt(w[l].style.height)-parseInt(o.offsetHeight);!(v=parseInt(w[l].getAttribute("colSpan")))||b<=0?(w[l].style.height="0px",w[l].style.padding="0px",w[l].style.borderTop="0px"):w[l].style.height=b+"px"}var C=parseInt(o.colSpan,10),I=!1;if(C>1)for(var _=r.D.getDataPrefix("header_id"),x=this.headerToBodyRelation[o.getAttribute(_)],S=this.getColumnIndex(x),D=S;D<S+C;D++)this.hiddenList[D]||(I=!0);(C<2||!I)&&(o.style.height="0px",o.style.padding="0px",o.style.borderTop="0px");for(u=0;u<a.length;u++)a[u].style.height="0px",a[u].style.padding="0px",a[u].style.borderTop="0px";this.setAdaptiveColumnStyle(t,"height","0px"),this.setAdaptiveColumnStyle(t,"padding","0px"),this.setAdaptiveColumnStyle(t,"border-top","0px")}parseInt(o.colSpan,10)>1&&this.setAdaptiveGridHeaderHeight(),this.hiddenAdaptiveList[t]=!e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.applyFilterHistory=function(){try{if(this.getElementById(this.id+"_groupbyFilterBox_apply").checked=this.groupbyFilterBox_history.length>0,!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var t=this.groupbyFilterBox_select.getSelectedIndex(),e=this.groupbyFilterBox_history[t];if(e.groupbyOptions)this.groupby(JSON.parse(e.groupbyOptions,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:e}catch(t){return e}}))),this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={};else{for(var i in this.groupbyStatus.grouped&&this.clearGroupby(),this._dataList.clearFilter(e.filterOption.length>0),this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],
this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.refreshCustomFilterHistory(t),this._dataList.broadcast({gridView:["clearHeaderSort"]}),this._dataList.broadcast({gridView:["notifyMultisort"]})}}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._refreshCustomFilterHistory=function(t,e,i){try{for(var o=t?JSON.parse(t,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:"object"===(0,l.Z)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):[],a="",r="",n=0;n<o.length;n++){var h=o[n];h.noRefresh=n<o.length-1,h.keepTop=!1,h.internal=!0;var d="";for(var u in h.bodyIdColIndexMap)h.bodyIdColIndexMap[u]===h.colIndex&&(d=u);"sort"!==h.type&&(a=',"'+d+'"'+a,r=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+r),this._dataList.setFilter(h);var p=this.bodyToHeaderRelation[this._dataList.cellIdList[h.colIndex]],c=this.getElementById(this.id+"_"+p+"_filter");c&&WebSquare.style.addClass(c,"w2grid_customFilter_filter")}a=a.slice(1)+"],",r=r.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var g='{"column":['+a+'"filteredRowIndexArr":['+r;this.customFilterList.filterHistory=JSON.parse(g),this.customFilterList.customFilterListFilterInfo=e?JSON.parse(e,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:"object"===(0,l.Z)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):{},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this.customFilterStatusObj=i?JSON.parse(i):{},this.groupbyStatus.grouped||this.drawHeaderSortImages()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.refreshCustomFilterHistory=function(t){try{for(var e=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()],i="",o="",a=0;a<e.filterOption.length;a++){var r=e.filterOption[a];r.noRefresh=a<e.filterOption.length-1,r.keepTop=!1,r.internal=!0;var n="";for(var h in r.bodyIdColIndexMap)r.bodyIdColIndexMap[h]===r.colIndex&&(n=h);"sort"!==r.type&&(i=',"'+n+'"'+i,o=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+o),this._dataList.setFilter(r);var d=this.bodyToHeaderRelation[this._dataList.cellIdList[r.colIndex]],u=this.getElementById(this.id+"_"+d+"_filter");u&&WebSquare.style.addClass(u,"w2grid_customFilter_filter")}i=i.slice(1)+"],",o=o.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var p='{"column":['+i+'"filteredRowIndexArr":['+o;this.customFilterList.filterHistory=JSON.parse(p),e.customFilterListFilterInfo?this.customFilterList.customFilterListFilterInfo=JSON.parse(e.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:"object"===(0,l.Z)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):this.customFilterList.customFilterListFilterInfo={},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.clearFilterHistory=function(){try{this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!1,this.groupbyFilterBox_history=[],this.groupbyFilterBox_select.removeAll(),this.groupbyStatus.grouped?this.clearGroupby():this._dataList.clearFilter()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype.refreshGroupbyFilterBox=function(){try{var t=this._dataList.getFilterList(),e="",i=!(!this.options.customFilterBox||!this.groupbyStatus.groupbyOptions),o=i?"[Groupby] ":""
;if(!this.options.customFilterBox&&!this.groupbyStatus.groupbyOptions)return;e+=o,e+="(";for(var a,n=null,h="",d=!0,u=o,p=!1,c=this.options.groupbyFilterBoxLabelSize,g=0;g<t.length;g++){var f="regExp"===(D=t[g]).type,m="func"===D.type&&D.param;if(f||m){d||(e+=" "+D.condition+" ",u+=D.condition),e+="(";var y=this._dataList.cellIdList[D.colIndex],b=this.getHeaderValue(this.bodyToHeaderRelation[y])||y;if(f){var w=this.dataList.getColData(y,this._dataList.filteredRowIndexArr);if((T=this.getUniqueValueOfArray(w)).length<=0){if(r.D.isNullReg(D.key)){n=y,h=b;break}continue}for(var v=0,C=0;C<T.length;C++){var I=T[C];this.useFilterEmptyValueInfo[I]&&(I=this.filterEmptyStr),v>0&&(v<c&&(e+=" OR "),u+="OR"),v<c&&(e+=b+" = "+I),u+=y+"="+I,v++}v>c&&(e+=" OR ... ("+(v-c)+" omitted)")}else if(m)for(C=0;C<D.param.length;C++){null!=(A=D.param[C]).radio&&(e+=1===A.radio?" OR ":" AND ",u+=1===A.radio?" OR ":" AND ");var _="string"==typeof A.auto?A.auto.replace(/[\\](?![\\])/g,""):A.auto;e+=b+" "+this.selectboxItemSet[A.select-1]+" "+_,u+=y+" "+this.selectboxItemSet[A.select-1]+" "+A.auto}e+=")",d=!1}}if(e+=")",n&&(e=o+"("+h+" = NULL)",u=o+n+"_NULL_"),"()"!==e&&e!==o+"()"||(e=o+"ALL",u=o+"_ALL_",p=!0),!p&&this.options.groupbyFilterBoxFormatter){var x=r.D.getGlobalFunction(this.options.groupbyFilterBoxFormatter,this.scope_id);if("function"==typeof x){var S=[];if(u===o+n+"_NULL_")S.push({header:h,filter:[]});else for(g=0;g<t.length;g++){var D;f="regExp"===(D=t[g]).type,m="func"===D.type&&D.param;if(f||m){y=this._dataList.cellIdList[D.colIndex];var R=this.getHeaderValue(this.bodyToHeaderRelation[y])||y;if(f){var L={header:R,filter:[]},T=(w=this.dataList.getColData(y,this._dataList.filteredRowIndexArr),this.getUniqueValueOfArray(w)),k=[];for(C=0;C<T.length;C++){I=T[C];this.useFilterEmptyValueInfo[I]&&(I=this.filterEmptyStr),k.push(I)}var F=this.getCellInfo(y);L.filter.push({operator:"in",values:k,labels:F.itemsetObj||F.itemArr?this.changeItemValue("label",y,T.slice(0)):k}),S.push(L)}else if(m){for(L={header:R,filter:[]},C=0;C<D.param.length;C++){var A=D.param[C],E={};null!=A.radio&&(E.gate=1===A.radio?"or":"and"),E.operator=this.selectboxItemSet[A.select-1];_="string"==typeof A.auto?A.auto.replace(/[\\](?![\\])/g,""):A.auto;E.values=_;F=this.getCellInfo(y);E.labels=F.itemsetObj||F.itemArr?this.changeItemValue("label",y,[_])[0]:_,L.filter.push(E)}D.param.length>0&&S.push(L)}}}var M=x.call(this,S,i);null!=M&&!1!==M&&(e=M)}}if(!p&&!1===this.groupbyFilterBox_select.setValueNM(u))this.groupbyFilterBox_select.addItem(u,e),this.groupbyFilterBox_select.setValueNM(u),u===o+"_ALL_"?a={filterOption:[],customFilterStatusObj:"{}"}:(a={filterOption:t,customFilterStatusObj:JSON.stringify(this.customFilterStatusObj)},this.groupbyStatus.grouped&&this.groupbyStatus.filter?a.customFilterListFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})):this.customFilterList&&this.customFilterList.customFilterListFilterInfo&&(a.customFilterListFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})))),this.groupbyStatus.groupbyOptions&&(a.groupbyOptions=this.groupbyStatus.groupbyOptions),this.groupbyFilterBox_history.push(a);this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!p}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getMouseColumnIndex=function(t){try{var e=t.colIndex,i=t.offsetX,o=t.offsetLeft,a=t.colSpan;if(i-o<(n=.3*this.colWidthList[e]>10?10:parseInt(.3*this.colWidthList[e],10))&&0!=e)e--;else for(var r=0;r<a;r++){var n,l=parseInt(this.colGroup.bodyColList[e+r].style.width,10);if((o+=l)-(n=.3*l>10?10:parseInt(.3*l,10))<i&&i<o+n){e+=r;break}}return e}catch(t){return s.w.printStackTrace(t,null,this),e}},c.prototype._useRole=function(){try{return!r.D.isMobile()}catch(t){s.w.printStackTrace(t,null,this)}},
c.prototype.setAdaptive=function(){try{var t=this.options.adaptive,e=parseInt(this.options.adaptiveThreshold)||480;for(var i in this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}"crosstab"==t&&(r.D.isIE()&&parseInt(a.v.browserVersion(),10)<10||(parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=e?this.addAdaptive():this.removeAdaptive()))}catch(t){s.w.printStackTrace(t)}},c.prototype.addAdaptive=function(){try{var t,e=this.options.adaptive;for(var i in"crosstab"==e&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}if(!this.hasClass(t)){this.oldOptions.visibleRowNum=this.options.visibleRowNum,this.oldOptions.drawType=this.options.drawType,this.options.visibleRowNum="all",this.options.drawType="virtual",this.adjustDraw(this.lastIndex),this.addClass(t),this.setAdaptiveGridBodyHeight(),this.setAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(var o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}if(this.options.adaptiveSlideHeader){var a=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody");this.slideHeadObj||(this.slideHeadObj={},this.slideHeadObj.render=a,this.slideHeadObj.headTableWidth=a.offsetWidth,this.slideHeadObj.hidden=!1),"absolute"!=this.slideHeadObj.render.style.position?n.scrollWidth>n.clientWidth+this.slideHeadObj.headTableWidth&&(this.slideHeadObj.render.style.position="absolute",this.options.adaptiveSlideHeaderOnScroll||($(this.slideHeadObj.render.firstChild).animate({width:"hide"}),this.slideHeadObj.hidden=!0)):n.scrollWidth==n.clientWidth&&(r.D.clearTimeout(this.id+"_adaptiveSlideHeader"),this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1)}}catch(t){s.w.printStackTrace(t)}},c.prototype.removeAdaptive=function(){try{var t;if("crosstab"==this.options.adaptive&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.options.adaptiveSlideHeader&&this.slideHeadObj&&(this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1),this.hasClass(t)){this.options.visibleRowNum=this.oldOptions.visibleRowNum,this.options.drawType=this.oldOptions.drawType;for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);if(this.removeClass(t),this.removeAdaptiveGridBodyHeight(),this.removeAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this._isBrowserScroll()){if(this._refreshDataChanged(),this._isHybridScroll())document.getElementById(this.id+"_scrollY_div").scrollTop=0}else if(""!=this.options.visibleRowNum){this.focusedCell=[],this.initializeDrawController(),this.dataRowList=[],this.drawedRowLength=0,this.lastDisplayedRow=-1;for(var i=this.getElementById(this.id+"_body_tbody");i.firstChild;)i.removeChild(i.firstChild);if(this.options.senseReader){for(e=0;e<this.adaptiveEmbeddedInputIdList.length;e++)delete this.dom[this.adaptiveEmbeddedInputIdList[e]];this.adaptiveEmbeddedInputIdList=[]}this.drawDataTable(0)}this.event.removeEvent(this.id+"_body_tbody","onscroll")}}catch(t){s.w.printStackTrace(t)}},c.prototype.doAdaptive=function(){try{if(""!=this.options.adaptive)return;this.options.adaptive="crosstab",
this.options.adaptiveThreshold="9999999",this.setAdaptive(),this.adaptiveDoneBy="doAdaptive"}catch(t){s.w.printStackTrace(t)}},c.prototype.undoAdaptive=function(){try{if("doAdaptive"!=this.adaptiveDoneBy)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="1",this.setAdaptive(),this.options.adaptive="",this.options.adaptiveThreshold="",this.adaptiveDoneBy=""}catch(t){s.w.printStackTrace(t)}},c.prototype.checkRefreshAdaptive=function(){try{var t=!1;if(!(r.D.isIE()&&parseInt(a.v.browserVersion(),10)<10)){var e=WebSquare.BootLoader.fullViewed||!1,i=r.D.fullViewed||!1;if(!e&&!i&&this.checkAdaptiveGridType()&&(""!=this.options.adaptive||0!=Object.keys(this.hideThresholdObj).length)){var o=this.options.adaptive,n=parseInt(this.options.adaptiveThreshold)||480;"crosstab"==o&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=n&&(t=!0)}}return t}catch(t){s.w.printStackTrace(t)}},c.prototype.refreshAdaptive=function(t){try{if(!0===this.checkRefreshAdaptive())if(t&&!0===t.simple){for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);for(var i in this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!1)}else this.removeAdaptive(),this.addAdaptive()}catch(t){s.w.printStackTrace(t)}},c.prototype._applyFormatter=function(t,e){try{var i=r.D.getGlobalFunction(t.options.customFormatter,this.scope_id),o=e,a=e;if("text"==t.options.inputType)(t.options.displayFormat||t.options.displayFormatter||t.options.ioFormat)&&(a=t.formatter.format(e));else if("select"==t.options.inputType)for(var n=t.itemArr.slice(0),l=0;l<=n.length-1;l++)if(n[l].value==e){a=n[l].label;break}return"function"==typeof(i=r.D.getGlobalFunction(t.options.customFormatter,this.scope_id))&&(o=i.call(t.mainGrid,o,a)),""!=o?o:this.filterEmptyStr}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getScrollYWidth=function(t){try{var e=0,i=document.getElementById(this.id+"_scrollY_div");if(!0!==this._isBrowserScroll()||this.options.autoFitFixYScroll)e="offsetWidth"===t?i.offsetWidth:this.options.autoFitFixYScroll?this.scrollLayerWidthSize:parseInt(i.style.width,10);else{var o=this.id+"_dataLayer",a=0;!0===this._isHybridScroll()&&(i.offsetWidth>this._getEpsilon()?(o=this.id+"_scrollY_div",a=1):o=this.id+"_main_div");var r=document.getElementById(o);e=r.offsetWidth-r.clientWidth+a}return e}catch(t){return s.w.printStackTrace(t,null,this),0}},c.prototype._autoFitRefreshNative=function(){try{if(!0===this._isNativeScroll())this._getScrollYWidth()!==this._bScrollYWidth&&this._setAutoFit()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._isBrowserScroll=function(){try{return"native"===this.options.drawType||"hybrid"===this.options.drawType}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._isNativeScroll=function(){try{return"native"===this.options.drawType}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._isHybridScroll=function(){try{return"hybrid"===this.options.drawType}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridRowNum=function(){try{return Math.abs(this.options.hybridRowNum)||1}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridVisibleHeightInfo=function(t){try{if(t<=0)return{height:0,cnt:0};var e=document.getElementById(this.id+"_body_tbody").childNodes;isNaN(t)&&(t=this._getHybridRowNum(),this.oneRowLength>1&&(t*=this.oneRowLength));for(var i=0,o=0,a=0,r=0;r<e.length&&t>0;r++){var n=e[r].offsetHeight,l=n>0;if(l&&(i+=n),!this.hasSubtotal||null==e[r].getAttribute("data-subtotal")){if(--t<=0||r>=e.length-1)for(var h=0;h<e[r].childNodes.length;h++){
var d=e[r].childNodes[h].clientHeight;if(d>0){o=n-d;break}}l||a++}}return{height:i,cnt:t+a,borderHeight:o}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setHybridVisibleHeight=function(t,e){try{null==t&&(t=this._hybridRowIndex);var i=this._getHybridLastIndex();null==e&&(e=this._getHybridVisibleHeightInfo());var o=e.height,a=this._hybridScrollHash[t];null==a&&(a=this._hybridScrollHeight),this._hybridScrollHash[t]=o;var r=this._hybridScrollDupHeight,n=0;t===i&&(this._hybridScrollDupHeight=this._getHybridDupHeight(),n=this._hybridScrollDupHeight-r);for(var l=0,h=!0,d=0,u=0;u<=i;u++){if(null==this._hybridScrollHash[u]){h=!1;break}d+=this._hybridScrollHash[u]}var p=document.getElementById(this.id+"_size_y"),c=this.getFooterHeight();if(!0!==this._hasHybridScroll()){var g=document.getElementById(this.id+"_body_table"),f=document.getElementById(this.id+"_main_div");l=Math.max(g.offsetHeight,f.offsetHeight-1)+c+this._getHybridScrollXHeight()-p.offsetHeight+1,this._hybridScrollLastTop=0}else if(!0===h){l=d+document.getElementById(this.id+"_head_table").offsetHeight-p.offsetHeight-this._hybridScrollDupHeight+c+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=d-this._hybridScrollHash[i]-this._getHybridLastSubtotalHeight()-e.borderHeight}else l=o-a-n;if(0!==l&&!0===this._useHybridScroll()){var m=p.offsetHeight+l;this._setHybridSizeY(m)}return l}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridVisibleTop=function(){try{var t=document.getElementById(this.id+"_scrollY_div"),e=1;return r.D.isIEAllVersion()||(e=document.getElementById(this.id+"_head_table").offsetHeight),t.scrollTop-e-this._hybridScrollYPos}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._adjustHybridEditedPosition=function(t,e){try{isNaN(e)&&(e=3);var i=document.getElementById(t),o=document.getElementById(this.id+"_head_table").offsetHeight;if(i.offsetTop<o)i.style.top=o+"px";else if(i.offsetTop+i.offsetHeight>this.render.offsetHeight){var a=document.getElementById(this.id+"_scrollX_div").offsetHeight;i.style.top=Math.max(this.render.offsetHeight-i.offsetHeight-a-e,o)+"px"}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridLastIndex=function(){try{var t=this.getDataLength(),e=0,i=t;return this.oneRowLength>1&&(i*=this.oneRowLength),i>this._getHybridTrCount()&&(e=Math.max(Math.ceil(t/this._getHybridRowNum())-1,0)),e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._hasHybridScroll=function(){try{if(document.getElementById(this.id+"_body_tbody").offsetHeight<this._getEpsilon())return!1;var t=this.getDataLength(),e=this._getHybridTrCount(),i=this._getHybridRowNum();return this.oneRowLength>1&&(i*=this.oneRowLength,t*=this.oneRowLength),e>i&&t>e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridTrCount=function(){try{var t=document.getElementById(this.id+"_body_tbody").childNodes,e=t.length;if(this.hasSubtotal)for(var i=0;i<t.length;i++)null!=t[i].getAttribute("data-subtotal")&&e--;return e}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridDupHeight=function(){try{if(!0!==this._hasHybridScroll())return 0;var t=this._getHybridRowNum(),e=this.getDataLength(),i=e-Math.floor(e/t)*t,o=0;if(i>0){var a=t-i;this.oneRowLength>1&&(a*=this.oneRowLength),o=this._getHybridVisibleHeightInfo(a).height}return o}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridLastSubtotalHeight=function(){try{var t=0;if(this.hasSubtotal)for(var e=this.lastSubtotalRow;null!=e&&null!=e.getAttribute("data-subtotal");e=e.previousSibling)t+=e.offsetHeight;return t}catch(t){return s.w.printStackTrace(t,null,this),0}},c.prototype._setHybridYPosition=function(t){try{if(isNaN(t))return;var e=r.D.isIEAllVersion(),i=e?"_body_table":"_body_tbody",o=document.getElementById(this.id+i);if(!o||!o.style)return;if("relative"!=o.style.position&&(o.style.position="relative;"),o.style.transform="translate3d(0,"+-t+"px,0)",e)for(var a=o.getElementsByTagName("th"),n=0;n<a.length;n++){var l=a[n]
;"relative"!=l.style.position&&(l.style.position="relative"),l.style.transform="translate3d(0,"+t+"px,0)";var h=parseInt(l.style.zIndex);(h<10||isNaN(h))&&(l.style.zIndex=10)}}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._getHybridWheelDeltaY=function(t){try{var e=t;this._hybridWheelCntY>0?this._hybridWheelCntY++:this._hybridWheelCntY=1;var i=this._hybridWheelCntY/10,o=Math.min(i,1),a=Math.max(i,1);a>1&&r.D.isMobile()&&(a=1+.1*a),a=Math.min(a,5),e=Math.round(e*(l=o,1-Math.pow(1-l,3))*a);var n=this.uuid;return r.D.setTimeout((function(){WebSquare.idCache[n]._hybridWheelCntY=0}),{key:this.id+"_getHybridWheelDeltaY",delay:100}),e}catch(e){return s.w.printStackTrace(e,null,this),t}var l},c.prototype._setHybridWheelDeltaY=function(t){try{var e=document.getElementById(this.id+"_scrollY_div"),i=e.scrollTop+this._getHybridWheelDeltaY(t);e.scrollTop=i}catch(e){return s.w.printStackTrace(e,null,this),t}},c.prototype._setHybridWheelDeltaX=function(t){try{var e=document.getElementById(this.id+"_scrollX_right"),i=e.scrollLeft+t;e.scrollLeft=i}catch(t){return s.w.printStackTrace(t,null,this),deltaY}},c.prototype._getHybridScrollXHeight=function(){try{var t=0,e=document.getElementById(this.id+"_scrollX_div");return null!=e&&(t=e.offsetHeight),t}catch(t){return s.w.printStackTrace(t,null,this),0}},c.prototype._drawDataHybrid=function(t,e){try{if(!0!==this._isHybridScroll())return this.drawData(t);void 0!==e&&null!=e||(e={});var i=this._getHybridRowNum(),o=this.getDataLength(),a=Math.floor(t/i),r=t-a*i;if(this._hybridRowIndex===a&&!0!==e.redraw)return!1;this._hybridRowIndex=a;var n=Math.min(a*i,o-i);n=Math.max(n,0),this.drawData(n),!0===e.redraw&&this.setScrollYHeightHybrid(),this._setHybridVisibleHeight();for(var l=0,h=0;h<a;h++){l+=null==this._hybridScrollHash[a]?this._hybridScrollHeight:this._hybridScrollHash[a]}if(r>0){this._getHybridVisibleHeightInfo(r);this.oneRowLength>1&&(r*=this.oneRowLength),l+=this._getHybridVisibleHeightInfo(r).height}e={scrollTop:l,maxRepeat:5,skipEndEdit:!0};return document.getElementById(this.id+"_scrollY_div").scrollTop=l,this.handleScrollYHybrid({},e),!0}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._useHybridScroll=function(){try{var t=document.getElementById(this.id+"_main_div"),e=document.getElementById(this.id+"_body_table"),i=this.getFooterHeight();return t.offsetHeight<e.offsetHeight+i}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setHybridSizeY=function(t,e){try{if(!0===this._useHybridScroll()){this.setOverflowYScroll();var i=document.getElementById(this.id+"_size_y");i.offsetHeight!==t&&(i.style.height=t+"px")}else this.setOverflowYHidden()}catch(t){s.w.printStackTrace(t,null,this)}},c.prototype._setHybridDataLayerTop=function(){try{var t=document.getElementById(this.id+"_dataLayer");0!==t.scrollTop&&(t.scrollTop=0)}catch(t){s.w.printStackTrace(t,null,this)}};var g=function(){};g.prototype.setTableLayout=function(){try{this.initializeHead(),this.initializeFooter(),this.setDataLayerPosition(),this.arrangeOverflowXScroll(),this.handlerResize_drawInitializer(),this.setTrRowTable(),this.setTrSubtotalRowTable(),this.initialColWidthList=this.colWidthList.slice(),this.initialGridWidth=this.gridWidth,this._setAutoFit(),this.realRowDataLength=this.oneRowDataLength+this.defaultColCnt,this.associateHeaderBody(),this.options.columnMove&&this.createBlockedHeaderInfo(),this.lastDisplayedRow=-1;for(var t=0;t<this.oneRowDataLength;t++){var e=this.cellInfoHash2[this.tdIdList[t]],i=new WebSquare.uiplugin.cellInfo(e,this);"textarea"==i.options.inputType&&(this.isExistTextarea=!0),i.options.colMerge&&(this.isColMerge=!0,r.D.getBoolean(this.options.colMergeAnd)&&(this.isColMergeAnd=!0),i.options.upperColumn&&(this.upperToLowerColumnRelation[i.options.upperColumn]||(this.upperToLowerColumnRelation[i.options.upperColumn]=[]),this.upperToLowerColumnRelation[i.options.upperColumn].push(i.options.id))),null!=i.options.maxLength&&""!==i.options.maxLength&&(i.options.maxlength=i.options.maxLength),
this.cellInfoHash[i.id]=i,this.cellIdList.push(i.id);var o=i.options.hideThreshold;void 0!==o&&(this.hideThresholdObj[i.id]=o)}this.drawFooter(),this.drawHeader();for(var a=0;a<this.thIdList.length;a++){var n=this.headerInfoHash2[this.thIdList[a]];if(n){var l=new WebSquare.uiplugin.headerInfo(n,this);this.headerInfoHash[l.id]=l,this.colMoveHeaderIndexMap[l.id]=a}}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setDataLayerPosition=function(){try{var t=this.getElementById(this.id+"_dataLayer");if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table").offsetHeight;e=0==e?this.footerHeight:e,t.style.bottom=e+"px"}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.arrangeOverflowXScroll=function(t){try{this.fixedWidth=0;for(var e=this.getFixedColumnLastIndex(),i=0;i<e;i++)this.hiddenList[i]||(this.fixedWidth+=this.colWidthList[i]);this.fixedWidth=parseInt(this.fixedWidth,10)||0,this.fixedWidthRight=0;var o=this.getFixedRightColumnLastIndex(),a=this.colWidthList.length;for(i=a-1;i>=o;i--)this.hiddenList[i]||(this.fixedWidthRight+=this.colWidthList[i]);if(this.fixedWidthRight=parseInt(this.fixedWidthRight,10)||0,e>this.defaultColCnt||o<a)for(var r=this.getColumnCount(),n=this.data_td_list.length/r,l=0;l<n+1;l++){if(e>this.defaultColCnt){var h=e-this.defaultColCnt;(u=this.data_td_list[l*r+(e-this.defaultColCnt)])&&this.addClass(u,"w2grid_fixedColumn");for(var d=0;d<h;d++){(g=this.data_td_list[l*r+d])&&this.addClass(g,"w2grid_fixedColumn_td")}}if(o<a){var u,p=o-this.defaultColCnt;(u=this.data_td_list[l*r+(o-this.defaultColCnt)])&&this.addClass(u,"w2grid_fixedRightColumn");for(var c=r-1;c>=p;c--){var g;(g=this.data_td_list[l*r+c])&&this.addClass(g,"w2grid_fixedRightColumn_td")}}}if(!0!==t){var f=this.getElementById(this.id+"_scrollX_div"),m=this.getElementById(this.id+"_scrollX_table"),y=0===f.offsetWidth?0:f.offsetWidth-m.offsetWidth,b=this.getElementById(this.id+"_scrollX_left"),w=this.getElementById(this.id+"_scroll_size"),v=this.getElementById(this.id+"_scrollX_fixedRight");b.style.width=this.fixedWidth+"px",w.style.width=this.gridWidth-this.fixedWidth-this.fixedWidthRight-y+"px",v.style.width=this.fixedWidthRight+"px"}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.handlerResize_drawInitializer=function(){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;if(this.setOverflowY(),this.setOverflowX(),this.setIE6Fix(),this.options.headFiller){var t=this.getElementById(this.id+"_header_bg_td"),e=this.getElementById(this.id+"_dataLayer").offsetWidth-1,i=this.getElementById(this.id+"_head_table").offsetHeight,o=e,a=i;for(t.style.width=e+"px";t.offsetWidth!=o;)t.offsetWidth>o?e--:e++,t.style.width=e+"px";for(t.style.height=i+"px";t.offsetHeight!=a;)t.offsetHeight>a?i--:i++,t.style.height=i+"px"}if(this.options.groupbyZone){var r=this.getElementById(this.id+"_main_div"),n=this.groupbyZoneStatus.groupbyZoneRender?this.groupbyZoneStatus.groupbyZoneRender.offsetHeight:0;if(this.isIE6or7&&(r.style.height=r.offsetHeight-n),this.options.groupbyFilterBox){var l=this.getElementById(this.id+"_groupbyFilterBox_div"),h=this.getElementById(this.id+"_groupbyFilterBox_buttons");if(this.isIE6or7){r.style.height=r.offsetHeight-(this.scrollLayerWidthSize+l.offsetHeight)-3+"px",h.style.left=-h.offsetWidth;var d=this.scrollLayerWidthSize+l.offsetHeight+n,u=Math.ceil(d/this.oneRowScrollHeight),p=this.getElementById(this.id+"_scrollY_div");this.lastIndex>-1&&this.lastIndex>u&&p.offsetHeight<p.scrollHeight&&this.cutGridBottom(this.lastIndex-u)}else"bottom"===this.options.groupbyFilterBoxLocation&&(r.style.bottom=this.scrollLayerWidthSize+l.offsetHeight+"px",r.style.height="")}else this.isIE6or7&&this.cutGridBottom(this.lastIndex-Math.ceil(n/this.oneRowScrollHeight))}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setIE6Fix=function(){try{var t=this.options.fixPrint&&(r.D.isIE(9)||r.D.isIE(10)||a.v.browserCheck.ieAllVersion&&"11"==document.documentMode||r.D.isFF());if(this.isIE6or7||r.D.isOpera()||t){
var e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_main_div"),n=this.render.offsetHeight-e.offsetHeight,l=this.render.offsetWidth-i.offsetWidth+2;n=n<0?0:n,l=l<0?0:l,o.style.height=n+"px",o.style.width=l+"px";var h,d=0;if(this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d),""!==this.options.visibleRowNum){var u=this.getElementById(this.id+"_body_table");h=!this.defaultDataLayerHeight||u.offsetHeight>this.defaultDataLayerHeight?u.offsetHeight+d:this.defaultDataLayerHeight+d}else h=n-d-1;h=h<0?0:h;var p=this.getElementById(this.id+"_dataLayer");p.style.height=h+"px",this.dataLayerHeight=h;var c=this.getElementById(this.id+"_scrollX_right");c.style.width=c.parentNode.offsetWidth+"px",t&&(o.style.position="relative",o.style.bottom="",o.style.right="",p.style.position="relative",p.style.bottom="")}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype._setOverflowXNative=function(t){if(!0===this._isBrowserScroll()){var e=document.getElementById(this.id+"_scrollX_div"),i=document.getElementById(this.id+"_dataLayer");if(!1===t||this.options.fixedColumn<=0&&this.options.fixedRightColumn<=0)return e.style.visibility="hidden",void(i.style.overflowX="auto");!0===t&&(e.style.visibility="visible",i.style.overflowX="hidden")}},g.prototype.setOverflowX=function(t){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowX=t):e=!1,t=this.isMobile&&!0!==this._isBrowserScroll()?"hidden":this.options.overflowX){case"auto":this.setOverflowXAuto();break;case"hidden":this.setOverflowXHidden();break;default:this.setOverflowXScroll()}this.isMobile&&this.setIScrollX(),e&&this.setIE6Fix()},g.prototype.setOverflowXAuto=function(){var t=this.getElementById(this.id+"_scrollX_div"),e=this.getElementById(this.id+"_scrollX_left"),i=this.getElementById(this.id+"_scrollX_right"),o=e.offsetWidth;if(this.options.fixedRightColumn){var s=this.getElementById(this.id+"_scrollX_fixedRight");s&&(o+=s.offsetWidth)}i.firstChild.offsetWidth>t.offsetWidth-o?this.setOverflowXScroll():this.setOverflowXHidden()},g.prototype.setOverflowXScroll=function(){try{var t=(l=this.getElementById(this.id+"_scrollX_div")).style.height;if(l.style.height=this.scrollLayerWidthSize+"px",this.options.scrollFocus){var e=this.getElementById(this.id+"_scrollX_right"),i=this.getElementById(this.id+"_scrollX_left");e.setAttribute("aria-hidden","true"),e.firstChild.offsetWidth>l.offsetWidth-i.offsetWidth?e.setAttribute("tabIndex","0"):e.setAttribute("tabIndex","-1")}var o=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"===t&&!o&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var a=parseInt(this.render.style.height,10);this.setSize(null,a+this.scrollWidthSize)}else{this.dataLayerHeight-=this.scrollWidthSize;var r=this.dataRowList[(this.lastIndex+1)*this.oneRowLength-1];r&&r.offsetTop+r.offsetHeight>this.dataLayerHeight&&(this._setRowDisplay(this.lastIndex,"none"),this.lastIndex=this.lastIndex-1,this.maxRowLength=this.maxRowLength-1,this.lastDisplayedRow=this.lastIndex,this.lastTopRowIndex=null,this.setScrollYHeight({noDraw:!0}),this.setOverflowYAuto())}if(!this.isIE6or7){var n=this.getElementById(this.id+"_main_div"),l=this.getElementById(this.id+"_scrollX_div"),h=parseInt(l.style.height,10);if(n.style.bottom=h+"px",this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation){var d=this.getElementById(this.id+"_groupbyFilterBox_div");n.style.bottom=this.scrollLayerWidthSize+d.offsetHeight+"px"}}if(o)(d=this.getElementById(this.id+"_groupbyFilterBox_div")).style.bottom=this.scrollLayerWidthSize+"px"}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setOverflowXHidden=function(){try{var t=this.getElementById(this.id+"_scrollX_div"),e=t.style.height;if(t.style.height="0px",
this.options.scrollFocus){var i=this.getElementById(this.id+"_scrollX_right"),o=this.getElementById(this.id+"_scrollX_left");i.setAttribute("aria-hidden","true"),i.firstChild.offsetWidth>t.offsetWidth-o.offsetWidth?i.setAttribute("tabIndex","0"):i.setAttribute("tabIndex","-1")}"0px"!=e&&this.handleScrollX();var a=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"!==e&&!a&&!0!==this._isBrowserScroll())if(""!==this.options.visibleRowNum){var r=parseInt(this.render.style.height,10);this.setSize(null,r-this.scrollWidthSize)}else{this.dataLayerHeight+=this.scrollWidthSize,this.maxRowLength=this.maxRowLength+1;var n=this.getDataLength();this.maxRowLength>=n&&(this.getElementById(this.id+"_size_y").style.height="0px"),this.setOverflowYAuto(),this.drawData(this.rowIndex,this.lastIndex);for(var l=0;l<this.tdIdList.length;l++){var h=this.cellInfoHash[this.tdIdList[l]];if(h.dataComp){var d=this.modelControl.getDataComp(h.dataComp);"linkedDataList"===d.initializeType&&d.syncWithParent()}}this.lastTopRowIndex=null}var u=this.getElementById(this.id+"_main_div");if(this.isIE6||(u.style.bottom="0px"),a)this.getElementById(this.id+"_groupbyFilterBox_div").style.bottom="0px"}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setOverflowY=function(t){if(!0!==this._isBrowserScroll()){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowY=t):e=!1,t=this.isMobile?"hidden":this.options.overflowY){case"auto":this.setOverflowYAuto();break;case"hidden":this.setOverflowYHidden();break;default:this.setOverflowYScroll()}this.isMobile&&this.setIScrollY(),e&&this.setIE6Fix()}},g.prototype.setOverflowYAuto=function(){if(!0!==this._isBrowserScroll()){var t=this.getElementById(this.id+"_scrollY_div");t.offsetHeight<t.scrollHeight?this.setOverflowYScroll():this.setOverflowYHidden()}},g.prototype.setOverflowYScroll=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_main_div"),o=parseInt(t.style.width,10);if(t.style.width=this.scrollLayerWidthSize+"px",t.style.overflowY="scroll",this.isIE6){var s=this.render.offsetWidth-this.scrollWidthSize;e.style.width=(s>0?s:0)+"px",t.style.height=this.render.offsetHeight+"px"}else i.style.right=this.scrollWidthSize-1+"px",e.style.right=this.scrollWidthSize+"px";this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);0==o&&!0!==this._setOverflowYScrollFlag&&(this._setOverflowYScrollFlag=!0,this._setAutoFit(),this._setOverflowYScrollFlag=!1),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1"))},g.prototype.setOverflowYHidden=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=parseInt(t.style.width,10);t.style.width="0px",t.style.overflowY="hidden";var i=this.getElementById(this.id+"_main_div");this.isIE6||(i.style.right="0px",this.getElementById(this.id+"_scrollX_div").style.right="0px");this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);if(0!=e&&!0!==this._setOverflowYHiddenFlag&&(this._setOverflowYHiddenFlag=!0,this._setAutoFit(),this._setOverflowYHiddenFlag=!1),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1")),!0===this._isHybridScroll()){var o=document.getElementById(this.id+"_size_y"),s=t.offsetHeight;o.offsetHeight!==s&&(o.style.height=s+"px")}},g.prototype.setTrRowTable=function(){try{this.tempDiv=document.createElement("div"),this.tempDiv.style.width="0px",this.tempDiv.style.height="0px",this.tempDiv.style.overflow="hidden",
this.tempDiv.innerHTML="<table id='tempTable' style='table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.htmlInfo.body,"tbody","td",this.options.bodyTdClass)+"</table>",this.tempTr=this.tempDiv.getElementsByTagName("table")[0];var t=this.tempTr.getElementsByTagName("td");this.aria_labelledby=[];for(var e=0;e<t.length;e++)this.aria_labelledby[e]=t[e].getAttribute("aria-labelledby"),t[e].innerHTML="";this.tempDiv.id=this.id,this.tempDiv.className=this.options.className+" w2grid",this.render.parentNode.appendChild(this.tempDiv);var i,o=this.tempDiv.getElementsByTagName("tbody")[0],a=o.getElementsByTagName("tr")[0];0==(i=a?a.offsetHeight:o.offsetHeight)?(i=-1!=this.options.defaultCellHeight?this.options.defaultCellHeight:20,this._visibleRowNumFixResetFlag=!0):this._visibleRowNumFixResetFlag=!1,this.oneRowHeight=i+(r.D.isIE(6)||r.D.isIE(7)?1:0),this.options.scrollRowHeight&&(this.oneRowScrollHeight=this.oneRowHeight),this.render.parentNode.removeChild(this.tempDiv)}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setTrSubtotalRowTable=function(){try{for(var t in this.subtotalTableList={},this.subtotalStrList){var e=document.createElement("div");e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",this.subtotalClassList&&this.subtotalStrList[t].attr?e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.subtotalStrList[t].attr.subtotalClass)+"</table>":e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.options.subtotalTdClass)+"</table>";for(var i=e.getElementsByTagName("table")[0],o=i.getElementsByTagName("td"),a=r.D.getDataPrefix("or_wd"),n=r.D.getDataPrefix("width"),l=!0===this._isHybridScroll(),h=0;h<o.length;h++){var d=o[h],u=d.getAttribute(n);u&&(d.removeAttribute(n),d.setAttribute(a,u)),l&&this.defaultColCnt}this.subtotalTableList[t]=i}}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype._setAutoFit=function(t){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;this.autofitDone=!0;var e=(t=t||{}).type?t.type:this.options.autoFit;"none"!==e&&e||(e="clear");var i=t.exceptCol,o=t.exceptWidth||0,a=this._getScrollYWidth();!0===this._isNativeScroll()&&(this._bScrollYWidth=a);var n=this.render.clientWidth;r.D.isIEAllVersion()&&(n=this.render.clientWidth||parseInt(this.render.style.width,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"width"),10)),this.autofit_clientWidth=n;for(var l=0,h=this.colWidthList.length-1;h>=0;h--)if(0==this.hiddenList[h]){l=h;break}if("selectedColumn"==e&&!this.autofitColumn){if(this.gridWidth>=n)return;this.autofitColumn=!0;var d=this.defaultColCnt+t.colIndex;this.gridWidth-=this.colWidthList[d],this.autofitColumnIndexArr.push(d),this.colWidthList[d]="*",this.autofitColumnWidthArr[d]="*"}if(this.autofitColumn){var u=n,p=this.autofitColumnIndexArr.slice();a>0&&(u-=a);for(h=p.length-1;h>=0;h--){var c=p[h];1!=this.hiddenList[c]&&c!==i||p.splice(h,1)}var g=0,f=[];for(h=0;h<this.colWidthList.length;h++)if(1!=this.hiddenList[h])if(h===i)this._setColumnWidth(h,o),u-=o;else if(h<this.autofitColumnWidthArr.length&&this.autofitColumnWidthArr[h]){var m=this.autofitColumnWidthArr[h].substring(0,this.autofitColumnWidthArr[h].indexOf("*"));m.length>0?f.push(parseInt(m,10)):0==m.length&&f.push(1)}else u-=this.colWidthList[h];var y=function(t){if(!t.length)return 0;for(var e,i=t.length-1,o=t[i];i;)for(var s=t[--i];e=s%o;s=o,o=e);return o}(f);for(h=0;h<f.length;h++)f[h]=f[h]/y,g+=f[h];var b=Math.floor(u/g),w=u-b*g;for(h=0;h<p.length;h++){var v=this.options.autoFitMinWidth||0,C=b*f[h];f[h]=Math.max(C,v)}if(w>0)if(1==p.length)f=[u];else{var I=f.slice();for(h=w;h>0;h--){for(var _={},x=0;x<f.length;x++)if(1!=this.hiddenList[p[x]]){
var S=Math.abs((I[x]-(f[x]+1))*(this.gridWidth/I[x]));(null==_.distortion||_.distortion>S)&&(_.distortion=S,_.index=x)}f[_.index]++}}for(var D=0;D<f.length;D++)this._setColumnWidth(p[D],f[D])}if("lastColumn"==e){this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth,this.orgLastWidth=this.colWidthList[l],this.orgLastVisibleCol=l),"number"==typeof i&&i!=l&&(this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o));var R=n-a-this.gridWidth+this.colWidthList[l];R>this.orgLastWidth?this._setColumnWidth(l,R):this._setColumnWidth(l,this.orgLastWidth)}else if("allColumn"==e){if(!this.autofitColumn){var L=this.autoFitColWidthList||this.colWidthList,T=n-a,k={};if(this.options.keepDefaultColumnWidth)for(h=0;h<this.defaultColCnt;h++)k[h]=!0;for(h=this.defaultColCnt;h<L.length;h++)!1===this.isColumnResizable(h)&&(this.hiddenList[h]||(k[h]=!0));v=parseInt(t.minWidth?t.minWidth:this.options.autoFitMinWidth,10);for(var F in!isNaN(v)&&v>T&&(T=v),T-=o,k)T-=this.colWidthList[F];var A=0;for(h=0;h<L.length;h++)A+=this.hiddenList[h]||h===i||k[h]?0:L[h];var E=0,M=A?T/A:0,O=[];if(M){for(h=0;h<L.length;h++)if(h==i)this.colWidthList[h]=o;else if(k[h]);else{O[h]=M*L[h];var N=Math.round(O[h]);this.colWidthList[h]=N,E+=this.hiddenList[h]?0:N}var B=T-E,H=B>0?1:-1;for(h=0;h<B*H;h++){var G={};for(x=0;x<L.length;x++)if(!this.hiddenList[x]&&x!=i&&!k[x]){S=Math.abs(O[x]-(this.colWidthList[x]+H))*(E/this.colWidthList[x]);(null==G.value||G.value>S)&&(G.value=S,G.index=x)}this.colWidthList[G.index]+=H,E+=H}if(this.hiddenList[0]&&r.D.isIE(8))for(h=0;h<this.colWidthList.length;h++)if(!this.hiddenList[h]){this.colWidthList[h]=this.colWidthList[h]-2;break}}for(var F in this.autoFitColWidthList||(this.autoFitColWidthList=this.colWidthList.slice(0)),this.gridWidth=E+o,k)this.gridWidth+=this.colWidthList[F];this.arrangeOverflowXScroll();var W="";this.options.autoFitMinWidth||(W="hidden"),this.setOverflowX(W),this.scrollXPreventEndEdit=!0,this.handleScrollX(),this.scrollXPreventEndEdit=!1,this.handlerResize_drawInitializer()}if(!this.groupbyStatus.grouped)for(h=0;h<this.oneRowDataLength;h++){var V=this.getCellInfo(h);"text"!=V.options.inputType&&"secret"!=V.options.inputType&&"calendar"!=V.options.inputType||!V.options.embeddedInput||!this.options.autoResizeEmbeddedInput&&"calendar"!=V.options.inputType||this.hiddenList[h]||(this.embeddedWidthObj[h]&&(this.embeddedWidthObj[h].isChanged=!0),this.drawColumnData(h))}}else"clear"==e&&"number"==typeof i&&(this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth),this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o))}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setAutoFit=function(t){try{t&&(this.options.autoFit=t.type),this._setAutoFit(t)}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.clearAutoFit=function(t){try{this.options.autoFit="",-1===this.initialColWidthList.indexOf("*")&&(this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autoFitColWidthList=null,this.gridWidth=this.initialGridWidth,this.colWidthList=this.initialColWidthList.slice(),this.arrangeOverflowXScroll(),this.setOverflowX("auto"),this.handleScrollX())}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.autoFitFunc=function(){this.autofit_clientWidth===this.render.clientWidth?a.v.clearTimer(this.id+"_autofit"):a.v.setTimer(this._setAutoFit,{key:this.id+"_autofit",caller:this,delay:100})},g.prototype.setIScrollX=function(){try{if(!0===this._isBrowserScroll())return;var t=this.getElementById(this.id+"_iScrollX");if(!t)return;var e=this.getElementById(this.id+"_scrollX_right");if(e.offsetWidth>=e.firstChild.offsetWidth)return void(t.style.visibility="hidden");var i=this.getElementById(this.id+"_dataLayer"),o=parseInt(this.getElementById(this.id+"_scrollX_left").style.width,10),a=e.firstChild.offsetWidth-e.offsetWidth,r=parseInt(e.offsetWidth*e.offsetWidth/e.firstChild.offsetWidth,10);t.style.width=(r<30?30:r)+"px",
t.style.left=o+e.scrollLeft/a*(i.offsetWidth-o-t.offsetWidth)+"px",t.style.visibility=""}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.setIScrollY=function(){try{if(!0===this._isBrowserScroll())return;var t=this.getElementById(this.id+"_iScrollY");if(!t)return;var e=this.getDataLength(),i=this.rowIndex,o=this.getElementById(this.id+"_size_y").parentNode.offsetHeight;if(0==o&&(o=parseInt(this.getStyleValue("height"))),-1==i||0==i&&i+this.lastIndex+1==e){var a=!this.hasSubtotal;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var r=this.drawedSubtotal[this.drawedSubtotal.length-1];if(r.rowIndex==e-1)"none"!=r[r.length-1].style.display&&(a=!0)}if(a)return void(t.style.visibility="hidden")}var n=this.getElementById(this.id+"_scrollY_div"),l=n.firstChild.offsetHeight,h=this.getElementById(this.id+"_dataLayer"),d=l-h.offsetHeight,u=parseInt(h.offsetHeight*h.offsetHeight/l,10);t.style.height=(u<30?30:u)+"px",t.style.top=n.scrollTop/d*(h.offsetHeight-t.offsetHeight)+"px",t.style.visibility=""}catch(t){s.w.printStackTrace(t,null,this)}},g.prototype.createBlockedHeaderInfo=function(){try{this.columnBlock={info:{},hash:{}};for(var t=[],e=this.getColCnt(),i=0;i<e;i++)t.push(1);for(var o in this.struct){var a;if("subtotalArr"===o)a=this.struct[o][0].rowArr;else{if(!this.struct[o]||!this.struct[o].rowArr)continue;a=this.struct[o].rowArr}for(var r=0;r<a.length;r++)for(var n=0,l=0;l<a[r].length;l++){var h=parseInt(a[r][l].colSpan,10)||1;for(i=1;i<h;i++)t[n+i]=0;n+=h}}var d=0;for(i=0;i<t.length;i++){var u=t[i];1===u?(this.columnBlock.info[i]=[i],this.columnBlock.hash[i]=i,d=i):0===u&&(this.columnBlock.info[d].push(i),this.columnBlock.hash[i]=d)}}catch(t){s.w.printStackTrace(t,null,this)}};var f=function(){};f.prototype.initializeEvent=function(){try{if(this.otherClickEvent(),this.checkResize(),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblClickEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),r.D.isIEAllVersion()){if(r.D.isIEAllVersion()){if(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||u.B.preventDefault(t)}))),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||u.B.preventDefault(t)}))),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,(function(t){this.options.preventPaste&&!this.editedCell&&"native"!==this.options.copyType&&u.B.preventDefault(t)}))),!0===this.options.noSelect)document.getElementById(this.id+"_main_div").onselectstart=function(t){if(r.D.isIEAllVersion()&&t&&t.srcElement){var e=t.srcElement;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!0}return!1};else!0===this.options.preventCopy&&(this.render.onselectstart=function(){return!1})}}else a.v.browserCheck.safari?(this.event.addListener(WebSquare.getBody().render,"onbeforecopy",this.event.bindAsEventListener(this,this.handleBeforeCopyEvent)),this.event.addListener(WebSquare.getBody().render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(WebSquare.getBody().render,"onbeforecut",this.event.bindAsEventListener(this,this.handleBeforeCutEvent)),this.event.addListener(WebSquare.getBody().render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent))):a.v.browserCheck.chrome||(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent)))
;this.isMobile||(this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollX_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)),this.options.useMoreButton&&this.event.addListener(this.getElementById(this.id+"_grid_more_button"),"onclick",this.event.bindAsEventListener(this,(function(t){WebSquare.event.fireEvent(this,"onscrollend")}))),this.hasFooter&&this.event.addListener(this.getElementById(this.id+"_foot_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)));var t=this.isHammerEnabled();if(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"oncontextmenu",this.event.bindAsEventListener(this,this.clickRightButtonCell)),t||(this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.gridOut)),this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseout",this.event.bindAsEventListener(this,this.gridHeaderOut))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeyDownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyUpEvent)),r.D.isOpera()&&this.event.addListener(this.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||u.B.preventDefault(t)})),this.options.dataDragDrop||this.options.dataDragDropSelf)if(1==this.isMobile){if(t){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0;else this.options.dataDragDrop||this.options.dataDragDropSelf||!this.options.dataDragSelect||this.isMobile||this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.handleDragSelectEvent));if(a.v.setTimer((function(){this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(t){var e=WebSquare.getBody().getLayerListener();if(e.layers[this.id]){for(var i=e.layers[this.id].component,o={};i.parentControl;)for(var s in i=i.parentControl,e.useOtherComponentId)e.useOtherComponentId[s]==i.id&&(o[s]=!0);WebSquare.getBody().getLayerListener().hideAll(o)}this.parentControl&&this.parentControl.options&&("gridItemTable"==this.parentControl.options.pluginName||"gridViewItemTable"==this.parentControl.options.pluginName)||u.B.stopPropagation(t)})))}),{key:this.id+"initializeEvent",caller:this,delay:100}),!0===this._isBrowserScroll()||(r.D.isTouchDevice()&&!window.navigator.msPointerEnabled?(this.iScroll={},this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"ontouchend",this.event.bindAsEventListener(this,this.handleTouchEnd))):window.navigator.msPointerEnabled&&-1!=window.navigator.userAgent.toLowerCase().indexOf("touch")?(this.iScroll={},this.render.style.touchAction="none",this.event.addListener(this.render,"onMSPointerDown",this.event.bindAsEventListener(this,this.handleTouchStart)),
this.event.addListener(this.render,"onMSPointerMove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"onMSPointerUp",this.event.bindAsEventListener(this,this.handleTouchEnd))):this.options.senseReader?(this.options.useStartEndDiv&&(this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onfocus",this.event.bindAsEventListener(this,this.handleStartDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleStartDivKeyDown)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onfocus",this.event.bindAsEventListener(this,this.handleEndDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeyup",this.event.bindAsEventListener(this,this.handleEndDivKeyUp))),this.options.scrollFocus?this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)):this.options.useStartEndDiv&&this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleEndDivKeyDown))):this.options.scrollFocus&&this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown))),t&&!this._bindPressEvent)try{e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.render),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){if(!o._bindPressEvent){for(var e,i=u.B.getTarget(t),s=-1;i&&"BODY"!=i.tagName;){if("TD"==i.tagName&&o.hasClass(i,o.options.bodyTdClass)){s=o.getElemRowIndex(i),e=i;break}i=i.parentNode}o.removeFocusedCell(),o._dataList.setRowPosition(s),e&&o.__setFocusedCell({},e,{editMode:"none"}),o.handleDblClickEvent(t),u.B.fireEvent(o,"ondblclick",t)}})))}))}catch(t){s.w.printStackTrace(t,null,this)}if(this._isNativeScroll()||!0===this.options.scrollXNative){var o=document.getElementById(this.id+"_dataLayer");i=this.uuid;o&&(o.onscroll=function(t){var e=WebSquare.idCache[i];e._endEdit();var o=document.getElementById(e.id+"_dataLayer"),s=o.scrollTop,a=o.offsetHeight,r=o.scrollLeft;e._nativeScrollInfo||(e._nativeScrollInfo={x:0,y:0});var n=r-e._nativeScrollInfo.x,l=s-e._nativeScrollInfo.y;if(Math.abs(l)>0&&!0===e._isNativeScroll()){if(WebSquare.util.isIEAllVersion())for(var h=document.getElementById(e.id+"_head_table").getElementsByTagName("th"),d=s+"px",p=0;p<h.length;p++){var c=h[p];"relative"!=c.style.position&&(c.style.position="relative"),c.style.top=d}a+s>=o.scrollHeight&&u.B.fireEvent(e,"onscrollend"),u.B.fireEvent(e,"onscrolly",t)}Math.abs(n)>0&&!0===e.options.scrollXNative&&u.B.fireEvent(e,"onscrollx",t),e._nativeScrollInfo={x:r,y:s}})}this.initializeLayoutEvents(),n.s.addCheckResize(this.uuid,"checkResize")}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleStartDivFocus=function(t){try{if(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[],"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()){var e=this.getElementById(this.id+"_scrollY_div"),i=this.getElementById(this.id+"_size_y");i&&i.offsetHeight>0&&(this.addGridScroll(0-this.rowIndex),0!=e.scrollTop&&this.addGridScroll(0-this.rowIndex)),this._dataList.setRowPosition(-1)}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleEndDivFocus=function(t){this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[]},f.prototype.handleScrollDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){for(var e=this.getRowCount()-1,i=this.getRightMostFocusableColIndex(e);e>=0&&null==i;)e-=1,i=this.getRightMostFocusableColIndex(e);if(null!==i){var o=this.getCellInfo(i)
;if("radio"===o.options.inputType){var s=0,a=this.getCheckedIndex(o.colID)[0];a>0&&(s=a),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),u.B.stopEvent(t)}}}else switch(t.keyCode){case 38:case 40:case 9:u.B.stopPropagation(t)}},f.prototype.handleStartDivKeyDown=function(t){t.shiftKey||9!=t.keyCode||this._lastHeaderElementId||this._setFirsCellFocus(t)},f.prototype.handleEndDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){if("none"===this.options.focusMode)return;var e=this.getElementById(this.id+"_main_div").offsetHeight,i=parseInt(this.getElementById(this.id+"_size_y").style.height,10)-e,o=this.getElementById(this.id+"_scrollY_div").scrollTop,s=this._getEpsilon();if(o<i&&(o=Math.min(Math.round(o)+s,i)),i!=o){for(var a=0,r=0;r<this.getRowCount();r++)a+=this.getHasSubtotalCount(r);this.addGridScroll(this.getRowCount()-this.rowIndex-this.lastIndex-1+a)}for(var n=this.getRowCount()-1,l=this.getRightMostFocusableColIndex(n,{shiftTab:!0});n>=0&&null==l;)n-=1,l=this.getRightMostFocusableColIndex(n);null!=l&&(this._setFocusedCell(n,l,!1,{tabDirection:"left"}),u.B.stopEvent(t))}},f.prototype.handleEndDivKeyUp=function(t){38==t.keyCode&&"all"!=this.options.visibleRowNum&&(this.getElementById(this.id+"_scrollY_div").scrollTop=0)},f.prototype.handleTdFocus=function(t){var e,i=u.B.getTarget(t),o=this.getLastFocusedCell(),s=r.D.getDataPrefix("tdIndex"),a=r.D.getDataPrefix("col_id");if("TD"==i.tagName&&o.focusedTd!=i&&!this.focusedByApi){var n,l,h,d,p,c,g=parseInt(i.getAttribute(s)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=i.getAttribute(a);if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&(e=null!=this.editedCell)){var y=this.getCellInfo(this.editedCell.colID);n=y.editRowIndex,l=this._dataList.getColumnIndex(y.id),h=this.getColumnIndex(y.id),d=this.getRealRowIndex(n),p=this._dataList.dataArr[d*this._dataList.getColumnCount()+l],c=y.comp&&y.comp.selectedIndex}if(this._setFocusedCell(f,m),e){var b=this._dataList.dataArr[d*this._dataList.getColumnCount()+l];if(0===p&&(p="0"),0===b&&(b="0"),p!=b){var w={oldValue:p,newValue:b,rowIndex:n,colIndex:h,colId:this.getColumnID(h)};isNaN(c)||(w.oldSelectedIndex=c,w.newSelectedIndex=y&&y.comp&&y.comp.selectedIndex),u.B.fireEvent(this,"onviewchange",w)}}}this.focusedByApi=!1},f.prototype.handleDragSelectEvent=function(t){if(!this._bindDrag)for(var e=this.body_table.offsetHeight,i=this.event.getTargetIterator(t);i.next();)if(i.match(this.options.bodyTdClass,null,"td")){var o=this,s=i.getElement();return void WebSquare.dragdrop.gDragManager.activate(t,this.render,{id:this.id+"_dragSelect",delay:15,handleStart:function(t){r.D.isIEAllVersion()&&(r.D.emptySelection(),u.B.preventDefault(t));var e,i,a,n,l,h,d=null!=o.editedCell;if(d&&(e=o.editedCell.editRowIndex,i=o._dataList.getColumnIndex(o.editedCell.id),a=o.getColumnIndex(o.editedCell.id),n=o._grid.getRealRowIndex(e),l=o._dataList.dataArr[n*o._dataList.getColumnCount()+i]),o.__setFocusedCell(t,s,{editMode:!1}),d&&l!=(h=o._dataList.dataArr[n*o._dataList.getColumnCount()+i])){var p={oldValue:l,newValue:h,rowIndex:e,colIndex:a,colId:o.getColumnID(a)};u.B.fireEvent(o,"onviewchange",p)}},handleUpdate:function(t,i,s,a,r){for(var n=null,l=null,h=o.event.getTargetIterator(r);h.next();){if(h.match("w2grid")){n=h.getElement().id;break}h.match(o.options.bodyTdClass,null,"td")&&(l=h.getElement())}var d=o.focusedCell[0];o.options.dataDragSelectAutoScroll&&d.focusedColIndex>-1&&o.dragSelectAutoScroll(u.B.getMouseY(r),e,u.B.getMouseX(r)),null!=n&&null!=l&&o.id==n&&d.focusedColIndex>-1&&(l.className.indexOf("_rowNum")>=0||l.className.indexOf("_rowStatus")>=0||o.__setFocusedCell({shiftKey:!0},l,{editMode:!1}))},handleFinish:function(){o.dragSelectAutoScrollFinish()}})}},f.prototype.handleDragEvent=function(t){
if((!this.options.rowResize||!this.rowResizeStarted)&&(!this.isDrillDown||this.drillDownDragDrop)&&!this.editedCell&&(0!=this.options.dataDragDrop||0!=this.options.dataDragDropSelf))for(var e=r.D.getDataPrefix("tdIndex"),i=r.D.getDataPrefix("col_id"),o=r.D.getDataPrefix("colindex"),s=r.D.getDataPrefix("index"),n=this.event.getTargetIterator(t);n.next();)if(n.match(null,null,"td")){var l=n.getElement(),h=[],d=l.getAttribute(e);if(null==d)return;var p=this.rowIndex+parseInt(parseInt(d)/(this.oneRowDataLength+this.defaultColCnt));""==this.options.dragDisplayColumn?h.push(l.getAttribute(i)):h=this.options.dragDisplayColumn.split(",");for(var c=[],g=0;g<h.length;g++){var f;f=null==h[g]||null==h[g]?(p+1).toString():this._getCellDisplayData(p,h[g].wq_trim()),c.push(f)}if(c=c.join(","),this.isMobile){for(var m=u.B.getTarget(t);m&&"TD"!=m.tagName&&"TH"!=m.tagName&&"DIV"!=m.tagName;)m=m.parentNode;this.__setFocusedCell(t,m)}var y=this,b={id:this.id+"_drag",component:y,className:"w2grid_drag",contents:c,delay:15,applyMousePosition:!0,showNoData:!0,handleStart:function(t){u.B.fireEvent(y,"ondatadragstart",p)},handleUpdate:function(t,e,i,o,s){var a=null;for(a=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(s.changedTouches[0].clientX,s.changedTouches[0].clientY)):y.event.getTargetIterator(s);a.next();)if(a.match(null,null,"td"))var r=a.getElement();var n=y.getElementById(y.id+"_resize_line");if(r&&!y.options.dataDragDropOther&&y.options.useDataDragDropGuideLine){var l=r.offsetHeight+r.offsetTop+"px";n.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",n.style.display="block",n.style.zIndex=999,n.style.top=l,n.style.width=y.render.offsetWidth+"px",n.style.left=0,n.style.border="1px solid #3a3f44"}},handleFinish:function(){y.getElementById(y.id+"_resize_line").style.display="none"},onDragover:function(t,e,i,o,s,a,n){if(t&&e){var l=null;for(l=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(n.changedTouches[0].clientX,n.changedTouches[0].clientY)):y.event.getTargetIterator(n);l.next();)if(l.match("w2grid")||l.match("w2grid_tooltip")){if(l.match("w2grid_tooltip"))l.getElement().style.display="none",l=new WebSquare.targetIterator(document.elementFromPoint(u.B.getClientX(n),u.B.getClientY(n)));var h=r.D.getComponentById(l.getElement().id);y.id!=h.id&&u.B.fireEvent(h,"ondatadragover",y.id,p),l.stop()}}},onDrop:function(t,n,l,h,d,c,g){var f,m=null,b=null,w=null,v=null,C={},I=null,_=null;for(v=y.isMobile?new WebSquare.targetIterator(document.elementFromPoint(g.changedTouches[0].clientX,g.changedTouches[0].clientY)):y.event.getTargetIterator(g);v.next();){if(v.match(null,null,"body"))return;if(v.match("w2grid")){m=v.getElement().id;break}if(v.match("w2grid_tooltip"))v.getElement().style.display="none",v=new WebSquare.targetIterator(document.elementFromPoint(u.B.getClientX(g),u.B.getClientY(g)));if(null==w&&v.match(null,null,"td")){var x=v.getElement();w=parseInt(x.getAttribute(e),10),"number"!=typeof(f=parseInt(x.getAttribute(o),10))&&(f=void 0)}if(v.match("w2treeview")||v.match("w2treeview_virtual")||v.match("w2input")||v.match("w2textarea")||y.options.dataDragDropClass&&v.match(y.options.dataDragDropClass)){I=v.getElement().id;break}(v.match("w2treeview_node")||v.match("treeview_virtual_node"))&&(_=v.getElement().getAttribute(s))}if((!y.options.dataDragDropSelf||y.id===m)&&(!y.options.dataDragDropOther||y.id!=m)&&(null!=m&&(b=(m=r.D.getComponentById(m)).getDataLength(),null!=w&&(b=m.rowIndex+parseInt(w/(m.oneRowDataLength+m.defaultColCnt)))),null!=I&&(I=r.D.getComponentById(I)),m||I)){var S,D,R=m&&""==m.options.dragEndFunction&&""==y.options.dragStartFunction;if(y.focusedCell.length>1&&(y.options.dataDragDropClass||R)){V=[],W=[];for(var L=0;L<y.focusedCell.length;L++){var T=y.focusedCell[L].focusedRowIndex;W.push(T)}W.sort((function(t,e){return t-e}));for(L=0;L<W.length;L++)for(var k=y.dataList.getRowArray(W[L]).data,F=0;F<k.length;F++)V.push(k[F])
}else S=y.dataList.getRowArray(p).data;var A=t.getAttribute(i),E=y.getColumnIndex(A);if(""!=y.options.dragStartFunction){var M=r.D.getGlobalFunction(y.options.dragStartFunction,y.scope_id);if("function"==typeof M)if(y.drillDownDragDrop){var O,N;y.getRowCount()<=b?(O=void 0,N=void 0):(O=y.getRealRowIndex(b),N=y.dataList.getRowData(b));var B=[j=y.getRealRowIndex(p)].concat(y.drilldown.getRecursiveRowIndex(j)),H=[];for(L=0;L<B.length;L++)H=H.concat(y.dataList.getRowData(y.getDisplayRowIndex(B[L])));if(!M.call(y,{parentRowIndex:O,parentRowData:N,beforeRemoveData:H,beforeRemoveRowIndex:B}))return}else{var G={fromColumnId:A,fromColumnIndex:E,rowJSON:y.dataList.getRowJSON(p)};null==D&&(D=y.dataList.getRowXML(p)),D=M.call(y,p,D,G)}}else if(m&&y.id!==m.id&&y.drillDownDragDrop){var W=[j=y.getRealRowIndex(p)].concat(y.drilldown.getRecursiveRowIndex(j)),V=[];for(L=0;L<W.length;L++)V=V.concat(y.dataList.getRowData(y.getDisplayRowIndex(W[L])))}if(m&&""!=m.options.dragEndFunction){var q=r.D.getGlobalFunction(m.options.dragEndFunction,m.scope_id);if("function"==typeof q)if(y.drillDownDragDrop){if(y.id==m.id){if(y.isDrillDown&&b!=p){var j=y.getRealRowIndex(p);if(y.getRowCount()<=b)y.drilldown.bodyDrop=!0,Z=(K=y.getRealRowIndex(b-1))+y.drilldown.getRecursiveRowCount(K);else Z=y.getRealRowIndex(b)+1;var P=[j].concat(y.drilldown.getRecursiveRowIndex(j)),z=y.drilldown.moveNode(j,Z),X=[z.insertedRowIndex].concat(y.drilldown.getRecursiveRowIndex(z.insertedRowIndex)),U=[];for(L=0;L<P.length;L++)U.push(y.dataList.getRowJSON(P[L]));C={removedData:z.detachedData,removedRowIndex:P,insertedData:z.insertedData,insertedRowIndex:X,fromRowIndex:j,toRowIndex:X[0],rowJSON:U},q.call(y,Z,y.dataList.getRowXML(p),C)}}else if(m.drillDownDragDrop&&m.isDrillDown){j=y.getRealRowIndex(p);if(m.getRowCount()<=b)m.drilldown.bodyDrop=!0,Z=(K=m.getRealRowIndex(b-1))+m.drilldown.getRecursiveRowCount(K);else Z=m.getRealRowIndex(b);for(B=[j].concat(y.drilldown.getRecursiveRowIndex(j)),H=[],L=0;L<B.length;L++)H=H.concat(y.dataList.getRowData(y.getDisplayRowIndex(B[L])));D=y.dataList.getRowXML(p);for(U=[],L=0;L<B.length;L++)U.push(y.dataList.getRowJSON(B[L]));C={removedData:H,removedRowIndex:B,fromRowIndex:j,toRowIndex:Z,rowJSON:U},q.call(y,Z,D,C)&&y._dataList.removeRow(j)}}else{G={fromColumnId:A,fromColumnIndex:E,toColumnId:"number"==typeof f?m.getColumnID(f):void 0,toColumnIndex:f,rowJSON:y.dataList.getRowJSON(p)};!0!==a.v.isXML(D)&&(D=y.dataList.getRowXML(p)),q.call(y,b,D,G)&&y.dataList.removeRow(p)}}else if(m){if(y.isDrillDown)if(y.id==m.id&&b!=p){if(y.drillDownDragDrop){j=y.getRealRowIndex(p);if(y.getRowCount()<=b)y.drilldown.bodyDrop=!0,Z=(K=y.getRealRowIndex(b-1))+y.drilldown.getRecursiveRowCount(K);else Z=y.getRealRowIndex(b)+1;return void y.drilldown.moveNode(j,Z)}}else if(m.drillDownDragDrop&&m.isDrillDown){var Z,K;j=y.getRealRowIndex(p);if(m.getRowCount()<=b)m.drilldown.bodyDrop=!0,Z=(K=m.getRealRowIndex(b-1))+m.drilldown.getRecursiveRowCount(K);else Z=m.getRealRowIndex(b)+1;for(H=[],L=(B=[j].concat(y.drilldown.getRecursiveRowIndex(j))).length-1;L>=0;L--)H=H.concat(y.dataList.getRowData(y.getDisplayRowIndex(B[L])));return m.drilldown.appendNode(Z,H),void y.dataList.removeRow(j)}var Y=m._dataList.getBroadcast();if(m._dataList.setBroadcast(!1),V&&W){var $=-1;if(y.id==m.id)for(L=0;L<W.length;L++)W[L]<b&&$++;$=Math.max(0,$);var J=m.dataList.getRealRowIndex(b),Q={};if(y.options.dataDragDropStatus)for(var tt=0;tt<W.length;tt++)Q[tt]=y.dataList.getRowStatus(W[tt]);y.dataList.removeRows(W),void 0===J&&(J=b,$=0);var et=J-$;y.id==m.id&&(et=Math.min(et,y.getRowCount())),m._dataList.insertData(et,V);var it=0;if(y.options.dataDragDropStatus){for(var ot in Q){var st=et+it,at=y._dataList.options.depthColumn?st:y._dataList.getRealRowIndex(st);y._dataList._setRowStatus(at,Q[ot]),it++}y.setFocusedMultiCell(et,0,et+it-1,0)}y.id===m.id?y._moveCellVisible(W,et,{remove:!0,insert:!0}):(y._moveCellVisible(W,et,{remove:!0}),m._moveCellVisible(W,et,{insert:!0}))}else{
var rt=y.dataList.getRowStatus(p);if(y.dataList.removeRow(p),!0===a.v.isXML(D)?m.dataList.setRowXML(b,D):m.dataList.setRowData(b,S),y.options.dataDragDropStatus){at=y._dataList.options.depthColumn?b:y._dataList.getRealRowIndex(b);y._dataList._setRowStatus(at,rt),y.setFocusedCell(at,0)}y.id===m.id?y._moveCellVisible([p],b,{remove:!0,insert:!0}):(y._moveCellVisible(W,et,{remove:!0}),m._moveCellVisible(W,et,{insert:!0}))}!1!==Y&&m._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0}]}),y.removeFocusedCell(),y.id!=m.id?u.B.fireEvent(m,"ondatadrop",{fromId:y.id,fromRowIndex:p,toRowIndex:b}):u.B.fireEvent(m,"ondatadropself",{id:y.id,fromRowIndex:p,toRowIndex:b}),t.blur()}else if(I){var nt;null!=_&&(nt=I.tree.findNodeByIndex(_),_=parseInt(_,10)),u.B.fireEvent(I,"ondropfromgrid",{dataListId:y._dataList.id,fromId:y.id,fromRowIndex:p,value:this.contents,dropNode:nt,toRowIndex:_,rowIndexArr:W||[p]}),y.removeFocusedCell(),t.blur()}}}};return this.isMobile&&(b.passive=!1,b.showGhostOnActivate=!0,b.ghostRightTop=!0,b.delay=0),void WebSquare.dragdrop.gDragManager.activate(t,l,b)}},f.prototype.dragSelectAutoScroll=function(t,e,i){try{this._dragSelectAutoScrollStartTime=new Date,r.D.setInterval((function(t,e,i){this._dragSelectAutoScroll(t,e,i)}),{key:this.id+"_dragSelectAutoScroll",caller:this,delay:this.options.dataDragSelectAutoScrollPeriod,args:[t,e,i]})}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype._dragSelectAutoScroll=function(t,e,i){try{var o=0,a=this.getRowCount(),n=null==this.lastTopRowIndex?a-this.lastIndex:this.lastTopRowIndex,l=WebSquare.style.getAbsoluteTop(this.render),h=l+e,d=1;if(t>h?o=t-h:l>t&&(o=l-t,d=-1),0!==o){var u=new Date-this._dragSelectAutoScrollStartTime,p=Math.floor(u/this.options.dataDragSelectAutoScrollLevel),c=Math.pow(2,p),g=Math.ceil(o*this.options.dataDragSelectAutoScrollDPI/100)*c*d,f=Math.max(Math.min(this.rowIndex+g,n-1),0);this.rowIndex!==f&&(this.scrollEvent=!1,this.checkScrollEnd=!0,this.rowIndex=f,this.fastDrawData(0,{scroll:!0}),this._dragSelectAutoScrollFlag=!0,document.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(f))}for(var m=0,y=WebSquare.style.getAbsoluteLeft(this.render),b=y+this.render.offsetWidth,w=0;w<this.defaultColCnt;w++)y+=this.colWidthList[w];d=1;if(i>b?m=i-b:y>i&&(m=y-i,d=-1),0!==m){var v=r.D.getDataPrefix("tdIndex"),C=this.focusedCell[0],I=this.getLastFocusedCell().focusedTd,_=parseInt(I.getAttribute(v)),x=parseInt(_/this.realRowDataLength),S=C.focusedRowIndex,D=C.focusedColIndex,R=x+this.rowIndex,L=_%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);L=d<0?Math.max(0,L-1):Math.min(this.oneRowDataLength-1,L+1),this._applyFocusedMultiCell(S,D,R,L),d<0?this.fixScrollLeftDirection():this.fixScrollRightDirection()}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.dragSelectAutoScrollFinish=function(){try{if(r.D.clearInterval(this.id+"_dragSelectAutoScroll"),!0!==this._dragSelectAutoScrollFlag)return;this._dragSelectAutoScrollFlag=!1,this._dragSelectAutoScrollStartTime=0;var t=r.D.getDataPrefix("tdIndex");a.v.setTimer((function(){var e=this.focusedCell[0],i=this.getLastFocusedCell().focusedTd,o=parseInt(i.getAttribute(t)),s=parseInt(o/this.realRowDataLength),a=e.focusedRowIndex,r=e.focusedColIndex,n=s+this.rowIndex,l=o%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h=null==this.lastTopRowIndex?this.getRowCount()-this.lastIndex:this.lastTopRowIndex,d=a<=n?1:-1,u=Math.max(Math.min(this.rowIndex+d,h),0);this.drawData(u,0),this._applyFocusedMultiCell(a,r,n,l)}),{key:this.id+"__dragSelectAutoScroll_drawData",caller:this,delay:this.options.dataDragSelectAutoScrollDelay})}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.otherClickEvent=function(){try{this.isMobile?(this.event.addListener(document.documentElement,"ontouchstart",this.event.bindAsEventListener(this,this.handleClickEventDocument)),
this.options.tooltipDisplay&&this.hideTooltip()):WebSquare.getBody().getLayerListener().addListener({component:this,event:{},otherClick:this.handleClickEventDocument,frameClick:this.handleClickEventFrame})}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleClickEventFrame=function(t){try{this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,!0]),this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),this.hideContextMenu(),this.groupbyFilterList&&this.hideGroupbyFilterList(),this.options.focusAutoRemove&&this.removeFocusedCell()}catch(t){s.w.printStackTrace(t)}},f.prototype.handleClickEventDocument=function(t){this.lastEvent=t,this.isHammerEnabled()&&!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),this.event.isMe(t,this.render)||this.isMine(t)?this.handleClickEventDocumentAfter(t):(this.editedCell?this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,{otherClick:!0}],{beforeFunc:function(t,e){t.handleClickEventDocumentAfter(e);var i=WebSquare.getBody();i.layerListener.handleMouseDownEventDocument.call(i,e),i=null},beforeFuncArgs:[this,t]}):this.handleClickEventDocumentAfter(t),this.options.tooltipDisplay&&this.isMobile&&(!t.srcElement.id==this.id+"_toGoButton"&&this.hideTooltip(),t.srcElement.id==this.id+"_tooltip"&&u.B.stopEvent(t)))},f.prototype.handleClickEventDocumentAfter=function(t){if(this.contextMenu){var e=u.B.getTarget(t);e&&e.className.match("contextMenu")||this.hideContextMenu()}if(this.groupbyFilterList||this.customFilterScrollView){var i=this.event.getTargetIterator(t,this.render),o=!0;if(this.customFilterScrollView&&this.customFilterScrollView.render&&"none"==this.customFilterScrollView.render.style.display)o=!1;else for(;i.next();)if(i.match("gridHeaderTDDefault")||i.match("w2grid_groupbyZone_scrollView")||i.match("w2grid_groupbyZone_column")||i.match("w2grid_customFilter_scrollView")||i.match("w2grid_customFilter_column")){o=!1;break}o&&this.hideCustomFilterList()}if(this.options.groupbyZone&&this.options.groupbyFilterBox)for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_filterBox_select_tbody")||i.match("w2grid_filterBox_itemTable")){o=!1;break}if(this.groupbyFilterList){for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_groupbyZone_list")||i.match("w2grid_groupbyZone_column")||i.match("gridHeaderTDDefault")){o=!1;break}o&&this.hideGroupbyFilterList()}this.options.focusAutoRemove&&this.removeFocusedCell()},f.prototype.isMine=function(t){try{for(var e=u.B.getTarget(t);null!=e;){if(e.id&&e.id.indexOf&&e.id.indexOf("G_"+this.id+"__")>=0)return!0;e=e.parentNode}return!1}catch(t){s.w.printStackTrace(t)}},f.prototype.handleResize=function(t){try{var e=t||{},i=this.render.offsetWidth,o=this.render.offsetHeight;if(i>0&&o>0)if(this.delayedDrawObj)this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.setRedrawStatus("draw");else{var n=i-this.resizeObj.width,l=o-this.resizeObj.height,h=!1,d=this.hiddenCellObj.length>0;if(!0===this._isHybridScroll()&&0!==l)this.setScrollYHeightHybrid();else if(l>0){if(this.options.adaptive){var u=parseInt(this.options.adaptiveThreshold)||480;if(!(r.D.isIE()&&parseInt(a.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=u)return}this._setGridHeightBefore(),h=!0;var p=this.getDataLength(),c=this.drawedRowLength;this.lastTopRowIndex=null,this.setDataTable(),this.setScrollYHeight();var g=this._getVisibleLastIndex(this.lastIndex+1);if(p<=0);else if(this.rowIndex+g-1+this.drawedRowLength-c<p){var f=p-this.drawedRowLength+1,m=this.rowIndex;this.rowIndex+1>f&&f>=-1&&(m=f>=0?f:0),d?(this.rowIndex=m,this._setCellVisibleRefresh()):this.drawData(m)}else{var y,b;if((m=p-this.drawedRowLength>0?p-this.drawedRowLength:0)==this.rowIndex)y=g-1;else this.scrollEvent=!1,this.checkScrollEnd=!0,
this.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(m);if(d)this.rowIndex=m,this._setCellVisibleRefresh();else e.startPoint&&(b=parseInt(e.startPoint),isNaN(b)||(y=b)),this.drawData(m,y)}this._setGridHeightAfter()}else if(l<0&&"all"!=this.options.visibleRowNum){this._setGridHeightBefore(),this._setGridHeightAfter(),h=!0;var w=this.getElementById(this.id+"_body_table");this.dataLayerHeight=w.parentNode.offsetHeight;var v=Number(this.options.visibleRowNum),C=this.getVisibleRowNum();d?this._setCellVisibleRefresh():(!isNaN(v)&&v>0&&v>=C||(this.lastTopRowIndex=null,this.cutGridBottom(this.lastIndex)),this.setScrollYHeight())}0!=n&&(h=!0,this.resizeObj.clientWidth=this.render.clientWidth,this.setScrollYHeight(),this.options.autoFit||this.setOverflowX(),this._handleScrollX(),this.options.autoFit&&this.autoFitFunc(),d&&this._setCellVisibleRefresh(),this.displayFixedColumnLine()),h&&this.groupbyZoneStatus.groupbyZoneRender&&this.resizeGroupbyZone()}else this.setRedrawStatus("stop");this.groupbyZoneStatus.groupbyZoneRender&&!this.adjustGroupbyZone&&(this.adjustGroupbyZone=!0,this.resizeGroupbyZone()),this.resizeObj={width:i,height:o,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.resizeObj.width>0&&this.resizeObj.height>0&&(this.resizeObj.scrollLeft=this.getElementById(this.id+"_scrollX_right").scrollLeft,this.resizeObj.scrollTop=this.getElementById(this.id+"_scrollY_div").scrollTop)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.resizeGroupbyZone=function(){if(this.groupbyZoneStatus.groupbyZoneRender){var t=this.resizeObj.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder,e=this.dom[this.id+"_scrollY_div"].offsetWidth;0!=e&&(t-=e),t+="px",this.groupbyZoneStatus.groupbyZoneRender.style.width!=t&&(this.groupbyZoneStatus.groupbyZoneRender.style.width=t)}},f.prototype.checkPercent=function(){var t=WebSquare.WebSquareparser.getAttribute(this.element,"style");if(t.indexOf("%")>0)for(var e=t.split(";"),i=0;i<t.length;i++)if(e[i].indexOf("%")&&e[i].indexOf("height")||e[i].indexOf("%")&&e[i].indexOf("width")){this.checkResize();break}},f.prototype.checkResize=function(){try{if(this.render){var t=!0;if(WebSquare.getBody().modalStack&&WebSquare.getBody().modalStack.length>0&&this.getDisabled()){for(var e=this.parentControl;e&&(!e.options||!("floatingLayer"==e.options.pluginName||"wframe"===e.options.pluginName&&e._isWframePopup));)e=e.parentControl;null==e&&(t=!1)}t&&!this.startedDisplayNone&&this.handleResize()}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleDblClickEvent=function(t){for(var e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match(this.options.bodyTdClass)||WebSquare.idToUUID[e.getElement().getAttribute("id")]){this.bodyDblClick(t,e.getElement());break}if(e.match(this.options.headerTdClass)){this.headerDdlClick(t,e.getElement());break}if(this.hasFooter&&e.match(this.options.footerTdClass)){this.footerDblClick(t,e.getElement());break}if(this.hasSubtotal){if(this.subtotalClassList){for(var i=!1,o=0;o<this.subtotalClassList.length;o++)if(this.subtotalClassList[o].length>0&&e.match(this.subtotalClassList[o])){this.subtotalDblClick(t,e.getElement()),i=!0;break}if(i)break}else if(e.match(this.options.subtotalTdClass)){this.subtotalDblClick(t,e.getElement());break}}else e.match("w2grid_customFilter_sortable_open")&&(u.B.stopEvent(t),e.stop())}},f.prototype.handleClickEvent=function(t){if(this.lastEvent=t,u.B.fireEvent(this,"onclick",t),!(this.isMobile&&this.iScroll&&this.iScroll.moveDirection&&this.iScroll.moveDistance>10)){var e,i,o,s,a,r,n,l=this.event.getTargetIterator(t,this.render),h=null!=this.editedCell,d=this.lastEvent;h&&(e=this.editedCell.editRowIndex,i=this._dataList.getColumnIndex(this.editedCell.id),n=this.getCellInfo(this.editedCell.id),o=this.getColumnIndex(this.editedCell.id),s=this._grid.getRealRowIndex(e),
a=this._dataList.dataArr[s*this._dataList.getColumnCount()+i],r=n.comp&&n.comp.selectedIndex);for(var p=function(t,e){var i=!1;if(e.subtotalClassList)for(var o=0;o<e.subtotalClassList.length;o++)if(e.subtotalClassList[o].length>0&&t.match(e.subtotalClassList[o])){i=!0;break}return i},c=!1;l.next();){if(l.match(this.options.bodyTdClass)){c=!0,this.bodyClick(t,l.getElement(),{from_handleClickEvent:!0});break}if(l.match(this.options.headerTdClass)){c=!0,this.headerClick(t,l.getElement(),{from_handleClickEvent:!0}),h&&null==this.editedCell&&(e=this.getDisplayRowIndex(s));break}if(this.hasFooter&&l.match(this.options.footerTdClass)){c=!0,this.footerClick(t,l.getElement(),{from_handleClickEvent:!0});break}if(this.hasSubtotal&&(l.match(this.options.subtotalTdClass)||p(l,this))){c=!0,this.subtotalClick(t,l.getElement(),{from_handleClickEvent:!0});break}if(this.isMine(t));else{if(l.match(this.options.headerTableClass))break;if(l.getElement().getAttribute("id")==this.id+"_dataLayer"){c=!0,null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,{from_handleClickEvent:!0}),u.B.fireEvent(this,"onblankclick",t);break}}}if(h){var g=this._dataList.dataArr[s*this._dataList.getColumnCount()+i];if(0===a&&(a="0"),0===g&&(g="0"),a!=g){var f={oldValue:a,newValue:g,rowIndex:e,colIndex:o,colId:this.getColumnID(o)};isNaN(r)||(f.oldSelectedIndex=r,f.newSelectedIndex=n&&n.comp&&n.comp.selectedIndex),u.B.fireEvent(this,"onviewchange",f)}var m=this._getGroupbyDisplayRowIndex(e);this.options.viewChangeAfterEdit&&c&&u.B.fireEvent(this,"onafteredit",m,o,g,d)}}},f.prototype.gridDataLayerOut=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},f.prototype.gridHeaderOver=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},f.prototype.gridOver=function(t){for(var e=r.D.getDataPrefix("colIndex"),i=r.D.getDataPrefix("col_id"),o=u.B.getTarget(t);o&&("TD"!=o.tagName||null==o.getAttribute(e)||!(this.hasClass(o,this.options.bodyTdClass)||this.hasClass(o,this.options.subtotalTdClass)||this.hasClass(o,this.options.footerTdClass)));){if("TD"==o.tagName&&null!=o.getAttribute(e)&&this.subtotalClassList){for(var s=!1,a=0;a<this.subtotalClassList.length;a++)if(this.subtotalClassList[a].length>0&&this.hasClass(o,this.subtotalClassList[a])){s=!0;break}if(s)break}if(this.options.tooltipHeader&&"TH"==o.tagName&&null!=o.getAttribute(e))break;if("DIV"==o.tagName&&o.getAttribute("id")==this.id+"_dataLayer")break;if("TABLE"==o.tagName&&o.getAttribute("id")==this.id+"_foot_table")break;if("TH"==o.tagName&&this.hasClass(o,this.options.headerTdClass))break;o=o.parentNode}if(o.id==this.id+"_dataLayer")this.overElem&&(this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null);else if(o.id==this.id+"_foot_table")this.overElem&&(this.bodyOut(t,this.overElem),this.overElem=null);else if(o&&"TD"==o.tagName){if(this.overElem!=o&&-1==o.className.indexOf(this.options.headerTdClass)){this.bodyOut(t,this.overElem),(this.options.tooltipDisplay||this.options.rowStatusTooltipDisplay)&&this.bodyOver(t,o),this.options.rowMouseOver&&(this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.hasClass(o,"w2grid_groupby")||this.addRowOverStyle(o.parentNode)),this.overElem=o;var n={};(l=o.getAttribute(i))&&(n.rowIndex=this._getGroupbyDisplayRowIndex(this.getElemRowIndex(o)),n.colIndex=this.getColumnIndex(o.getAttribute(i))),u.B.fireEvent(this,"onbodymouseover",n)}}else if(o&&"TH"==o.tagName&&this.overElem!=o){this.bodyOut(t,this.overElem),(this.options.tooltipHeader||this.options.headerTooltipDisplay)&&this.headerOver(t,o),this.options.rowMouseOver&&this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.overElem=o;n={};var l=o.getAttribute(i);if(this.getHeaderInfo(l)){
var h=r.D.getDataPrefix("header_id");n.header_id=o.getAttribute(h),n.id=this.overElem.id}u.B.fireEvent(this,"onheadermouseover",n)}},f.prototype.gridOver1=function(t){var e=u.B.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem&&this.removeRowOverStyle(this.overElem.parentNode),this.addRowOverStyle(e.parentNode)),this.overElem=e)},f.prototype.gridOver2=function(t){var e=u.B.getTarget(t);("NOBR"==e.tagName||"SPAN"==e.tagName&&e.className.indexOf("w2grid_span")>-1)&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem,this.addRowOverStyle(e.parentNode)),this.overElem=e)},f.prototype.handlePasteEvent=function(t){try{var e=this.options.preventPasteColumn,i=e?e.split(","):[];if(this.options.preventPaste&&!this.editedCell||u.B.getTarget(t)&&u.B.getTarget(t).getAttribute("class")&&u.B.getTarget(t).getAttribute("class").indexOf("w2grid_head_input")>-1)return;if(!1===u.B.fireEvent(this,"oncustompaste",t))return;var o,n,l,h=r.D.isIEAllVersion()?window.clipboardData:t.clipboardData,d=h.getData("Text");if(1==this.options.ctrlShiftKey&&(o=h.getData("Nofocus")),"\r\n"==d.slice(-2)?d=d.slice(0,d.length-2):"\n"==d.slice(-1)&&(d=d.slice(0,d.length-1)),this.options.customPasteFormatter)if("string"==typeof this.options.customPasteFormatter){var p=r.D.getGlobalFunction(this.options.customPasteFormatter.wq_trim(),this.scope_id);if("function"==typeof p){var c=p.call(this,d);d=c||d}}else $l("The type of customPasteFormatter must be string.");if("native"===this.options.copyType?n=[[d]]:(1==this.options.ctrlShiftKey&&(l=Papa.parse(o,{delimiter:"\t"}).data),n=Papa.parse(d,{delimiter:"\t"}).data),r.D.isIEAllVersion("6 7")&&'"'===d.slice(0,1)&&'"'===d.slice(-1)&&-1==d.slice(1,-1).indexOf("\t")&&(n=[[d.slice(1,d.length-1)]]),!n||null==n||"undefined"==n||0==n.length)return;if(this.focusedCell.length>0){for(var g,f=this.getColumnOrder(),m=this.htmlInfo.body.rowAttrArr.length,y=this.getDataLength()*m,b=0,w=f.length,v=0,C=null,I=0,_=0;_<this.focusedCell.length;_++){var x=this.focusedCell[_],S=x.focusedRowIndex,D=x.focusedColIndex,R=this.getLocationRowCol(S,D);S=R.rowIndex,D=R.colIndex,I+=R.rowSize*R.colSize-1,y>S&&(y=S),b<S+R.rowSize-1&&(b=S+R.rowSize-1),w>D&&(w=D),v<D+R.colSize-1&&(v=D+R.colSize-1),y==S&&w==D&&(C=x)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(w=0,v=f.length-1);var L=0;for(_=this.defaultColCnt+w;_<this.defaultColCnt+v;_++)1==this.hiddenList[_]&&(L+=1);if(this.focusedCell.length>1&&this.focusedCell.length+I!=(b-y+1)*(v-w-L+1))return;var T=!1;if(I>0&&(T=!0),g={focusedRange:{minRow:y,maxRow:b,minCol:w,maxCol:v},startCell:C},C.focusedRowIndex>=0&&C.focusedColIndex>=0){var k=C.focusedTd;if(k){var F=r.D.getDataPrefix("col_id"),A=r.D.getDataPrefix("colMerged"),E=k.getAttribute(F);if(null==E||""==E.wq_trim())return;if("1"==k.getAttribute(A))return}else{var M=this.getCellInfo(C.focusedColIndex);if(M&&(M.options.colMerge||M.options.colMergeAnd))return}var O=y,N=w,B=this.getOriginalRowCol(y,w),H=(D=B.colIndex,S=B.rowIndex,this.getTotalRow()),G=(this.getTotalCol(),H*m),W=f.length;if(this.options.checkBlankRowOnPaste)for(_=n.length-1;_>-1;_--){for(var V=!0,q=0;q<n[0].length;q++)if(""!=n[_][q].wq_trim()){V=!1;break}V&&n.splice(_,1)}if(!1===u.B.fireEvent(this,"onbeforepaste",{rowIndex:this._getGroupbyDisplayRowIndex(S),colIndex:D,data:n.slice(0)}))return;this.isPaste=!0;var j,P=this,z=function(t){for(var e=P.defaultColCnt+t;e<P.hiddenList.length;e++)if(0==P.hiddenList[e])return e-P.defaultColCnt},X=this.uuid,U=!1,Z=function(t){var e=WebSquare.idCache[X],o=e.options.checkReadOnlyOnPasteEnable,s=o?o.split(","):[];if(O+n.length>G&&!r.D.getBoolean(P.options.preventAddRowOnPaste)&&"focus"!==P.options.pasteOption){var a=Math.ceil((O+n.length-G)/m),h=Array(P._dataList.getTotalCol()*a)
;if(""!=P.depthColumn)for(var d=P._dataList.getCellInfo(P.depthColumn).options.defaultValue,p=0;p<a;p++)h[p*P._dataList.getTotalCol()+P._dataList.getColumnIndex(P.depthColumn)]=d;if(P.options.setDefaultValueOnPaste){var c=P._dataList.getTotalCol();for(p=0;p<c;p++)for(var g=P._dataList.getCellInfo(p).options.defaultValue,f=0;f<a;f++)h[f*c+P._dataList.getColumnIndex(p)]=g}if(P.options.checkReadOnlyOnPaste){var C=!0,I=!1;for(p=0;p<n.length;p++){var _=N,x=O+p;for(f=0;f<n[0].length&&!(null==_||_>=W);f++){var S=(k=P.getOriginalRowCol(x,_)).colIndex,D=k.rowIndex;I=!1;for(var R=0;R<s.length;R++)if(s[R]==e.getColumnID(S)){I=!0;break}if(!P.___getEditReadOnly(D,S)||P.___getEditReadOnly(D,S)&&I){C=!1;break}_=z(_+1)}}if(C)return}if(P.options.checkDisabledOnPaste){var L=!0;for(p=0;p<n.length;p++)for(_=N,x=O+p,f=0;f<n[0].length&&!(null==_||_>=W);f++){var k;S=(k=P.getOriginalRowCol(x,_)).colIndex,D=k.rowIndex;if(!P._getEditDisabled(D,S)){L=!1;break}_=z(_+1)}if(L)return}if(h.length>0){U=!0,P._dataList.setData(h,!0);p=0;for(var F=a,A=new Array(a);p<F;p++)A[p]="C";j=A.length,P._dataList.rowStatusArr=P._dataList.rowStatusArr.slice(0,H).concat(A)}}var E=function(o,a,h){for(var d=function(t,e,i,o){var s=P.data_td_list[e+(t-P.rowIndex)*P.oneRowDataLength];if(t<P.rowIndex&&(s=null),!(P.groupbyStatus.grouped&&s&&P.hasClass(s,"w2grid_groupby"))){var a=P.getCellInfo(e),r=P._getRealColIndex("body",a.options.col_id)+P.defaultColCnt;if(!a.options.blockSelect&&!P.hiddenList[r]){if(1==P.options.ctrlShiftKey)if("true"!=(l[o].length>1?l[o][e]:l[o]))return;var n={focusedTd:s,focusedRowIndex:t,focusedColIndex:e};P.options.groupbyDisplayRowIndex&&(n.groupbyDisplayRowIndex=P._getGroupbyDisplayRowIndex(t)),i?P.focusedCell.push(n):P.focusedCell.unshift(n),null!=s&&P.applyFocusedCellIn(s,i)}}},p=o,c=0;c<n.length;c++){for(var g=a,f=0;f<n[c].length&&!(null==g||g>=W);f++){var y=P.getOriginalRowCol(p,g),b=y.colIndex,w=y.rowIndex;if(y.noLeftTop)y.leftCell&&(g=z(g+y.colSize));else{1==P.options.ctrlShiftKey?d(w,b,h,c):d(w,b,h);for(var v=!1,C=0;C<s.length;C++)if(s[C]==e.getColumnID(b)){v=!0;break}if(P.options.checkReadOnlyOnPaste&&P.___getEditReadOnly(w,b)&&!v)g=z(g+y.colSize);else if(P.options.checkDisabledOnPaste&&P._getEditDisabled(w,b))g=z(g+y.colSize);else{var I=!1;for(C=0;C<i.length;C++)if(i[C]==e.getColumnID(b)){g=z(g+y.colSize),I=!0;break}if(!I&&!(r.D.getBoolean(P.options.preventAddRowOnPaste)&&P.dataList.getRowCount()*m-1<w||"focus"===P.options.pasteOption&&(g>t.focusedRange.maxCol||g<t.focusedRange.minCol||p>t.focusedRange.maxRow||p<t.focusedRange.minRow))){var _,x=b,S=P.tdIdList[x],D=P._dataList.getColumnIndex(S),R=P._dataList.dataArr[P.getRealRowIndex(w)*P._dataList.getColumnCount()+D],L=n[c][f];1==P.options.ctrlShiftKey&&(_=l[c][f]);var T=P.getCellInfo(x),k=!(!P.isDrillDown||!P._dataList.options.depthColumn)?P.getRealRowIndex(w):w;if("number"!=T.options.dataType&&"float"!=T.options.dataType||"."!==(L=L.wq_trim())&&"-"!==L&&"+"!==L){if((T.options.selectedDataOnPaste||P.options.selectByLabel)&&("autoComplete"===T.options.inputType||"select"===T.options.inputType)){var F,A=T.getItemArray(),E=T.dataComp;if(T.existGridViewItemsetNode||"gridViewItemset"===T.options.itemTableType){var M=T.itemsetObj.nodeset;M.indexOf("data:")>=0&&(E=M.slice(5))}if(E&&(F=T.mainGrid.modelControl.getDataComp(E)),F&&(!A||0==A.length||1==A.length&&(!0===T.options.chooseOption||!0===T.option.allOption)||2==A.length&&!0===T.options.chooseOption&&!0===T.option.allOption)){var O=F.bodyIdColIndexMap[T.itemsetObj.label],N=F.bodyIdColIndexMap[T.itemsetObj.value],B=F.cellIdList.length,H=F.filteredRowIndexArr.length;if(A=[],F&&"linkedDataList"===F.initializeType&&null!=F.conditionInfo&&F.conditionInfo.filterInfo.useRef)for(var G=0;G<F._dataList.getDataLength();G++){(V={}).label=F._dataList.dataArr[G*B+O],V.value=F._dataList.dataArr[G*B+N],A[G]=V}else for(C=0;C<H;C++){var V={};"linkedDataList"!=F.initializeType&&F.dataArr?(V.label=F.dataArr[F.filteredRowIndexArr[C]*B+O],
V.value=F.dataArr[F.filteredRowIndexArr[C]*B+N]):(V.label=F._dataList.dataArr[F.filteredRowIndexArr[C]*B+O],V.value=F._dataList.dataArr[F.filteredRowIndexArr[C]*B+N]),A[C]=V}}var q=!1;if(T.options.selectedDataOnPaste)if(0===A.length)q=!0;else for(var X=0;X<A.length;X++){var Z=A[X];switch(T.options.selectedDataOnPaste){case"true":case"both":Z.value!==L&&Z.label!==L||(q=!0);break;case"value":Z.value===L&&(q=!0);break;case"label":Z.label===L&&(q=!0);break;default:q=!0}if(q)break}if(!q&&T.options.selectedDataOnPaste){n.length<=j+c&&0===f&&U&&P._drawRowStatus(k-P.rowIndex,k),g=z(g+y.colSize);continue}if(P.options.selectByLabel)for(X=0;X<A.length;X++){if((Z=A[X]).label===L){L=Z.value;break}}}var K=T.comp&&T.comp.selectedIndex;if("true"===P.options.unformatOnPaste||"true"===T.options.unformatOnPaste){if("calendar"==T.options.inputType&&"date"==T.options.dataType){var Y=0;"yearMonthDate"==T.options.calendarValueType?Y=8:"yearMonth"==T.options.calendarValueType?Y=6:"yearMonthDateHour"==T.options.calendarValueType?Y=10:"yearMonthDateTime"==T.options.calendarValueType?Y=12:"yearMonthDateTimeSec"==T.options.calendarValueType?Y=14:"year"==T.options.calendarValueType&&(Y=4);var $=new WebSquare.validator.validateInvoker;$.addCommand(new WebSquare.validator.allowCharCommand("0-9")),$.addCommand(new WebSquare.validator.maxLengthCommand(Y)),L=$.validateString(L)}var J=L,Q=T.formatter.masking,tt=T.formatter.type;L=J=void 0===tt||null==tt||"number"!=tt&&"float"!=tt?void 0!==tt&&null!=tt&&"date"==tt?WebSquare.text.unformatDate2(Q,J):void 0!==tt&&null!=tt&&"time"==tt?WebSquare.text.unformatTime(Q,J):WebSquare.text.unformatText(Q,J):WebSquare.text.unformatCurrency(Q,J)}if(T.options.maxLength)if("float"==T.options.dataType)L=new WebSquare.validator.maxFloatLengthCommand(T.options.maxLength,T.options.decimalDelimiter,T.options.delimiter).executeValidateString(L);else if("number"==T.options.dataType||"bigDecimal"==T.options.dataType){L=new WebSquare.validator.maxLengthCommand(T.options.maxLength).executeValidateString(L)}else{H=parseInt(T.options.maxLength);isNaN(H)||(L=L.slice(0,H))}else if(T.options.maxByteLength){if("number"==T.options.dataType||"bigDecimal"==T.options.dataType)L=new WebSquare.validator.maxByteLengthCommand(T.options.maxByteLength,T.options.byteCheckIgnoreChar).executeValidateString(L)}var et=T.options.allowChar;if(T.options.allowChar||"float"!=T.options.dataType&&"number"!=T.options.dataType&&"bigDecimal"!=T.options.dataType||(et="0-9+-"+T.options.decimalDelimiter),et&&void 0!==et&&null!=et&&""!=et){var it=new RegExp("["+et+"]"),ot=!0;for(C=0;C<L.length;C++){if(null==L.charAt(C).match(it)){ot=!1;break}}!1===ot&&(L="")}if(T.options.ignoreChar)L=new WebSquare.validator.ignoreCharCommand(T.options.ignoreChar).executeValidateString(L);if((""!==T.options.escape?T.options.escape:P.options.escape)+""=="true"&&(L=WebSquare.xml.decode(L)),"radio"===T.options.inputType&&T.options.trueValue===L)for(var st=P.getCheckedIndex(x),at=0;at<st.length;at++)P._dataList.setCellData(st[at],D,T.options.falseValue);if("text"===T.options.inputType||"textImage"===T.options.inputType){var rt=r.D.getGlobalFunction(T.options.customModelFormatter,P.scope_id);"function"==typeof rt?(P.useCustomModelFormatter=!0,L=rt.call(P,L,L,T.editRowIndex,T.getColumnIndex(S))):P.useCustomModelFormatter=!1}if("text"===T.options.inputType&&"float"===T.options.dataType&&L.charAt(L.length-1)===T.options.decimalDelimiter&&(L=L.substr(0,L.length-1)),1==P.options.ctrlShiftKey?"true"==_&&P._dataList.setCellData(k,D,L):P._dataList.setCellData(k,D,L),!L&&U&&n.length<=j+c&&P._drawRowStatus(k-P.rowIndex,k),R!=L){if(1==P.options.ctrlShiftKey)var nt={oldValue:R,newValue:"true"==_?L:R,rowIndex:w,colIndex:x,colId:P.getColumnID(x)};else nt={oldValue:R,newValue:L,rowIndex:w,colIndex:x,colId:P.getColumnID(x)};isNaN(K)||(nt.oldSelectedIndex=K,nt.newSelectedIndex=T.comp&&T.comp.selectedIndex),u.B.fireEvent(P,"onviewchange",nt)}g=z(g+y.colSize)}}}}}p+=1}},M=y,B=w
;if(n.length>0&&!T)for(p=1;p<n.length;p++)if(n[p].length!==n[0].length){T=!0;break}if(P.applyFocusedCellOut(),P.focusedCell=[],T)E(y,w,!1);else if(b-y+1>=n.length&&v-w+1>=n[0].length)for(;M<=b-n.length+1;){for(B=w;B<=v-n[0].length+1;){var V=!0;M+n.length>b-n.length+1&&B+n[0].length>v-n[0].length+1&&(V=!1),E(M,B,V),B+=n[0].length}M+=n.length}else if(b-y+1>=n.length)for(;M<=b-n.length+1;){V=!0;M+n.length>b-n.length+1&&(V=!1),E(M,B,V),M+=n.length}else if(v-w+1>=n[0].length)for(;B<=v-n[0].length+1;){V=!0;B+n[0].length>v-n[0].length+1&&(V=!1),E(M,B,V),B+=n[0].length}else E(y,w,!1)};if("true"===this.options.showMessageOnPaste){var K=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/pasteMessage/@value");WebSquare.layer.pasteMessageLoaded=!1,WebSquare.layer.showProcessMessage(K,{type:"pasteMsg",scope:this.scope_id||""});!function t(){WebSquare.layer.pasteMessageLoaded?(r.D.clearTimeout(P.id+"_pasteMessageLoaded"),Z(),WebSquare.layer.hideProcessMessage({type:"pasteMsg",scope:this.scope_id||""}),u.B.fireEvent(P,"onafterpaste")):r.D.setTimeout(t,{delay:500,key:P.id+"_pasteMessageLoaded"})}()}else Z(g),u.B.fireEvent(this,"onafterpaste")}}this.isPaste=!1,u.B.preventDefault(t)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype._doPaste=function(){try{if(r.D.isIEAllVersion())this.handlePasteEvent({});else if(!r.D.isIEAllVersion()&&(a.v.browserCheck.moz||a.v.browserCheck.chrome||a.v.browserCheck.safari)){var t=document.createElement("textarea"),e=this;t.style.opacity="0",t.onpaste=function(t){e.handlePasteEvent(t),i.removeChild(this)},t.textContent="temp";var i=document.getElementsByTagName("body")[0];i.appendChild(t),t.select();try{document.execCommand("paste")}catch(t){p.k.printLog(this.id+"_doPaste skip.")}}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleBeforeCopyEvent=function(t){u.B.preventDefault(t)},f.prototype.handleBeforeCutEvent=function(t){u.B.preventDefault(t)},f.prototype.handleCopyEvent=function(t){try{if(!1===u.B.fireEvent(this,"oncustomcopy",t))return;var e=this.options.preventCopyColumn,i=e?e.split(","):[];if(this.options.preventCopy||"native"===this.options.copyType)return;if(a.v.browserCheck.safari){for(var o=document.activeElement,n=!1;null!=o;)o.id&&o.id==this.id&&(n=!0),o=o.parentNode;if(!n)return}var l=r.D.isIEAllVersion()?window.clipboardData:t.clipboardData,h=this.options.copyAmount;if(h||(h="cell"),"cell"==h&&this.focusedCell.length>0){for(var d=[],p=this.getColumnOrder(),c=this.htmlInfo.body.rowAttrArr.length,g=this.getDataLength()*c,f=0,m=p.length,y=0,b=0,w=0;w<this.focusedCell.length;w++){var v=this.focusedCell[w],C=v.focusedRowIndex,I=v.focusedColIndex,_=this.getLocationRowCol(C,I);C=_.rowIndex,I=_.colIndex,b+=_.colSize*_.rowSize-1,g>C&&(g=C),f<C+_.rowSize-1&&(f=C+_.rowSize-1),m>I&&(m=I),y<I+_.colSize-1&&(y=I+_.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(m=0,y=p.length-1);var x=0;for(w=this.defaultColCnt+m;w<y+this.defaultColCnt;w++)1==this.hiddenList[w]&&(x+=1);if(this.focusedCell.length+b==(f-g+1)*(y-m-x+1)||1==this.options.ctrlShiftKey||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==f-g+1)if(this.isDrillDown){var S=this._dataList.getRealRowIndex(f),D=this.drilldown.getChildrenRowArr(S),R=this._dataList.getRealRowIndex(g),L=S;this.drilldown.isOpen(f)||function t(e){var i=e[e.length-1];L=L<i?i:L;for(var o=0;o<e.length;o++){var s=this.drilldown.getChildrenRowArr(e[o]);s.length>0&&t.call(this,s)}}.call(this,D);for(w=R;w<=L;w++){for(var T=[],k=m;k<=y;k++){var F=(V=this.getOriginalRowCol(w,k)).colIndex,A=V.rowIndex;if((!V.noLeftTop||V.leftCell)&&1!=this.hiddenList[k+this.defaultColCnt]){for(var E=this.getCellInfo(F),M=!1,O=0;O<i.length;O++)if(i[O]==E.colID){M=!0;break}if(!M){var N=""!==E.options.escape?E.options.escape:this.options.escape,B=this.drilldown.statusArr;if("display"==E.options.copyOption)z=!1===B[w]?this._getDisplayData(A,this.getColumnID(F)):this._getDisplayData(this.getRealRowIndex(A),this.getColumnID(F));else{
var H=this.getColumnID(F);z=this.dataList.getColData(H)[A]}V.noLeftTop&&(z=""),N+""=="true"&&(z=WebSquare.xml._encode(z+"")),(z||this.focusedCell.length>1)&&T.push(z)}}}d.push(T)}}else{var G=[];for(w=g;w<=f;w++){T=[];var W=[];for(k=m;k<=y;k++){var V;F=(V=this.getOriginalRowCol(w,k)).colIndex,A=V.rowIndex;if((!V.noLeftTop||V.leftCell)&&1!=this.hiddenList[k+this.defaultColCnt]){for(E=this.getCellInfo(F),M=!1,O=0;O<i.length;O++)if(i[O]==E.colID){M=!0;break}if(!M){N=""!==E.options.escape?E.options.escape:this.options.escape;var q=!1;if(1==this.options.ctrlShiftKey){var j=this.getAllFocusedIndex();for(O=0;O<j.length;O++)if(A===j[O].row&&F===j[O].col){q=!0;break}W.push(q)}z="display"==E.options.copyOption?this._getDisplayData(this.getRealRowIndex(A),this.getColumnID(F)):this.dataList.getCellData(A,this.getColumnID(F)),V.noLeftTop&&(z=""),N+""=="true"&&(z=WebSquare.xml._encode(z+"")),(z||this.focusedCell.length>1)&&(1==this.options.ctrlShiftKey?!0===q&&T.push(z):T.push(z))}}}d.push(T),1==this.options.ctrlShiftKey&&G.push(W)}}else{var P=this.focusedCell[this.focusedCell.length-1];if(null!=P){var z;for(N=""!==(E=this.getCellInfo(P.focusedColIndex)).options.escape?E.options.escape:this.options.escape,w=0;w<i.length;w++)if(i[w]==E.colID)return;z="display"==E.options.copyOption?this._getDisplayData(this.getRealRowIndex(P.focusedRowIndex),this.getColumnID(P.focusedColIndex)):this.dataList._getCellData(P.focusedRowIndex,this.getColumnID(P.focusedColIndex)),N+""=="true"&&(z=WebSquare.xml._encode(z+"")),d.push([z])}}var X=Papa.unparse(d,{delimiter:"\t"});if(1==this.options.ctrlShiftKey){var U=Papa.unparse(G,{delimiter:"\t"});l.setData("noFocus",U)}l.setData("Text",X)}u.B.preventDefault(t)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleCutEvent=function(t,e){try{if(!e)if(!1===u.B.fireEvent(this,"oncustomcut",t))return;var i=this.options.preventCopyColumn,o=i?i.split(","):[];if(this.options.preventCopy)return;if(a.v.browserCheck.safari){for(var n=document.activeElement,l=!1;null!=n;)n.id&&n.id==this.id&&(l=!0),n=n.parentNode;if(!l)return}var h=r.D.isIEAllVersion()?window.clipboardData:t.clipboardData,d=this.options.copyAmount;if(d||(d="cell"),"cell"==d&&this.focusedCell.length>0){for(var p=[],c=this.getColumnOrder(),g=this.htmlInfo.body.rowAttrArr.length,f=this.getDataLength()*g,m=0,y=c.length,b=0,w=0,v=0;v<this.focusedCell.length;v++){var C=this.focusedCell[v],I=C.focusedRowIndex,_=C.focusedColIndex,x=this.getLocationRowCol(I,_);I=x.rowIndex,_=x.colIndex,w+=x.rowSize*x.colSize-1,f>I&&(f=I),m<I+x.rowSize-1&&(m=I+x.rowSize-1),y>_&&(y=_),b<_+x.colSize-1&&(b=_+x.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(y=0,b=c.length-1);var S=0;for(v=this.defaultColCnt+y;v<b+this.defaultColCnt;v++)1==this.hiddenList[v]&&(S+=1);if(this.focusedCell.length+w==(m-f+1)*(b-y-S+1))for(v=f;v<=m;v++){for(var D=[],R=y;R<=b;R++){var L=this.getOriginalRowCol(v,R),T=L.colIndex,k=L.rowIndex,F=R+this.defaultColCnt;if(1!=this.hiddenList[F]&&!(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(k,T)||e&&this.___getEditReadOnly(k,T)||this.options.checkDisabledOnCut&&this._getEditDisabled(k,T)||e&&this._getEditDisabled(k,T))){for(var A=this.getCellInfo(T),E=!1,M=0;M<o.length;M++)if(o[M]==A.colID){E=!0;break}if(!E&&!L.noLeftTop){var O=""!==A.options.escape?A.options.escape:this.options.escape;if(V="display"==A.options.copyOption?this._getDisplayData(this.getRealRowIndex(k),this.getColumnID(T)):this.dataList.getCellData(k,this.getColumnID(T)),O+""=="true"&&(V=WebSquare.xml._encode(V+"")),""!==V){var N={oldValue:V,newValue:"",rowIndex:k,colIndex:T,colId:this.getColumnID(T)};u.B.fireEvent(this,"onviewchange",N)}D.push(V),this.dataList.setCellData(k,this.getColumnID(T),"")}}}p.push(D)}else{var B=this.focusedCell[this.focusedCell.length-1],H=B.focusedRowIndex,G=this.getColumnID(B.focusedColIndex),W=!1;if(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(H,G)&&(W=!0),this.options.checkDisabledOnCut&&this._getEditDisabled(H,G)&&(W=!0),
null!=B&&!0!==W){var V;for(A=this.getCellInfo(G),v=0;v<o.length;v++)if(o[v]==A.colID)return;O=""!==A.options.escape?A.options.escape:this.options.escape;if(V="display"==A.options.copyOption?this._getDisplayData(this.getRealRowIndex(H),G):this.dataList.getCellData(H,G),O+""=="true"&&(V=WebSquare.xml._encode(V+"")),""!==V){N={oldValue:V,newValue:"",rowIndex:H,colIndex:B.focusedColIndex,colId:this.getColumnID(B.focusedColIndex)};u.B.fireEvent(this,"onviewchange",N)}this.dataList.setCellData(H,G,""),p.push([V])}}if(!e){var q=Papa.unparse(p,{delimiter:"\t"});h.setData("Text",q)}}u.B.preventDefault(t)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.clickRightButtonCell=function(t){for(var e=r.D.getDataPrefix("header_id"),i=r.D.getDataPrefix("colIndex"),o=r.D.getDataPrefix("tdIndex"),s=r.D.getDataPrefix("rowIndex"),a=u.B.getTarget(t);a&&"TD"!=a.tagName&&"TH"!=a.tagName&&"DIV"!=a.tagName;)a=a.parentNode;var n=a&&this.hasClass(a,this.options.headerTdClass);if(a&&this.hasClass(a,this.options.bodyTdClass)&&(n=!1),n)u.B.preventDefault(t),u.B.fireEvent(this,"onheaderrightbuttonclick",a.getAttribute(e));else{for(var l=a;l;){if("TH"===l.tagName&&this.hasClass(l,this.options.headerTdClass)){n=!0;break}if("TD"===l.tagName&&this.hasClass(l,this.options.bodyTdClass)){n=!1;break}if("DIV"===l.tagName&&this.hasClass(l,"w2grid_dataLayer")&&0===this.getRowCount()){n=!1;break}l=l.parentNode}a=l}var h,d,p,c,g,f,m=null!=this.editedCell;if(!n&&m&&(h=this.editedCell.editRowIndex,d=this._dataList.getColumnIndex(this.editedCell.id),I=this.getCellInfo(this.editedCell.id),p=this.getColumnIndex(this.editedCell.id),c=this._grid.getRealRowIndex(h),g=this._dataList.dataArr[c*this._dataList.getColumnCount()+d],f=I.comp&&I.comp.selectedIndex),n&&this.options.useHeaderContextMenu){var y=void 0,b=-1,w=parseInt(a.getAttribute(i),10)-this.defaultColCnt;(T={}).result=y,T.rowIndex=b,T.colIndex=w,T.event=t;var v=[];if(this.focusedCell)for(var C=0;C<this.focusedCell.length;C++)v.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});T.focusedCell=v,(L={isHeader:!0}).headerId=a.getAttribute(e),(k=u.B.fireEvent(this,"oncontextopen",b,w,v,L))?this.createContextMenu(T,k):this.contextMenu?this.showContextMenu(T):this.createContextMenu(T)}else if(a&&"TD"==a.tagName&&this.hasClass(a,this.options.bodyTdClass)){var I;if(!1===(y=this.__setFocusedCell(t,a,{allowContextMenuMultiCell:this.options.allowContextMenuMultiCell}))){if(this.focusedCell.length>0)for(C=0;C<this.focusedCell.length;C++)this._applyFocusedCellOut(this.focusedCell[C]);var _=a.className,x=parseInt(a.getAttribute(o)),S=parseInt(x/this.realRowDataLength);null!=_.match("rowNum")?(b=S,w="rowNum"):null!=_.match("rowStatus")?(b=S,w="rowStatus"):null!=_.match("groupby")?(b="groupby",w=-1):null!=_.match("Subtotal")&&(b="subtotal",w="number"==typeof(w=parseInt(a.getAttribute(i),10))?w:-1)}else a&&(this.hasClass(a,"w2grid_textImage")||this.hasClass(a,"w2grid_textImage_image"))?(b=parseInt(a.getAttribute(s),10),w=parseInt(a.getAttribute(i),10),this._setFocusedCell(b,w)):n?(b=parseInt(a.getAttribute(s),10),w=parseInt(a.getAttribute(i),10)):(b=this.getFocusedRowIndex(),w=this.getFocusedColumnIndex());if(!n&&a&&m){var D=this._dataList.dataArr[c*this._dataList.getColumnCount()+d];if(g!=D){var R={oldValue:g,newValue:D,rowIndex:h,colIndex:p,colId:this.getColumnID(p)};isNaN(f)||(R.oldSelectedIndex=f,R.newSelectedIndex=I&&I.comp&&I.comp.selectedIndex),u.B.fireEvent(this,"onviewchange",R)}}if(this.options.senseReader)("text"!=(I=this.getCellInfo(w)).options.inputType&&"secret"!=I.options.inputType||this.___getEditReadOnly(b,w)||this.options.contextMenu)&&u.B.preventDefault(t);else u.B.preventDefault(t);if(u.B.fireEvent(this,"onrightbuttonclick",this._getGroupbyDisplayRowIndex(b),w,t),this.options.contextMenu){(T={}).result=y,T.rowIndex=b,T.colIndex=w;v=[];if(this.focusedCell)for(C=0;C<this.focusedCell.length;C++)v.push({
rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[C].focusedRowIndex),colIndex:this.focusedCell[C].focusedColIndex});T.focusedCell=v,T.event=t;var L={isHeader:!1};(k=u.B.fireEvent(this,"oncontextopen",this._getGroupbyDisplayRowIndex(b),w,v,L))?this.createContextMenu(T,k):this.contextMenu?this.showContextMenu(T):this.createContextMenu(T)}}else if(a&&"DIV"==a.tagName&&this.hasClass(a,"w2grid_dataLayer")&&0===this.getRowCount()&&(u.B.preventDefault(t),u.B.fireEvent(this,"onrightbuttonclick",-1,-1,t),this.options.contextMenu)){var T;(T={result:!1,rowIndex:-1,colIndex:-1,focusedCell:null}).event=t;var k;L={isHeader:!1};(k=u.B.fireEvent(this,"oncontextopen",-1,-1,null,L))?this.createContextMenu(T,k):this.contextMenu?this.showContextMenu(T):this.createContextMenu(T)}},f.prototype.fireImageClick=function(t,e){var i=this.getCellInfo(e),o=this._getEditDisabled(t,e);if(this.options.useImageClick||0==o){var s=r.D.getGlobalFunction(i.options.imageClickFunction,this.scope_id);"function"==typeof s&&s.call(this,t,e,this.dataList._getCellData(t,e))}},f.prototype.gridHeaderOut=function(t){try{var e=u.B.getTarget(t),i=r.D.getDataPrefix("col_id");if(this.overElem){var o={},a=e.getAttribute(i);if(this.getHeaderInfo(a)){var n=r.D.getDataPrefix("header_id");o.header_id=e.getAttribute(n),o.id=this.overElem.id}u.B.fireEvent(this,"onheadermouseout",o),this.overElem=null}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.gridOut=function(t){var e=u.B.getTarget(t);if(this.overElem&&(e.id==this.id+"_dataLayer"||e.id==this.overElem.id||""==e.id)){if(this.options.rowMouseOver&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),"TD"===this.overElem.tagName){var i=r.D.getDataPrefix("col_id"),o={};this.overElem.getAttribute(i)&&(o.rowIndex=this.getElemRowIndex(this.overElem),o.colIndex=this.getColumnIndex(this.overElem.getAttribute(i))),u.B.fireEvent(this,"onbodymouseout",o)}this.bodyOut(t,this.overElem),this.overElem=null}},f.prototype.addRowOverStyle=function(t){for(var e=r.D.getDataPrefix("trIndex"),i=r.D.getDataPrefix("tdIndex"),o=r.D.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(e));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var s=parseInt(t.getAttribute(e));s>0;)s--,t=r.D.prev(t);var a=r.D.first(t),n=parseInt(a.getAttribute(i));if(!isNaN(n)){n=parseInt(n/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var l=this.options.rowMouseOverColor.wq_trim(),h=""==this.options.selectedCellOverColor?"":this.options.selectedCellOverColor.wq_trim(),d=""==this.options.selectedRowOverColor?"":this.options.selectedRowOverColor.wq_trim(),u=0;u<this.realRowDataLength;u++){var p=this.all_data_td_list[n+u],c=l;if(!(""==d||"row"!=this.options.focusMode&&"both"!=this.options.focusMode||"row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&u<this.options.fixedColumn))for(var g=parseInt(p.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex,m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex){c=d;break}if(""!=h&&("cell"==this.options.focusMode||"both"==this.options.focusMode)){g=parseInt(p.getAttribute(i)),f=parseInt(g/this.realRowDataLength)+this.rowIndex;var y=g%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);for(m=0;m<this.focusedCell.length;m++)if(f==this.focusedCell[m].focusedRowIndex&&y==this.focusedCell[m].focusedColIndex){c=h;break}}if(!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&u<this.options.fixedColumn))if(u<this.defaultColCnt){var b=p.className;((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&b.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||b.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)&&(p.style.backgroundColor=c,r.D.isIEAllVersion(11)&&this.__addClass(p,"w2BackgroundClip"))}else p.style.backgroundColor=c,r.D.isIEAllVersion(11)&&this.__addClass(p,"w2BackgroundClip")
;p.removeAttribute(o)}}}},f.prototype.removeRowOverStyle=function(t,e){if(!(this.options.tooltipHeader&&t&&t.getElementsByTagName("TH").length>0)){for(var i=r.D.getDataPrefix("trIndex"),o=r.D.getDataPrefix("tdIndex"),s=r.D.getDataPrefix("or_bgColor"),a=r.D.getDataPrefix("style_bak");null!=t&&(1!=t.nodeType||null==t.getAttribute(i));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var n=parseInt(t.getAttribute(i));n>0;)n--,t=r.D.prev(t);var l=r.D.first(t),h=parseInt(l.getAttribute(o));if(!isNaN(h)){h=parseInt(h/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var d=0;d<this.realRowDataLength;d++){var u=this.all_data_td_list[h+d];if(d<this.defaultColCnt){var p=u.className;if((""===this.options.rowNumBackgroundColor||!0===this.options.rowNumRowMouseOverColor)&&p.indexOf(this.options.bodyTdClass+"_rowNumber")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(var c=parseInt(u.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}u.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else u.style.backgroundColor="";else if(p.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(c=parseInt(u.getAttribute(o)),g=parseInt(c/this.realRowDataLength)+this.rowIndex,f=!1,m=0;m<this.focusedCell.length;m++)if(g==this.focusedCell[m].focusedRowIndex){f=!0;break}u.style.backgroundColor=f?this.options.selectedRowColor.wq_trim():""}else u.style.backgroundColor=""}else!0!==e&&(u.style.backgroundColor=u.getAttribute(s)||"");this.hasClass(u,"w2BackgroundClip")&&this.__removeClass(u,"w2BackgroundClip"),!0!==e&&u.removeAttribute(a)}}}}},f.prototype.handleKeyDownEvent=function(t){if(!(this.parentControl&&this.parentControl.options&&"gridViewItemTable"===this.parentControl.options.pluginName||"gridItemTable"===this.parentControl.options.pluginName)&&0!=u.B.fireEvent(this,"onkeydown",t)){this.lastEvent=t;var e=WebSquare.event.getTarget(t);if(this.headerFocus);else{var i,o;if(e&&(e.className.match("w2grid_head_sort_div_main_btn")||e.className.match("w2grid_customFilter_open")))for(var s=e;s;){if("TH"===s.tagName&&this.hasClass(s,this.options.headerTdClass)){var a=WebSquare.util.getDataPrefix("header_id");i=s.getAttribute(a),e.className.match("w2grid_head_sort_div_main_btn")?o="sort":e.className.match("w2grid_customFilter_open")&&(o="filter");break}s=s.parentNode}if(!t.shiftKey&&9==t.keyCode&&i&&this.options.senseReader&&i===this._lastHeaderElementId&&o===this._lastHeaderElementType)this._setFirsCellFocus(t);else{if(e&&e.className.match("w2grid_start_div")&&this.options.senseReader&&"none"===this.options.focusMode)return;this.handleBodyKeyDown(t)}}}},f.prototype.handleKeyUpEvent=function(t){try{if(0==u.B.fireEvent(this,"onkeyup",t))return;if(this.lastEvent=t,this.editedCell&&this.editedCell._getEditedValue){var e=this.editedCell.options.inputType;if("custom"===e&&!this.editedCell.internal&&this.editedCell.editRowIndex){var i=this.getRealRowIndex(this.editedCell.editRowIndex);e=this.editedCell.cellManagerHashByRowIndex[i].options.inputType}if("text"===e||"textarea"===e||"calendar"===e||"textImage"===e||"secret"===e){var o=t.charCode?t.charCode:t.keyCode,a={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:e,keyCode:o};u.B.fireEvent(this,"oneditkeyup",a)}}else null!=this.beforeEditedCellInfo&&u.B.fireEvent(this,"oneditkeyup",this.beforeEditedCellInfo);if(this.beforeEditedCellInfo=null,!0===this.options.accessibility)for(var r=this.event.getTargetIterator(t,this.render);r.next();)r.match(this.options.bodyTdClass)&&r.stop(),r.match(this.options.headerTdClass)&&(this.removeFocusedCell(),r.stop())}catch(t){
s.w.printStackTrace(t,null,this)}},f.prototype.headerOver=function(t,e){if(!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=e.offsetWidth;if(!(i<2)&&e.firstChild){var o=r.D.getDataPrefix("col_id"),a=e.getAttribute(o),n=null;if(a){var l=this.getHeaderInfo(a),h=(f=this.getHeaderInputType(a),l.options.embeddedInput);if(h&&"text"==f){var d=this.getElemRowIndex(e),u=this.getColumnIndex(e.getAttribute(o));h=!this._getEditDisabled(d,u)&&!this.___getEditReadOnly(d,u)}if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)n=e.getElementsByTagName("th")[0];else{var c=this.event.getTargetIterator(t),g="w2grid_textImage_image";for("true"===l.options.viewTypeIconImage&&("autoComplete"==f?g=this.options.bodyTdClass+"_autoComplete_img":"calendar"==f&&(g=this.options.bodyTdClass+"_calendar_div_img"));c.next();)if(c.match(null,null,"th")&&c.getElement().id){n=this.hasClass(e,g)?e.previousSibling:e,e=c.getElement();break}}}else var f="text";if("text"==f||"textarea"==f||"textImage"==f||"link"==f||"calendar"==f||"expression"==f||"select"==f&&!h||"drilldown"==f||"autoComplete"==f||"checkcombobox"==f||"button"==f||this.options.showImageTooltip&&"image"==f){var m;"textarea"==f?(m=e.cloneNode(!0)).firstChild.style.width="":m=n||e;var y=i,b=e.offsetHeight,w=WebSquare.style.getStyle(e,"text-overflow"),v=20,C=b+3;try{this.options.tooltipPositionX&&(v=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(y,b)),this.options.tooltipPositionY&&(C=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(y,b))}catch(t){p.k.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.w.printStackTrace(t,null,this)}this.options.tooltipShowAlwaysColumns;if(this.options.tooltipHeaderShowAlways){var I=WebSquare.style.getAbsoluteLeft(e)+v,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h)x=m.firstChild.value;else if("link"==f)"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),x=m.firstChild.innerHTML;else if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)x="NOBR"==n.firstChild.tagName||"SPAN"==n.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?m.firstChild.innerHTML:m.innerHTML;else if("image"==f)x=m.firstChild.innerHTML;else if("drilldown"==f)x="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else{x="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),"TABLE"==e.firstChild.tagName&&"sort"==e.firstChild.getAttribute("sort")&&x.split("\t")&&x.split("\t").length>1&&(x=x.split("\t")[0])}if(this.options.tooltipFormatterHeader)try{if("function"==typeof(F=r.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.w.printStackTrace(t,null,this)}""!=x&&this.showTooltip(I,_,x,C)}else if("ellipsis"==w){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=m.className,"text"==f&&h?(this.toolTipRuler.innerHTML="<div>"+m.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(m.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(m.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(m.firstChild,"font-weight")):(this.toolTipRuler.innerHTML=m.innerHTML,
this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(m,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(m,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(m,"font-weight"));var S=this.toolTipRuler.firstChild.offsetWidth;if("textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage)var D=n.clientWidth;else D=e.clientWidth;if(3!=m.firstChild.nodeType){var R=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),L=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");S-=parseInt(R||"0",10),S-=parseInt(L||"0",10),"textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage?(D-=parseInt(WebSquare.style.getStyle(n.firstChild,"padding-left"),10),D-=parseInt(WebSquare.style.getStyle(n.firstChild,"padding-right"),10),D-=parseInt(WebSquare.style.getStyle(n,"padding-left"),10),D-=parseInt(WebSquare.style.getStyle(n,"padding-right"),10)):(D-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),D-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),D-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),D-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(D<S||"image"==f||D==S&&e.clientWidth<e.scrollWidth){I=WebSquare.style.getAbsoluteLeft(e)+v,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h?x=m.firstChild.value:"link"==f?("NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),x=m.firstChild.innerHTML):x="textImage"==f||("autoComplete"==f||"calendar"==f)&&"true"==l.options.viewTypeIconImage?"NOBR"==n.firstChild.tagName||"SPAN"==n.firstChild.tagName&&n.firstChild.className.indexOf("w2grid_span")>-1?m.firstChild.innerHTML:m.innerHTML:"image"==f?m.firstChild.innerHTML:"drilldown"==f?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatterHeader)try{if("function"==typeof(F=r.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.w.printStackTrace(t,null,this)}x.match('href=""')&&(x=x.wq_replaceAll('href=""',"")),this.showTooltip(I,_,x,C)}else this.render.removeChild(this.toolTipRuler)}else{var T=e.firstChild.offsetWidth;if(!0===this.options.showSortableImage){var k=e.firstChild.getElementsByTagName(this.options.dataTag)[0];k&&("NOBR"==k.tagName||"SPAN"==k.tagName&&k.className.indexOf("w2grid_span")>-1)&&(T=k.offsetWidth+parseInt(WebSquare.style.getStyle(e.firstChild,"margin-left"),10))}if(i+3<T){I=WebSquare.style.getAbsoluteLeft(e)+v,_=WebSquare.style.getAbsoluteTop(e)+C,x="";if("text"==f&&h?x=m.firstChild.value:"link"==f?("NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span"),x=m.firstChild.innerHTML):x="image"==f?m.firstChild.innerHTML:"drilldown"==f?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?m.firstChild.innerHTML:m.innerText.wq_trim(),this.options.tooltipFormatterHeader)try{var F;if("function"==typeof(F=r.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=F(e.getAttribute(o),x)}catch(t){s.w.printStackTrace(t,null,this)}this.showTooltip(I,_,x,C)}}}}}},f.prototype.bodyOver=function(t,e){var i=r.D.getDataPrefix("col_id");if(this.options.rowStatusTooltipDisplay&&e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0){
var o=c=e.offsetWidth,a="",n=20,l=(x=e.offsetHeight)+3;try{this.options.tooltipPositionX&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(o,x)),this.options.tooltipPositionY&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(o,x))}catch(t){p.k.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.w.printStackTrace(t,null,this)}var h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,u=this.getElemRowIndex(e);switch(this.getRowStatus(u)){case"C":a=WebSquare.language.getMessage("Grid_rowStatus_insert");break;case"R":a=WebSquare.language.getMessage("Grid_rowStatus_initialValue");break;case"U":a=WebSquare.language.getMessage("Grid_rowStatus_update");break;case"D":a=WebSquare.language.getMessage("Grid_rowStatus_delete");break;case"V":a=WebSquare.language.getMessage("Grid_rowStatus_D_After_C");break;default:return}this.options.tooltipFormatter&&(a=this._showTooltopFormatter(e.id,a,!0)),""!=a&&this.showTooltip(h,d,a,l)}else{if(!this.options.tooltipDisplay)return;if(e.className.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)return;var c;if((c=e.offsetWidth)<2||!e.firstChild)return;var g=e.getAttribute(i);if(this.options.tooltipDisplayColumn&&g&&-1===this.options.tooltipDisplayColumn.indexOf(g))return;var f=null;if(g){var m=this.getCellInfo(g),y=m.options.escape;if(0==m.internal&&"custom"==m.options.inputType){u=this.getRealRowIndex(this.getElemRowIndex(e));m=m.cellManagerHashByRowIndex[u]?m.cellManagerHashByRowIndex[u]:m}I=m.options.inputType;var b=m.options.embeddedInput;if(b&&"text"==I){u=this.getElemRowIndex(e);var w=this.getColumnIndex(e.getAttribute(i));b=!this._getEditDisabled(u,w)&&!this.___getEditReadOnly(u,w)}if("textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)f=e.getElementsByTagName("td")[0];else{var v=this.event.getTargetIterator(t),C="w2grid_textImage_image";for("true"===m.options.viewTypeIconImage&&("autoComplete"==I?C=this.mainGrid.options.bodyTdClass+"_autoComplete_img":"calendar"==I&&(C=this.mainGrid.options.bodyTdClass+"_calendar_div_img"));v.next();)if(v.match(null,null,"td")&&v.getElement().id){f=this.hasClass(e,C)?e.previousSibling:e,e=v.getElement();break}}}else var I="text";if("checkbox"==I||"radio"==I||"text"==I||"textarea"==I||"textImage"==I||"link"==I||"calendar"==I||"expression"==I||"select"==I||"drilldown"==I||"autoComplete"==I||"checkcombobox"==I||"button"==I||this.options.showImageTooltip&&"image"==I){var _;"textarea"==I?(_=e.cloneNode(!0)).firstChild.style.width="":_=f||e;o=c;var x=e.offsetHeight,S=WebSquare.style.getStyle(e,"text-overflow");n=20,l=x+3;try{this.options.tooltipPositionX&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(o,x)),this.options.tooltipPositionY&&(l=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(o,x))}catch(t){p.k.printLog("An error occurred while applying the tooltipPosistion option. Ignore options and apply default values. ["+this.id+"]"),s.w.printStackTrace(t,null,this)}var D=this.options.tooltipShowAlwaysColumns;if(this.options.tooltipShowAlways||g&&D&&D.indexOf(g)>-1){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,a=""
;if("text"==I&&b)a=_.firstChild.value;else if("link"==I)a="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML;else if("textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage)a="NOBR"==f.firstChild.tagName||"SPAN"==f.firstChild.tagName&&f.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML;else if("image"==I)a=_.firstChild.src;else if("drilldown"==I)a="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else if("select"==I&&"ul"===m.options.tableRender)a=_.innerText.wq_trim();else if("select"==I&&b)a=e.querySelector("select").value;else if("checkbox"==I||"radio"==I){(L=_.getElementsByTagName("label")[0])&&(a=L.innerText)}else a="NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim();if(this.options.tooltipFormatter){var R=c<e.scrollWidth;a=this._showTooltopFormatter(e.id,a,R)}""!=a&&this.showTooltip(h,d,a,l,y)}else if("ellipsis"==S){var L,T;if(("checkbox"==I||"radio"==I)&&!(L=_.getElementsByTagName("label")[0]))return;if(this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=_.className,"text"==I&&b)this.toolTipRuler.innerHTML="<div>"+_.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_.firstChild,"font-weight");else{if("drilldown"==I&&"line"==m.options.depthType){var k=_.getElementsByTagName(this.options.dataTag)[0];("NOBR"==k.tagName||"SPAN"==k.tagName&&k.className.indexOf("w2grid_span")>-1)&&(this.toolTipRuler.innerHTML=k.outerHTML)}else if("checkbox"==I||"radio"==I)this.toolTipRuler.innerHTML=L.outerHTML;else if("select"==I&&b){v=this.event.getTargetIterator(t);for(var F=null;v.next();)if(v.match(this.options.bodyTdClass,null,"td")&&v.getElement().id){F=v.getElement();break}if(null!=F){var A=this.getInput(m,F).dom.select,E=document.createElement("div"),M=document.createElement("select");M.className=A.className;var O=document.createElement("option");O.value=A.value,O.text=A.value,M.add(O),E.appendChild(M),this.toolTipRuler.innerHTML=E.innerHTML,T=A.value}}else this.toolTipRuler.innerHTML=_.innerHTML;this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(_,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(_,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(_,"font-weight")}var N=this.toolTipRuler.firstChild.offsetWidth;if(null!=e.getBoundingClientRect&&(N=this.toolTipRuler.firstChild.getBoundingClientRect().width),"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage){var B=f.clientWidth;null!=e.getBoundingClientRect&&(B=f.getBoundingClientRect().width)}else{B=e.clientWidth;if(null!=e.getBoundingClientRect){var H=(WebSquare.style.getSize(e,"outerwidth")-WebSquare.style.getSize(e,"width"))/2;B=e.getBoundingClientRect().width-H}"drilldown"==I&&"line"==m.options.depthType?B=e.clientWidth-e.firstChild.clientWidth:"checkbox"!=I&&"radio"!=I||(B=e.clientWidth-WebSquare.style.getSize(e.firstChild,"outerMarginWidth"))}if(3!=_.firstChild.nodeType){var G=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),W=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");N-=parseInt(G||"0",10),N-=parseInt(W||"0",10),
"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage?(B-=parseInt(WebSquare.style.getStyle(f.firstChild,"padding-left"),10),B-=parseInt(WebSquare.style.getStyle(f.firstChild,"padding-right"),10),B-=parseInt(WebSquare.style.getStyle(f,"padding-left"),10),B-=parseInt(WebSquare.style.getStyle(f,"padding-right"),10)):(B-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),B-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),B-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),B-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(B<N||"image"==I||B==N&&e.clientWidth<e.scrollWidth){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,a="";a=T||("text"==I&&b?_.firstChild.value:"link"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"textImage"==I||("autoComplete"==I||"calendar"==I)&&"true"==m.options.viewTypeIconImage?"NOBR"==f.firstChild.tagName||"SPAN"==f.firstChild.tagName&&f.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.innerHTML:_.innerHTML:"image"==I?_.firstChild.src:"drilldown"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim()),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatter&&(a=this._showTooltopFormatter(e.id,a,!0)),a.match('href=""')&&(a=a.wq_replaceAll('href=""',"")),this.showTooltip(h,d,a,l,y)}else this.render.removeChild(this.toolTipRuler)}else{if(c+3<e.firstChild.offsetWidth){h=WebSquare.style.getAbsoluteLeft(e)+n,d=WebSquare.style.getAbsoluteTop(e)+l,a="";a="text"==I&&b?_.firstChild.value:"link"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?_.firstChild.firstChild.innerHTML:_.firstChild.innerHTML:"image"==I?_.firstChild.src:"drilldown"==I?"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"SPAN"==e.firstChild.tagName&&e.firstChild.className.indexOf("w2grid_span")>-1||"BUTTON"==e.firstChild.tagName?_.firstChild.innerHTML:_.innerText.wq_trim(),this.options.tooltipFormatter&&(a=this._showTooltopFormatter(e.id,a,!0)),this.showTooltip(h,d,a,l,y)}}}}},f.prototype._showTooltopFormatter=function(t,e,i){try{var o=document.getElementById(t),a=r.D.getDataPrefix("col_id"),n=r.D.getDataPrefix("colindex"),l=r.D.getDataPrefix("trindex"),h=r.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if("function"==typeof h){var d,u,p="body";this.hasClass(o,this.options.subtotalTdClass)?(p="subtotal",d=parseInt(o.parentNode.getAttribute(l),10),u=parseInt(o.getAttribute(n),10)):this.hasClass(o,this.options.footerTdClass)?(p="footer",d=parseInt(o.parentNode.getAttribute("data-trindex"),10),u=parseInt(o.getAttribute(n),10)):(d=this.getElemRowIndex(o),u=this.getColumnIndex(o.getAttribute(a))),e=h(d,u,e,i,p)}return e}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.bodyOut=function(t,e){var i=this;(i.options.tooltipDisplay||i.options.headerTooltipDisplay||this.options.tooltipHeader||i.options.rowStatusTooltipDisplay)&&e&&i.hideTooltip()},f.prototype.showTooltip=function(t,e,i,o,n){if(null==this.editedCell){try{var l=a.v.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(l){var h=r.D.getGlobalFunction(l,this.scope_id),d=!0;if("function"==typeof h&&(d=h(this)),!d)return}}catch(t){s.w.printStackTrace(t)}var p=document.body.scrollWidth,c=this.options.useMobileTooltip&&this.isMobile?"w2grid_mobileTooltip":""
;this.tooltip||(this.tooltip=new WebSquare.uiplugin.output(this.id+"_tooltip",{className:"w2grid_tooltip "+this.options.tooltipClass+c,style:"position:absolute;"+this.options.tooltipStyle}),this.tooltip.parentFrame=this.parentFrame,this.tooltip.writeTo(WebSquare.getBody()),this.tooltip.activate(),"click"===this.options.tooltipHide?this.tooltip.render.onclick=function(){this.style.display="none"}:this.tooltip.render.onmouseover=function(){this.style.display="none"}),"click"===this.options.tooltipHide&&(1==WebSquare.getBody().hasClass("w2drag_activate")?(this.tooltip.render.onclick=null,this.tooltip.render.onmouseover=function(){this.style.display="none"}):(this.tooltip.render.onclick=function(){this.style.display="none"},this.tooltip.render.onmouseover=null)),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",t+"px"),this.tooltip.setStyle("top",e+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip");var g=n?WebSquare.xml._encode(i):i,f=this,m=this.getCellInfo(this.getFocusedColumnIndex()).options.inputType;if(this.options.useMobileTooltip&&(r.D.isMobile()||this.isHammerEnabled())){var y="",b="<button type='button' id='"+this.id+"_mobileTooltipCloseButton' onclick='' class='w2grid_mobileTooltipClose_button'>X</button>";if("link"==m){y="<p id='"+this.id+"_toGoButton'><a href class='w2grid_mobileTooltip_anchor' onClick='event.returnValue=false; return false;'>"+g+"</a></p>";y+=b,this.tooltip.render.innerHTML=y,this.tooltip.event.addListener(this.tooltip.render.querySelector(".w2grid_mobileTooltip_anchor"),"onclick",(function(t){try{var e=f.getFocusedColumnIndex();u.B.fireEvent(f,"oncellclick",f._getGroupbyDisplayRowIndex(f._getFocusedRowIndex()),e,f.getFocusedColumnID())}catch(t){s.w.printStackTrace(t,null,this)}}))}else"text"==m&&(y="<p>"+g+"</p>"+b,this.tooltip.render.innerHTML=y)}else this.tooltip.render.innerHTML=g;u.B.fireEvent(this,"ontooltipshow");var w=this.tooltip.render.offsetTop+this.tooltip.render.offsetHeight+20,v=document.body.scrollHeight;if(null!=WebSquare.BootLoader.fullViewRatio&&(v=document.body.clientHeight+Math.abs(document.body.getBoundingClientRect().top)),w>v){var C=e-(o+this.tooltip.render.offsetHeight);C<0&&(C=0),this.tooltip.setStyle("top",C+"px")}if(document.body.scrollWidth>p){var I=t-(document.body.scrollWidth-p);I<0&&(I=0),this.tooltip.setStyle("left",I+"px")}this.options.tooltipDisplayTime>0&&a.v.setTimer(this.hideTooltip,{key:this.id+"_tooltip_hide_timer",caller:this,delay:this.options.tooltipDisplayTime})}},f.prototype.hideTooltip=function(){this.tooltip&&(this.options.tooltipDisplayTime>0&&a.v.clearTimer(this.id+"_tooltip_hide_timer"),u.B.fireEvent(this,"ontooltiphide"),this.tooltip.setStyle("display","none"))},f.prototype.bodyClick=function(t,e,i){try{var a=this.getLastFocusedCell().focusedTd;this.options.rowMouseOver&&this.removeRowOverStyle(this.lastOverSrc,"grid_body_row_over","grid_body_row");var n=r.D.getDataPrefix("tdIndex"),l=r.D.getDataPrefix("col_id"),h=r.D.getDataPrefix("colIndex"),d=this.rowIndex,p=parseInt(e.getAttribute(n)),c=(E=parseInt(p/this.realRowDataLength))+this.rowIndex,g=e.getAttribute(l),f=this._dataList.getRowPosition(),m=this.getColumnIndex(this._dataList.getColumnPosition()),y=E+d,b=p%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(g&&(U=this.getCellInfo(g)),"number"!=typeof(N=this.dataList.getRealRowIndex(c)))return void(N&&"header"==N.type&&this.toggleGroup(N.groupId));if(this.options.focusDefaultColumn){var w=e.getAttribute("id")||"",v="_headerRowNumber"===w.slice(0,16),C="_headerRowStatus"===w.slice(0,16);if(v||C)return this.__setFocusedCell(t,e,{editMode:!1}),void(C?u.B.fireEvent(this,"onrowstatusclick",y):u.B.fireEvent(this,"onrownumclick",y))}if(null==g)return;this.moveDirection=null;var I=m-b,_=f-y;0==I&&0==_?this.moveDirection="none":(I>0||I<0)&&(_>0||_<0)?this.moveDirection="both":I>0||I<0?this.moveDirection="column":(_>0||_<0)&&(this.moveDirection="row")
;var x=r.D.getDataPrefix("editModeEvent"),S=e.getAttribute(x)||"",D=!1;if(""!=S&&"onsecondclick"==S.toLowerCase()||""==S&&"onsecondclick"==this.options.editModeEvent.toLowerCase())for(var R=0;R<this.focusedCell.length;R++)this.focusedCell[R].focusedRowIndex==y&&this.focusedCell[R].focusedColIndex==b&&(D=!0);U=this.getCellInfo(e);var L,T=!0,k=u.B.getTarget(t);if(!U.options.blockSelect&&("button"!==U.options.inputType||"button"===U.options.inputType&&k&&"TD"===k.tagName)){var F,A=!0;if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&"link"!==U.options.inputType&&(A=!1),this.options.preventMultipleClick&&"checkbox"===U.options.inputType&&k&&"LABEL"===k.tagName&&(A=!1),A){if("enter"===this.options.drilldownToggle&&this.isMobile&&this.isHammerEnabled())if(1==this.focusedCell.length)if((U=this.getCellInfo(this.focusedCell[0].focusedColIndex))&&"drilldown"==U.options.inputType){p=parseInt(e.getAttribute(n));var E=parseInt(p/this.realRowDataLength),M=(g=parseInt(e.getAttribute(h)),y=this._getGroupbyDisplayRowIndex(E+d),b=p%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),this.focusedCell[0].focusedColIndex),O=this.focusedCell[0].focusedRowIndex;if(y===O&&b===M){var N=this.dataList.getRealRowIndex(O);this.toggle(N)}}var B={editMode:"none"==U.options.focusMode,dont_fixScroll:this.options.CellClickFixScrollX};o.x.extend(B,i),F=this.__setFocusedCell(t,e,B)}"multiCell"===F&&(T=!1),U.options.embeddedInput&&(this.focusedByApi=!1)}if(t.altKey&&!0===this.options.contextMenuAltClick)return void this.clickRightButtonCell(t);var H=!0;switch(L=r.D.isIE()?t.srcElement:t.target,U.options.inputType){case"radio":case"checkbox":if("INPUT"!=L.tagName)if(!this.options.checkOnCellClick||"LABEL"==L.tagName||this._getEditDisabled(y,b)||this.___getEditReadOnly(y,b))H=!1;else{var G=e.getElementsByTagName("input")[0];!G||"checkbox"!=U.options.inputType&&G.checked||(G.checked=!G.checked)}break;case"drilldown":this.options.ignoreToggleOnDisabled&&this._getEditDisabled(c,g)&&(H=!1)}var W,V=!1,q=this.isHammerEnabled();if(H&&!(W=this.setCellClickEdit(e))){S=e.getAttribute(x)||U.options.editModeEvent||"";var j=null!=a&&a===e,P=""!=S&&"onclick"==S.toLowerCase()||""==S&&"onclick"==this.options.editModeEvent.toLowerCase()||D;if((!q||j)&&P){if(!this._getEditDisabled(c,g)){p=parseInt(e.getAttribute(n)),E=parseInt(p/this.realRowDataLength),g=parseInt(e.getAttribute(h));var z=e.getAttribute(l);y=this._getGroupbyDisplayRowIndex(E+d),b=p%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.hideTooltip(),!("button"===(U=this.getCellInfo(b)).options.inputType||!U.options.embeddedInput&&("checkbox"===U.options.inputType||"radio"===U.options.inputType)&&this.options.preventMultipleClick)){var X=!1;if(0==U.internal&&"custom"==U.options.inputType)("button"===(Z=U.cellManagerHashByRowIndex[this.getRealRowIndex(y)]?U.cellManagerHashByRowIndex[this.getRealRowIndex(y)]:U).options.inputType||!Z.options.embeddedInput&&("checkbox"===Z.options.inputType||"radio"===Z.options.inputType)&&this.options.preventMultipleClick)&&(X=!0);X||"drilldown"==U.options.inputType&&this.options.ignoreCellClick&&W||u.B.fireEvent(this,"oncellclick",y,b,z)}V=!0}T&&this.setEditMode(e)}}if(!V&&!this._getEditDisabled(c,g)){var U;p=parseInt(e.getAttribute(n)),E=parseInt(p/this.realRowDataLength),g=parseInt(e.getAttribute(h)),z=e.getAttribute(l),y=E+d,b=p%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(q||this.options.tooltipDisplay&&this.isMobile?this.bodyOver(t,e):this.hideTooltip(),!("button"===(U=this.getCellInfo(b)).options.inputType||!U.options.embeddedInput&&("checkbox"===U.options.inputType||"radio"===U.options.inputType&&this.options.preventDuplicateFocusedCell)&&this.options.preventMultipleClick&&!(this.options.checkOnCellClick&&"LABEL"!=L.tagName))){var Z
;if(0==U.internal&&"custom"==U.options.inputType)if("button"===(Z=U.cellManagerHashByRowIndex[this.getRealRowIndex(y)]?U.cellManagerHashByRowIndex[this.getRealRowIndex(y)]:U).options.inputType||!Z.options.embeddedInput&&"checkbox"===Z.options.inputType&&this.options.preventMultipleClick)return;y=this._getGroupbyDisplayRowIndex(y),"drilldown"==U.options.inputType&&this.options.ignoreCellClick?W||u.B.fireEvent(this,"oncellclick",y,b,z):("radio"===U.options.inputType||"checkbox"===U.options.inputType)&&("LABEL"===L.tagName||"TD"===L.tagName)||"link"===U.options.inputType&&this.options.contentCellClick&&"A"!==L.tagName||"link"===U.options.inputType&&this.options.useMobileTooltip&&(q||this.options.tooltipDisplay&&this.isMobile)||"image"===U.options.inputType&&this.options.contentCellClick&&"IMG"!==L.tagName||u.B.fireEvent(this,"oncellclick",y,b,z)}}}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.bodyDblClick=function(t,e){var i=r.D.getDataPrefix("tdIndex"),o=r.D.getDataPrefix("col_id"),s=r.D.getDataPrefix("editModeEvent");if("INPUT"==e.tagName)var a=this.getLastFocusedCell(),n=a.focusedRowIndex,l=a.focusedColIndex;else{var h=parseInt(e.getAttribute(i));n=parseInt(h/this.realRowDataLength)+this.rowIndex,l=e.getAttribute(o)}if(null!=l){var d=e.getAttribute(s)||"";if((""!=d&&"ondblclick"==d.toLowerCase()||""==d&&"ondblclick"==this.options.editModeEvent.toLowerCase())&&this.setEditMode(e),!this._getEditDisabled(n,l)){this.rollbackCommitFlag=!1;var p=this.isHammerEnabled(),c=this.getCellInfo(l);if(p||c.options.blockSelect)u.B.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(n),this.getColumnIndex(l),this.getColumnID(l));else{var g=this.getFocusedColumnIndex();u.B.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(this._getFocusedRowIndex()),g,this.getColumnID(g))}this.rollbackCommitFlag=!0}}},f.prototype.headerClick=function(t,e,i){this.focusedByApi=!1,this.options.tooltipHeader&&this.hideTooltip();var o=r.D.getDataPrefix("header_id"),s=r.D.getDataPrefix("sortable"),a=e.getAttribute(o);if((this.options.preventMultipleClick||this.options.senseReader)&&this.headerInfoHash[a]&&this.headerInfoHash[a].options&&"checkbox"===this.headerInfoHash[a].options.inputType||1!=this._getHeaderDisabled(a)&&u.B.fireEvent(this,"onheaderclick",a),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i),1==this.noevent);else if(this.getDataLength()>0&&"onclick"==this.options.sortEvent&&(this.options.sortable||"true"==e.getAttribute(s))&&!this.groupbyStatus.grouped&&(this.fireSortEvent(t,e),this.options.sortHeaderDiv)){var n=e.getElementsByTagName("button");if(n.length>0){var l=n[n.length-1];if(!0!==this.options.accessibility){var h=this.getElementById(this.id+"_scrollX_div"),d=this.getElementById(this.id+"_scrollX_right").scrollLeft;if(h.offsetHeight){d=this.getElementById(this.id+"_scrollX_right").scrollLeft;for(var p=parseInt(e.getAttribute("colSpan"))||1,c=this.headerToBodyRelation[a],g=this.getColumnIndex(c),f=e.offsetWidth,m=this.colWidthList[g],y=1;y<p;y++)m+=this.colWidthList[g+y];var b=this.getColumnIndex(c)+p-1,w=0;for(y=0;y<=b;y++)w+=this.colWidthList[y];var v=w-(d+h.offsetWidth);v>0?this.setScrollLeft(d+v):f<m&&this.setScrollLeft(d-(m-f))}}r.D.requestAnimationFrame((function(){l.focus()})),1==this.options.senseReader&&this.addGridScroll(0-this.rowIndex)}}this.noevent=!1},f.prototype.headerDdlClick=function(t,e){var i=r.D.getDataPrefix("header_id"),o=r.D.getDataPrefix("sortable");u.B.fireEvent(this,"onheaderdblclick",e.getAttribute(i)),this.getDataLength()>0&&("ondblclick"!=this.options.sortEvent||!this.options.sortable&&"true"!=e.getAttribute(o)||this.groupbyStatus.grouped||this.fireSortEvent(t,e)),this.groupbyStatus.grouped&&this.options.sortable||(this.noevent=!1)},f.prototype.fireGroupByRangeSortEvent=function(t,e){try{return}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.recursiveRangeSort=function(t,e,i){try{return}catch(t){s.w.printStackTrace(t,null,this)}},
f.prototype.fireSortEvent=function(t,e){if(!e.disabled&&!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=r.D.getDataPrefix("header_id"),o=e.getAttribute(i);if("false"!==this.getHeaderConfigValue(e,o,"sortable")){var s=this.headerToBodyRelation[o],a=r.D.getDataPrefix("orderByColumn"),n=e.getAttribute(a);n&&this.bodyIdColIndexMap[n]&&(s=n);var l=this.options.useCtrlOnMultisort?t.ctrlKey||t.metaKey:!(t.ctrlKey||t.metaKey);this.options.preventMultisort&&(l=!1);var h=this.cellInfoHash[s];if("gridView"!=this.initializeType||"expression"!=h.options.inputType||"true"==h.options.expressionSort){if(null==this.headerSortStatusArr&&(this.headerSortStatusArr=[]),this.headerSortStatusArr[s]){if(this.options.noSortInit?-1==this.headerSortStatusArr[s].sortOrder?this.headerSortStatusArr[s].sortOrder=1:this.headerSortStatusArr[s].sortOrder=-1:this.options.sortOrderReverse?this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder+3)%3-1:this.headerSortStatusArr[s].sortOrder=(this.headerSortStatusArr[s].sortOrder-3)%3+1,!l){var d=this.headerSortStatusArr[s];this.clearHeaderSort(),this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[0]}}else{if(this.headerSortStatusArr.length>0&&l){if(isNaN(this._grid._dataList.getColumnIndex(s)))return void p.k.printLog("fake columns do not supported multiple sort.["+this.id+"]");for(var c=0;c<this.headerSortStatusArr.length;c++)if(isNaN(this._grid._dataList.getColumnIndex(this.headerSortStatusArr[c].colID)))return void p.k.printLog("fake columns do not supported multiple sort.["+this.id+"]")}(d={}).headerId=o,d.colID=s,this.options.sortOrderReverse?d.sortOrder=-1:d.sortOrder=1;h=this.getCellInfo(s);var g=this.getColumnOption(h.options.col_id,"dataType"),f=this._dataList.getCellInfo(s).options.dataType;d.dataType="number"==g||"bigDecimal"===g||"float"==g?g:f,l?(this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[this.headerSortStatusArr.length-1]):(this.clearHeaderSort(),this.headerSortStatusArr.push(d),this.headerSortStatusArr[s]=this.headerSortStatusArr[0])}var m=[],y=[],b=(g=[],{});if(b.headerId=o,b.bodyColId=s,b.sortOrder=this.headerSortStatusArr[s].sortOrder,0==this.headerSortStatusArr.length)this.dataList.clearSortFilter();else{for(c=this.headerSortStatusArr.length-1;c>=0;c--)if(0==this.headerSortStatusArr[c].sortOrder){var w=this.headerSortStatusArr[c].colID;if(this.setHeaderSortImage(o,0,0),this.headerSortStatusArr.splice(c,1),delete this.headerSortStatusArr[w],0==this.headerSortStatusArr.length)return u.B.fireEvent(this,"onbeforesort",b),this.dataList.clearSort(),void u.B.fireEvent(this,"onsort",b)}else m.push(this.headerSortStatusArr[c].colID),y.push(this.headerSortStatusArr[c].sortOrder),g.push(this.headerSortStatusArr[c].dataType);if(m.reverse(),y.reverse(),g.reverse(),0==u.B.fireEvent(this,"onbeforesort",b))return;this.dataList.setFilter({type:"sort",sortIndex:m.join(" "),sortOrder:y.join(" "),dataType:g.join(" "),focuseMode:this.options.filterFocusMode,ignoreEmptyStringOnSort:this.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:this.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:this.options.setEmptyStringSortableOnSort})}this.drawHeaderSortImages(),u.B.fireEvent(this,"onsort",b)}}}},f.prototype.footerClick=function(t,e,i){var o=r.D.getDataPrefix("footer_id");u.B.fireEvent(this,"onfooterclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},f.prototype.footerDblClick=function(t,e,i){var o=r.D.getDataPrefix("footer_id");u.B.fireEvent(this,"onfooterdblclick",e.getAttribute(o)),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)},f.prototype.subtotalClick=function(t,e,i){try{
for(var o=e.getAttribute("id"),a=r.D.getDataPrefix("targetcolumnid"),n=e.parentNode.getAttribute(a),l=0,h=-1,d=0;d<this.subtotalRowHash[n].length;d++)if(this.subtotalRowHash[n][d]===e.parentNode){h=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(h>-1){var p=this._dataList.getCellData(h,n);for(l=h-1;this._dataList.getCellData(l,n)==p&&l>=0;l--);l++}var c={colID:o,startRowIndex:l,endRowIndex:h,element:e};u.B.fireEvent(this,"onsubtotalclick",c),null!=this.editedCell&&this.editedCell.handleEndEdit(t,void 0,i)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.subtotalDblClick=function(t,e){try{for(var i=e.getAttribute("id"),o=r.D.getDataPrefix("targetcolumnid"),a=e.parentNode.getAttribute(o),n=0,l=-1,h=0;h<this.subtotalRowHash[a].length;h++)if(this.subtotalRowHash[a][h]===e.parentNode){l=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(l>-1){var d=this._dataList.getCellData(l,a);for(n=l-1;this._dataList.getCellData(n,a)==d&&n>=0;n--);n++}var p={colID:i,startRowIndex:n,endRowIndex:l,element:e};u.B.fireEvent(this,"onsubtotaldblclick",p)}catch(t){s.w.printStackTrace(t,null,this)}},f.prototype.handleTouchStart=function(t){!this.isHammerEnabled()&&this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),a.v.clearTimer(this.id+"_iScroll_slideX");var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;(e||i)&&(this.iScrollAddMoveClass(),this.iScroll.moveDirection=null,this.iScroll.propagation=null,this.iScroll.prevTouches=[{x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY}],a.v.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime}))},f.prototype.handleTouchMove=function(t){if("pass"!=this.iScroll.propagation){this.iScroll.addMoveClass&&(this.iScrollAddMoveClass(),this.iScroll.addMoveClass=!1);var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;if(e||i){var o=this.scrollX_right,s=this.getElementById(this.id+"_scrollY_div");this.iScroll.prevTouches.push({x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY});var r=this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2),n=r[0].x-r[1].x,l=r[0].y-r[1].y,h=this.iScroll.moveDirection;if(h||(h=this.iScroll.moveDirection=Math.abs(l)>=Math.abs(n)?"Y":"X",this.iScroll.moveDistance=Math.abs(l)>=Math.abs(n)?Math.abs(l):Math.abs(n)),this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===h)return void u.B.stopEvent(t);var d=this.hasSubtotal&&this.lastSubtotalRow&&"none"==this.lastSubtotalRow.style.display;if("X"==h&&n<0&&0==o.scrollLeft||"X"==h&&n>0&&o.scrollLeft>=o.firstChild.offsetWidth-o.offsetWidth||"Y"==h&&l<0&&0==s.scrollTop||"Y"==h&&l>0&&this.rowIndex+this.lastIndex+1==this.getDataLength()&&!d||"Y"==h&&this.hasClass("w2grid_adaptive_crosstab")||"Y"==h&&0===this.getDataLength())return void("stop"==this.iScroll.propagation?u.B.stopEvent(t):(this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"));"X"==h?this.moveXScroll(n):this.moveYScroll(l),this.iScroll.propagation="stop",u.B.stopEvent(t),a.v.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.addMoveClass=!0}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime})}}},f.prototype.handleTouchEnd=function(t){if(this.isMobile||window.navigator.msPointerEnabled&&this.iScroll.prevTouches&&"touch"==t.pointerType){a.v.clearTimer(this.id+"_iScroll"),this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2);var e=this.iScroll.prevTouches;if(e.length>=2){var i=e[0].x-e[1].x;if(this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===this.iScroll.moveDirection){var o=this.getElementById(this.id+"_body_tbody"),s=o.firstChild.offsetWidth,r=0;return i>0?r=Math.ceil(i/s)*s:i<0&&(r=Math.floor(i/s)*s),
void(o.scrollLeft=Math.floor((o.scrollLeft+r)/s)*s)}var n=new Date;this.slideX(i,n)}else this.iScrollRemoveMoveClass()}},f.prototype.iScrollAddMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__addClass(t,"w2grid_iScrollX_move"),this.__addClass(e,"w2grid_iScrollY_move")},f.prototype.iScrollRemoveMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__removeClass(t,"w2grid_iScrollX_move"),this.__removeClass(e,"w2grid_iScrollY_move")},f.prototype.moveXScroll=function(t){var e=this.getElementById(this.id+"_iScrollX"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_scrollX_left"),s=this.scrollX_right;s.scrollLeft+=t;var a=parseInt(o.style.width,10),r=s.firstChild.offsetWidth-s.offsetWidth,n=parseInt(s.offsetWidth*s.offsetWidth/s.firstChild.offsetWidth,10);e.style.width=(n<30?30:n)+"px",e.style.left=a+s.scrollLeft/r*(i.offsetWidth-a-e.offsetWidth)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},f.prototype.slideX=function(t,e){var i=new Date,o=parseInt(t/3,10);this.moveXScroll(o),t-=o,Math.abs(t)>=0&&i-e<this.options.iScrollSlideTime?(a.v.clearTimer(this.id+"_iScroll_slideX"),a.v.setTimer(this.slideX,{key:this.id+"_iScroll_slideX",caller:this,delay:this.options.iScrollSlidePeriod,args:[t,e]})):this.iScrollRemoveMoveClass()},f.prototype.moveYScroll=function(t){t*=parseInt(this.options.touchScrollDelta,10)||5;var e=this.getElementById(this.id+"_iScrollY"),i=this.getElementById(this.id+"_scrollY_div");i.scrollTop+=t;var o=i.firstChild.offsetHeight,s=this.getElementById(this.id+"_dataLayer"),a=o-s.offsetHeight,r=parseInt(s.offsetHeight*s.offsetHeight/o,10);e.style.height=(r<30?30:r)+"px",e.style.top=i.scrollTop/a*(s.offsetHeight-e.offsetHeight)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},f.prototype.tbodyMoveXScroll=function(t){if(this.editedCell&&this.editedCell.handleEndEdit(),!this.mobile&&this.options.scrollByColumnAdaptive,this.options.adaptiveSlideHeader){var e=this.options.adaptive,i=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==e&&!(r.D.isIE()&&parseInt(a.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=i&&this.slideHeadObj&&"absolute"==this.slideHeadObj.render.style.position){this.slideHeadObj.hidden&&($(this.slideHeadObj.render.firstChild).animate({width:"show"}),this.slideHeadObj.hidden=!1);var o=this;!function t(){r.D.setTimeout((function(){null!=WebSquare.userTimerHash[o.id+"_adaptiveSlideHeader"]?(r.D.clearTimeout(o.id+"_adaptiveSlideHeader"),t()):o.slideHeadObj.hidden||($(o.slideHeadObj.render.firstChild).animate({width:"hide"}),o.slideHeadObj.hidden=!0)}),{delay:1e3,key:o.id+"_adaptiveSlideHeader"})}()}}};var m=function(){};m.prototype.nonCharKeys={4:"insert",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",9:"tab",13:"enter",46:"del",16:"shift",17:"ctrl",18:"alt",21:"hanyoung",25:"hanja",91:"window",20:"capslock",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"numlock",145:"scrolllock"},m.prototype.handleBodyKeyDown=function(t){this.isKeyPressed=!0;for(var e=this.event.getTargetIterator(t,this.render),i=!1;e.next()&&e.element;)e.match(this.options.bodyTdClass)?(i=!1,e.stop()):e.match(this.options.headerTdClass)&&(i=!0,e.stop());if(this.editMode){var o=this.editedCell.options.inputType;switch("text"!==o&&"textarea"!==o&&"calendar"!==o&&"textImage"!==o&&"secret"!==o||(this.beforeEditedCellInfo={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:o,keyCode:t.charCode?t.charCode:t.keyCode}),F=t.keyCode){case 9:if(u.B.stopEvent(t),"down"==this.options.tabKeyMove){
if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;p=!1,"calendar"===o&&(p=this.options.keyMoveEditMode&&"down"==this.options.tabKeyMove);var n=this.editedCell.id}if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,p],{checkFunc:function(t){return t+""!="false"}})){var l=!1;if("down"===this.options.tabKeyMove){var h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);var d=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==d&&null!=h&&null!=d)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}else l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);l||this._setFocusedCell(this.editMode)}break;case 13:if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;var p=!1;r.D.isIEAllVersion()&&"calendar"===o&&(p=this.options.keyMoveEditMode&&"right"!=this.options.enterKeyMove&&"none"!=this.options.enterKeyMove);n=this.editedCell.id;if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}}))if(p){L=this;setTimeout((function(){var e=!1;if("right"==L.options.enterKeyMove||"editRight"==L.options.enterKeyMove)e=L.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=L.options.enterKeyMove&&"edit"!=L.options.enterKeyMove){var i=L.getLastFocusedCell().focusedColIndex;e=L.moveVertical(t,t.shiftKey?"up":"down",L.options.keyMoveEditMode,n);var o=L.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===e?(L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))]),L.focusNextTabOrder()):(!e||i!==o&&null!=i&&null!=o)&&L._fireOnviewchange(n,"_handleEndEdit_focus",[L.getInput(L.getCellInfo(n))])}e||L._setFocusedCell(L.editMode)}),1)}else{l=!1;if("right"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove)l=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=this.options.enterKeyMove&&"edit"!=this.options.enterKeyMove){h=this.getLastFocusedCell().focusedColIndex;l=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,n);d=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===l?(this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))]),this.focusNextTabOrder()):(!l||h!==d&&null!=h&&null!=d)&&this._fireOnviewchange(n,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(n))])}l||this._setFocusedCell(this.editMode)}break;case 27:this.editedCell.handleCancelEdit(t),this._setFocusedCell(),u.B.stopEvent(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){u.B.stopEvent(t);break}this.options.checkEditOnPaste&&this._doPaste()}default:var c={};c.rowIndex=this.editedCell.editRowIndex,c.colIndex=this._dataList.getColumnIndex(this.editedCell.id),c.colID=this.editedCell.id,c.keyCode=t.charCode?t.charCode:t.keyCode,this.editedCell._getEditedValue&&(this.editedCell.beforeEditValue=this.editedCell._getEditedValue()),u.B.fireEvent(this,"oneditkeydown",c)}}else{if(i&&this.removeFocusedCell(),this.options.ignoreKeyCheckFunction){var g=null,f=!1;try{
if("function"==typeof this.options.ignoreKeyCheckFunction?g=this.options.ignoreKeyCheckFunction:"function"==typeof(g=r.D.getGlobalFunction(this.options.ignoreKeyCheckFunction,this.scope_id))&&(this.options.ignoreKeyCheckFunction=g),"function"==typeof g&&(f=g.call(this,t)),f)return void u.B.preventDefault(t)}catch(t){g=null}}var m=r.D.getDataPrefix("tdIndex"),y=(r.D.getDataPrefix("colIndex"),r.D.getDataPrefix("col_id")),b=r.D.getDataPrefix("directItemChoice");if("none"!=this.options.focusMode&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){if(13==t.keyCode&&document.activeElement==this.render&&(this._setFocusedCell(),u.B.stopEvent(t)),"A"!=u.B.getTarget(t).tagName)return;e=this.event.getTargetIterator(t,this.render);for(var w=!1;e.next();)if(e.match(this.options.bodyTdClass)){w=!0;var v=e.getElement(),C=parseInt(v.getAttribute(m)),I=parseInt(C/this.realRowDataLength),_=v.getAttribute(y),x=this.getColumnIndex(_);this.focusedCell.push({focusedTd:v,focusedRowIndex:I,focusedColIndex:x});var S=v.getElementsByTagName("a");if(-1==this.focusedCellLinkIndex)for(var D=0;D<S.length;D++)document.activeElement==S[D]&&(this.focusedCellLinkIndex=D);this.focusedCellLinkLength=S.length;break}if(!w)return}var R=!1;if(a.v.browserCheck.safari&&(t.ctrlKey||t.metaKey)){this.tempEditableCell=document.activeElement,this.tempEditableCell.contentEditable="true",this.tempEditableCell.style.textShadow="0 0 0 "+WebSquare.style.getStyle(this.tempEditableCell,"color"),this.tempEditableCell.style.color="transparent";var L=this;a.v.setTimer((function(){L.tempEditableCell.contentEditable="inherit",this.tempEditableCell.style.color="",this.tempEditableCell.style.textShadow=""}),{key:this.id+"_tempEditableCell_contentEditable",caller:this,delay:500})}switch(t.keyCode){case 37:case 39:if(this.options.moveKeyEditMode){var T=37==t.keyCode?"left":"right";return this.moveHorizontal({byApi:!0},T,this.options.moveKeyEditModeAll),void u.B.stopEvent(t)}case 38:case 40:if(this.skipScrollEndEvent=!1,this.skipScrollStartEvent=!1,this.options.moveKeyEditMode){T=38==t.keyCode?"up":"down";return this.moveVertical({},T,!0),void u.B.stopEvent(t)}case 33:case 34:case 35:case 36:case 9:R=!0;break;case 13:if(this.options.senseReader&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex)if((A=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"image"==A.options.inputType)for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_image")){var k=r.D.getGlobalFunction(A.options.imageClickFunction,this.scope_id);"function"==typeof k&&k.call(this,this.getLastFocusedCell().focusedRowIndex,A.id,this.dataList.getCellData(this.getLastFocusedCell().focusedRowIndex,A.id))}if(this.options.senseReader&&null!=this.getLastFocusedCell().focusedColIndex)if((A=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"select"==A.options.inputType&&"ul"==A.options.tableRender)return this.setEditHtml(t),void u.B.stopEvent(t);R=!0;break;default:R=!1}if(1==R&&"false"==this.options.focusMove){var F=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return;if(9!=F)return}if(this.F2Mode)switch(t.keyCode){case 8:case 46:case 35:case 36:case 37:case 38:case 39:case 40:return}switch(t.keyCode){case 4:break;case 46:this.removeCellData(t),u.B.stopEvent(t);break;case 32:this.doDefaultAction(t);break;case 33:this.movePageUp(t),u.B.stopEvent(t);break;case 34:this.movePageDown(t),u.B.stopEvent(t);break;case 35:this.moveHorizontal(t,"end"),u.B.stopEvent(t);break;case 36:this.moveHorizontal(t,"home"),u.B.stopEvent(t);break;case 37:this.moveHorizontal(t,"left"),u.B.stopEvent(t);break;case 38:this.moveVertical(t,"up"),u.B.stopEvent(t);break;case 39:this.moveHorizontal(t,"right"),u.B.stopEvent(t);break;case 40:this.moveVertical(t,"down"),u.B.stopEvent(t);break;case 9:var A=this.getCellInfo(this.getLastFocusedCell().focusedColIndex)
;if(this.options.senseReader&&A&&"image"==A.options.inputType&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex){u.B.stopPropagation(t);for(e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match("w2grid_image"))if(u.B.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else(this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)||"linear"!=this.options.focusFlow)&&u.B.stopEvent(t)}}else if(u.B.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else{(("down"==this.options.tabKeyMove?this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode):"none"==this.options.tabKeyMove||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode))||"linear"!=this.options.focusFlow)&&u.B.stopEvent(t)}break;case 13:A=this.getCellInfo(this.focusedCell[0].focusedColIndex);var E=this.focusedCell[0].focusedRowIndex,M=this.focusedCell[0].focusedColIndex,O=!0===this.options.senseReader&&WebSquare.util.isIEAllVersion()&&(this.___getEditReadOnly(E,M)||this._getEditDisabled(E,M));if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&A&&"drilldown"==A.options.inputType){var N=this.focusedCell[0].focusedRowIndex,B=this.dataList.getRealRowIndex(N);this.toggle(B);break}if(this.editMode||"autoComplete"!==A.options.inputType&&"select"!==A.options.inputType||!A.options.directOpen)if("edit"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove||"editDown"==this.options.enterKeyMove)this.setEditHtml(t);else if("none"==this.options.enterKeyMove);else if("right"==this.options.enterKeyMove){if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===A.options.inputType)if(!O)(H=this.getInput(A,this.focusedCell[0].focusedTd))&&H.blur();O||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)}else{var H;if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===A.options.inputType)if(!O)(H=this.getInput(A,this.focusedCell[0].focusedTd))&&H.blur();O||this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode)}else"autoComplete"===A.options.inputType&&(A.autoCompleteImageClicked=!0),this.setEditHtml(t);u.B.stopEvent(t);break;case 67:if("native"===this.options.copyType)break;if(t.ctrlKey||t.metaKey){if(r.D.isIEAllVersion())this.handleCopyEvent({});else if(!r.D.isIEAllVersion()&&(a.v.browserCheck.moz||a.v.browserCheck.chrome&&!this.options.preventCopy)){var G=document.activeElement,W=document.createElement("textarea"),L=this,V=document.getElementsByTagName("body")[0];W.oncopy=function(t){L.handleCopyEvent(t),V.removeChild(this),document.activeElement!=G&&G.focus()},W.textContent="temp",V.appendChild(W),W.select();try{document.execCommand("copy")}catch(t){s.w.printStackTrace(t,null,this)}}}else r.D.getBoolean(t.srcElement.getAttribute(b))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 88:if(t.ctrlKey||t.metaKey){if(r.D.isIEAllVersion())this.handleCutEvent({});else if(!r.D.isIEAllVersion()&&(a.v.browserCheck.moz||a.v.browserCheck.chrome)){W=document.createElement("textarea"),L=this,V=document.getElementsByTagName("body")[0];W.oncut=function(t){L.handleCutEvent(t),V.removeChild(this)},W.textContent="temp",V.appendChild(W),W.select();try{document.execCommand("cut")}catch(t){s.w.printStackTrace(t,null,this)}}}else r.D.getBoolean(t.srcElement.getAttribute(b))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){u.B.stopEvent(t);break}this._doPaste()}else{r.D.getBoolean(t.srcElement.getAttribute(b))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}break;case 90:
if(t.ctrlKey);else r.D.getBoolean(t.srcElement.getAttribute(b))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 27:"none"!=this.options.focusMode&&"linear"!=this.options.focusFlow&&(this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1),this.render.focus());break;case 16:case 17:case 18:case 21:case 229:case 25:case 91:case 20:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:break;case 65:if(this.options.useSelectAll&&t.ctrlKey){this.setFocusedMultiCell(0,0,this.getRowCount()-1,this.getColumnCount()-1);break}default:if(!t.ctrlKey&&!t.metaKey&&!t.altKey)r.D.getBoolean(t.srcElement.getAttribute(b))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}}this.isKeyPressed=!1},m.prototype.handleOnfocus=function(t){if(this.getDataLength()>0&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){for(var e=null,i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.colIndexes.bodyColInfo.trIndexArr,s=o[this.defaultColCnt],a=0;a<i.length;a++){var r=i[a];if(!this.hiddenList[a]){for(var n=r.length-1;n>=0;n--){var l=r[n]-this.defaultColCnt;if(o[r[n]]<=s){if(this.options.readOnlyTabIgnore&&this.___getEditReadOnly(0,l))break;if(this.options.ignoreNonEditableCell&&(this.___getEditReadOnly(0,l)||this._getEditDisabled(0,l)))break;e=l;break}}if(null!==e)break}}null!==e&&this._setFocusedCell(0,e)}},m.prototype.removeCellData=function(t){this.handleCutEvent(t,!0)},m.prototype.doDefaultAction=function(t){if("none"==this.options.focusMode){for(var e=u.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;e&&this.getCellInfo(e).doDefaultAction(t)}else this.getCellInfo(this.getLastFocusedCell().focusedColIndex).doDefaultAction(t)},m.prototype.setEditHtml=function(t){var e=u.B.getTarget(t);if(this.options.fastEditMode||"INPUT"==e.tagName||u.B.stopEvent(t),this.focusedCell.length>0){var i=this.focusedCell[this.focusedCell.length-1];null!=i.focusedTd&&this.setEditMode(i.focusedTd)}},m.prototype.getFirstTdTrIndex=function(t){for(var e=t.parentNode,i=r.D.getDataPrefix("trIndex");"0"!=e.getAttribute(i);)e=r.D.prev(e);return e},m.prototype.fixScrollRightDirection=function(){var t=this.getLastFocusedCell(),e=this.getElementById(this.id+"_dataLayer").offsetWidth,i=this.getElementById(this.id+"_scrollX_right");if(t&&t.focusedTd){var o=t.focusedTd.offsetLeft,s=t.focusedTd.offsetWidth+1;r.D.isFF()&&(s-=1),r.D.isOpera()&&(s+=2);var a=o+s-e;if(this.options.lazyDrawHiddenColumn){var n=this.focusedCell[0].focusedTd;if("none"==n.style.display||a>0)if(this.options.scrollByColumn){for(var l=e-this.fixedWidth,h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==t.focusedColIndex){m=h+this.defaultColCnt;break}var d=-1,u=0;r.D.isOpera()&&(u=2);for(var p=m;p>=0;p--)if(!this.hiddenList[p]&&(l-=this.colWidthList[p])<0){d=p;break}p=0;for(this.fixedWidth>0&&(p=this.getFixedColumnLastIndex());p<=d;p++)this.hiddenList[p]||(u+=this.colWidthList[p]);this.scrollXPreventEndEdit=!0,i.scrollLeft=u,this._handleScrollX()}else{var c=r.D.getDataPrefix("colIndex"),g=parseInt(n.getAttribute(c),10),f=0;r.D.isOpera()&&(f=2);for(h=0;h<=g;h++)this.hiddenList[h]||(f+=this.colWidthList[h]);this.scrollXPreventEndEdit=!0,i.scrollLeft=f-e,this._handleScrollX()}}else if(a>0)if(this.options.scrollByColumn){l=e-this.fixedWidth;var m,y=t.focusedColIndex%this.columnOrder.length;for(h=0;h<this.columnOrder.length;h++)if(this.columnOrder[h]==y){m=h+this.defaultColCnt;break}for(d=-1,u=0,p=m;p>=0;p--)if(!this.hiddenList[p])if(0!=this.colIndexes.bodyColInfo.colSpanArr.length){if((l-=this.colWidthList[p]*(this.colIndexes.bodyColInfo.colSpanArr[p]?this.colIndexes.bodyColInfo.colSpanArr[p]:1))<0){d=p;break}}else if((l-=this.colWidthList[p])<0){d=p;break}p=0
;for(this.fixedWidth>0&&(p=this.getFixedColumnLastIndex());p<=d;p++)this.hiddenList[p]||(0!=this.colIndexes.bodyColInfo.colSpanArr.length?u+=this.colWidthList[p]*(this.colIndexes.bodyColInfo.colSpanArr[p]?this.colIndexes.bodyColInfo.colSpanArr[p]:1):u+=this.colWidthList[p]);this.scrollXPreventEndEdit=!0,i.scrollLeft=u,this._handleScrollX()}else this.scrollXPreventEndEdit=!0,i.scrollLeft=i.scrollLeft+a,this._handleScrollX()}},m.prototype.fixScrollLeftDirection=function(){var t=this.getLastFocusedCell();if(t&&t.focusedTd){var e=r.D.getDataPrefix("colIndex"),i=t.focusedTd.getAttribute(e);i=parseInt(i);for(var o=this.getElementById(this.id+"_scrollX_right"),s=0,a=this.getFixedColumnLastIndex();a<i;a++){if(!this.hiddenList[a])s+=this.colWidthList[a]}o.scrollLeft>s&&(this.scrollXPreventEndEdit=!0,o.scrollLeft=s,this._handleScrollX())}},m.prototype.getLeftMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.dataList.getRowCount()||t<0)return i;for(var o=0;o<e.length-this.defaultColCnt;o++){var s=!1,a=this.getCellInfo(o);if(!0!==a.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==a.options.inputType&&this.getCellData(t,o)!=a.options.trueValue){var r=this.getCheckedIndex(a.colID);r?s=r[0]!==t:0!=t&&(s=!0)}if((this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==a.options.inputType||"link"==a.options.inputType)){var n=this.data_td_list[o+(t-this.rowIndex)*this.oneRowDataLength];if(n){var l=n.getElementsByTagName("a");0==l.length&&(l=n.getElementsByTagName("input")),0!=l.length&&(s=!1)}else s=!1}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var h=this.dataList.getCellData(t-1,o),d=this.upperGroupingTest(t,o);h==this.dataList.getCellData(t,o)&&d&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o]&&!s){i=o;break}}}return i},m.prototype.getRightMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.getRowCount()||t<0)return i;for(var o=e.length-1-this.defaultColCnt;o>=0;o--){var s=!1,a=this.getCellInfo(o);if(!0!==a.options.skipKeyMove){if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==a.options.inputType&&this.getCellData(t,o)!=a.options.trueValue){var r=this.getCheckedIndex(a.colID);r?s=r[0]!==t:0!=t&&(s=!0)}if((this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))&&("user"==a.options.inputType||"link"==a.options.inputType))if(t<this.rowIndex)s=!0;else{var n=this.data_td_list[o+(t>=this.rowIndex?t-this.rowIndex:t)*this.oneRowDataLength],l=n.getElementsByTagName("a");0==l.length&&(l=n.getElementsByTagName("input")),s=0==l.length}if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var h=this._dataList.getCellData(t-1,o),d=this.upperGroupingTest(t,o);h==this._dataList.getCellData(t,o)&&d&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o+this.defaultColCnt]&&!s){i=o;break}}}return i},m.prototype.moveHorizontal=function(t,e,i,o){if("false"==this.options.focusMove||"vertical"==this.options.focusMove){o=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return!1;if(9!=o)return!1}var s,a=this.getLastFocusedCell(),n=a.focusedRowIndex,l=a.focusedColIndex,h=(this.colIndexInfo.body.colInfo.colIndexArr,
this._getRealColIndex("body",this.tdIdList[l])+this.defaultColCnt),d=this.colIndexInfo.body.colInfo.colIndexMatch,p=this.columnOrder,c=this.colIndexes.bodyColInfo.trIndexArr,g=c[l+this.defaultColCnt],f=!!t&&9==t.keyCode,m=!!t&&(9==t.keyCode||13==t.keyCode),y=!!t&&t.shiftKey,b=(e=e||"right",0==t||t&&!0===t.byApi);s=1==this.options.moveKeyEditModeAll&&b?!!o&&(37==o||39==o):!!t&&(37<=t.keyCode&&t.keyCode<=40),a.bTrIndex&&(g=a.bTrIndex);var w=null,v=n;if(this.options.focusMultiRow){if("left"==e)var C=h-1,I=this.defaultColCnt-1,_=-1;else if("right"==e)C=h+1,I=d.length,_=1;else if("home"==e)C=this.defaultColCnt,I=d.length,_=1;else C=d.length-1,I=this.defaultColCnt-1,_=-1;for(var x=C;x!=I;x+=_){var S=d[x];if(!this.hiddenList[x]){for(var D=S.length-1;D>=0;D--){var R=S[D]-this.defaultColCnt;if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,R)||this.cellMergeInfo[n+"_"+R])if(!0!==(k=this.getCellInfo(R)).options.skipKeyMove)if(c[S[D]]<=g&&("left"!=e&&"right"!=e||R!=l)){if((this.options.readOnlyTabIgnore||this.options.senseReader)&&this.___getEditReadOnly(n,R))break;if(m&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,R)||this._getEditDisabled(n,R)))break;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[R]].options.colMerge){var L=this.dataList.getCellData(n-1,R),T=this.upperGroupingTest(n,R);if(L==this.dataList.getCellData(n,R)&&T)break}w=R;break}}if(null!==w)break}}}else{var k=this.getCellInfo(l),F=!1;this.options.senseReader&&"user"==k.options.inputType&&this.___getEditReadOnly(n,l)?F=!0:(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0);var A=this.getLocationRowCol(n,l),E=A.rowIndex,M=A.colIndex,O=this.htmlInfo.body.rowAttrArr.length;a.bMovedRow&&(E=a.bMovedRow);var N=E%O;if("left"==e)if(F&&this.focusedCellLinkIndex>0)C=M,I=p.length,_=1;else C=M-1,I=-1,_=-1;else if("right"==e)if(F&&this.focusedCellLinkIndex+1<this.focusedCellLinkLength)C=M,I=p.length,_=1;else{this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0;C=M+A.colSize,I=p.length,_=1}else if("home"==e){C=0,I=p.length,_=1;E-=N}else{C=p.length-1,I=0,_=-1;E=E+O-N-1}for(x=C;;x+=_){if(x==I)if("left"==e&&N>0)x=p.length-1,E--;else{if(!("right"==e&&N<O-1))break;x=0,E++}var B=this.getOriginalRowCol(E,x);if(!B.noLeftTop){_>0&&(_=B.colSize);R=B.colIndex;if(!this.hiddenList[x+this.defaultColCnt])if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,R)||this.cellMergeInfo[n+"_"+R])if(!(k=this.getCellInfo(R)).options.blockSelect&&!0!==k.options.skipKeyMove){if(this.options.senseReader&&"radio"==k.options.inputType&&this.getCellData(n,R)!=k.options.trueValue&&0!=n){if(this.getCheckedIndex(k.colID))continue;if(0!=n)continue}if("left"!=e&&"right"!=e||(F||R!=l)){var H=!1;if(f&&this.___getEditReadOnly(n,R)&&(this.options.readOnlyTabIgnore||this.options.senseReader)){if("user"!=k.options.inputType&&"link"!=k.options.inputType||!this.options.senseReader)continue;var G=this.data_td_list[R+(v-this.rowIndex)*this.oneRowDataLength],W=G.getElementsByTagName("a");if(0==W.length&&(W=G.getElementsByTagName("input")),"right"==e)for(var V=0;V<W.length;V++){if(document.activeElement==W[V]){this.focusedCellLinkIndex=V;break}this.focusedCellLinkIndex=-1}else if("left"==e)for(V=W.length-1;V>-1;V--){if(document.activeElement==W[V]){this.focusedCellLinkIndex=V;break}this.focusedCellLinkIndex=-1}if(!W[0])continue;("right"==e&&this.focusedCellLinkIndex!=W.length-1||"left"==e&&0!=this.focusedCellLinkIndex)&&(H=!0)}if((m||s)&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,R)||this._getEditDisabled(n,R))&&(!f||1!=H))continue;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[R]].options.colMerge){L=this.dataList.getCellData(n-1,R),T=this.upperGroupingTest(n,R);if(L==this.dataList.getCellData(n,R)&&T)continue}w=R;break}if(null!==w)break}}}}if(null===w&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),null!==w){
if(i&&(this.___getEditReadOnly(v,w)||this._getEditDisabled(v,w))&&(i=!1),i&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(w);r.D.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setFocusedCell(n,w,i,{tabDirection:e}),(a=this.getLastFocusedCell()).bTrIndex=g,a.bMovedRow=E,!0}if("linear"==this.options.focusFlow){if(n>0&&y){var q=this.getRightMostFocusableColIndex(n-1);if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&null==q)for(;n>=0&&null==q;){this._setGridBorderNoRefresh=!0;var j=-1;this.hasSubtotal&&(j-=this.getHasSubtotalCount(n-1)),"true"!==this.options.keepScrollForSenseReader&&!0!==this._isBrowserScroll()&&this.addGridScroll(j),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(q=this.getRightMostFocusableColIndex(n-1)),null==q&&(n-=1)}else for(;n>=0&&null==q;)n-=1,q=this.getRightMostFocusableColIndex(n-1);if(null==q)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),n-1<this.rowIndex){this._setGridBorderNoRefresh=!0;j=-1;this.hasSubtotal&&(j-=this.getHasSubtotalCount(n-1)),!0!==this._isBrowserScroll()&&this.addGridScroll(j),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&null!=q&&"all"!=this.options.visibleRowNum&&(q=this.getRightMostFocusableColIndex(n-1))}return"custom"==(k=this.getCellInfo(q)).options.inputType&&n-1>=0&&(v=n-1),i&&(this.___getEditReadOnly(v,q)||this._getEditDisabled(v,q))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)&&r.D.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1),this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,q,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}if("left"==e&&n>0&&!y){for(var P=this.getRightMostFocusableColIndex(n-1);n>0&&null==P;)n-=1,P=this.getRightMostFocusableColIndex(n-1);if(null==P)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(n-1>0&&n==this.rowIndex){this._setGridBorderNoRefresh=!0;j=-1;!0!==this._isBrowserScroll()&&this.addGridScroll(j),this._setGridBorderNoRefresh=!1}if(i&&(this.___getEditReadOnly(v,P)||this._getEditDisabled(v,P))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){k=this.getCellInfo(P);r.D.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,P,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}if("right"!=e||y){if("left"===e&&0===n&&f&&l-1==0){!0===(k=this.getCellInfo(l-1)).options.skipKeyMove&&u.B.preventDefault(t)}}else{if(n<this.getDataLength()-this._getVisibleLastIndex(1)){for(P=this.getLeftMostFocusableColIndex(n+1);n!=this.dataList.getRowCount()&&null==P;)n+=1,P=this.getLeftMostFocusableColIndex(n+1);if(null==P)return this.editedCell&&this.editedCell.handleEndEdit(t),1==this.options.moveKeyEditModeAll&&n==this.dataList.getRowCount()&&document.getElementById(this.id+"_gridend_div").focus(),!1;var z=this._getVisibleLastIndex(this.lastIndex+1);if(n+1>this.rowIndex+z-1){this._setGridBorderNoRefresh=!0;j=1;this.hasSubtotal&&(j+=this.getHasSubtotalCount(n+1)),1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(j+=n-(this.rowIndex+z-1),this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),!0!==this._isBrowserScroll()&&this.addGridScroll(j),this._setGridBorderNoRefresh=!1}if(i)"custom"==(k=this.getCellInfo(P)).options.inputType&&(v=n+1),(this.___getEditReadOnly(v,P)||this._getEditDisabled(v,P))&&(i=!1);if(i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var k=this.getCellInfo(P);r.D.getBoolean(k.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n+1,P,i,{tabDirection:e}),
this._setGridBorderNoRefresh=!1,!0}f&&!0===(k=this.getCellInfo(l+1)).options.skipKeyMove&&u.B.preventDefault(t)}}if(f&&null!=WebSquare.tabOrder[this.id])if(0===h&&0===n&&"left"==e){if(null!=WebSquare.tabOrder[this.id].preTabID&&(X=r.D.getPreTabbableComp(this.id)))return X.focus(),!0}else if(h===d.length-1&&n===this.getDataLength()-this._getVisibleLastIndex(1)&&"right"==e){var X;if(null!=WebSquare.tabOrder[this.id].nextTabID)if(X=r.D.getNextTabbableComp(this.id))return X.focus(),!0}return this.editedCell?(this._setGridBorderNoRefresh=!0,this.editedCell.handleEndEdit(t),this._setGridBorderNoRefresh=!1):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(n,l,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!1},m.prototype.moveVertical=function(t,e,i){if(this.moveDirection="row","false"==this.options.focusMove||"horizontal"==this.options.focusMove)return!1;var o=this.getLastFocusedCell(),s=o.focusedRowIndex,a=o.focusedColIndex,n=this.defaultColCnt,l=this.colIndexInfo.body.colInfo.colIndexArr,h=this.colIndexInfo.body.colInfo.colIndexMatch,d=this.colIndexes.bodyColInfo.trIndexArr,p=this.colIndexes.bodyColInfo.colSpanArr,c=this.colIndexes.bodyColInfo.rowSpanArr,g=l[a+n],f=d[a+n],m=p[a+n],y=c[a+n],b=a,w=s,v=!!t&&13==t.keyCode,C=!!t&&9==t.keyCode,I=this.getDataLength()-this._getVisibleLastIndex(1),_=!1,x=!!(this.oneRowLength>1&&this.options.skipMultiRowMove);if(m&&o.bColIndex&&(g=o.bColIndex),"up"==e)var S=0==f?this.oneRowDataLength-1:a-1,D=-1,R=-1;else S=f+y==this.oneRowLength?0:a+1,D=this.oneRowDataLength,R=1;if(x){for(var L=c[0],T=(L=c[this.defaultColCnt],this.defaultColCnt+1);T<c.length;T++)if(L!=c[T]){x=!1;break}x&&(S=a)}var k=!1;for(T=S;T!=D;T+=R){var F=l[T+n],A=F+(p[T+n]?p[T+n]:1)-1,E=this._getArrayIndexOf(this.columnOrder,l[T+n]-n)+n;if(F<=g&&g<=A&&(!this.hiddenList[E]||k)){if(b=T,E=this._getArrayIndexOf(this.columnOrder,l[b]+1)+this.defaultColCnt,w==I&&"down"==e&&this.hiddenList[E]){k=!0,g++;continue}if(E=this._getArrayIndexOf(this.columnOrder,l[b]-1)+this.defaultColCnt,0==w&&"up"==e&&this.hiddenList[E]){k=!0,g--;continue}if("up"==e){for(var M=s;M>=0;M--)if(w=0==f?M-1:M,x&&(w=0==f?w:w-1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(w))&&(!this.getMerged(w,b)||this.cellMergeInfo[w+"_"+b])){if(this.hiddenCellObj.length>0&&!1===this.getCellVisible(w,b))for(;!1===this.getCellVisible(w,b);){if(0===(H=d[b+this.defaultColCnt])&&w>0){w--;for(var O=!1,N=b+1+n;N<l.length;N++)if(l[N]===a+n&&d[N]===this.oneRowLength-1){b=N-n,O=!0;break}if(!O)break}else if(H>0){for(O=!1,N=b+n;N>=0;N--)if(l[N]===a+n&&d[N]===H-1){b=N-n,O=!0;break}if(!O)break}}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b))break;if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b))break;if(this.oneRowLength>1&&!x){var B=f;for(T=0;T<h[g].length;T++){if(0>--B&&(B=h[g].length-1,0!==f&&w--),b=h[g][B],w<0){j=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b)){j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b)){j=!0;break}}}if(j){j=!1;break}}}else for(M=s;M<=I;M++)if(w=f+y==this.oneRowLength?M+1:M,x&&(w=f+y==this.oneRowLength?w:w+1),(!(this.hiddenRowObj.length>0)||this._getRowVisible(w))&&(!this.getMerged(w,b)||this.cellMergeInfo[w+"_"+b])){if(this.hiddenCellObj.length>0)for(;!1===this.getCellVisible(w,b);){var H;if((H=d[b+this.defaultColCnt])>=this.oneRowLength-1&&w<=I){w++;for(O=!1,N=n;N<l.length;N++)if(l[N]===a+n&&0===d[N]){b=N-n,O=!0;break}if(!O)break}else if(H<this.oneRowLength-1){for(O=!1,N=b+1+n;N<l.length;N++)if(l[N]===a+n&&d[N]===H+1){b=N-n,O=!0;break}if(!O)break}}
if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b))break;if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b))break;if(this.oneRowLength>1&&!x)for(B=f,T=0;T<h[g].length;T++){if(B++,h[g].length<=B&&(B=0,f+y!==this.oneRowLength&&w++),b=h[g][B],w>I){j=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b)){j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b)){j=!0;break}}if(j){j=!1;break}}break}}if(0<=w&&w<=I&&(s!=w||a!=b)){if(u.B.stopEvent(t),i&&(this.___getEditReadOnly(w,b)||this._getEditDisabled(w,b))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var G=this.getCellInfo(b);r.D.getBoolean(G.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(w,b,i,{tabDirection:e})&&((o=this.getLastFocusedCell()).bColIndex=g,!0)}if("linear"==this.options.focusFlow){var W=!1;if((-1==w&&"up"==e&&0==a||w==I+1&&"down"==e&&null==l[a+n+1]||-1==w&&"up"==e&&-1!==h[0].indexOf(a)&&x||w==I+1&&"down"==e&&-1!==h[this.columnOrder.length-1].indexOf(a)&&x)&&(W=!0),!W&&(-1==w||w==I+1)){var V=this.getLastFocusedCell().focusedTd;if("text"==(G=this.getCellInfo(V)).options.inputType&&G.options.embeddedInput){var q=this.getInput(G,V);this.showFakeInput(q),this.fakeInput.setValue(q.getValue()),this.F2Mode=!1,q.select()}else{var j=!1;if("up"==e&&-1==w&&b-1>-1){for(var P=b-1;null!=l[P+n]&&(!x||-1===h[l[l.length-1]].indexOf(P));P--)if(E=this._getArrayIndexOf(this.columnOrder,P)+this.defaultColCnt,!this.hiddenList[E]){for(var z=I;z>-1;z--){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(z,P)&&!this._getEditDisabled(z,P)){w=z,b=P,j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(z,P)){w=z,b=P,j=!0;break}if(this.oneRowLength>1&&!x){w=z,b=P;var X=l[P+n];for(B=f,T=0;T<h[X].length;T++){if(0>--B&&(B=h[X].length-1),b=h[X][B],w<0){j=!0;break}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b)){j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b)){j=!0;break}}}if(j)break}if(j)break}}else if("down"==e&&w==I+1)for(P=b+1;null!=l[P+n]&&(!x||-1===h[l[n]].indexOf(P));P++)if(E=this._getArrayIndexOf(this.columnOrder,P)+this.defaultColCnt,!this.hiddenList[E]){for(z=0;z<=I;z++){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(z,P)&&!this._getEditDisabled(z,P)){w=z,b=P,j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(z,P)){w=z,b=P,j=!0;break}if(this.oneRowLength>1&&!x){w=z,b=P;for(X=l[P+n],B=f,T=0;T<h[X].length;T++){if(B++,h[X].length<=B&&(B=0),b=h[X][B],!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(w,b)&&!this._getEditDisabled(w,b)){j=!0;break}if(!C&&!v&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(w,b)){j=!0;break}}}if(j)break}if(j)break}if(j){if(u.B.stopEvent(t),i&&(this.___getEditReadOnly(w,b)||this._getEditDisabled(w,b))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){G=this.getCellInfo(b);r.D.getBoolean(G.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(w,b,i,{tabDirection:e})&&((o=this.getLastFocusedCell()).bColIndex=g,!0)}
C&&WebSquare.tabOrder[this.id]&&WebSquare.tabOrder[this.id].nextTabID&&(_=!0)}}}return this.editedCell?this.editedCell.handleEndEdit(t):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(s,a,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!0===_&&"focusNextTabOrder"},m.prototype.moveEnd=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=r.D.getDataPrefix("colIndex");this._moveRight(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),a=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[a+l]){o=!1;break}1==o?this._moveLeft(t):i=!0}this.fixScrollRightDirection()}},m.prototype.moveHome=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(var e=r.D.getDataPrefix("colIndex");this._moveLeft(t););for(var i=!1;!i;){for(var o=!0,s=this.getLastFocusedCell(),a=parseInt(s.focusedTd.getAttribute(e)),n=parseInt(s.focusedTd.getAttribute("colSpan")||1),l=0;l<n;l++)if(0==this.hiddenList[a+l]){o=!1;break}1==o?this._moveRight(t):i=!0}this.fixScrollLeftDirection()}},m.prototype.movePageUp=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(this.rowIndex<=0)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e),this.focusedCell&&this.focusedCell.pop();var s,a=this._getScrollRowIndex(this.rowIndex);return(s=a<this.lastIndex?-1:this._getVisibleRowIndex(a-this.lastIndex))>=0?(this.setTopRowIndex(s),this._setFocusedCell(i+this.rowIndex,o)):(this.setTopRowIndex(0),this._setFocusedCell(0,o)),!0}}},m.prototype.movePageDown=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(null!=this.lastTopRowIndex&&this.rowIndex>=this.lastTopRowIndex)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e);var s=this.rowIndex+this.lastIndex,a=this.getDataLength(),r=a-this._getVisibleLastIndex(1),n=a-this._getVisibleLastIndex(this.lastIndex+1);return s<=n?(this.setTopRowIndex(s),this._setFocusedCell(Math.min(i+this.rowIndex,r),o)):(this.setTopRowIndex(n),this._setFocusedCell(r,o)),!0}}},m.prototype.findTd=function(t,e,i){for(var o=0,s=r.D.getDataPrefix("colIndex");null!=t;){for(var a=r.D.first(t);null!=a;){var n=parseInt(a.getAttribute(s));if(n<=e&&e<=n+a.colSpan-1&&o<=i&&i<=o+a.rowSpan-1)return a;if(n>e)break;a=r.D.next(a)}if(t=r.D.next(t),o>i)break;o++}},m.prototype.pasteFromClipboard=function(){for(var t=this.parseClipboardExcel(),e=this._getFocusedRowIndex(),i=this.getFocusedColumnIndex(),o=[],a=0;a<t.length;a++){o.push([]);for(var r=0;r<t[0].length;r++)o[a][r]=this.dataList._getCellData(a+e,this.getColumnID(r+i))}for(a=0;a<t.length;a++)for(r=0;r<t[0].length;r++){var n=t[a][r];try{n=n.wq_trim();var l=this.getCellInfo(r+i),h=this.mainGrid.getColumnOption(l.options.col_id,"dataType");"number"==h&&(n=n.replace(/[^(\-0-9)]/g,""))}catch(t){s.w.printStackTrace(t,null,this)}1!=this.___getEditReadOnly(a+e,r+i)&&1!=this._getEditDisabled(a+e,r+i,!0)&&this.dataList.__setCellData(a+e,this.getColumnID(r+i),n)}var d=this;WebSquare.historyManager.set("grid","grid1",{focusRowIndex:e,focusColIndex:i,data2d:o},{onRestore:function(t){for(var o=t.data2d,s=0;s<o.length;s++)for(var a=0;a<o[0].length;a++){var r=o[s][a];d.dataList.__setCellData(s+e,this.getColumnID(a+i),r)}}})},m.prototype.parseClipboardExcel=function(){for(var t=[],e=window.clipboardData.getData("Text").split("\n"),i=0;i<e.length-1;i++){var o=e[i].split("\t");t.push(o)}return t},m.prototype.copyToClipboard=function(){var t=this.options.copyAmount;if(t||("cell"==this.options.focusMode?t="cell":"both"!=this.options.focusMode&&"row"!=this.options.focusMode||(t="row")),"cell"==t){for(var e=this.getDataLength(),i=this.getTotalCol(),o=[],s=0;s<this.focusedCell.length;s++){
var a=(u=this.focusedCell[s]).focusedRowIndex,r=u.focusedColIndex;null==o[a]&&(o[a]=[]),o[a][r]=u,e>a&&(e=a),i>r&&(i=r)}var n=[];for(s=e;s<o.length;s++){var l=[];if(void 0!==(p=o[s]))for(var h=i;h<p.length;h++){o[s][h]?l.push(this.dataList._getCellData(s,this.getColumnID(h))):l.push("")}n.push(l.join("\t"))}window.clipboardData.setData("Text",n.join("\n"))}else if("row"==t){var d=[];for(s=0;s<this.focusedCell.length;s++){var u;d[(u=this.focusedCell[s]).focusedRowIndex]=1}var p=[];for(var a in d)p.push(a);p.sort((function(t,e){return parseInt(t)>parseInt(e)?1:-1}));for(o=[],s=0;s<p.length;s++){a=p[s];var c=this.getRowData(a);o.push(c.join("\t"))}window.clipboardData.setData("Text",o.join("\n"))}},m.prototype.getEditCursorEnable=function(t,e){try{if(!t)return!1;var i=u.B.getTarget(t);if(!i)return!1;var o=i.tagName.toUpperCase();if(("INPUT"==o||"TEXTAREA"==o)&&null!=i.value){if(r.D.isIEAllVersion("6 7 8")){var a=document.selection.createRange();if(a.text.length>0)return!0;a.moveStart("character",-i.value.length);var n=a.text.length;if("left"===e){if(n>0)return!0}else if("right"===e&&n<i.value.length)return!0;return!1}if(null!=i.selectionStart&&i.selectionStart!=i.selectionEnd)return!0;if("left"===e){if(i.selectionEnd>0)return!0}else if("right"===e&&i.selectionEnd<i.value.length)return!0}return!1}catch(t){return s.w.printStackTrace(t,null,this),!1}},m.prototype._moveKeyEdit=function(t,e,i){try{if(void 0!==i&&null!=i||(i={}),!(this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.moveKeyEditMode))return;var o=this.uuid,a=WebSquare.idCache[t];a["_"+e]=a[e];var r=i.itemTable,n=i.skipVertical,l=i.skipHorizontal,h=this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.arrowMove;a[e]=function(t,i){this["_"+e]&&this["_"+e](t,i);var s=WebSquare.idCache[o],a=!1;if(s&&s.editedCell){var d=s.getCellInfo(s.editedCell.colID);(s.options.keyMoveEditMode||s.options.moveKeyEditMode||s.options.moveKeyEditModeAll)&&d.options.skipKeyMoveEditMode&&(a=!0);var p=!1;!a||"select"!=d.options.inputType&&"autoComplete"!=d.options.inputType&&"checkcombobox"!=d.options.inputType||(p=!0)}var c={37:"left",38:"up",39:"right",40:"down"}[t.keyCode];if(c)switch(c){case"left":case"right":if(!0!==l&&(r||0==this.getValue().length||h&&!s.getEditCursorEnable(t,c)))s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"&&s.moveHorizontal({byApi:!0},c,!0,t.keyCode),u.B.stopEvent(t);break;case"up":case"down":if(!0!==p&&!0!==n&&(!r||0==this.getItemCount()||this._keyIndex<0||this._keyIndex===this.getItemCount())){if(s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"){var g=!0!==a;s.moveVertical({},c,g,t.keyCode)}u.B.stopEvent(t)}}}}catch(t){s.w.printStackTrace(t,null,this)}},m.prototype._directEdit=function(t){var e=this.focusedCell[this.focusedCell.length-1],i=this.getCellInfo(e.focusedTd);if("textarea"!==i.options.inputType||!this._getEditDisabled(e.focusedRowIndex,e.focusedColIndex)&&!this.___getEditReadOnly(e.focusedRowIndex,e.focusedColIndex)){var o,s=i.comp,a=this.getInput(i);a&&(a.reFocus=!0,a._focusStatus="cancel");var r=s.render.tagName.toLowerCase();(o="input"===r||"textarea"===r?s.render:s.render.getElementsByTagName("input")[0])&&WebSquare.text.setCaretPos(o,o.value.length);var n=t.keyCode,l=null;t.key&&1===t.key.length?l=t.key:!t.shiftKey&&65<=n&&n<=90?(n+=32,l=String.fromCharCode(n)):l=n>=96||n<65?{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"}[n+""]||"":String.fromCharCode(n),"autoComplete"===i.options.inputType?(s.dom.input.value=l,s.inputKeyDown(t)):a&&a.setValueNM(l)}};var y=i(5861),b=i(4687),w=i.n(b),v=i(8402),C=function(t){};C.prototype.initializeDrawController=function(){this.data_td_list=[],this.data_num_td_list=[],this.data_status_td_list=[],this.all_data_td_list=[]},C.prototype.showAllBodyTR=function(t){t=t||""
;for(var e=0;e<this.drawedRowLength;e++)this._setRowDisplay(e,t);this.lastDisplayedRow="none"===t?-1:this.drawedRowLength-1},C.prototype._setRowDisplay=function(t,e){for(var i=null,o=0;o<this.oneRowLength;o++)(i=this.dataRowList[this.oneRowLength*t+o])&&(i.style.display=e,"none"==e?this.__addClass(i,"w2grid_hidedRow"):this.__removeClass(i,"w2grid_hidedRow"));return i},C.prototype.drawColumnData=function(t,e){var i=this._dataList.rowPosition,o=!1;t=this.getColumnIndex(t);var s=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,a=this.getCellInfo(t);if(a.dataComp){var r=this.modelControl.getDataComp(a.dataComp);null!=r&&"linkedDataList"===r.initializeType&&null!=r.conditionInfo&&r.conditionInfo.filterInfo.useRef&&"number"==typeof i&&(o=!0)}for(var n=0;n<=s;n++){var l=n+this.rowIndex;e&&a.select&&a.hasRef&&(a.select.itemArr=a.getRefItemArr(l),a.select.setSelectOptions(),a.select.setValueNM(a.mainGrid._dataList._getData(l,t))||a.mainGrid._dataList._setData(l,t,"")),o&&n===i||this.drawCellData(n,l,t)}o&&this.drawCellData(i,i+this.rowIndex,t)},C.prototype._setMouseOverTr=function(t,e){this.setOverClass(e,"overTd",!0)},C.prototype._setMouseOutTr=function(t,e){this.setOverClass(e,"overTd",!1)},C.prototype.setOverClass=function(t,e,i){for(var o=t.parentNode,s=r.D.getDataPrefix("trIndex"),a=r.D.getDataPrefix("row_out_style"),n=parseInt(o.getAttribute(s));n>0;)n--,o=r.D.prev(o);do{for(var l=r.D.first(o);null!=l&&!(l.offsetLeft>this.render.offsetWidth);)l.offsetWidth>0&&(i?(l.setAttribute(a,l.style.cssText),l.style.cssText=l.style.cssText+";background-color:"+this.options.rowMouseOverColor):l.style.cssText=l.getAttribute(a)),l=r.D.next(l);o=r.D.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},C.prototype.changeFocusedCellPosition=function(t,e,i,o){try{if(0==this.focusedCell.length)return;o=o||{};this.applyFocusedCellOut();for(var a=0;a<this.focusedCell.length;a++){var r=this.focusedCell[a].focusedRowIndex-t,n=this.focusedCell[a].focusedColIndex,l=null;if(this.options.focusDefaultColumn&&n<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode))l=this.all_data_td_list[this.defaultColCnt+n+r*(this.oneRowDataLength+this.defaultColCnt)];else if(this.options.fixedRow>0&&this.options.fixedRow>this.focusedCell[a].focusedRowIndex||this.options.lastFixedRow>0&&this.focusedCell[a].focusedRowIndex>this.lastIndex-this.options.lastFixedRow)l=this.data_td_list[n+this.focusedCell[a].focusedRowIndex*this.oneRowDataLength],this.applyFocusedCellIn(l,e);else if(r<0||r>this.maxRowLength+this.hiddenRowObj.extraRow)l=null;else if(l=this.data_td_list[n+r*this.oneRowDataLength]){var h=this.getCellInfo(n);i&&h.options.embeddedInput&&(e=!1),this.applyFocusedCellIn(l,e,o)}this.focusedCell[a].focusedTd=l}}catch(t){s.w.printStackTrace(t)}},C.prototype.setTRClass=function(t,e,i){for(var o=t.parentNode,s=r.D.getDataPrefix("trIndex"),a=parseInt(o.getAttribute(s));a>0;)a--,o=r.D.prev(o);do{for(var n=r.D.first(o);null!=n;)i?this.addClass(n,e):this.removeClass(n,e),n=r.D.next(n);o=r.D.next(o)}while(null!=o&&"0"!=o.getAttribute(s))},C.prototype.setEditMode=function(t){try{var e=r.D.getDataPrefix("tdIndex"),i=r.D.getDataPrefix("col_id"),o=r.D.getDataPrefix("colMerged"),n=t.getAttribute(i);if(null==n||""==n.wq_trim())return;var l,h=parseInt(t.getAttribute(e)),d=parseInt(h/this.realRowDataLength);if(this.options.fixedRow>0&&this.options.fixedRow>d)l=d;else if(this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow){l=this.getDataLength()-1-(this.lastIndex-d)}else l=d+this.rowIndex;var p=r.D.getBoolean(a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/colIdToColIndex/@value"))?this.getColumnIndex(t.getAttribute(i)):t.getAttribute(i),c=this.getCellInfo(p);if(!c.options.colMergeEdit&&"1"==t.getAttribute(o))return;if(c.options.embeddedInput||this.groupbyStatus.grouped)return;var g=this.__getEditReadOnly(t,l);if(g)return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,
c.showReadonly(t,l)));if(this._getEditDisabled(l,p))return this.editMode=!1,void(c.options.showReadOnly&&(this.editMode=!0,c.showReadonly(t,l)));if(0!=u.B.fireEvent(this,"onbeforeedit",l,p,this.dataList._getCellData(l,this.getColumnID(p)))&&null==this.editedCell)if(this.editMode=!0,this.setCellEditMode(t,l),c.comp)c.comp.setReadOnly(g);else if("custom"===c.options.inputType&&!c.internal){var f=this.getRealRowIndex(l),m=c.cellManagerHashByRowIndex[f];m.comp&&m.comp.setReadOnly(g)}}catch(t){s.w.printStackTrace(t)}},C.prototype.getEditReadOnly=function(t,e){var i=r.D.getDataPrefix("col_id"),o=t.getAttribute(i);return this._getEditReadOnly(e,o)},C.prototype.getReadOnly=function(){var t=r.D.getBoolean,e=arguments[0];if("grid"==e||0==arguments.length)return t(this.options.readOnly);if("row"==e)return t(this.getRowReadOnly(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnReadOnly(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellReadOnly(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this._getEditReadOnly(o,i)}},C.prototype.setReadOnly=function(){try{var t=arguments[0];if(1==arguments.length||"grid"==t){var e=arguments[arguments.length-1],i=this.options.readOnly,o=r.D.getBoolean(e);if("clear"==e?(this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],2===arguments.length?(o=!1,this.options.readOnly=o):3===arguments.length&&(o=r.D.getBoolean(arguments[arguments.length-2]),this.options.readOnly=o)):this.options.readOnly=o,0!=this.getDataLength()&&(i!==o||"clear"===e)){var a=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex;for(var n in this.cellInfoHash){"clear"===e&&(this.cellInfoHash[n].options.readOnly="");var l=this.getColumnIndex(n);if(!isNaN(l)){for(var h=0;h<=a;h++)this.drawCellData(h,h+this.rowIndex,l);this.applyColumnStyleOptions(l)}}}this.options.readOnly?this.addClass(" w2grid_readonly_outer"):this.removeClass("w2grid_readonly_outer")}else"row"==t?this.setRowReadOnly(arguments[1],arguments[2]):"column"==t?this.setColumnReadOnly(arguments[1],arguments[2]):"cell"==t&&this.setCellReadOnly(arguments[1],arguments[2],arguments[3])}catch(t){s.w.printStackTrace(t)}},C.prototype._getEditReadOnly=function(t,e,i){try{e=this.getColumnID(e);var o=this.getCellReadOnly(t,e,i),a=this.cellInfoHash[e];if(null==a)return;var n=r.D.getBoolean;if(o+""!="")return n(o);var l=this.options.readOnlyPriority,h=a.options.readOnly,d=this.getRowReadOnly(t,i);return"column"==l&&""!==h?n(h):"row"==l&&""!==d?n(d):h+""=="true"||d+""=="true"||h+""!="false"&&d+""!="false"&&(this.options.readOnly+""!=""&&n(this.options.readOnly))}catch(t){s.w.printStackTrace(t)}},C.prototype.__getEditReadOnly=function(t,e){var i=r.D.getDataPrefix("col_id"),o=t.getAttribute(i);return this.___getEditReadOnly(e,o)},C.prototype.___getEditReadOnly=function(t,e,i){var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)?this.dataList.getRealRowIndex(t):this._getGroupbyDisplayRowIndex(t);return this._getEditReadOnly(o,e,i)},C.prototype.getDisabled=function(){var t=r.D.getBoolean,e=arguments[0];if("grid"==e||null==e)return t(this.options.disabled);if("row"==e)return t(this.getRowDisabled(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnDisabled(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellDisabled(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this.getEditDisabled(o,i)}},C.prototype.setDisabled=function(t,e,i,o){try{for(var a=[t,e,i,o];a.length>0&&null==a[a.length-1];)a.pop();var n=a[0],l=1==a.length||"grid"==n,h=2==a.length&&"boolean"==typeof a[0]&&"boolean"==typeof a[1],d=r.D.getDataPrefix("header_id");if(l||h){var u=l?a[a.length-1]:a[0];if((u=r.D.getBoolean(u))!=this.options.disabled){this.options.disabled=u;var p=this.getElementById(this.id+"_dataLayer");!l&&u||(p.disabled=u),(h||!u&&p.disabledW2)&&(p.disabledW2=u),
u?(this.addClass(p,"w2grid_disabled"),this.addClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowXHidden(),this.setOverflowYHidden())):(this.removeClass(p,"w2grid_disabled"),this.removeClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowX(),!0===this._isHybridScroll()?this.setScrollYHeightHybrid():this.setOverflowY()));for(var c=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),g=0;g<c.length;g++){var f=c[g].getAttribute(d),m=this.headerObj[f];m?m.setDisabled?m.setDisabled(u):m.render?m.render.disabled=u:m.disabled=u:c[g].disabled=u}for(var y in this.cellInfoHash){var b=this.cellInfoHash[y];b&&"checkbox"===b.options.inputType&&(""===b.options.disabled?(b._oriDisabled=b.options.disabled,b.options.disabled=u):""===b._oriDisabled&&(b.options.disabled=u));var w=this.getColumnIndex(y);this.drawColumnData(w),this.applyColumnStyleOptions(w)}}return u}"row"==n?this.setRowDisabled(a[1],a[2]):"column"==n?this.setColumnDisabled(a[1],a[2]):"cell"==n&&this.setCellDisabled(a[1],a[2],a[3])}catch(t){s.w.printStackTrace(t)}},C.prototype.getEditDisabled=function(t,e,i){return this._getEditDisabled(this._getGroupbyGroupedRowIndex(t),e,i)},C.prototype._getEditDisabled=function(t,e,i){try{var o=-1,a="";"number"==typeof e?(o=e,a=this.cellIdList[e]):(o=this.bodyIdColIndexMap[e],a=e);var r=-1;if(!0===i)r=t;else if(this._linkedDataList)r=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var n=!0;for(var l in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[l]){r=this._dataList.filteredRowIndexArr[t],n=!1;break}n&&(r=this.groupbyStatus.groupedRowIndexArr[t])}else r=this._dataList.filteredRowIndexArr[t];var h=this.cellInfoHash[a]||{options:{}},d=this.cellDisabledArr[r*this.oneRowDataLength+o];if(!0!==d&&!1!==d){var u=h.options.disabled,p=this.rowDisabledArr[r],c=this.options.disabledPriority;!0!==p&&!1!==p&&(p=""),d="column"===c&&""!==u?u:"row"===c&&""!==p?p:u+""=="true"||p+""=="true"||u+""!="false"&&p+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}return d}catch(t){s.w.printStackTrace(t)}},C.prototype.getElemRowIndex=function(t){var e=r.D.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e));return parseInt(i/this.realRowDataLength)+this.rowIndex},C.prototype.notifyDataChanged=function(t){try{if("active"!=this.activeStatus)return;void 0!==t&&null!=t||(t={}),this.initHeightCompleted=!1,this.checkResize();var e=t&&t.append||!1,i=t&&t.keepTop||!1,o=t&&t.refreshScroll||!1,a=t&&t.refreshInstance||!1,r=i&&this.rowIndex>=0?this.rowIndex:0,n=t&&!0===t.gridData,l={sortIcon:this.options.hideSortIconOnNoData};if(this.delayedDraw({rowIndex:r}))return!0===a&&this._refreshInstance(void 0,e),void this.changeCount++;if(this._mergeRefresh(),!0===this._isBrowserScroll())return t.sync=!i,this.changeCount++,this._refreshDataChanged(t);var h=this._setGridBorderNoRefresh||!1;if(this._setGridBorderNoRefresh=!0,this.options.senseReader&&this.rowIndex<=0)return this.changeCount++,this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),o&&"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,l),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),this._setGridBorderNoRefresh=h,!0===a&&this._refreshInstance(void 0,e),void this.refreshAdaptive({simple:!0});if(e&&!this.loadFlag)return this.drawFooter(),this.drawHeader(void 0,l),void(!0===a&&this._refreshInstance(void 0,e));if(this.changeCount++,!0===e&&"true"===this.options.keepScrollForSenseReader&&!0===this.options.senseReader&&this.options.visibleRowNum>0)var d=this.drawDataTable(0,{keepScrollTop:!0});else d=this.drawDataTable(0);for(var u in o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),0==d&&(e&&!o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.hiddenCellObj.length>0?(this.rowIndex=r,!0!==n&&this._setCellVisibleRefresh()):this.drawData(r)),
this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,l),this._setGridBorderNoRefresh=h,this.refreshAdaptive({simple:!0}),this.cellInfoHash)this.cellInfoHash[u].refreshCell();if(this.hasCustomInputType)for(var p=0;p<this.cellIdList.length;p++){var c=this.cellInfoHash[this.cellIdList[p]];c&&c.options&&"custom"===c.options.inputType&&c.options.typeGetter&&c.refreshCellManagerHash()}!0===a&&this._refreshInstance(void 0,e)}catch(t){s.w.printStackTrace(t)}},C.prototype.notifyCellChanged=function(t,e,i,o){if(this.changeCount++,!this.delayedDraw({})){var s=this._getTrRowIndex(t);if(e=this.getColumnIndex(e),this._drawRowStatus(s,t),this._drawCellStatus(s,t,e),!0!==i&&(this.drawCellData(s,t,e),this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex)){for(var a=t+1,n=s+1;"number"==typeof this.groupbyStatus.groupedRowIndexArr[a]&&a<this.groupbyStatus.groupedRowIndexArr.length;)a++,n++;if("object"===(0,l.Z)(this.groupbyStatus.groupedRowIndexArr[a])&&"footer"===this.groupbyStatus.groupedRowIndexArr[a].type){var h=this.dataList.getRealRowIndex(a);if(null!=h){var d=this.all_data_td_list[n*this.realRowDataLength];d&&this.drawGroupData(d,h,n)}}}var u=this.getColumnID(e);this._refreshExpression(t,u);var p=this.labelColumnAssArr[u];if(null!=p)for(var c=0;c<p.length;c++){var g=this.getColumnIndex(p[c]);this.drawCellData(s,t,g)}this.displayNoResultMessage(),this.hasSubtotal&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex)),this.drawFooter(u),this.drawHeader(u),o||this._setCheckboxHead(u),"never"!==this.options.mergeCellsFixedCols&&r.D.setTimeout((function(){var t={fixedCols:!0,fixedRows:!1};this._mergeCells(this.options.mergeCellsFixedCols,t,{type:"mergeCellsFixedCols"})}),{key:this.id+"notifyCellChanged_mergeRefresh",caller:this,delay:200})}},C.prototype._getTrRowIndex=function(t){try{var e=t;if(this.rowIndex>=0){var i=this.getDataLength();this.options.fixedRow>0&&this.options.fixedRow>t||(this.options.lastFixedRow>0&&e>=i-this.options.lastFixedRow?e=this.lastIndex-(i-1-e):e-=this.rowIndex)}return e}catch(t){s.w.printStackTrace(t)}},C.prototype._refreshExpression=function(t,e){try{var i=this._getTrRowIndex(t),o=this.expressionAssArr[e];if(null!=o){var a=this.searchExpression(o);for(var r in a){var n=this.getColumnIndex(r);this.drawCellData(i,t,n),this.drawFooter(n),this.drawHeader(n)}}}catch(t){s.w.printStackTrace(t)}},C.prototype.searchExpression=function(t){for(var e={},i=[t];i.length>0;)for(var o=i.pop(),s=0;s<o.length;s++)if(e[o[s]]=!0,this.expressionAssArr[o[s]]){var a=this.expressionAssArr[o[s]];if(a.length>1)i.push(a);else null!=this.expressionAssArr[a]&&i.push(a),e[a]=!0}return e},C.prototype.notifyRowChanged=function(t,e){if(this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged(e);var i={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(void 0,i),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(-1==this.rowIndex)this.drawDataTable(0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(e&&!0===e.keepScrollTop)this.lastTopRowIndex=null,this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0});else{this.lastTopRowIndex=null;var o=this._dataList.options.depthColumn?this.getDrawCount()+this.rowIndex:this.getDataLength(),s=(t=t||this.rowIndex)-this.rowIndex,a=this.rowIndex;if(0<=s&&s<=this.lastIndex&&(this.rowIndex<=0||this.rowIndex+this.lastIndex<o))if(this.isDrillDown&&!this.drilldown.isOpen(t)){var n=("linkedDataList"===this.drilldown.mode?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr).length-(t+1),l=this.lastIndex-s-n;a=h=l<=0?this.rowIndex:(h=this.rowIndex-l)>0?h:0
}else a=this.rowIndex;else if(0<=s&&s<=this.lastIndex||s<0){var h;(h=this.rowIndex-1)+this.lastIndex>=o&&(h=o-this.lastIndex-1),a=h=h>0?h:0}this.hiddenCellObj.length>0?(this.rowIndex=a,r.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200})):this.drawData(a,0)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader(void 0,i),this.refreshAdaptive({simple:!0})}},C.prototype.notifyRowInserted=function(t){if(t=parseInt(t,10),this.changeCount++,!this.delayedDraw({rowIndex:t})){if(!0===this._isBrowserScroll())return this._refreshDataChanged();var e={sortIcon:this.options.hideSortIconOnNoData};if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(void 0,e),this.senseReaderMode=!1,this.displayNoResultMessage(),this.displayFixedColumnLine(),void this.refreshAdaptive({simple:!0});if(this.lastTopRowIndex=null,-1==this.rowIndex)0==this.drawDataTable(0)&&this.drawData(0,0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(""!==this.options.visibleRowNum||this.options.initFixedHeightByRowNum>0)this.setDataTable(),this.drawData(0);else{var i=t-this.rowIndex,o=this.getElementById(this.id+"_scrollY_div");if(i<0){var s=this.getElementById(this.id+"_scrollY_div");this.scrollEvent=!1,s.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0)}else(o.offsetHeight>=o.scrollHeight||i<=this.lastIndex)&&(this.hasSubtotal&&(i=0),this.drawData(this.rowIndex,i))}0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight();var a=this._getVisibleLastIndex(this.lastIndex+1);if(this.rowIndex+a-1<t){this.scrollEvent=!1,(s=this.getElementById(this.id+"_scrollY_div")).scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t);var n=this._getEpsilon(),l=Math.round(s.scrollTop)+n,h=this._getVisibleRowIndex(parseInt(l/this.oneRowScrollHeight));this.hiddenCellObj.length>0?(this.rowIndex=h,r.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200}),this.lastTopRowIndex=null):this.drawData(h)}this.displayNoResultMessage(),this.displayFixedColumnLine(),this.drawFooter(),this.drawHeader(void 0,e),this.refreshAdaptive({simple:!0})}},C.prototype.makeNoResultMessage=(0,y.Z)(w().mark((function t(){var e,i,o,a,r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.getElementById(this.id+"_noresult"),i=this.options.noResultMessageURL,!0===e.hasChildNodes()){t.next=15;break}return o=this.options._scope_obj_uuid,!0,a={className:"noResultDiv",scope:"true",pluginName:"wframe",src:i,preload:!0},r=this.getOriginalID(),n=v.D.create(r+"_noResultMessageFrame",a,null,this.scope_obj,o,true),t.next=12,v.D.initAsync();case 12:n.writeTo(e),n.activate(),this.addControl(n);case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),s.w.printStackTrace(t.t0);case 20:case"end":return t.stop()}}),t,this,[[0,17]])}))),C.prototype.displayNoResultMessage=function(){var t="removed"!==this.options.noResultMessageExclude||0==this.removed,e=this.getElementById(this.id+"_noresult");if(e&&this.options.noResultMessageVisible&&t&&0==this.initFlag&&0==this.getDataLength()){var i=this.getElementById(this.id+"_main_div"),o=i.offsetHeight,s=this.getElementById(this.id+"_body_table").offsetHeight+3,a=this.getElementById(this.id+"_foot_table"),r=0;a&&(r=a.offsetHeight);var n=o-s-r;if(!0!==this.options.useNoResultMessageURL){var l=this.getElementById(this.id+"_noresult");e.innerHTML=this.options.noResultMessage,e.style.display="block";var h=parseInt(WebSquare.style.getStyle(l,"margin-top"),10)||0,d=parseInt(WebSquare.style.getStyle(l,"margin-bottom"),10)||0,u=l.offsetHeight+h+d,p=this.getElementById(this.id+"_scrollX_div").offsetHeight
;if(n<=0);else if(n<=u)l.style.top=s+h+"px",this.setSize(i,s+r+u+p+h+d);else{var c=this.getElementById(this.id+"_head_table"),g=(l.style.top,0);if(c&&c.childNodes)for(var f=0;f<c.childNodes.length;f++)"string"==typeof c.childNodes[f].tagName&&"TR"===c.childNodes[f].tagName.toUpperCase()&&g++;if((g>1||this.options.groupbyZone)&&!this.options.noResultMessageStylePriority){var m;m=this._noResultMessageDivTop.indexOf("px")>0?o-parseInt(this._noResultMessageDivTop):o*parseInt(this._noResultMessageDivTop)/100;var y=0;this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(y=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),l.style.top=parseInt(g*this.oneRowHeight/2+m)+y+"px"}}}else{var b=this.makeNoResultMessage(),w=this.id+"_noresult";b.then((function(t){var e=document.getElementById(w);e&&(e.style.display="flex",e.style.top=s+"px",e.style.height=n+"px")}))}}else e.style.display="none";this.removed=!1,this.delayedDrawObj||this.removeAllFinish||(this.initFlag=!1)},C.prototype.displayFixedColumnLine=function(){try{if(!this.options.fixedColumnLineDiv)return;var t,e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_head_table").offsetHeight,a=this.getRowCount(),n=this.getElementById(this.id+"_fixedColumnDiv"),l=Math.min(e.offsetHeight,i.offsetHeight);if(this.options.fixedColumn>0){var h=this.getElementById(this.id+"_scrollX_left"),d=parseInt(r.D.getStyleProperty(n,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==a?0:l-o,n.style.top=o+"px"):t=0==a?o:l;var u=h.offsetWidth;n.style.left=u-(d-1)/2+"px",n.style.height=t+"px",n.style.display="block"}else n.style.display="none";var p=this.getElementById(this.id+"_fixedRightColumnDiv");if(this.options.fixedRightColumn>0){var c=this.getElementById(this.id+"_scrollX_fixedRight");d=parseInt(r.D.getStyleProperty(p,"border-right-width"),10)||0;"tbody"===this.options.fixedColumnLineDivStart?(t=0==a?0:l-o,p.style.top=o+"px"):t=0==a?o:l;u=e.offsetWidth-c.offsetWidth;p.style.left=u-(d-1)/2-1+"px",p.style.height=t+"px",p.style.display="block"}else p.style.display="none"}catch(t){s.w.printStackTrace(t)}},C.prototype.delayedDraw=function(t){return(0==this.resizeObj.width||0==this.resizeObj.height)&&(this.delayedDrawObj||(this.delayedDrawObj={}),this.delayedDrawObj.redraw=!0,t.hasOwnProperty("rowIndex")?this.delayedDrawObj.rowIndex=t.rowIndex:t.hasOwnProperty("subTotalVisible")?this.delayedDrawObj.subTotalVisible=t.subTotalVisible:t.hasOwnProperty("newColumnOrder")&&(this.delayedDrawObj.newColumnOrder=t.newColumnOrder),!0)},C.prototype.delayedAction=function(){this.startedDisplayNone=!1,this.setPreAction(),this.getRowCount&&this.getRowCount()>0&&this.notifyDataChanged(),this.options.focusOnSetData&&this._setFocusedCell(0,0);var t=WebSquare.BootLoader.fullViewed||!1,e=r.D.fullViewed||!1;t||e||this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),r.D.isMobile()&&this.options.fixAdaptive||this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),this.delayedDrawObj=null,this.initFlag=!1},C.prototype.setRedrawStatus=function(t){if(!this.startedDisplayNone||"stop"!=t)if("stop"==t)this.delayedDrawObj||(this.delayedDrawObj={});else{this.setDataLayerPosition(),this.scrollX_right.scrollLeft=this.resizeObj.scrollLeft,this.getElementById(this.id+"_scrollY_div").scrollTop=this.resizeObj.scrollTop,this.handlerResize_drawInitializer(),this._handleScrollX();for(var e=!1,i=0;i<this.colWidthList.length;i++)if(this.colWidthList[i].toString().indexOf("*")>-1){e=!0;break}if((this.options.autoFit||e)&&this.autoFitFunc(),this.delayedDrawObj.redraw){this.lastTopRowIndex=null,this.setDataTable(),this.setTrRowTable(),this.setColIndexInfo();var o=this.delayedDrawObj.rowIndex||0,s=o,a=this.getDataLength()
;if(a-this.drawedRowLength<s&&(s=a-this.drawedRowLength)<0&&(s=0),"all"!==this.options.visibleRowNum)for(;this.hiddenRowObj.extraRow<this.hiddenRowObj.length;)this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.extraRow);if(!0===this._isHybridScroll())this._drawDataHybrid(s,{redraw:!0}),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal&&this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible);else{this.drawData(s),null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal?this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible):this.setScrollYHeight();var r=this.rowIndex+this.lastIndex,n=this._getScrollRowIndex(o);if(r<o||n<o){this.scrollEvent=!1;var l=this.getElementById(this.id+"_scrollY_div");l.scrollTop=this.oneRowScrollHeight*n;var h=this._getVisibleRowIndex(parseInt(l.scrollTop/this.oneRowScrollHeight));this.drawData(h)}}this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),this.displayFixedColumnLine();var d="never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols;for(var u in d||(this._mergeRefresh(),this.dynamicMergeHTML()),this.cellInfoHash)this.cellInfoHash[u].refreshCell();this._drawGroupbyZone(),void 0!==this.delayedDrawObj.newColumnOrder&&this.delayedDrawObj.newColumnOrder.length>0&&this.setColumnOrder(this.delayedDrawObj.newColumnOrder)}this._setVisibleRowNumFix(),this.delayedDrawObj=null,this.initFlag=!1}},C.prototype._refreshDataChanged=function(t){try{void 0!==t&&null!=t||(t={}),this._hybridRefreshCnt++;var e={sortIcon:this.options.hideSortIconOnNoData};this.setDataTable();var i=t.keepTop||t.keepScrollTop||!0===this._isHybridScroll();if(!0!==i&&this.drawData(0),this.drawFooter(),this.drawHeader(void 0,e),this.displayNoResultMessage(),t.refreshInstance&&this._refreshInstance(void 0,t.append),!0===i){var o=this.uuid;!0===t.sync||this._hybridRefreshCnt<this._hybridRefreshMax?(!0===t.sync?this._hybridRefreshCnt=0:(this._hybridRefreshCnt++,r.D.setTimeout((function(){WebSquare.idCache[o]._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged_reset",delay:100})),this._refreshScrollYHybrid(t)):r.D.setTimeout((function(t){var e=WebSquare.idCache[o];e._refreshScrollYHybrid(t),e._hybridRefreshCnt=0}),{key:this.id+"_refreshDataChanged",delay:50,args:[t]})}else this._autoFitRefreshNative();return void this.refreshAdaptive({simple:!0})}catch(t){s.w.printStackTrace(t)}};var I=function(){};I.prototype.setScrollYHeight=function(t){if(!0!==this._isNativeScroll()){if(!0===this._isHybridScroll())return this.setScrollYHeightHybrid(t);void 0!==t&&null!=t||(t={});var e=this.getDataLength(),i=this.rowIndex,o=!0===t.noDraw,s=!0===t.keepScrollTop,n=this.getElementById(this.id+"_size_y"),l=this.getElementById(this.id+"_scrollY_div"),h=n.parentNode.offsetHeight;0==h&&(h=parseInt(this.getStyle("height")));var d=this._getScrollRowIndex(i);if(-1==i||0==d&&d+this._getVisibleLastIndex(this.lastIndex+1)==e){var u=!0;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var p=this.drawedSubtotal[this.drawedSubtotal.length-1];p.length>0&&(p.rowIndex+1!=e||"none"===p[p.length-1].style.display||this._getLastSubtotalCount()>this.drawedSubtotal.length)&&(u=!1)}else this.hasSubtotal&&0==this.drawedSubtotal.length&&this.lastSubtotalRow&&e>0&&(u=!1);if(u)return"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),void(0!==n.offsetHeight&&(n.style.height="0px",this.handlerResize_drawInitializer()))}var c=l.scrollTop;if(!0!==t.skipResize){var g;if("number"==typeof t.restRowCnt)g=t.restRowCnt;else if(""!==this.options.visibleRowNum)this.options.senseReader&&"all"===this.options.visibleRowNum||this.isDrillDown?g=e-(this.lastIndex+1):(g=e-this.drawedRowLength,this._dynamicVisibleRowNum>0&&(g=e-this._dynamicVisibleRowNum),this.options.initFixedHeightByRowNum>-1&&(g+=this._getLastSubtotalCount())),
g<0&&(g=0),g=Math.max(0,g-this._getHiddenRowCount());else if(this.lastTopRowIndex&&this.lastTopRowIndex>0)g=this._getScrollRowIndex(Math.ceil(this.lastTopRowIndex));else{var f=this.getElementById(this.id+"_head_table"),m=this.dataLayerHeight-f.offsetHeight,y=parseInt(m/this.oneRowHeight),b=this.drawedRowLength;this.oneRowLength>1&&(b=Math.ceil(this.drawedRowLength/this.oneRowLength)),y+(this.isMobile?0:1)<b&&(b=y+(this.isMobile?0:1)),g=this.options.fixHeight||this.hasSubtotal?0===i?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-y>1?e-y:1:this.options.senseReader?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-b+1>1?e-b+(this.isMobile?0:1):1,g=Math.max(0,g-this._getHiddenRowCount())}var w=h+this.oneRowScrollHeight*g;if(h=l.offsetHeight,w<=1e6&&"table"!=n.tagName.toLowerCase())n.style.height=w+"px";else if(w<=1e6)l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,(n=this.getElementById(this.id+"_size_y")).style.height=w+"px";else if(a.v.browserCheck.ieAllVersion&&!this.isIE6or7||r.D.isSpartan()){var v=[];for(v.push("<table id='"+this.id+"_size_y' style='border-collapse:collapse; border-spacing:0px;height:0px; position:absolute; top:0px; left:0px; width:18px'><tbody>");w>1e6;)v.push("<tr style='height:1000000px'><td></td></tr>"),w-=1e6;v.push("<tr style='height:"+w+"px'><td></td></tr></tbody></table>"),l.innerHTML=v.join(""),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")}else"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),a.v.browserCheck.moz?n.style.height=w+1+"px":n.style.height=w+"px"}else h=l.offsetHeight;if(!0!==t.skipScrollEnd){var C=n.offsetHeight;C<1e6&&(C=parseInt(n.style.height,10));var I=C-h,_=this._getEpsilon(),x=Math.min(Math.round(c)+_,I),S=this._getScrollMaxRowIndex();if(S>e-this._getHiddenRowCount())this._applyScrollEnd(S,{noDraw:!0});else{var D=this.options.syncWithScrollTrack?Math.ceil:Math.floor;if(I>=0&&D.call(this,x/this.oneRowScrollHeight)!=this._getScrollRowIndex(i)){this.lastTopRowIndex&&this.lastTopRowIndex==i&&(i=this.lastTopRowIndex+1);var R=this._getScrollRowIndex(i);o&&l.scrollTop!=this.oneRowScrollHeight*R&&(this.scrollEvent=!1),x=Math.min(this.oneRowScrollHeight*R,I),l.scrollTop=x;var L=this._getVisibleRowIndex(parseInt(x/this.oneRowScrollHeight));this.bScrollTop=L,this.rowIndex=L}!s&&I>0&&I==x&&this._applyScrollEnd(this.rowIndex),this.lastScrollYTop=l.scrollTop,!0!==t.skipResize&&this.handlerResize_drawInitializer(),this.isMobile&&this.setIScrollY()}}else this.handlerResize_drawInitializer()}},I.prototype.setScrollYHeightHybrid=function(t){try{if(void 0!==t&&null!=t||(t={}),!0===t.skipResize)return;var e,i,o,a,r,n=document.getElementById(this.id+"_main_div"),l=this.getFooterHeight(),h=!0===this._hasHybridScroll();if(h&&(e=this._getHybridVisibleHeightInfo(),o=this.getDataLength(),r=a=this._getHybridRowNum(),this.oneRowLength>1&&(r*=this.oneRowLength),h=(r-=e.cnt)>=1),h){var d=Math.floor(o/a),u=e.height;e.cnt>0&&(u=Math.round(u*(r+e.cnt)/r));var p=o-d*a,c=0;if(p>0){var g=a-p;this.oneRowLength>1&&(g*=this.oneRowLength);var f=this._getHybridVisibleHeightInfo(g);c=f.height,f.cnt>0&&(c=Math.round(c*g/(g-f.cnt))),d++}var m=document.getElementById(this.id+"_head_table").offsetHeight,y=0,b=!1;if(!0===t.keepHybridHash){b=!0;for(var w=0;w<d;w++)"number"==typeof this._hybridScrollHash[w]?y+=this._hybridScrollHash[w]:"number"==typeof this._hybridScrollHeight?y+=this._hybridScrollHeight:(y+=u,b=!1)}else y=u*d;i=y-c+m+l+this._getHybridScrollXHeight()+1,this._hybridScrollLastTop=NaN,this._hybridScrollDupHeight=c,!0!==b&&(this._hybridScrollHeight=u),e.cnt>0&&(this._hybridScrollHeight=Math.round(e.height*(r+e.cnt)/r))}else{var v=document.getElementById(this.id+"_body_table");i=Math.max(v.offsetHeight,n.offsetHeight-1)+l+this._getHybridScrollXHeight()+1,this._hybridScrollHeight=i,this._hybridScrollLastTop=i,this._hybridScrollDupHeight=0}
document.getElementById(this.id+"_size_y").offsetHeight!==i&&!0!==t.keepHybridHash&&(this._hybridScrollHash={}),this._setHybridSizeY(i,t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._checkScrollEnd=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=t.offsetHeight;o<1e6&&(o=parseInt(t.style.height,10));var a=o-i,r=this._getEpsilon(),n=e.scrollTop,l=Math.min(Math.round(n)+r,a);return a>0&&a===l}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._checkScrollEnd2=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=parseInt(t.style.height,10)-i,a=this._getEpsilon(),r=e.scrollTop,n=Math.min(Math.round(r)+a,o);return o<=0?-1:n<3?1:n<o?0:2}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._applyScrollEnd=function(t,e){try{if(""!==this.options.visibleRowNum||this.lastTopRowIndex>0||0===this.lastTopRowIndex||this.groupbyStatus.grouped)return 0;if(this.hiddenCellObj.length>0)return 0;if(isNaN(t)&&(t=this.rowIndex),void 0!==e&&null!=e||(e={}),this._applyScrollEndCnt){if(this._applyScrollEndCnt>4)return;this._applyScrollEndCnt++}else this._applyScrollEndCnt=0;var i=0,o=this.getDataLength(),a=!1;if(this.hasSubtotal){if(this.drawedSubtotal.length>0){var r=this.drawedSubtotal[this.drawedSubtotal.length-1];if(r.rowIndex==o-1)"none"!=r[r.length-1].style.display&&(a=!0)}}else a=!0;var n=this.lastIndex+1,l=this._getVisibleLastIndex(n);if(t+l==o&&a)!0!==this._onSetHeight&&(this.lastTopRowIndex=t);else{var h=o-l;i=this._getScrollRowIndex(h)-this._getScrollRowIndex(t);var d=this.getElementById(this.id+"_size_y");if(this.hasSubtotal&&!a&&!0!==this._onSetHeight)if(this.struct.subtotalArr.length>1&&""===this.options.visibleRowNum&&!0!==e.noDraw){var u=this._getDrawedRowCount();if(u>0)return this.options.initFixedHeightByRowNum=u,this.options.visibleRowNum=u,this.drawedRowLength=u,this.lastTopRowIndex=null,this.drawedRowLength=this.options.initFixedHeightByRowNum,void this.drawData(this.rowIndex,0);i+=this.struct.subtotalArr.length}else i+=this.struct.subtotalArr.length;if(0!==i){this.lastTopRowIndex=null;var p=d.offsetHeight;p<1e6&&(p=parseInt(d.style.height,10)),d.style.height=p+this.oneRowScrollHeight*i+"px",!0!==e.noDraw&&this.drawData(Math.max(t+i,0)),this.handlerResize_drawInitializer()}}return this._applyScrollEndCnt=0,i}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.addGridScroll=function(t){try{var e=this.rowIndex+t;e=(e=e<0?0:e)>=this.getDataLength()-this.lastIndex?this.getDataLength()-this.lastIndex:e,this.scrollEvent=!1,this.checkScrollEnd=!0,this.drawData(e,0)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.handleScrollY=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.getElementById(this.id+"_scrollY_div").scrollTop;if(i==this.bScrollY)return;if(this.bScrollY=i,0===this.getElementById(this.id+"_size_y").offsetHeight)return;var o=this._getEpsilon(),a=Math.round(i)+o,n=this._getVisibleRowIndex(parseInt(a/this.oneRowScrollHeight)),l=this.getDataLength(),h=this._checkScrollEnd();if(this.scrollEvent&&(null!=this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleScrollY",[t]),this.bScrollTop!=n||this.rowIndex!=n)){this.hasClass(document.activeElement,this.options.bodyTdClass)&&document.activeElement.blur&&document.activeElement.blur();var d="async",p=e&&!0===e.changedHeight;(p||h)&&(d="sync",p||this.handleResize()),this.drawData(n,null,d)}this.bScrollTop=n;var c=this._getVisibleLastIndex(this.lastIndex+1);if(0==i&&this.checkScrollStart&&(this.skipScrollStartEvent||(this.scrollEvent=!0,this.checkScrollStart=this.options.alwaysTriggerScrollStart,u.B.stopEvent(t),r.D.setTimeout((function(){u.B.fireEvent(this,"onscrollstart")}),{key:this.id+"_scrollstart",caller:this,delay:150}))),(this.scrollEvent||this.checkScrollEnd)&&this.options.loadCount>0&&this.loadFlag){var g=n+c-1
;l-this.options.loadCount-1<=g&&null==this.loadCheck[l]&&(this.skipScrollEndEvent||(this.loadCheck[l]=!0,this.scrollEvent=!0,this.loadFlag=!1,u.B.stopEvent(t),r.D.setTimeout((function(){u.B.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150})))}else(this.scrollEvent||this.checkScrollEnd)&&0==this.options.loadCount&&!0===h&&(!this.scrollEvent||this._applyScrollEnd(this.rowIndex)<=0)&&(u.B.stopEvent(t),r.D.setTimeout((function(){u.B.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150}));if(this.skipScrollStartEvent=!1,this.skipScrollEndEvent=!1,this.scrollEvent=!0,this.checkScrollEnd=!1,1==this.options.syncScroll&&this.options.syncScrollId)for(var f=this.options.syncScrollId.split(","),m=0;m<f.length;m++){var y=r.D.getComponentById(f[m],this.scope_id);y&&this.getRowCount()==y.getRowCount()&&y.setScrollTop(i)}u.B.fireEvent(this,"onscrolly",t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.handleScrollYHybrid=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"number"==typeof e.maxRepeat&&e.maxRepeat<=0)return;!0!==e.skipEndEdit&&this._endEdit();var i=this._getHybridVisibleHeightInfo();this._setHybridVisibleHeight(this._hybridRowIndex,i);var o=document.getElementById(this.id+"_scrollY_div"),a=document.getElementById(this.id+"_size_y"),r=this.getDataLength(),n=r;this.oneRowLength>1&&(n*=this.oneRowLength);var l=this._getHybridTrCount(),h=this.getFooterHeight(),d=document.getElementById(this.id+"_body_table");if(n<=l){this._setHybridYPosition(o.scrollTop),this._hybridScrollYPos=0;var p=o.scrollHeight-o.offsetHeight;return void(p>0&&o.scrollTop>=p&&u.B.fireEvent(this,"onscrollend"))}var c=o.scrollTop;"number"==typeof e.scrollTop&&(c=e.scrollTop);var g=0,f=c,m=this._getHybridLastIndex(),y=this._hybridScrollDupHeight;if(f>0&&f>=this._hybridScrollLastTop)g=m,f=c-this._hybridScrollLastTop+this._hybridScrollDupHeight;else{for(;f>0&&g<m;){var b=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(!(f>=b))break;f-=b,g++}g===m&&(f+=y+this._getHybridLastSubtotalHeight()+i.borderHeight)}var w=c-f,v=c-w;if(this._setHybridYPosition(v),g!==this._hybridRowIndex){var C=this._getHybridRowNum(),I=Math.min(g*C,r-C);this.drawData(I),this._hybridRowIndex=g;var _=null==this._hybridScrollHash[g]?this._hybridScrollHeight:this._hybridScrollHash[g];if(this._setHybridVisibleHeight(),_!==this._hybridScrollHash[g])return"number"==typeof e.maxRepeat?e.maxRepeat--:e.maxRepeat=10,e.scrollEvent=!0,this.handleScrollYHybrid({},e)}var x=0;0!==(x=g===m?a.offsetHeight-d.offsetHeight-w-h-this._getHybridScrollXHeight()-1:y-this._hybridScrollDupHeight)&&(w+=x,this._setHybridYPosition(v-x)),this._hybridScrollYPos=w,"scroll"!==t.type&&"onscroll"!==t.type&&!0!==e.scrollEvent||(u.B.fireEvent(this,"onscrolly",t),o.scrollTop>=o.scrollHeight-o.offsetHeight&&u.B.fireEvent(this,"onscrollend")),this._setHybridDataLayerTop()}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._refreshScrollYHybrid=function(t){try{var e=this._getHybridRowNum(),i=this.getDataLength(),o=Math.max(i-e,0),a=Math.min(this._hybridRowIndex*e,o);this._hybridRowIndex=Math.ceil(a/e),this.drawData(a),this.setScrollYHeightHybrid(t),this._autoFitRefreshNative();this.handleScrollYHybrid({},t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.drawDataTable=function(t,e){try{null==t&&(t=this.rowIndex),-1==t&&(t=0);var i=this.drawedRowLength;return this.setDataTable(),this.headerTds=null,this.footerTds=null,this.drawedRowLength!=i&&(this.setColIndexInfo(),e&&e.keepScrollTop?this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0}):this.drawData(t,0)),this.drawedRowLength-i}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.drawData=function(t,e,i,o,r){try{a.v.clearTimer(this.id+"_drawData"),a.v.clearTimer(this.id+"_completiveDrawData"),a.v.clearTimer(this.id+"_adjustDraw");i=i||"sync";var n=!0;this.options.senseReader&&(n=!1),t=Math.min(t,this.getDataLength()),this.changeFocusedCellPosition(t,n,!0,{
linkNoFocus:!0});var l=this.maxRowLength;if(this.rowIndex=t,null!=this.editedCell&&this.editedCell.handleEndEdit(null,o),this.subtotalHidden(e?{startRowIndex:e+this.rowIndex}:null),-1!=this.rowIndex&&"sync"!=i&&"all"!==this.options.visibleRowNum||this.startedDisplayNone)e=this.fastDrawData(e,{scroll:!0}),a.v.setTimer((function(e){a.v.setTimer(this.completiveDrawData,{key:this.id+"_completiveDrawData",caller:this,delay:120,args:[e],callback:function(e){a.v.setTimer((function(){this.startedDisplayNone||(this.adjustDraw(e),this._setGridBorder(),this._setCheckboxHead()),l!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}),{key:this.id+"_adjustDraw",caller:this})}})}),{key:this.id+"_drawData",caller:this,delay:1,args:[e]});else{var h=this.completiveDrawData(e,!1);this.adjustDraw(h,r),this._setGridBorder(),this._setCheckboxHead(),l!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.fastDrawData=function(t,e){try{var i=this.options.initFixedHeightByRowNum>-1;i&&(void 0===e||null==e?e={skipSubtotal:!0}:e.skipSubtotal=!0),this.options.measureTime&&a.v.measureTime((function(t){var e=t.aver,i=parseInt(1e3/e*10,10)/10;p.k.printLog("Id : "+this.id+", time : "+e+"ms   ,fps : "+i)}),{key:this.id+"_measureDrawTime",caller:this});var o=this.rowIndex,r=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var n=this._getVisibleTrRowIndex(t,o),h=this.hiddenCellObj.length>0;if(r>0){0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);new Date;var d,u=1;h?(d=r,u=r):""===this.options.visibleRowNum?d=this._getVisibleTrRowIndex(this.drawedRowLength,o):("all"===this.options.visibleRowNum||(u=parseInt(this.options.visibleRowNum,10)-t),d=r);for(this._getVisibleTrRowIndex(this.options.drawLimitRow,o);n<d&&n+o<r&&u>0;n++){var c=!this.hiddenRowObj.length>0||this._getRowVisible(n+o);c&&!0===this.hiddenRowObj.init&&this._setRowDisplay(n,""),this.options.fixedRow>0&&this.options.fixedRow>n?this.fastDrawRowData(n,n,e):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(n,n+o,e);var g=this.options.backgroundColorMode.toLowerCase();if("always"==g?"object"!=(0,l.Z)(this.dataList.getRealRowIndex())&&(this.options.fixedRow>0&&this.options.fixedRow>n?this.applyRowStyleOptions(n):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.applyRowStyleOptions(o+n)):"full"==g&&"object"!=(0,l.Z)(this.dataList.getRealRowIndex())&&(this.options.fixedRow>0&&this.options.fixedRow>n?(this.applyRowStyleOptions(n),this.setEvenOddBackground(n,n)):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||(this.applyRowStyleOptions(o+n),this.setEvenOddBackground(n,o+n))),c?this.lastDisplayedRow<n&&!0!==this.hiddenRowObj.init&&(this._setRowDisplay(n,""),h||(this.lastDisplayedRow=n)):this._setRowDisplay(n,"none"),c&&""!==this.options.visibleRowNum)if(u--,i&&this.hasSubtotal&&u>=1)u-=this.drawSubtotalRow(n+1,n+o,{maxCount:u});if(h)for(var f=0;f<this.oneRowDataLength;f++){var m=n+o,y=this._getTdElem(n+o,f);if(y){var b=!0===this.hiddenCellObj[m+"_"+f];y.style.display=b?"none":""}}}}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),null!==this.lastTopRowIndex&&o>=this.lastTopRowIndex&&!0!==this.hiddenRowObj.init&&!h){for(f=n;f<=this.lastDisplayedRow;f++)this._setRowDisplay(f,"none");this.lastDisplayedRow=n-1}return this.options.mergeRefreshAlways&&this.dynamicMergeHTML(),!0===this.hiddenRowObj.init?t:n}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.completiveDrawData=function(t,e){try{!this.autofitDone&&this.options.autoFit&&this._setAutoFit();var i=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var o=this.rowIndex,a=t-1,n=this.dataLayerHeight,l=this.hiddenCellObj.length>0;if(i>0){if(!0===this.hiddenRowObj.init)this._applyRowVisible({applyStyle:!0,drawRow:!0}),a=this.lastIndex;else{var h=this.options.initFixedHeightByRowNum>-1
;0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);var d,u=this.drawedRowLength;this._dynamicVisibleRowNum>0&&(u=this._dynamicVisibleRowNum),h&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength),h&&(d={skipSubtotal:!0});for(var p=t;p<u&&p+o<i;p++){var c=p+this.rowIndex;if(this.options.fixedRow>0&&this.options.fixedRow>p?this.fastDrawRowData(p,p,d):this.fastDrawRowData(p,c,d),a=p,h&&this.hasSubtotal&&p<u-1)u-=this.drawSubtotalRow(p+1,c,{maxCount:u-p-1})}if(h&&this.hasSubtotal&&u>a+1&&(u-=this.drawSubtotalRow(0,o-1,{maxCount:u-a-1})),this.options.rowResize&&this.rowResized){var g=n-this.getElementById(this.id+"_head_table").offsetHeight,f=0;for(p=0;p<this.dataRowList.length;p++){if(!(f<g)){a=p;break}f+=this.dataRowList[p].offsetHeight}}if("native"==this.options.drawType&&0!=t&&(a=this.getDataLength()-1),l){for(p=a+1;p<this.drawedRowLength+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=0;p<=a;p++)this._setRowDisplay(p,"")}else{for(p=a+1;p<=this.lastDisplayedRow+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=this.lastDisplayedRow+1;p<=a;p++)this._setRowDisplay(p,"")}var m=l||""===this.options.visibleRowNum&&-1==this.options.initFixedHeightByRowNum;if(m){var y=0,b=this.options.backgroundColorMode.toLowerCase();if("always"!==b&&"full"!==b||(y=t),this.defaultColCnt)for(p=0;p<this.dataRowList.length;p++)this.removeRowOverStyle(this.dataRowList[p],!0);for(p=y;p<=a;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.applyRowStyleOptions(p):this.applyRowStyleOptions(o+p);this.options.autoResizeEmbeddedInput&&this.firstEmbeddedInputResize&&(this.setAutoResizeEmbeddedInput(),this.firstEmbeddedInputResize=!1)}this.lastDisplayedRow=a,m&&"all"!==this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&(a=this.cutGridBottom(a,e)),!0===this._isBrowserScroll()&&(this.lastIndex=a)}for(p=0;p<=a;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.setEvenOddBackground(p,p):this.setEvenOddBackground(p,o+p);if(this.options.lastFixedRow>0)for(p=0;p<this.options.lastFixedRow;p++)this.options.lastFixedRowStartIndex>0?(this.fastDrawRowData(a-p,this.options.lastFixedRowStartIndex+1-p),m&&this.applyRowStyleOptions(a-p),this.setEvenOddBackground(a-p,this.options.lastFixedRowStartIndex+1-p)):(this.fastDrawRowData(a-p,i-1-p),m&&this.applyRowStyleOptions(a-p),this.setEvenOddBackground(a-p,i-1-p));if(!0!==this.hiddenRowObj.init&&!l){var w=this._getVisibleLastIndex(a+1);a+1<this.drawedRowLength&&(this._setRowDisplay(w,""),this.setEvenOddBackground(w,o+w),this.applyRowStyleOptions(o+w),this.options.showLastRow&&!this.hasSubtotal?this.getDataLength()<=o+w&&this._setRowDisplay(w,"none"):this._setRowDisplay(w,"none"))}}else{var v=this.options.showLastRow&&!this.hasSubtotal?1:0,C=this.lastDisplayedRow+v;!0===this.hiddenRowObj.init&&(C=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(p=0;p<=C;p++)this._setRowDisplay(p,"none");a=this.lastDisplayedRow=-1}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),this.focusedCell.length>0&&!this.editedCell){var I,_=this.focusedCell[this.focusedCell.length-1].focusedRowIndex-this.rowIndex,x=this.focusedCell[this.focusedCell.length-1].focusedColIndex;if(0<=_&&_<=a)(I=this.options.focusDefaultColumn&&x<0&&this.defaultColCnt&&("row"===this.options.focusMode||"both"===this.options.focusMode)?this.all_data_td_list[this.defaultColCnt+x+_*(this.oneRowDataLength+this.defaultColCnt)]:this.data_td_list[x+_*this.oneRowDataLength])&&this.applyFocusedCellIn(I)}var S=WebSquare.BootLoader.fullViewed||!1,D=r.D.fullViewed||!1;if(!S&&!D&&"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")){this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(p=this.defaultColCnt;p<this.hiddenList.length;p++)1==this.hiddenList[p]&&this.setAdaptiveColumnVisible(p,!1)}return a}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.adjustDraw=function(t,e){try{void 0!==e&&null!=e||(e={})
;var i=this.rowIndex;this.dataLayerHeight;if(this.options.lazyDrawHiddenColumn)this.initVisibilityArr=this.colIndexInfo.body.visibilityArr.slice(0),this.hideInvisibleTds();else{this.rollbackCommitFlag=!1;var o=this.lastDisplayedRow;!0===this.hiddenRowObj.init&&(o=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(var a=0;a<=o-this.options.lastFixedRow;a++)this.groupbyStatus.grouped&&"object"==(0,l.Z)(this.dataList.getRealRowIndex(a+i))||(!0!==this.hiddenRowObj.init||this._getRowVisible(a+i))&&(this.options.fixedRow>0&&a<=this.options.fixedRow-1?this.lazyDrawRowData(a,a):this.lazyDrawRowData(a,a+i));this.rollbackCommitFlag=!0}t=this.options.initFixedHeightByRowNum>-1?this.adjustInitFixedByRowNum(t):""!==this.options.visibleRowNum?this.adjustVisibleRowNum(t):this.adjustDefault(t),this.maxRowLength=t,!this.isIE6or7||1==this.options.senseReader&&""==this.options.visibleRowNum||(this._setRowDisplay(t+1,""),this.dataRowList[(t+1)*this.oneRowLength]&&this.dataRowList[(t+1)*this.oneRowLength].offsetHeight,this._setRowDisplay(t+1,"none")),this.dynamicMergeHTML()}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.adjustVisibleRowNum=function(t){try{if(""===this.options.visibleRowNum||!0===this._isBrowserScroll())return t;var e=this.rowIndex,i=this.getDataLength();this.setDataTable();var o={noDraw:!0,skipResize:null!=this.lastTopRowIndex};this.setScrollYHeight(o),!0===this.hiddenRowObj.init&&this.applyStyleOptions(t);var a,n=this.getElementById(this.id+"_scrollX_div"),l=parseInt(n.style.height,10),h=this.getElementById(this.id+"_body_table"),d=0;if(!0===this.hiddenRowObj.init)this.lastDisplayedRow=t,this.lastIndex=t,a=h.offsetHeight,r.D.isIE(9)&&(a=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d);else{var u="all"==this.options.visibleRowNum?i:u=parseInt(this.options.visibleRowNum,10);this.options.initFixedHeightByRowNum>-1&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength);for(var p=t+1;p+e<i&&p<u;p++)this.drawRowData(p,p+e),t++;for(p=this.lastDisplayedRow+1;p<=t;p++)this._setRowDisplay(p,"");this.applyStyleOptions(t);for(p=t+1;p<=this.lastDisplayedRow;p++)this._setRowDisplay(p,"none");this.lastDisplayedRow=t,this.lastIndex=t,a=h.offsetHeight,r.D.isIE(9)&&(a=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d)}this.options.initFixedHeightByRowNum>-1&&i>this.options.initFixedHeightByRowNum||!(a<this.defaultDataLayerHeight)||!0===this.options.isItemTable||this._dynamicVisibleRowNum>0||(a=this.defaultDataLayerHeight);var c=0;""!==this.options.visibleRowNum&&this.options.groupbyZone&&this.groupbyZoneStatus.groupbyZoneRender&&(c=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight,this.options.groupbyFilterBox&&(c+=this.groupbyZoneStatus.groupbyFilterBoxRender.offsetHeight));var g=this.getSize("height"),f=a+l+d+c,m=!0!==this._isBrowserScroll();if(this.options.visibleRowNumFix){var y=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(!isNaN(y)){var b=this.getElementById(this.id+"_head_table").offsetHeight;f<this.oneRowHeight*y+b+l+d+1&&(m=!1)}}if((i>0||"all"==this.options.visibleRowNum)&&g!=f&&(m&&this.setSize(null,f),null!=this.lastTopRowIndex)){var w=this._getScrollRowIndex(this.lastTopRowIndex);w!==this._getScrollMaxRowIndex()&&(o.skipResize=!1,o.restRowCnt=w,this.lastTopRowIndex=null)}if(this.options.autoFit&&this._setAutoFit(),this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight,clientWidth:this.render.clientWidth},this.dataLayerHeight=h.parentNode.offsetHeight,this.setScrollYHeight(o),null==this.lastTopRowIndex){var v=this._getVisibleRowIndex(this._getScrollMaxRowIndex()),C=this._getVisibleLastIndex(this.lastIndex+1);this.rowIndex===v&&this.rowIndex+C===i&&(this.lastTopRowIndex=this.rowIndex)}return t}catch(t){s.w.printStackTrace(t,null,this)}},
I.prototype.adjustInitFixedByRowNum=function(t){try{return this.adjustVisibleRowNum(t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.adjustDefault=function(t){try{return""!==this.options.visibleRowNum||(this.adjustDraw_keepTop?this.adjustDraw_keepTop=null:this.setScrollYHeight({skipResize:!0})),t}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.drawBottomData=function(t){try{if(this.rowIndex<0||0==this.rowIndex&&t<=this.lastIndex||this.rowIndex>=0&&this.rowIndex+this.lastIndex==t||isNaN(Number(t)))return;if(!0===this._isNativeScroll())return void this.drawData(0);if(!0===this._isHybridScroll()){var e=Math.max(drawedRowLength-this._getHybridRowNum(),0),i=Math.min(t-e,0);return void this._drawDataHybrid(i)}var o=this.getDataLength();t>=o&&(t=o-1);var a=0;this.lastIndex>-1&&(a=Math.max(t-this.lastIndex,0)),this.rowIndex!==a&&this.drawData(a);var r=this.rowIndex+this.lastIndex-t,n={};n[this.rowIndex]=r;for(var l=5;Math.abs(r)>0&&null==n[this.rowIndex-r]&&l>0;)this.drawData(this.rowIndex-r),r=this.rowIndex+this.lastIndex-t,n[this.rowIndex]=r,l--}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.cutGridBottom=function(t,e){try{if(!0===this._isBrowserScroll())return;var i=this.rowIndex,o=this.dataLayerHeight,a=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody"),l=WebSquare.style.getStyle(a,"border-top-width");l="thin"==l?r.D.isIE(6)||r.D.isIE(7)?2:1:"medium"==l?r.D.isIE(6)||r.D.isIE(7)?4:3:"thick"==l?r.D.isIE(6)||r.D.isIE(7)||r.D.isOpera()?6:5:parseInt(l,10);var h=parseInt(l/2,10)-a.offsetTop;if(n.getBoundingClientRect){var d=n.getBoundingClientRect(),u=d.bottom-d.top;h+=u-parseInt(u,10)>0?1:0}for(var p=o-h,c=this.getElementById(this.id+"_body_tbody").childNodes,g=(t=-1,!0),f=this.getDataLength(),m=this.oneRowLength*f-1,y=i*this.oneRowLength,b=this.hiddenCellObj.length>0,w={row:[],cnt:0},v=0;v<c.length;v++){var C=c[v],I=!1,_=!1;if(0!==C.offsetHeight){w.row[v]="visible",w.cnt++,this.hasClass(C,"grid_body_row")?(g&&y+t<m?t++:(C.style.display="none",this.addClass(C,"w2grid_hidedRow")),I=!0):C.getAttribute("data-subtotal")&&(g||this._subtotalHidden([C]),_=!0);var x=C.offsetTop+C.offsetHeight-p;if(g&&x>0){if(g=!1,I){var S=t%this.oneRowLength;if(b){var D=this.oneRowHeight/this.oneRowLength;S=Math.floor(x/D)}for(var R=0;R<=S&&v>=R;R++){var L=c[v-R];L.style.display="none",this.addClass(L,"w2grid_hidedRow"),t--}}_&&this._subtotalHidden([C])}}else w.row[v]="hidden"}if(w.cnt-=t+1,b){var T=-1,k=-1;for(v=0;v<w.row.length&&k<t;v+=this.oneRowLength){var F=!1;for(R=0;R<this.oneRowLength;R++)"visible"===w.row[v+R]&&(!1===F&&(T++,F=!0),k++)}t=T}else if(t=Math.floor(t/this.oneRowLength),!this.senseReaderMode){if(!0!==this.hiddenRowObj.init)for(v=t+1;v<=this.drawedRowLength;v++)this._setRowDisplay(v,"none");this.lastDisplayedRow=t}var A=this.options.showLastRow&&!this.hasSubtotal,E=!(1==this.options.senseReader&&"all"!==this.options.visibleRowNum);if(A&&(!this.senseReaderMode||E)){f=this.getDataLength();var M=b?Math.floor(t/this.oneRowLength):t,O=this._getVisibleRowIndex(this._getScrollRowIndex(this.rowIndex)+M+1);if(f>0){for(;!this._getRowVisible(O)&&O<f;)O++;O<f&&this._getRowVisible(O)&&(this._setRowDisplay(O-this.rowIndex,""),this.lazyDrawRowData(O-this.rowIndex,O))}}this.lastIndex=t,!0===this.hiddenRowObj.init&&(this.lastDisplayedRow=t);var N=t;if(e&&!0===e.extraRowByCellHidden){var B=0;for(v=0;v<w.row.length&&w.cnt>0;v+=this.oneRowLength)for(F=!1,R=0;R<this.oneRowLength;R++)"visible"===w.row[v+R]&&(!1===F&&(B++,F=!0),w.cnt--);N=B}return N}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.getLastIndex=function(t){try{var e=this.dataLayerHeight;if(t<0)return this.lastDisplayedRow=-1,-1;for(;;){var i=this.dataRowList[(t+1)*this.oneRowLength-1];if(!(t>0&&i.offsetTop+i.offsetHeight>e))break;t--}return t}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.lazyDrawRowData=function(t,e){try{for(var i=0;i<this.colIndexInfo.body.invisibleTds.length;i++){
var o=this.colIndexInfo.body.invisibleTds[i]-this.defaultColCnt,a=this._getColumnMoveIndex(o);a>=0&&this.drawCellData(t,e,a,!0)}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.fastDrawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),a=this.all_data_td_list[t*this.realRowDataLength],r=0;if("number"==typeof o){if((this.groupbyStatus.grouped||this.clearGrouping)&&this.defaultColCnt>0)for(var n=a,h=!0,d=0;d<this.defaultColCnt;d++){var u=this.colIndexes.bodyColInfo.colSpanArr[d]||1;n.setAttribute("colSpan",u),n.style.display="",n.innerText="",n.textContent="",n.className.match("w2grid_groupby")&&(n.className=a.className.split(" ").splice(0,1),this.options.rowNumVisible&&h?(n.className+=" gridBodyDefault_rowNumber",h=!1):n.className+=" gridBodyDefault_rowStatus"),n=n.nextSibling}if(this.options.rowMerge){var p={rowMergeStartPoint:[],rowMergeSameDataLength:[]},c=this.getRowData(e),g=!1,f=0;for(d=0;d<c.length;d++)c[d]==c[d+1]?(g||p.rowMergeStartPoint.push(d),f++,g=!0):(g&&(f++,p.rowMergeSameDataLength.push(f)),g=!1,f=0)}this._drawRowNumData(t,e,i),this._drawRowStatus(t,e,i);var m=this.colIndexInfo.body.visibleTds,y=m.length;i&&!0===i.refreshColumn&&(y=this.oneRowDataLength);for(d=0;d<y;d++){var b;if(i&&!0===i.refreshColumn)b=d;else{var w=m[d]-this.defaultColCnt;b=this._getColumnMoveIndex(w)}if(b>=0)if(this.options.rowMerge){u=null;for(var v=0;v<p.rowMergeStartPoint.length;v++)b==p.rowMergeStartPoint[v]?u=p.rowMergeSameDataLength[v]:p.rowMergeStartPoint[v]<b&&b<p.rowMergeStartPoint[v]+p.rowMergeSameDataLength[v]&&(u=-1);this.drawCellData(t,e,b,null,u,i)}else this.drawCellData(t,e,b,null,null,i)}i&&!0===i.skipSubtotal||(r=this.drawSubtotalRow(t+1,e))}else"object"==(0,l.Z)(o)&&this.drawGroupData(a,o,t);return r}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.clearGroupedRow=function(t,e){try{if(this.defaultColCnt>0)for(var i=this.all_data_td_list[t*this.realRowDataLength],o=i,a=!0,r=0;r<this.defaultColCnt;r++){var n=this.colIndexes.bodyColInfo.colSpanArr[r]||1;o.setAttribute("colSpan",n),o.style.display="",o.innerText="",o.textContent="",o.className.match("w2grid_groupby")&&(o.className=i.className.split(" ").splice(0,1),this.options.rowNumVisible&&a?(o.className+=" gridBodyDefault_rowNumber",a=!1):o.className+=" gridBodyDefault_rowStatus"),o=o.nextSibling}for(r=0;r<this.oneRowDataLength;r++){var l=r,h=this._getColumnMoveIndex(l);h>=0&&this.drawCellData(t,e,h)}this.drawSubtotalRow(t+1,e)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.drawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),a=0;if(null==o)return a;var n=r.D.getDataPrefix("colMerged"),l=this.all_data_td_list[t*this.realRowDataLength];if("number"==typeof o){this._drawRowNumData(t,e),this._drawRowStatus(t,e);for(var h=0;h<this.oneRowDataLength;h++){var d=h,u=this.getCellInfo(d);if(this.drawCellData(t,e,d),u&&u.options.colMerge&&!this.groupbyStatus.grouped)for(var p=this._dataList.getColumnIndex(this.getColumnID(d)),c=this._dataList.dataArr[e*this._dataList.oneRowDataLength+p],g=0;g<=this.maxRowLength-t;g++){var f=this.data_td_list[(t+g)*this.oneRowDataLength+d];if(f){var m=c==this.dataList.getCellData(t+g+1,d)?"1":"0";f.setAttribute(n,m),this.drawCellData(t+g,e+g,d)}}}i&&!0===i.skipSubtotal||(a=this.drawSubtotalRow(t+1,e))}else this.drawGroupData(l,o,t);return a}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.hideNochangeDataLayer=function(t){if(null==this.hideDataLayer){this.hideDataLayer=document.createElement("div"),this.hideDataLayer.className="w2grid_fastScroll_layer";var e=document.createElement("div");e.innerHTML=this.options.scrollMsg,e.className="w2grid_fastScroll_msg",this.hideDataLayer.appendChild(e),this.getElementById(this.id+"_dataLayer").appendChild(this.hideDataLayer)}var i=this.all_data_td_list[(t-1)*this.realRowDataLength],o=i.offsetHeight;0!=o?(this.hideDataLayer.style.display="block",
this.hideDataLayer.style.top=i.offsetTop+o+1+"px"):this.hideDataLayer.style.display="none"},I.prototype.setEvenOddBackground=function(t,e){if(this.options.oddEvenColorDisplay){var i=this.data_td_list[t*this.oneRowDataLength],o=null;if(i){var s=r.D.getDataPrefix("trIndex");o=i.parentNode;do{o.style.backgroundColor=e%2==1?this.options.evenRowBackgroundColor:this.options.oddRowBackgroundColor,o=r.D.next(o)}while(null!=o&&"0"!=o.getAttribute(s))}}},I.prototype._drawRowNumData=function(t,e,i){if(this.options.rowNumVisible){var o=this.data_num_td_list[t],s="";s=o&&null!=o.textContent?"textContent":o&&null!=o.innerText?"innerText":"innerHTML",this.rowNumArr?"number"==typeof this.rowNumArr[e]&&(o[s]=1+this.rowNumArr[e]):o&&(o[s]=1+e+this.startRowNumber)}},I.prototype._drawRowStatus=function(t,e,i){if(this.options.rowStatusVisible){var o=this.data_status_td_list[t];if(o){var s,a=this._linkedDataList||this._dataList;s="linkedDataList"==a.initializeType?a.getRowStatusValue(e):this._dataList.options.depthColumn||this.groupbyStatus.grouped?a._getRowStatusValue(this.getRealRowIndex(e)):a.getRowStatusValue(e),this._drawStatus(s,o,"w2grid_rowStatus_")}}},I.prototype._drawCellStatus=function(t,e,i,o){if(this.options.cellStatusVisible){var s=this.data_td_list[i+t*this.oneRowDataLength];if(s){var a,r=this.getColumnID(i),n=this._linkedDataList||this._dataList;a="linkedDataList"==n.initializeType?n.getCellStatusValue(e,r):this._dataList.options.depthColumn||this.groupbyStatus.grouped?n._getCellStatusValue(this.getRealRowIndex(e),r):n.getCellStatusValue(e,r),this._drawStatus(a,s,"w2grid_cellStatus_","_"+this.options.cellStatusIconPosition,!0)}}},I.prototype._drawStatus=function(t,e,i,o,a){try{var n="",l="";switch("string"!=typeof o&&(o=""),t){case 0:n="R",l=WebSquare.language.getMessage("Grid_rowStatus_initialValue")||"initial value";break;case 1:n="U",l=WebSquare.language.getMessage("Grid_rowStatus_update")||"updated";break;case 2:n="C",l=WebSquare.language.getMessage("Grid_rowStatus_insert")||"inserted";break;case 3:n="D",l=WebSquare.language.getMessage("Grid_rowStatus_delete")||"deleted";break;case 4:n="V",l=WebSquare.language.getMessage("Grid_rowStatus_D_After_C")||"deleted after insertion"}var h=r.D.getDataPrefix("imageName"),d=e.getAttribute(h)||"";if((d!=n||this.clearGrouping)&&(this.removeClass(e,i+(d||"R")+o),""!=n&&this.addClass(e,i+n+o),"imageName"===h&&(e.imageName=n),e.setAttribute(h,n),!0===this.options.accessibility)){var u=e.id+"_altspan",p=document.getElementById(u);if(!p){(p=document.createElement("span")).id=u;var c=i+"span";!0===a&&(c="w2blind "+c),p.className=c,e.appendChild(p)}p.textContent=l}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.drawCellData=function(t,e,i,o,a,n){try{o||null==this.editedCell||this.editedCell.options.colIndex+""!=i+""||this.editedCell.handleCancelEdit();var l=this.data_td_list[i+t*this.oneRowDataLength];if(l){var h=this.cellInfoHash[this.tdIdList[i]];if(this.groupbyStatus.grouped||this.clearGrouping){var d=this.colIndexes.bodyColInfo.colSpanArr[i+this.defaultColCnt]||1;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}if(this.options.rowMerge)if(null==a)l.setAttribute("colSpan",""),l.style.display="",l.style.textAlign="";else if(a>0){d=a;l.setAttribute("colSpan",d),l.style.display="",l.style.textAlign=h.options.textAlign}else-1==a&&(l.style.display="none");!h.options.embeddedInput&&this.groupbyStatus.grouped&&(l.innerText="",l.textContent=""),(this.groupbyStatus.grouped||this.clearGrouping)&&this.hasClass(l,"w2grid_groupby")&&(l.className="gridBodyDefault");var u=this.aria_labelledby[i];if(u){var p=t+e+1;l.setAttribute("aria-labelledby",u+" r"+p)}if(h.options.headers&&this.options.applyScopeHeaders){var c=this.scope_id?this.scope_id+"_":"",g=r.D.getDataPrefix("headers");l.setAttribute(g,c+h.options.headers)}this.isColMerge&&h.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(t,e,i,n):this.setInnerHTML(l,e,i,n),
this._drawCellStatus(t,e,i)}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.setColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.setColMergeAndCellData(t,e,i,o);var s=this.data_td_list[i+t*this.oneRowDataLength],a=this.getHasSubtotalCount(e);if(0==t)return 0!=a&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);var n=this.getColumnID(i),l=this.dataList._getCellData(e-1,n),h=this.data_td_list[i+(t-1)*this.oneRowDataLength],d=this.upperGroupingTest(e,i,t);if(l==this.dataList._getCellData(e,n)&&d){this.options.readOnly&&this.options.readOnlyBackgroundColor?(h.style.borderBottomColor=s.style.backgroundColor,s.style.borderTopColor=s.style.backgroundColor,s.style.borderBottomColor=s.style.backgroundColor):(h.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px"),s.innerHTML="";var u=r.D.getDataPrefix("viewType"),p=r.D.getDataPrefix("inputType");if("icon"==s.getAttribute(u)){var c=s.getAttribute(p);this.removeClass(s,this.options.bodyTdClass+"_"+c)}if(this.options.senseReader&&(0==a&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomWidth="1px")),0!=a&&(s.style.borderBottomWidth="1px"),null!=h)return this.applyCellStyleOptions(e,i,!1),"mergeCellBackgroundColor"}else{var g=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==g&&!this.groupbyStatus.grouped&&(g="1px"),this.options.readOnly&&this.options.readOnlyBackgroundColor?s.style.borderTopColor=s.style.backgroundColor:s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=g}},I.prototype.setColMergeAndCellData=function(t,e,i,o){var s=this.data_td_list[i+t*this.oneRowDataLength],a=this.getHasSubtotalCount(e);if(0==t)return 0!=a&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]};var r=this.getColumnID(i);if(null==this.colMergeObj.colArr[i]){var n=this.dataList._getCellData(e-1,r),l=this.dataList._getCellData(e,r);if(this.colMergeObj.colArr[i]=n==l,this.colMergeObj.colArr[i])for(var h=0;h<this.oneRowDataLength;h++){if(null==this.colMergeObj.colArr[h])if(this.getCellInfo(h).options.colMerge){var d=this.getColumnID(h),u=this.dataList._getCellData(e-1,d),p=this.dataList._getCellData(e,d);this.colMergeObj.colArr[h]=u==p}else this.colMergeObj.colArr[h]=!0}}var c=!0;for(h=0;h<this.colMergeObj.colArr.length;h++)if(!this.colMergeObj.colArr[h]){c=!1;break}var g=this.data_td_list[i+(t-1)*this.oneRowDataLength];if(c)g.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px",s.innerHTML="",this.options.senseReader&&(0==a&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(g.style.borderBottomWidth="1px")),0!=a&&(s.style.borderBottomWidth="1px");else{var f=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==f&&(f="1px"),s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=f}},I.prototype.drawColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.drawColMergeAndCellData(t,e,i,o);var s=this.getColumnID(i),a=this.data_td_list[i+t*this.oneRowDataLength];if(this.options.readOnly&&this.options.readOnlyBackgroundColor||(a.style.borderBottomWidth="0px"),0!=t||o){var n=this.getHasSubtotalCount(e);0==n&&(this.options.readOnly&&this.options.readOnlyBackgroundColor||(a.style.borderBottomWidth="0px"));var l=this.dataList._getCellData(e-1,s),h=this.data_td_list[i+(t-1)*this.oneRowDataLength];this.options.readOnly&&this.options.readOnlyBackgroundColor||(a.style.borderTopWidth="0px")
;var d=this.upperGroupingTest(e,i,t),u=this.dataList._getCellData(e,i),p=WebSquare.style.getComputedStyle(h,"border-right-width"),c=WebSquare.style.getComputedStyle(h,"border-left-width"),g="";if("0px"!=p?g=WebSquare.style.getComputedStyle(h,"border-right-color"):"0px"!=c&&(g=WebSquare.style.getComputedStyle(h,"border-left-color")),l==u&&d){null!=h&&(this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=a.style.backgroundColor:h.style.borderBottomWidth="0px");var f=r.D.getDataPrefix("colMerged"),m=r.D.getDataPrefix("viewType"),y=r.D.getDataPrefix("inputType");if(this.options.readOnly&&this.options.readOnlyBackgroundColor?(a.style.borderTopColor=a.style.backgroundColor,a.style.borderBottomColor=a.style.backgroundColor,t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(h.style.borderBottomColor=g)):(a.style.borderTopWidth="0px",a.style.borderBottomWidth="0px"),a.setAttribute(f,"1"),a.innerHTML="",0!=n&&(a.style.borderBottomWidth="1px"),"icon"===a.getAttribute(m)){var b=a.getAttribute(y);this.removeClass(a,this.options.bodyTdClass+"_"+b)}if(null!=h&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else this.options.readOnly&&this.options.readOnlyBackgroundColor?h.style.borderBottomColor=g:a.style.borderTopWidth="1px"}},I.prototype.drawColMergeAndCellData=function(t,e,i,o){var s=this.getColumnID(i),a=this.data_td_list[i+t*this.oneRowDataLength];if(a.style.borderBottomWidth="0px",0!=t||o){var n=this.getHasSubtotalCount(e);if(0==n&&(a.style.borderBottomWidth="0px"),this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]},null==this.colMergeObj.colArr[i]){var l=this.dataList._getCellData(e-1,s),h=this.dataList._getCellData(e,s);if(this.colMergeObj.colArr[i]=l==h,this.colMergeObj.colArr[i])for(var d=0;d<this.oneRowDataLength;d++){if(null==this.colMergeObj.colArr[d])if(this.getCellInfo(d).options.colMerge){var u=this.getColumnID(d),p=this.dataList._getCellData(e-1,u),c=this.dataList._getCellData(e,u);this.colMergeObj.colArr[d]=p==c}else this.colMergeObj.colArr[d]=!0}}var g=!0;for(d=0;d<this.colMergeObj.colArr.length;d++)if(!this.colMergeObj.colArr[d]){g=!1;break}if(g){var f=this.data_td_list[i+(t-1)*this.oneRowDataLength];null!=f&&(f.style.borderBottomWidth="0px");var m=r.D.getDataPrefix("colMerged");if(a.style.borderTopWidth="0px",a.style.borderBottomWidth="0px",a.setAttribute(m,"1"),a.innerHTML="",0!=n&&(a.style.borderBottomWidth="1px"),null!=f&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else a.style.borderTopWidth="1px"}},I.prototype.upperGroupingTest=function(t,e,i){try{var o=this.getCellInfo(e),a=o.options.upperColumn;if(this.hasSubtotal&&this.hasUpperSubtotalRow(t))return!1;if(""!=a){if(i){var n=r.D.getDataPrefix("colMerged"),l=this.getColumnIndex(a),h=this.data_td_list[l+i*this.oneRowDataLength],d=this.getCellInfo(l);if(h&&""==h.style.width&&(""==d.options.upperColumn||d.options.upperColumn&&"1"!=h.getAttribute(n))&&"1"!=h.getAttribute(n)&&1==d.options.colMerge&&!this.groupbyStatus.grouped)return!1}if(this.dataList._getCellData(t,a)!=this.dataList._getCellData(t-1,a))return!1;var u=this.getCellInfo(a);if(u.options.upperColumn&&""!=u.options.upperColumn&&u.options.upperColumn!=o.id)return this.upperGroupingTest(t,a,i)}else{if(this.dataList._getCellData(t,e)!=this.dataList._getCellData(t-1,e))return!1}return!0}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.setDataTable=function(){try{var t=this.getElementById(this.id+"_head_table"),e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_body_tbody");if(this.dataLayerHeight=e.parentNode.offsetHeight,""===this.options.visibleRowNum&&0==this.dataLayerHeight)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({
rowIndex:-1==this.rowIndex?0:this.rowIndex});this.defaultDataLayerHeight||(this.isIE6or7||r.D.isOpera()?this.defaultDataLayerHeight=this.getElementById(this.id+"_main_div").offsetHeight:this.defaultDataLayerHeight=this.dataLayerHeight);var o=0,a=this.getDataLength();if(!0===this._isHybridScroll()){var n=Math.ceil((this.render.offsetHeight-t.offsetHeight)/this.oneRowHeight),l=Math.min(this._getHybridRowNum()+n,a);o=Math.max(l,1)}else if(this.options.senseReader&&"all"===this.options.visibleRowNum)o=a;else if(""===this.options.visibleRowNum)if(this.options.initFixedHeightByRowNum>-1)o=parseInt(this.options.initFixedHeightByRowNum,10)+1;else{var h=this.oneRowHeight;this.hiddenCellObj.length>0&&(h=this.oneRowHeight/this.oneRowLength),o=parseInt((this.dataLayerHeight-t.offsetHeight)/h)+1}else o="all"===this.options.visibleRowNum?a:parseInt(this.options.visibleRowNum,10);if(0==this.drawedRowLength&&(this.tdCellClassArr=new Array(o*this.oneRowLength)),o>this.drawedRowLength){var d=this.drawedRowLength;this.drawedRowLength=o;var u=[],p=!!(this.subtotalStrList&&Object.keys(this.subtotalStrList).length>0);0==d&&p&&(u=u.concat(this.createSubtotalRows(-1)));for(var c=d;c<this.drawedRowLength;c++){for(var g=[],f=0;f<this.oneRowLength;f++){var m=this.tempTr.rows[f].cloneNode(!0);g[f]=m,u.push(m),this.tdCellClassArr.push(null)}this.addBodyRow(c,g),p&&(u=u.concat(this.createSubtotalRows(c)))}0==this.drawedRowLength?e.style.borderWidth="0px":e.style.borderWidth="";for(f=0;f<u.length;f++)i.appendChild(u[f]);for(c=d+this.hiddenRowObj.extraRow;c<this.drawedRowLength+this.hiddenRowObj.extraRow;c++)this._setRowDisplay(c,"none")}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.applyStyleOptions=function(t){try{for(var e=this.rowIndex>=0?this.rowIndex:0,i=0;i<=t+1+this.hiddenRowObj.extraRow&&i<this.drawedRowLength+this.hiddenRowObj.extraRow;i++)"object"!=(0,l.Z)(this.dataList.getRealRowIndex(i+e))&&(this.options.fixedRow>0&&i<=this.options.fixedRow-1||this.options.lastFixedRow>0&&i>t-this.options.lastFixedRow?this.applyRowStyleOptions(i):(!this.hiddenRowObj.length>0||this._getRowVisible(i+e))&&this.applyRowStyleOptions(i+e))}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._setCheckboxHead=function(t){try{if(t)if(1==this.htmlInfo.head.rowArr.length)this.checkHeader(this.bodyToHeaderRelation[t]);else for(var e in this.headerToBodyRelation)this.headerToBodyRelation[e]==t&&this.checkHeader(e);else for(var e in this.headerInfoHash)this.checkHeader(e)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.applyColumnStyleOptions=function(t){try{t=this.getColumnIndex(t);for(var e=0;e<this.drawedRowLength;e++)this.applyCellStyleOptions(e+this.rowIndex,t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.applyRowStyleOptions=function(t,e){try{var i=this._getTrIndex(t);e&&(i=this._getTrIndex(this.getDisplayRowIndex(t)));for(var o=0,a=this.rowIndex;a<t&&this.hiddenRowObj.length>0;a++)this._getRowVisible(a)||o++;if(i<0||i-o>=this.drawedRowLength)return;var r=this.dataRowList[this.oneRowLength*i];if(!r&&!e)return;if(r&&"none"==r.style.display&&!e)return;if(this.options.fixedRow>0&&i==this.options.fixedRow-1){var n=this.dataRowList[this.oneRowLength*(i+1)-1];this.addClass(n,"w2grid_fixedRow")}if(this.options.lastFixedRow>0&&i==this.lastIndex-this.options.lastFixedRow+1){n=this.dataRowList[this.oneRowLength*(i-1)];this.addClass(n,"w2grid_lastFixedRow")}if(this.options.lazyDrawHiddenColumn){var l=this.colIndexInfo.body.visibleTds,h=i*this.oneRowDataLength;for(a=this.defaultColCnt;a<l.length;a++){var d=l[a]-this.defaultColCnt;this.all_data_td_list[h+d]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),d):this.applyCellStyleOptions(t,d))}}else for(a=0;a<this.oneRowDataLength;a++){h=i*this.oneRowDataLength;this.data_td_list[h+a]&&(e?this.applyCellStyleOptions(this.getDisplayRowIndex(t),a):this.applyCellStyleOptions(t,a))}var u=!0===this._isHybridScroll(),p=r,c="w2grid_lastRow_hybrid"
;if(this.hasSubtotal&&this.lastSubtotalRow?(p=this.lastSubtotalRow,c="w2grid_lastRow_subtotal_hybrid"):this.oneRowLength>1&&(p=this.dataRowList[this.oneRowLength*(i+1)-1]),t===this.getRowCount()-1?(this.__addClass(r,"w2grid_lastRow"),u&&this.__addClass(p,c)):this.hasClass(r,"w2grid_lastRow")&&(this.__removeClass(r,"w2grid_lastRow"),u&&this.__removeClass(p,c)),this.hasSubtotal&&!0===this._isBrowserScroll()){var g="w2grid_firstRow_subtotal_native";0===t?this.__addClass(r,g):this.hasClass(r,g)&&this.__removeClass(r,g)}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.setAutoResizeEmbeddedInput=function(){try{for(var t=this.data_td_list,e="",i=null,o=null,a=0,n=0,l=!1,h=r.D.getDataPrefix("inputType"),d=r.D.getDataPrefix("colindex"),u=r.D.getDataPrefix("col_id"),p=0;p<t.length;p++)if("text"==t[p].getAttribute(h)||"secret"==t[p].getAttribute(h)){e=t[p].getAttribute(u),o=this.cellInfoHash[e];var c=!1;if((this.dom[o.mainGridId+o.id]||this.dom[t[p].getAttribute("id")+"_"+t[p].getAttribute(h)])&&(c=!0),1==o.options.embeddedInput&&c){null==(i=this.getInput(o,t[p])).render.parentNode&&(t[p].innerHTML="",t[p].appendChild(i.render)),"none"==t[p].parentNode.style.display&&(t[p].parentNode.style.display="",l=!0);var g=parseInt(t[p].getAttribute(d),10);this.embeddedStyleObj||(this.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t[p],"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t[p],"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t[p],"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t[p],"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(i.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(i.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(i.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(i.render,"padding-right"),10)});var f=parseInt(WebSquare.style.getStyle(i.render,"border-top-width"),10),m=parseInt(WebSquare.style.getStyle(i.render,"border-bottom-width"),10),y=parseInt(WebSquare.style.getStyle(i.render,"border-left-width"),10),b=parseInt(WebSquare.style.getStyle(i.render,"border-right-width"),10);a=t[p].offsetHeight-parseInt(WebSquare.style.getStyle(t[p],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[p],"border-bottom-width"),10),a-=this.embeddedStyleObj.top+this.embeddedStyleObj.bottom,a-=f+m,this.embeddedWidthObj[g]&&!this.embeddedWidthObj[g].isChanged||(this.embeddedWidthObj[g]={isChanged:!1,width:t[p].clientWidth}),n=this.embeddedWidthObj[g].width,n-=this.embeddedStyleObj.left+this.embeddedStyleObj.right,n-=y+b,n-=this.embeddedStyleObj.inputLeft+this.embeddedStyleObj.inputRight,r.D.isOpera()&&(a+=2),l?t[p].parentNode.style.display="none":r.D.isIE("6 7")&&(a-=2),i.setSize(n-2,a-(this.embeddedStyleObj.inputTop+this.embeddedStyleObj.inputBottom)),i.setStyle("lineHeight",a+"px")}}else if("calendar"==t[p].getAttribute(h)){e=t[p].getAttribute(u),o=this.cellInfoHash[e];var w=null;if(1==o.options.embeddedInput){null==(w=this.getInput(o,t[p])).render.parentNode&&(t[p].innerHTML="",t[p].appendChild(w.render)),"none"==t[p].parentNode.style.display&&(t[p].parentNode.style.display="",l=!0),a=t[p].offsetHeight-parseInt(WebSquare.style.getStyle(t[p],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[p],"border-bottom-width"),10),a-=this.embeddedCalendarStyleObj.top+this.embeddedCalendarStyleObj.bottom;g=parseInt(t[p].getAttribute(d),10);this.embeddedWidthObj[g]&&!this.embeddedWidthObj[g].isChanged||(this.embeddedWidthObj[g]={isChanged:!1,width:t[p].clientWidth}),n=this.embeddedWidthObj[g].width,n-=this.embeddedCalendarStyleObj.left+this.embeddedCalendarStyleObj.right,l?t[p].parentNode.style.display="none":r.D.isIE("6 7")&&(a-=2),w.setSize(n-2,a)}}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.applyCellStyleOptions=function(t,e,i,o){try{var a=this._getTrIndex(t),n=this._getTdElem(t,e);if(n){var l,h,d,u=[],p=!1;if("number"==typeof e?(l=e,h=this.cellIdList[e]):(l=this.bodyIdColIndexMap[e],
h=e),this._linkedDataList)d=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var c=!0;for(var g in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[g]){d=this._dataList.filteredRowIndexArr[t],c=!1;break}c&&(d=this.groupbyStatus.groupedRowIndexArr[t])}else d=this._dataList.filteredRowIndexArr[t];var f=this.cellInfoHash[h]||{options:{}};if("custom"==f.options.inputType&&(f=f.cellManagerHashByRowIndex[d]?f.cellManagerHashByRowIndex[d]:f),"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&"true"==f.options.hidden)return;null!=this.initStyleValueObj[l]&&u.push(this.initStyleValueObj[l].style),""!=f.options.textAlign&&u.push("text-align:"+f.options.textAlign),this.options.adjustAlign&&"left"==f.options.textAlign&&u.push("padding-left:"+this.options.adjustAlign+"px"),null!=this.defaultStyleValueObj[l]&&u.push(this.defaultStyleValueObj[l].style);var m=null,y=null,b=null,w=null,v=null,C=!1;(t<this.options.fixedRow||l<this.options.fixedColumn||l>=this.tdIdList.length-this.options.fixedRightColumn)&&(C=!0),null!=d?(m="number"==typeof d?this.rowStyleArr[d]:this.rowStyleArr[d.type+"_"+d.groupId],y="number"==typeof d?this.rowStyleFixedArr[d]:this.rowStyleFixedArr[d.type+"_"+d.groupId],b="number"==typeof d?this.rowStyleDataArr[d]:this.rowStyleDataArr[d.type+"_"+d.groupId],w="number"==typeof d?this.cellStyleArr[d*this.oneRowDataLength+l]:this.cellStyleArr[d.type+"_"+d.groupId+"_"+l],v=this.cellClassArr[d*this.oneRowDataLength+l]):v=this.cellClassArr[t*this.oneRowDataLength+l],null!=m&&u.push(this.rowStyleValueObj[m].style),null!=y&&C&&u.push(this.rowStyleFixedValueObj[y].style),null==b||C||u.push(this.rowStyleDataValueObj[b].style);var I=this.columnStyleValueObj[l],_=this.columnStyleFixedValueObj[l],x=this.columnStyleDataValueObj[l];null!=I&&u.push(this.columnStyleValueObj[l].style),null!=_&&C&&u.push(this.columnStyleFixedValueObj[l].style),null==x||C||u.push(this.columnStyleDataValueObj[l].style),null!=this.adaptiveColumnStyleValueObj[l]&&!0===this.checkRefreshAdaptive()&&u.push(this.adaptiveColumnStyleValueObj[l].style),null!=w&&u.push(this.cellStyleValueObj[w].style),m=="rowResizeStyle_"+t&&u.push(this.rowStyleValueObj[m].style);var S=this.___getEditReadOnly(t,e);""!=this.options.readOnlyBackgroundColor&&"number"==typeof d&&(1==S?(u.push(this.readOnlyTdStyle),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0))),""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(1==S?(u.push(this.readOnlyTdImg),this.options.readOnlyBackgroundImgCSS||(r.D.isIE(8)||r.D.isIE(6)||r.D.isIE(7))&&(u.push("filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\""),u.push("-ms-filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\"")),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0))),n.disabled=!1,n.removeAttribute("disabled");var D=this.cellDisabledArr[d*this.oneRowDataLength+l],R=D;if(!0!==D&&!1!==D){var L=f.options.disabled,T=this.rowDisabledArr[d],k=this.options.disabledPriority;!0!==T&&!1!==T&&(T=""),D="column"===k&&""!==L?L:"row"===k&&""!==T?T:L+""=="true"||T+""=="true"||L+""!="false"&&T+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}!0!==D&&"true"!==D||(u.push(this.disabledTdStyle),
this.disabledCellStyleObj&&this.disabledCellStyleObj[t+"_"+e]&&this.disabledCellStyleObj[t+"_"+e].style&&u.push(this.disabledCellStyleObj[t+"_"+e].style));var F=this.options.focusMode;if(o&&(F="cell"),!i&&"transparent"!=this.options.selectedRowColor&&("row"==F||"both"==F))for(var A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&e<this.options.fixedColumn)){u.push("background-color:"+this.options.selectedRowColor),p=!0;break}if(!i&&"transparent"!=this.options.selectedCellColor&&("cell"==F||"both"==F))for(A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&e==this.focusedCell[A].focusedColIndex){u.push("background-color:"+this.options.selectedCellColor),p=!0;break}("none"!=n.style.display||this.hiddenCellObj.length>0)&&!0!==this.hiddenCellObj[t+"_"+e]||u.push("display:none");var E=!1;this.hiddenCellObj.length>0&&(!0===this.hiddenCellObj[t+"_"+e]&&"none"!==n.style.display||!0!==this.hiddenCellObj[t+"_"+e]&&"none"===n.style.display)&&(E=!0);var M=u.join(";"),O=r.D.getDataPrefix("style_bak"),N=r.D.getDataPrefix("colMerged"),B=r.D.getDataPrefix("or_bgColor"),H=n.style.borderBottomWidth;(M!=n.getAttribute(O)||this.groupbyStatus.grouped||E)&&(n.style.cssText=M);var G=this.cellStyleValueObj[w];if(G&&G["background-repeat"]?n.style.backgroundRepeat=G["background-repeat"]:G&&G["background-size"]?n.style.backgroundSize=G["background-size"]:G&&G["background-position"]&&(n.style.backgroundPosition=G["background-position"]),this.isColMerge&&f.options.colMerge&&!this.groupbyStatus.grouped){n.setAttribute(N,"0");var W=this.drawColMergeCellData(a,t,e);if(this.options.senseReader&&H&&-1!=H.indexOf("px")&&(n.style.borderBottomWidth=H),"mergeCellBackgroundColor"===W&&!p){var V,q=this.getCellStyleValue(t-1,h,"background-color",!0)||this.getColumnStyleValue(e,"background-color"),j=!0;n.readOnly||this.__getEditReadOnly(n,t)?(V=q,this.options.readOnlyBackgroundColor?V=this.options.readOnlyBackgroundColor:(f.options.readOnlyClass||this.options.readOnlyClass)&&(j=!1)):(V=""!=q?q:t%2?this.options.oddRowBackgroundColor:this.options.evenRowBackgroundColor,!this.options.disabledClass||!0!==D&&"true"!==D||(j=!1)),j&&(n.style.backgroundColor=V,this._setMergeCellBackground(t,h,V)),""!=f.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,f.options.readOnlyClass):this.removeClass(n,f.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,this.options.readOnlyClass):this.removeClass(n,this.options.readOnlyClass))}}if(n.setAttribute(O,M),n.setAttribute(B,n.style.backgroundColor),this.cellReadOnlyArr[d*this.oneRowDataLength+e]||S?(n.setAttribute("readonly","true"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&n.setAttribute("tabIndex",-1):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):!1===this.cellReadOnlyArr[d*this.oneRowDataLength+e]||!1===S?(n.setAttribute("readonly","false"),this.options.senseReader&&!f.options.embeddedInput?"linear"===this.options.focusFlow&&n.setAttribute("tabIndex",0):"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0)):n.removeAttribute("readonly"),null!=v){var P=a*this.oneRowDataLength+e;this.tdCellClassArr[P]&&this.tdCellClassArr[P]!=v&&this.removeClass(n,this.tdCellClassArr[P]),this.tdCellClassArr[P]=v,this.addClass(n,v)}else{P=a*this.oneRowDataLength+e;this.tdCellClassArr[P]&&(this.removeClass(n,this.tdCellClassArr[P]),this.tdCellClassArr[P]=void 0)}if(""!=f.options.disabledClass&&(!0===D||"true"===D?this.addClass(n,f.options.disabledClass):this.removeClass(n,f.options.disabledClass)),!0!==R&&"true"!==R||(""!=this.options.disabledClass?this.addClass(n,this.options.disabledClass):this.removeClass(n,this.options.disabledClass)),
""!=this.options.hiddenClass||""!=f.options.hiddenClass){var z=this.options.hiddenClass;""!=f.options.hiddenClass&&(z=f.options.hiddenClass);var X=this._getRealColIndex("body",f.options.col_id)+this.defaultColCnt;this.hiddenList[X]?this.addClass(n,z):this.removeClass(n,z)}}}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.dynamicMergeHTML=function(){try{for(var t in this.tdMergeInfo){var e=this.data_td_list[t];this.tdMergeInfo[t].orgColSpan>1?e.setAttribute("colSpan",this.tdMergeInfo[t].orgColSpan):e.removeAttribute("colSpan"),this.tdMergeInfo[t].orgRowSpan>1?e.setAttribute("rowSpan",this.tdMergeInfo[t].orgRowSpan):e.removeAttribute("rowSpan"),e.style.display=this.tdMergeInfo[t].display,delete this.tdMergeInfo[t]}var i=this.getRowCount(),o=!0===this._isBrowserScroll()?i:Math.min(this.lastIndex+2,i),a=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=!1;for(var l in this.cellMergeInfo){var h=l.split("_"),d=Number(h[0]),u=d;if(!(a&&(d=this.getDisplayRowIndex(d),isNaN(d)||d<0))){var p=Number(h[1]),c=d;this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>d||this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow||(c-=this.rowIndex));var g=this.cellMergeInfo[l].rowSpan,f=this.cellMergeInfo[l].colSpan;if(a){for(var m=g,y=0;y<m;y++)0==this.drilldown.statusArr[u+y]&&g--;g=Math.max(g,1)}var b=0;if(this.hiddenRowObj.length>0)for(y=this.rowIndex;y<d;y++)this._getRowVisible(y)||b++;if(!(c<0&&c+g<=0||c-b>=o||(c<this.options.fixedRow&&c+g>this.options.fixedRow&&(g=c+g-this.options.fixedRow-b,c=this.options.fixedRow),c<this.options.fixedRow&&d>=this.options.fixedRow))){var w=0,v=0;if(this.hiddenRowObj.length>0)for(y=0;y<g;y++)this._getRowVisible(c+y+this.rowIndex)||(v++,y===w&&w++);c+(g-=v)>o+b&&(g=o-c+b);var C=g,I=this.oneRowLength;for(y=0;y<C;y++){for(var _=!1,x=0;x<f;x++){t=(c+y)*this.oneRowDataLength+(p+x);if(null!=(e=this.data_td_list[t]))if(this.hiddenRowObj.length>0&&!this._getRowVisible(c+y+this.rowIndex))e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),_=!0;else if(this.tdMergeInfo[t]={orgColSpan:e.getAttribute("colSpan"),orgRowSpan:e.getAttribute("rowSpan"),display:e.style.display},y===w&&0===x){f>1?(e.setAttribute("colSpan",f),n=!0):e.removeAttribute("colSpan");var S=g*I;if(S>1)if(I>1){var D=parseInt(e.getAttribute("rowSpan"),10);!isNaN(D)&&D>1&&(e.setAttribute("rowSpan",S),n=!0)}else e.setAttribute("rowSpan",g),n=!0;else e.removeAttribute("rowSpan");e.style.display=""}else e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),e.style.display="none"}!0===_&&C++}}}}!0===n&&this.isWebKit&&r.D.setTimeout(this.redrawTable,{key:this.id+"_dynamicMergeHTML",delay:50,caller:this})}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.createSubtotalRows=function(t){var e=[];for(var i in this.subtotalTableList){var o=this.subtotalRowHash[i];null==o&&(o=[]);for(var s=this.subtotalTableList[i],a=0;a<s.rows.length;a++){var r=s.rows[a].cloneNode(!0);if(r.style.display="none",this.options.rowNumStatusUniqueId)for(var n=r.getElementsByTagName("td"),l=0;l<this.defaultColCnt;l++){var h=n[l].getAttribute("id");"_headerRowNumber"!==h&&"_headerRowStatus"!==h||n[l].setAttribute("id",h+"_subtotal_"+t)}r.setAttribute("data-subtotal",i+"_"+a),o.push(r),e.push(r)}this.subtotalRowHash[i]=o}return e},I.prototype.addBodyRow=function(t,e){var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),a=0,n=0,l="grid_body_row";!0===this._isBrowserScroll()&&(l+=" "+this.options.gridNativeClass);for(var h=r.D.getDataPrefix("tdIndex"),d=r.D.getDataPrefix("or_wd"),u=r.D.getDataPrefix("col_id"),p=r.D.getDataPrefix("width"),c=0;c<e.length;c++){this.dataRowList.push(e[c]),e[c].className=l;for(var g=e[c].getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.className;m.setAttribute(h,t*this.realRowDataLength+a),m.removeAttribute("title");var b=m.getAttribute(p)
;if(b&&(m.removeAttribute(p),m.setAttribute(d,b)),this.options.rowNumStatusUniqueId){var w=m.getAttribute("id");"_headerRowNumber"!==w&&"_headerRowStatus"!==w||m.setAttribute("id",w+"_bodyRow_"+t)}if(a++,this.all_data_td_list.push(m),i.test(y))this.data_num_td_list.push(m);else if(o.test(y))this.data_status_td_list.push(m);else if(!this.hasSubtotal||s.test(y)){this.data_td_list.push(m);var v=this.id+"_columnstyle_"+n+"_";this.addClass(m,v);var C=m.getAttribute(u),I=this.getCellInfo(C);if(this.addClass(m,I.options.className),m.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",m.setAttribute("id",this.id+"_cell_"+t+"_"+n),this.options.fixedColumn>0){var _=this.getFixedColumnLastIndex();_==f&&this.addClass(m,"w2grid_fixedColumn"),_>f&&this.addClass(m,"w2grid_fixedColumn_td")}if(this.options.fixedRightColumn>0){var x=this.getFixedRightColumnLastIndex();x==f&&this.addClass(m,"w2grid_fixedRightColumn"),x<=f&&this.addClass(m,"w2grid_fixedRightColumn_td")}n++,"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||"custom"==I.options.inputType&&1==this.options.senseReader||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&"user"!=I.options.inputType&&"ul"!=I.options.tableRender&&("expression"==I.options.inputType&&1==this.options.senseReader||m.setAttribute("tabIndex","0")),this.event.addListener(m,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}!0===this._isBrowserScroll()&&this.addClass(m,this.options.gridNativeClass)}}var S=[];if(!this.options.duplicateColumnId){for(c=0;c<e.length;c++){g=e[c].getElementsByTagName("td");var D=[];for(f=0;f<g.length;f++)D[f]=g[f];for(f=0;f<D.length;f++){y=D[f].className;i.test(y)||o.test(y)||S.push(D[f].parentNode.removeChild(D[f]))}}for(c=0;c<this.htmlInfo.body.rowArr.length;c++)for(f=0;f<this.htmlInfo.body.rowArr[c].length;f++)for(var R=this.htmlInfo.body.rowArr[c][f].col_id,L=0;L<S.length;L++)if(S[L].getAttribute(u)==R){e[c].appendChild(S[L]);break}}},I.prototype.addBodyRow2=function(t,e){for(var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),a=[],n=r.D.getDataPrefix("tdIndex"),l=r.D.getDataPrefix("or_wd"),h=r.D.getDataPrefix("col_id"),d=r.D.getDataPrefix("width"),u=0;u<e.length;u++){this.dataRowList.push(e[u]),e[u].className="grid_body_row";for(var p=e[u].getElementsByTagName("td"),c=0;c<p.length;c++){var g=p[c],f=g.className,m=parseInt(g.getAttribute(n),10)%this.realRowDataLength;g.setAttribute(n,t*this.realRowDataLength+m),g.removeAttribute("title");var y=g.getAttribute(d);if(y&&(g.removeAttribute(d),g.setAttribute(l,y)),this.options.rowNumStatusUniqueId){var b=g.getAttribute("id");"_headerRowNumber"!==b&&"_headerRowStatus"!==b||g.setAttribute("id",b+"_bodyRow_"+t)}if(i.test(f))this.data_num_td_list.push(g),this.all_data_td_list.push(g);else if(o.test(f))this.data_status_td_list.push(g),this.all_data_td_list.push(g);else if(!this.hasSubtotal||s.test(f)){var w=m-this.defaultColCnt;a[w]=g;var v=this.id+"_columnstyle_"+w+"_";this.addClass(g,v);var C=g.getAttribute(h),I=this.getCellInfo(C);this.addClass(g,I.options.className),g.style.cssText=""==I.options.textAlign?"":"text-align:"+I.options.textAlign+";",g.setAttribute("id",this.id+"_cell_"+t+"_"+w),"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(I.options.embeddedInput||("link"!=I.options.inputType&&"button"!=I.options.inputType&&"image"!=I.options.inputType&&g.setAttribute("tabIndex","0"),this.event.addListener(g,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}}}[].push.apply(this.all_data_td_list,a),[].push.apply(this.data_td_list,a)},I.prototype.addRows=function(t){for(var e=this.drawedRowLength,i=[],o=0;o<t;o++){for(var s=0;s<this.oneRowLength;s++){var a=this.tempTr.rows[s].cloneNode(!0);i.push(a)}this.addBodyRow(e+o,[]),
this.hasSubtotal&&(i=i.concat(this.createSubtotalRows(e+o)))}var r=this.getElementById(this.id+"_body_tbody");for(o=0;o<i.length;o++)r.appendChild(i[o])},I.prototype.notifyStatusChanged=function(t){var e,i,o=!1;"object"==(0,l.Z)(t.rowIndex)?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getRowCount()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var s=e;s<i;s++){var a;if(a=o?t.rowIndex[s]:s,null!=this.rowStatusColIDArr)for(var r=0;r<this.rowStatusColIDArr.length;r++){var n=this.getColumnIndex(this.rowStatusColIDArr[r]);this.drawCellData(a-this.rowIndex,a,n)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))},I.prototype.refreshColumn=function(t){try{t=this.getColumnIndex(t),this.redrawColumn(t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.refreshRow=function(t){try{var e=t-this.rowIndex;this.drawRowData(e,t)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype.refreshCell=function(t,e){try{e=this.getColumnIndex(e);var i=t-this.rowIndex;this.drawCellData(i,t,e)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._setVisibleRowNumFix=function(){try{if(!this.options.visibleRowNumFix)return;var t=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(t)||t<0||""==t)return;!0===this._visibleRowNumFixResetFlag&&this.setTrRowTable();var e=this._getVisibleRowNumHeight(!0);this.setSize(null,e)}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._getVisibleRowNumHeight=function(t){try{var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(e))return 0;!0===t&&this.oneRowLength>1&&(e*=this.oneRowLength);var i=this.getElementById(this.id+"_scrollX_div"),o=parseInt(i.style.height,10),a=0;this.hasFooter&&(a=0==(a=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:a);var r=this.getElementById(this.id+"_head_table").offsetHeight;return this.oneRowHeight*e+r+o+a+1}catch(t){s.w.printStackTrace(t,null,this)}},I.prototype._getDrawedRowCount=function(){try{for(var t=0,e=this.getElementById(this.id+"_body_tbody").childNodes,i=0;i<e.length;i++){e[i].offsetHeight>0&&t++}}catch(e){s.w.printStackTrace(e,null,this),t=this.drawedRowLength}return t};var _=function(){};_.prototype.setCellInfo=function(){for(var t=r.D.getDataPrefix("inputType"),e=r.D.getDataPrefix("depthColumn"),i=r.D.getDataPrefix("showDepth"),o=this.tempDiv.getElementsByTagName("td"),s=0;s<o.length;s++){"drilldown"==o[s].getAttribute(t)&&(this.isDrillDown=!0,this.depthColumn=o[s].getAttribute(e),this.showDepth=o[s].getAttribute(i),this._dataList.options.depthColumn||"grid"==this.options.pluginName&&!this.options.drilldownRealRowIndex||(this._dataList.options.depthColumn=this.depthColumn))}},_.prototype.setDataListCellInfo=function(){if(this.successBinding)for(var t=this.getColCnt(),e=0;e<t;e++){var i=this.getColumnID(e),o=this.getCellInfo(i);if(o&&o.options&&o.options.importExp){var s=this._dataList.getCellInfo(i);s&&s.options&&!s.options.importExp&&(s.options.importExp=o.options.importExp)}}},_.prototype.setInnerHTML=function(t,e,i,o){var s=this.getColumnID(i),a=this.dataList._getCellData(e,s),r=this.cellInfoHash[this.tdIdList[i]];""===a&&(a=r.options.groupName?this.dataList._getCellData(e,r.options.groupName)==r.options.groupValue?r.options.trueValue:r.options.falseValue:r.options.defaultValue);if(r.setInnerHTML(t,a,e,i,o),""!=r.options.disabledClass&&(this._getEditDisabled(e,i)?this.addClass(t,r.options.disabledClass):this.removeClass(t,r.options.disabledClass)),""!=this.options.disabledClass&&!1===this.options.disabled&&(this._getEditDisabled(e,i)?this.addClass(t,this.options.disabledClass):this.removeClass(t,this.options.disabledClass)),
""!=r.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,r.options.readOnlyClass):this.removeClass(t,r.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,this.options.readOnlyClass):this.removeClass(t,this.options.readOnlyClass)),""!=this.options.hiddenClass||""!=r.options.hiddenClass){var n=this.options.hiddenClass;""!=r.options.hiddenClass&&(n=r.options.hiddenClass);var l=this._getRealColIndex("body",s)+this.defaultColCnt;this.hiddenList[l]?this.addClass(t,n):this.removeClass(t,n)}},_.prototype.getCellInfo=function(t){try{var e=r.D.getDataPrefix("col_id"),i="";return i="string"==typeof t?t:"number"==typeof t?this.tdIdList[t]:t?t.getAttribute(e):null,this.cellInfoHash[i]||{options:{}}}catch(t){s.w.printStackTrace(t,null,this)}},_.prototype._endEdit=function(){null!=this.editedCell&&this.editedCell.handleEndEdit()},_.prototype.initColumns=function(){for(var t in this.cellInfoHash){var e=this.cellInfoHash[t];if("select"==e.options.inputType&&(e.initializeCellInfo(e.element),e.style="",e.comp=null),this.options.initColumns)for(var i in e.dynamicAttrInfo){var o=e.dynamicAttrInfo[i];o&&(e.options[i]=o.originalValue,"displayFormat"!=i&&"displayFormatter"!=i||e.initFormatter())}}},_.prototype.initHeaders=function(){for(var t in this.headerInfoHash){"checkbox"==this.headerInfoHash[t].options.inputType&&this.setHeaderValue(t,!1)}},_.prototype._setCellInfo=function(t,e){this.cellInfoHash2[t]=e},_.prototype.getColumnCount=function(){return this.tdIdList.length},_.prototype.getColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[t];return e||null},_.prototype.getMovedColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[this.columnOrder[t]];return e||null},_.prototype.getColumnIndex=function(t){return"number"==typeof t?t:this.bodyIdColIndexMap[t]},_.prototype.getDisplayColumnIndex=function(t){return"number"==typeof t?t:this.colMoveIndexMap[t]},_.prototype.setExpressionAssociation=function(t,e){try{null==this.expressionAssArr[t]&&(this.expressionAssArr[t]=[]),this.expressionAssArr[t].push(e)}catch(t){s.w.printStackTrace(t,null,this)}},_.prototype.setLabelColumnAssociation=function(t,e){try{null==this.labelColumnAssArr[t]&&(this.labelColumnAssArr[t]=[]),this.labelColumnAssArr[t].push(e)}catch(t){s.w.printStackTrace(t,null,this)}},_.prototype.setCellEditMode=function(t,e){this.hideTooltip();var i=this.getCellInfo(t);this.editedCell=i,this.rollbackCommitFlag=!1;var o=this.render.offsetWidth,s=this.render.offsetHeight;i.setEditMode(t,e),o===this.render.offsetWidth&&s===this.render.offsetHeight||(this.handleResize(),i.setEditMode(t,e)),this.rollbackCommitFlag=!0},_.prototype.setCellClickEdit=function(t){var e=this.getElemRowIndex(t),i=this.getCellInfo(t);if("custom"==i.options.inputType&&!i.internal){var o=e;this.isDrillDown&&this._dataList.options.depthColumn&&(o=this.getRealRowIndex(e)),i=i.cellManagerHashByRowIndex[o]?i.cellManagerHashByRowIndex[o]:i}var s=!1;switch(i.options.inputType){case"checkbox":case"radio":case"drilldown":s=i.handleClick(t,e)}return s},_.prototype.getInput=function(t,e,i){var n=t.options.inputType||"text",l=t.options.embeddedInput,h=this.getColumnOption(t.id,"dataType");"text"===n&&"number"===h&&"true"===this.options.floatNumber&&(h="float",t.options.dataType="float");var d,c="bigDecimal"==h,g=this;if(this.options.titleFormatter)try{if("function"!=typeof this.options.titleFormatter){var f=r.D.getGlobalFunction(this.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.options.titleFormatter=f,d=f.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i))}else d=this.options.titleFormatter.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i)}catch(t){s.w.printStackTrace(t,null,this)}if(l){if("custom"==t.options.inputType&&!t.internal){var m=this.getElemRowIndex(e);this.isDrillDown&&this._dataList.options.depthColumn&&(m=this.getRealRowIndex(m)),
t=t.cellManagerHashByRowIndex[m]?t.cellManagerHashByRowIndex[m]:t}y=t.parentColumnInfo?this.id+"_"+t.id:e.getAttribute("id")+"_"+n,this.fakeInput||"text"!=n&&"secret"!=n&&"calendar"!=n||(this.makeFakeInput=function(){this.fakeInput=new WebSquare.uiplugin.input(this.id+"_fakeInput",{style:"visibility:hidden;position:absolute;z-index:100;background-color:"+this.options.selectedCellColor,className:"w2grid_embedded_input",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",useKeyupBlur:!1,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){g.lastEvent=t,u.B.stopEvent(t);var e=this;setTimeout((function(){e.lastInput.focus()}),1)}}},{name:"oncontextmenu",action:"script",param:{handler:function(t){g.lastEvent=t}}},{name:"ondblclick",action:"script",param:{handler:function(t){g.lastEvent=t,g.hideFakeInput(this),u.B.stopPropagation(t),g.F2Mode=!0,WebSquare.text.setCaretPos(this.lastInput.render,this.lastInput.render.value.length)}}}]}),this.fakeInput.setAction=function(){},this.fakeInput.writeTo(this.render),this.fakeInput.activate(),this.fakeInput.render.parentNode.removeChild(this.fakeInput.render);var t=null;this.showFakeInput=function(e){var i=e.render.parentNode;if(this.render.appendChild(this.fakeInput.render),!t){var o=this.all_data_td_list[0];t=1-o.offsetLeft}var s=this.getElementById(this.id+"_dataLayer");this.fakeInput.setPosition(i.offsetLeft+t-s.scrollLeft,i.offsetTop+t-s.scrollTop),this.fakeInput.setSize(i.clientWidth,i.clientHeight),r.D.isIE()&&this.fakeInput.setVerticalAlign(),this.fakeInput.lastInput=e;var a=e.getStyle("text-align");a?this.fakeInput.setStyle("text-align",a):this.fakeInput.setStyle("text-align","")},this.hideFakeInput=function(t){this.fakeInput.render.parentNode&&this.fakeInput.render.parentNode.removeChild(this.fakeInput.render)}})}else var y=t.mainGridId+t.id;var b=!!(V=this.dom[y]);V&&(V.render?"select"!=n||!l||V.render.parentElement||this.groupbyStatus.grouped||(b=!1):V.ownerDocument&&!V.parentNode&&(b=!1)),b&&""!==d&&null!=d&&("text"==n?V.render.setAttribute("title",d):V.setAttribute("title",d));var w=r.D.getDataPrefix("col_id"),v=r.D.getDataPrefix("rowIndex"),C=r.D.getDataPrefix("rowindex");r.D.getDataPrefix("dateValidCheck");if(b){if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){T=this.getElemRowIndex(e),k=this._getGroupbyDisplayRowIndex(T),F=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+T,A=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(E=t.options.checkboxLabelColumn.split(","),M="",O=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",N=0;N<E.length;N++){B=this.bodyToHeaderRelation[E[N]];if(N===E.length-1)this.options.showCheckboxLabelUserFormat?M+=" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0}):M+=this._getCellDisplayData(T,E[N],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){H=WebSquare.language.getMessage("Grid_row")||"row";M+=(0===N?T+1+H+O:"")+" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0})+O}else M+=this._getCellDisplayData(T,E[N],{removeTag:!0})+O}A=A?M+O+A:M}if(t.options.checkboxLabelFormatter)try{"function"==typeof(G=r.D.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(A=G.call(this,k,this.getColumnIndex(t.colID),A))}catch(e){p.k.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}(I=e.getElementsByTagName("label")[0])&&(I.innerText=A)}}else if("radio"==n&&l){if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var I;T=this.getElemRowIndex(e),k=this._getGroupbyDisplayRowIndex(T),P=(j=t.mainGridId+"_radio_"+t.id)+"_"+T,z=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(E=t.options.radioLabelColumn.split(","),M="",O=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",N=0;N<E.length;N++){B=this.bodyToHeaderRelation[E[N]]
;if(N===E.length-1)this.options.showRadioLabelUserFormat?M+=" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0}):M+=this._getCellDisplayData(T,E[N],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){H=WebSquare.language.getMessage("Grid_row")||"row";M+=(0===N?T+1+H+O:"")+" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0})+O}else M+=this._getCellDisplayData(T,E[N],{removeTag:!0})+O}z=z?M+O+z:M}if(t.options.radioLabelFormatter)try{"function"==typeof(X=r.D.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(z=X.call(this,k,this.getColumnIndex(t.colID),z))}catch(e){p.k.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}(I=e.getElementsByTagName("label")[0])&&(I.innerText=z)}}else if("text"==n&&l){if(!(U=d||t.options.title||"")){x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";this.options.titleAuto&&("text"==n&&""!==i?U=x+" "+i:"text"==n&&""==i?U=x+WebSquare.language.getMessage("Grid_text"):"secret"==n&&(U=x+WebSquare.language.getMessage("Grid_secret")),V.render.title=U)}}this.options.titleFormatter&&l&&d&&V.title!==d&&(V.title=d)}else{if("text"!=n&&"secret"!=n||!l){if("select"==n&&l){var _=d||t.options.title||"";if(this.options.titleAuto&&!_){var x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";_=""!==i&&null!=i?x+" "+(this.changeItemValue("label",t.id,[i])[0]||i):x+WebSquare.language.getMessage("Grid_select")}V=new WebSquare.uiplugin.selectbox_native(y,{className:"w2grid_embedded_select",style:"$blank",pluginName:"selectbox",renderType:"native",title:_,emptyItem:t.options.emptyItem,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){u.B.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:return void u.B.stopPropagation(t)}}}}]},t.xml),e.innerHTML=V.toHTML();var S=WebSquare.uiplugin.selectbox_native.prototype.handleOnchange;V.handleOnchange=function(t){var e=this.render.parentNode.getAttribute(w),i=parseInt(this.render.getAttribute(C),10),o=g._getGroupbyDisplayRowIndex(i),s=g.getColumnIndex(e),a=this.selectedIndex,r=this.getValue();if(S.call(this,t),g.dataList.__setCellData(i,e,this.getValue()),g._dataList.setRowPosition(i),a!=this.selectedIndex){var n={oldValue:r,newValue:this.getValue(),oldSelectedIndex:a,newSelectedIndex:this.selectedIndex,rowIndex:i,colIndex:s,colId:g.getColumnID(s)};u.B.fireEvent(g,"onviewchange",n)}u.B.fireEvent(g,"onafteredit",o,s,this.getValue(),t)};var D=WebSquare.uiplugin.selectbox.prototype.refreshItemset;V.refreshItemset=function(t){var e=this.render.parentNode.getAttribute(w),i=parseInt(this.render.getAttribute(C),10);D.call(this,t);var o=g._dataList.getCellData(i,e);this.setValueNM(o)},V.activate();var R=V.uuid;V.event.addListener2(V.dom.select,"onfocus",(function(t){g.lastEvent=t;var e=WebSquare.idCache[R];g.getLastFocusedCell().focusedTd==e.render.parentNode||g.focusedByApi||g._setFocusedCell(e.render.getAttribute(C),e.render.parentNode.getAttribute(w)),g.focusedByApi=!1}))}else if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){var L,T=this.getElemRowIndex(e),k=this._getGroupbyDisplayRowIndex(T),F=(L=t.mainGridId+"_checkbox_"+t.id)+"_"+T,A=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(var E=t.options.checkboxLabelColumn.split(","),M="",O=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",N=0;N<E.length;N++){var B=this.bodyToHeaderRelation[E[N]];if(N===E.length-1)this.options.showCheckboxLabelUserFormat?M+=" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0}):M+=this._getCellDisplayData(T,E[N],{removeTag:!0});else if(this.options.showCheckboxLabelUserFormat){
var H=WebSquare.language.getMessage("Grid_row")||"row";M+=(0===N?T+1+H+O:"")+" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0})+O}else M+=this._getCellDisplayData(T,E[N],{removeTag:!0})+O}A=A?M+O+A:M}if(t.options.checkboxLabelFormatter)try{var G;"function"==typeof(G=r.D.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(A=G.call(this,k,this.getColumnIndex(t.colID),A))}catch(e){p.k.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}q="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check'  id='"+F+"' name='"+L+"'/>";var W="<label class='w2checkbox_label ' for='"+F+"'>"+A+"</label>";"left"===t.options.checkboxLabelPosition?q=W+q:q+=W,e.innerHTML=q;var V=e.getElementsByTagName("input")[0]}else{q="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check' />",e.innerHTML=q;V=e.getElementsByTagName("input")[0];if(d)V.title=d;else if(t.options.title)V.title=t.options.title;else if(this.options.titleAuto){x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";V.title=i?x+WebSquare.language.getMessage("Grid_title"):x+WebSquare.language.getMessage("Grid_title_not_choose"),A&&(V.title=V.title+A)}}if(this.event.addListener(V,"onclick",this.event.bindAsEventListener(this,(function(t){var e=u.B.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),a=this.getCellInfo(o),r=a.id,n=this.getColumnIndex(r);if(!0===this.options.useShiftKeyCheck&&t.shiftKey){var l={td:o,rowIndex:s,checked:e.checked};this._ShiftKeyMultiCheck(this,l,o)}!0===this.options.useShiftKeyCheck&&(this.beforeChecked={td:o,rowIndex:s,checked:e.checked}),i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,r),this.focusedByApi=!1,a.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&u.B.preventDefault(t)}))),t.options.noDisabledOnReadOnly){var T=this.getElemRowIndex(e);this._getEditReadOnly(T,t.id)?this.addClass(V,this.options.readOnlyClass+"_nodisabled"):this.removeClass(V,this.options.readOnlyClass+"_nodisabled")}}else if("radio"==n&&l){var q;if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var j,T=this.getElemRowIndex(e),k=this._getGroupbyDisplayRowIndex(T),P=(j=t.mainGridId+"_radio_"+t.id)+"_"+T,z=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(var E=t.options.radioLabelColumn.split(","),M="",O=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",N=0;N<E.length;N++){var B=this.bodyToHeaderRelation[E[N]];if(N===E.length-1)this.options.showRadioLabelUserFormat?M+=" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0}):M+=this._getCellDisplayData(T,E[N],{removeTag:!0});else if(this.options.showRadioLabelUserFormat){var H=WebSquare.language.getMessage("Grid_row")||"row";M+=(0===N?T+1+H+O:"")+" "+this.getHeaderValue(B)+" "+this._getCellDisplayData(T,E[N],{removeTag:!0})+O}else M+=this._getCellDisplayData(T,E[N],{removeTag:!0})+O}z=z?M+O+z:M}if(t.options.radioLabelFormatter)try{var X;"function"==typeof(X=r.D.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(z=X.call(this,k,this.getColumnIndex(t.colID),z))}catch(e){p.k.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}q="<INPUT style='border-width:0px;' type='radio' class='w2grid_embedded_radio'  id='"+P+"' name='"+j+"'/>";W="<label class='w2radio_label ' for='"+P+"'>"+z+"</label>";"left"===t.options.radioLabelPosition?q=W+q:q+=W,e.innerHTML=q;V=e.firstChild}else{q="<INPUT style='border-width:0px;' type='radio' name='"+(t.mainGridId+"_radio_"+t.id)+"' class='w2grid_embedded_radio' />",e.innerHTML=q;V=e.firstChild;if(d)V.title=d;else if(t.options.title)V.title=t.options.title;else if(this.options.titleAuto){x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";V.title=i?x+WebSquare.language.getMessage("Grid_title"):x+WebSquare.language.getMessage("Grid_title_not_choose"),z&&(V.title=V.title+z)}}
if(this.event.addListener(V,"onclick",this.event.bindAsEventListener(this,(function(t){var e=u.B.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),a=this.getCellInfo(o),r=a.id,n=this.getColumnIndex(r);i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,r),this.focusedByApi=!1,a.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&u.B.preventDefault(t)}))),t.options.noDisabledOnReadOnly){T=this.getElemRowIndex(e);this._getEditReadOnly(T,t.id)?this.addClass(V,this.options.readOnlyClass+"_nodisabled"):this.removeClass(V,this.options.readOnlyClass+"_nodisabled")}}else if("calendar"==n&&l){var U=d||t.options.title||"";if(this.options.titleAuto&&!U){x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U=""!==i?x+" "+i:x+WebSquare.language.getMessage("Grid_calendar")}var Z=t.options.ioFormat,K={style:"width:0px; height:0px;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:Z,ioFormatter:"$blank",displayFormat:t.options.displayFormat||Z,displayFormatter:"$blank",displayFormatFunc:t.options.displayFormatFunc,calendarDisplayFormatFunc:t.options.calendarDisplayFormatFunc,footerDiv:!0,renderDiv:!0,keepFocusSelect:!0,focusOnOuterDiv:!0,renderType:"native",readOnly:"$blank",disabled:"$blank",title:U,validCheck:!1,_scope_obj_uuid:t.options._scope_obj_uuid,senseReader:t.options.senseReader,accessibility:this.options.accessibility,disableAfterDate:t.options.disableAfterDate,disableBeforeDate:t.options.disableBeforeDate,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=this.render.parentNode.getAttribute(w),o=g.getColumnIndex(i);u.B.fireEvent(g,"oncellclick",e,o,i),u.B.stopPropagation(t)}}},{name:"onafterviewchange",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(C),10),i=g._getGroupbyDisplayRowIndex(e),o=g.getColumnIndex(this.render.parentNode.getAttribute(w));t.oldValue!=t.newValue&&u.B.fireEvent(g,"onviewchange",{oldValue:t.oldValue,newValue:t.newValue,rowIndex:i,colIndex:o,colId:g.getColumnID(o)})}}},{name:"ondateselect",action:"script",param:{handler:function(t,e){this.options.senseReader||this.dom.input.blur();var i=this.render.getAttribute(C),o=this.render.parentNode.getAttribute(w),s=this.getValue();g.dataList.__setCellData(i,o,s),i=parseInt(i,10);var a=g.getColumnIndex(o);u.B.fireEvent(g,"ondateselect",i,a,t,e)}}},{name:"onconfirm",action:"script",param:{handler:function(){this.options.senseReader||this.dom.input.blur();var t=this.render.getAttribute(C),e=this.render.parentNode.getAttribute(w),i=V.validator.validateString(this.getValue());g.dataList.__setCellData(t,e,i)}}},{name:"onyearselect",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(C),10),i=g.getColumnIndex(this.render.parentNode.getAttribute(w));u.B.fireEvent(g,"onyearselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onmonthselect",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(C),10),i=g.getColumnIndex(this.render.parentNode.getAttribute(w));u.B.fireEvent(g,"onmonthselect",e,i,{oldValue:t.oldValue,newValue:t.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(t){var e={rowIndex:parseInt(this.render.getAttribute(C),10),colIndex:g.getColumnIndex(this.render.parentNode.getAttribute(w)),data:[[t]]};return u.B.fireEvent(g,"onbeforepaste",e)}}}]};V=new WebSquare.uiplugin.inputCalendar(y,K,t.element);try{t.element&&!t.element.getAttribute("dateValidCheck")&&(V.options.dateValidCheck=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false")}catch(t){s.w.printStackTrace(t,null,this)}e.innerHTML="",V.writeTo(e),V.parentControl||this.addControl(V),Z!=V.options.ioFormat&&(t.options.ioFormat=V.options.ioFormat,t.initFormatter()),V.setVerticalAlign=function(){},
V.handleKeyupEvent=function(){};var Y=WebSquare.uiplugin.inputCalendar.prototype.handleFocusEvent;V.handleFocusEvent=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return u.B.stopEvent(t),!1;var e=this.render.getAttribute(C),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute(w);if(g.lastEvent=t,g.getLastFocusedCell().focusedTd==this.render.parentNode||g.focusedByApi||g._setFocusedCell(e,o),Y.call(this,t),g.focusedByApi=!1,!this.reFocus&&(g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),this.select(),this.focus(),g.fakeInput.render.parentNode)){var s=g.getColumnIndex(o);u.B.fireEvent(g,"onbeforeedit",i,s,g._dataList.getCellData(e,s))}g.F2Mode=!1,this.reFocus=!1};var $=WebSquare.uiplugin.inputCalendar.prototype.handleKeyEvent;V.handleKeyEvent=function(t){g.lastEvent=t,$.call(this,t);var e=this.dom[V.id+"_input"];switch(t.keyCode){case 46:return void u.B.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void u.B.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(e,e.value.length),g.hideFakeInput(this),void u.B.stopPropagation(t);case 9:for(var i=this.event.getTargetIterator(t,this.render);i.next();){if(i.match("w2inputCalendar_divInput")){u.B.stopPropagation(t);break}if(i.match("w2inputCalendar_button")&&t.shiftKey){u.B.stopPropagation(t);break}}return}var o=t.which||t.keyCode;g.nonCharKeys[o]||(32!=o?(g.fakeInput.render.parentNode&&g.hideFakeInput(this),u.B.stopPropagation(t)):u.B.stopPropagation(t))};var J=WebSquare.uiplugin.inputCalendar.prototype.handleBlurEvent;V.handleBlurEvent=function(t){var e,i=this.render.getAttribute(C),o=g._getGroupbyDisplayRowIndex(i),s=this.render.parentNode.getAttribute(w),a=g.getColumnIndex(s),r=V.validator.validateString(this.getValue()),n=WebSquare.historyManager.get(this.options.pluginName,this.id);if(n&&(e=n.value),this.options.disableDateValidSet&&this.disableValidate(r))return null!=n.value&&this._setValue(n.value,{skipValidate:!0}),!1;if(!1===this.validate(r)&&""!=r){if(this.options.dateValidSet&&this.options.dateValidSetCustom);else if(this.options.dateValidSet&&null!=n.value&&this._setValue(n.value,{skipValidate:!0}),"false"!==this.options.displaymessage){var l=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format";this.options.invalidMessageFunc||alert(l)}return!1}if(u.B.fireEvent(g,"oneditend",o,a,r,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=this.render.parentNode&&g._setFocusedCell(i,s),u.B.stopEvent(t),!1;g.editEndFlag=!1,J.call(this,t);var h=g.getCellInfo(s);g.dataList.__setCellData(i,s,r),r=g._dataList.getCellData(i,s),"all"==h.options.applyFormat||this.options.displayFormat||(r=h.getDisplayData(r));var d=V.sub_validator.validateString(r);this._setValue(d,{skipValidate:!0}),u.B.fireEvent(this,"onafterviewchange",{oldValue:e,newValue:r});u.B.fireEvent(g,"onafteredit",i,a,r,g.lastEvent);g.F2Mode=!1},V.setStyle("z-index","10"),V.activate(),this.fakeInput||this.makeFakeInput()}else if("text"==n||"textImage"==n||"drilldown"==n||"secret"==n){ot=t.options.type?t.options.type:"text",U=d||"";"secret"==n&&(ot="password"),c&&(h="bigDecimal");at={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;z-index:10;",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"all"==t.options.applyFormat?"":"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",title:U,type:ot,dataType:h,editType:t.options.editType,byteCheckIgnoreChar:t.options.byteCheckIgnoreChar,maxlength:t.options.maxLength||t.options.maxlength||-1,maskFormat:t.options.maskFormat,maskFormatModelNumber:t.options.maskFormatModelNumber,customModelFormatter:t.options.customModelFormatter,customModelUnformatter:t.options.customModelUnformatter,
customPasteFormatter:this.options.customPasteFormatter,useMaxLength:t.options.useMaxLength,adjustMaxLength:t.options.adjustMaxLength,useKeyupBlur:!1,inputMode:t.options.inputMode||"",_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"ondblclick",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);u.B.fireEvent(g,"oneditdblclick",i,o,t.id)}}}]};t.options.maskFormat&&"display"==t.options.applyFormat&&(at.displayFormat=t.options.displayFormat),t.internal&&(at=o.x.extend(o.x.extend(at,t.initializeInfo.options))),"float"===t.options.dataType&&(at.dataType=t.options.dataType),(V=new WebSquare.uiplugin.input(y,at,t.element)).writeTo(this),this.options.editInputClass&&"text"==n&&this.addClass(V.render,this.options.editInputClass),V.event.addListener(V.render,"oncopy",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),V.event.addListener(V.render,"onpaste",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),V.activate(),"number"==t.options.dataType?""==t.options.displayFormat?V.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):t.options.maskFormat&&t.options.displayFormat||V.validator.addCommand(new WebSquare.validator.numberCommand):"euro"==t.options.dataType?V.validator.addCommand(new WebSquare.validator.euroCommand(V.options.delimiter,V.options.decimalDelimiter)):"text"==t.options.dataType&&(t.options.maskFormat&&t.options.displayFormat||(t.options.applyFormat="display")),V.setVerticalAlign=function(){},this._moveKeyEdit(V.uuid,"handleKeydownEvent",{oldMode:!0})}else if("textarea"==n){if(l){var Q,tt,et;e&&(T=this.getElemRowIndex(e),Q=this.getColumnIndex(e.getAttribute(w)),tt=this._getEditDisabled(T,Q),et=this.___getEditReadOnly(T,Q));var it="position:relative;display:none;width:150px;height:60px;resize:none;";!0!==this.options.accessibility&&(it+="z-index:1000;"),V=new WebSquare.uiplugin.textarea(y,{style:it,className:"$blank",readOnly:!0===et?et:"$blank",disabled:!0===tt?tt:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.options.accessibility,xmlEvents:[{name:"onkeydown",action:"script",param:{handler:function(t){9!==(t.charCode?t.charCode:t.keyCode)&&u.B.stopPropagation(t)}}}]},t.element);J=WebSquare.uiplugin.textarea.prototype.handleBlurEvent;V.handleBlurEvent=function(t){J.call(this,t);var e=parseInt(this.render.getAttribute(C),10),i=this.render.parentNode.getAttribute(w),o=g.getCellInfo(i),s=this.getValue();"number"==o.mainGrid.getColumnOption(o.options.col_id,"dataType")&&""!=s&&(s=Number(s)),o.mainGrid.dataList.__setCellData(e,i,s)}}else{K={style:"position:absolute;display:none;width:150px;height:60px;z-index:1000;resize:none;",className:"$blank",readOnly:"$blank",disabled:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid};!0===t.options.keepCellClass&&(K.className=""),t.internal&&(K=o.x.extend(o.x.extend(K,t.initializeInfo.options))),V=new WebSquare.uiplugin.textarea(y,K,t.element)}V.writeTo(this),V.event.addListener(V.render,"oncopy",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),V.event.addListener(V.render,"onpaste",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),this._moveKeyEdit(V.uuid,"handleKeydownEvent"),V.activate()}else if("calendar"==n){Z=t.options.ioFormat,K={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:Z,ioFormatter:"$blank",displayFormat:t.options.displayFormat||Z,applyFormat:t.options.applyFormat||"display",displayFormatter:"$blank",holidayRef:t.options.holidayRef||"",keepFocusSelect:!0,focusOnOuterDiv:!0,footerDiv:t.options.footerDiv,_scope_obj_uuid:t.options._scope_obj_uuid,readOnly:"$blank",disabled:"$blank",validCheck:!1,renderDiv:!0,
inputReadOnly:t.options.inputReadOnly,unformatOnPaste:t.options.unformatOnPaste,pickerType:t.options.pickerType,fixPickerStatus:t.options.fixPickerStatus,xmlEvents:[{name:"ondateselect",action:"script",param:{handler:function(e,i){var o=t.editRowIndex,s=g.getColumnIndex(t.id);u.B.fireEvent(g,"ondateselect",o,s,e,i)}}},{name:"onmonthselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);u.B.fireEvent(g,"onmonthselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onyearselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);u.B.fireEvent(g,"onyearselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onbeforepaste",action:"script",param:{handler:function(e){var i={rowIndex:t.editRowIndex,colIndex:g.getColumnIndex(t.id),data:[[e]]};return u.B.fireEvent(g,"onbeforepaste",i)}}}]};t.internal&&(K=o.x.extend(o.x.extend(K,t.initializeInfo.options)));V=new WebSquare.uiplugin.inputCalendar(y,K,t.element);try{0==t.internal?t.element&&!t.element.getAttribute("dateValidCheck")&&(V.options.dateValidCheck=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false"):1!=t.options.dateValidCheck&&"true"!=t.options.dateValidCheck||(V.options.dateValidCheck="true")}catch(t){s.w.printStackTrace(t,null,this)}V.writeTo(this),V.event.addListener(V.render,"oncopy",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),V.event.addListener(V.render,"onpaste",this.event.bindAsEventListener(this,(function(t){u.B.stopPropagation(t)}))),Z!=V.options.ioFormat&&(t.options.ioFormat=V.options.ioFormat,t.initFormatter()),this._moveKeyEdit(V.uuid,"handleKeyEvent"),V.activate(),V.setVerticalAlign=function(){},"display"===t.options.applyFormat&&(V.handleKeyupEvent=function(){}),V.setStyle("z-index","10"),V.options.dateValidSet&&V.options.dateValidSetCustom&&(V._skipDateValidSet=!0)}else if("autoComplete"==n&&l){(K={}).titleStr=d,K.input_id=y,K.dataRowIndex=v,K.dataCol_id=w,V=t.getInput(t,e,i,K)}}else{var U=d||t.options.title||"",x=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";U||this.options.titleAuto&&("text"==n&&""!==i?U=x+" "+i:"text"==n&&""==i?U=x+WebSquare.language.getMessage("Grid_text"):"secret"==n&&(U=x+WebSquare.language.getMessage("Grid_secret")));var ot=t.options.type?t.options.type:"text",st="w2grid_embedded_input";"secret"==n&&(ot="password",r.D.isIEAllVersion()?st+=" w2grid_secret":st="w2grid_embedded_secret");var at={className:st,style:"$blank",ioFormat:"$blank",ioFormatter:"$blank",readOnly:"$blank",disabled:"$blank",hidden:"$blank",title:U,type:ot,adjustMaxLength:t.options.adjustMaxLength,useMaxLength:t.options.useMaxLength,useKeyupBlur:!1,accessibility:this.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=this.render.parentNode.getAttribute(w),o=g.getColumnIndex(i);u.B.fireEvent(g,"oncellclick",e,o,i),u.B.stopPropagation(t)}}},{name:"oncopy",action:"script",param:{handler:function(t){u.B.stopPropagation(t)}}},{name:"onpaste",action:"script",param:{handler:function(t){u.B.stopPropagation(t)}}},{name:"oncut",action:"script",param:{handler:function(t){u.B.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){this._SenSeReaderBeforeEditValue=null;var e={},i=this.render.parentNode.getAttribute(w);e.rowIndex=parseInt(this.render.getAttribute(v),10),e.colIndex=g.getColumnIndex(i),e.colID=i,e.keyCode=t.charCode?t.charCode:t.keyCode,this._SenSeReaderBeforeEditValue=this.render.value,e.oldValue=this.render.value,u.B.fireEvent(g,"oneditkeydown",e)}}},{name:"onkeyup",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode,i=this.render.parentNode.getAttribute(w),o={rowIndex:parseInt(this.render.getAttribute(v),10),colIndex:g.getColumnIndex(i),colID:i,oldValue:this._SenSeReaderBeforeEditValue||"",
newValue:this.render.value,inputType:"text",keyCode:e};this._SenSeReaderBeforeEditValue=null,u.B.fireEvent(g,"oneditkeyup",o),u.B.stopPropagation(t)}}}]};!0!==this._isBrowserScroll()&&at.xmlEvents.unshift({name:"onmousedown",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(v),10),i=this.render.parentNode.getAttribute(w);if(e-g.rowIndex>=g.lastIndex+1)return u.B.stopEvent(t),g.addGridScroll(1),void g._setFocusedCell(e,i,!0)}}}),"float"===t.options.dataType&&(at.dataType=t.options.dataType),t.options.delimiter="",V=new WebSquare.uiplugin.input(y,o.x.extend(o.x.extend({},t.options),at)),e.innerHTML="",V.writeTo(e),"number"==t.options.dataType&&(""==t.options.displayFormat?V.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):V.validator.addCommand(new WebSquare.validator.numberCommand)),r.D.isIE()&&V.setVerticalAlign(),V.setVerticalAlign=function(){};var rt=WebSquare.uiplugin.input.prototype.handleBlurEventBasic,nt=this.uuid;V.handleBlurEventBasic=function(t){var e=parseInt(this.render.getAttribute(C),10),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute(w),s=g._dataList.getColumnIndex(o),a=g.getColumnIndex(o),n=V.validator.validateString(this.getValue());if(u.B.fireEvent(g,"oneditend",i,a,n,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=this.render.parentNode&&g._setFocusedCell(e,o),u.B.stopEvent(t),!1;g.editEndFlag=!1,rt.call(this,t,{skipEditEnd:!0});var l=g.getCellInfo(o),h=g.getColumnOption(l.id,"dataType");if(this._isNumberType(h)){var d=n.wq_trim();"."!==d&&"-"!==d&&"+"!==d&&","!==d&&d!=="+"+l.options.decimalDelimiter&&d!=="-"+l.options.decimalDelimiter||(n="")}var p=!(!g.isDrillDown||!g._dataList.options.depthColumn),c=e,f=g._dataList.getRealRowIndex(c);p&&(c=f);var m=g._dataList.dataArr[f*g._dataList.getColumnCount()+s];if(g.dataList.__setCellData(e,o,n),n=g._dataList.getCellData(c,o),"all"==l.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||l._changeDisplayFormat||(n=l.getDisplayData(n)),this.setValue(n),WebSquare.idCache[nt].options.senseReader&&this.options.customFormatter){var y=null;try{"function"==typeof this.options.customFormatter?y=this.options.customFormatter:"function"==typeof(y=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=y)}catch(t){y=null}var b=n,v=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&v&&(b=this.formatter.format(n)),"function"==typeof y){this.useCustomFormatter=!0;var I=y.call(this.mainGrid,n,b,i,s);this.render.value=I}}u.B.fireEvent(g,"onafteredit",i,a,n,g.lastEvent);m!=n&&u.B.fireEvent(g,"onviewchange",{oldValue:m,newValue:n,rowIndex:i,colIndex:a,colId:g.getColumnID(a)}),g.hideFakeInput(V),g.F2Mode=!1};var lt=WebSquare.uiplugin.input.prototype.handleFocusValueEventAdv;V.handleFocusValueEventAdv=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return u.B.stopEvent(t),!1;var e=parseInt(this.render.getAttribute(C),10),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute(w);g.lastEvent=t;var s,a=g.getLastFocusedCell();if(!(!g.isDrillDown||!g._dataList.options.depthColumn)&&(e=g._dataList.getRealRowIndex(e)),a.focusedTd!=this.render.parentNode&&(s=!g.focusedByApi||a.focusedRowIndex===e&&a.focusedColIndex===g.getColumnIndex(o)?g._setFocusedCell(e,o):g._setFocusedCell(e,o,!1)),!1!==s){var r=this.reFocus;if(lt.call(this,t),this.reFocus=r,g.focusedByApi=!1,!this.reFocus){var n=g._dataList.getCellData(e,o);if(n!==this.getValue()&&(this.formatter&&(n=this.formatter.format(n)),this.setValue(n)),g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),"select"===this.options.editType&&this.select(),this.focus(),g.fakeInput.render.parentNode){var l=g.getColumnIndex(o);u.B.fireEvent(g,"onbeforeedit",i,l,g._dataList.getCellData(e,l))}}g.F2Mode=!1,this.reFocus=!1}}
;var ht=WebSquare.uiplugin.input.prototype.handleKeydownEvent;V.handleKeydownEvent=function(t){switch(g.lastEvent=t,ht.call(this,t),t.keyCode){case 46:return void u.B.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void u.B.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(this.render,this.render.value.length),g.hideFakeInput(this),void u.B.stopPropagation(t);case 9:for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2inputCalendar_divInput")){u.B.stopPropagation(t);break}return}var i=t.which||t.keyCode;if(!g.nonCharKeys[i])if(32!=i){if(g.fakeInput.render.parentNode){var o=this.render.getAttribute(C),s=g._getGroupbyDisplayRowIndex(o),a=this.render.parentNode.getAttribute(w),r=g.getColumnIndex(a);u.B.fireEvent(g,"onbeforeedit",s,r,g.dataList._getCellData(o,r)),g.hideFakeInput(this)}u.B.stopPropagation(t)}else u.B.stopPropagation(t)},V.activate(),this.fakeInput||this.makeFakeInput()}this.dom[y]=V,l&&this.adaptiveEmbeddedInputIdList.push(y)}return V},_.prototype.getTemporaryDataCollectionItemArr=function(t){try{var e=[],i=this.modelControl.getDataComp(t.dataCompID);if(i)switch(i.initializeType){case"linkedDataList":for(var o={},a=0;a<i.filteredRowIndexArr.length;a++){var r=i.getRealRowIndex(a),n=i._dataList.dataArr[r*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[r*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataList":for(o={},a=0;a<i.filteredRowIndexArr.length;a++){n=i.dataArr[i.filteredRowIndexArr[a]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i.dataArr[i.filteredRowIndexArr[a]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataMap":for(o={},a=0;a<i._dataList.oneRowDataLength;a++){n=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}}return e}catch(t){s.w.printStackTrace(t)}};var x=function(){};x.prototype.initializeHead=function(){try{this.headerObj={},this.headerConfigOptions={};for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=[],i={},o=0;o<t.length;o++){if(i[t[o].id]){var n=WebSquare.language.getMessage("E_comp_duplicated_Msg",t[o].id)||"id["+t[o].id+"] 가 중복사용되었습니다. 소스코드를 확인하세요.";$l(n)}else i[t[o].id]=t[o].id;e.push(t[o])}var l=r.D.getDataPrefix("header_id"),h=r.D.getDataPrefix("inputType"),d=r.D.getDataPrefix("dataType"),u=r.D.getDataPrefix("value"),p=r.D.getDataPrefix("useLocale"),c=r.D.getDataPrefix("localeRef"),g=r.D.getDataPrefix("sortable"),f=r.D.getDataPrefix("toolTip"),m=r.D.getDataPrefix("useFilter");for(o=0;o<e.length;o++){var y=e[o];if(!y.getAttribute(l)){var b=y.getAttribute(h),w=y.getAttribute(d),v=y.getAttribute(u),C=null;if(this.setConfigOptions(y,v),"checkbox"==b)y.innerHTML="",(C=this.setCheckboxHead(y,v)).headInputType="checkbox";else if("select"==b)(C=this.setSelectboxHead(y,v)).headInputType="select";else if("text"==b&&"own"==w)(C=this.setInputHead(y,v)).headInputType="input";else if("checkcombobox"==b)(C=this.setCheckcomboboxHead(y,v)).headInputType="checkcombobox";else if("textImage"==b)(C=this.setTextImageHead(y,v)).headInputType="textImage";else{var I=y.getAttribute(u),_=y.getAttribute(p);if("true"===_||this.options.useLocale&&!_){var x=y.getAttribute(c);if(x){(D=this.getLocaleValue(x))&&(I=D)}else{var S=y.getAttribute("id");if(null!=S&&S.match("RowNumber")&&this.options.rowNumLocaleRef)(D=this.getLocaleValue(this.options.rowNumLocaleRef))&&(I=D);else if(null!=S&&S.match("RowStatus")&&this.options.rowStatusLocaleRef){var D;(D=this.getLocaleValue(this.options.rowStatusLocaleRef))&&(I=D)}}}I=null!=I?I:"",y.innerHTML=this.dataTagOpen+I+this.dataTagClose}var R=y.getAttribute("id")
;y.setAttribute(l,R);var L=y.className;if(!0===this._isBrowserScroll()&&(L+=" "+this.options.gridNativeClass,this.struct.head.rowArr.length>1&&(L+=" "+this.options.gridNativeClass+"MultiHeader")),L+=" "+this.id+"_header__column"+o,this.headCellInfoHash[R]){var T=this.headCellInfoHash[R].getAttribute("class");T&&(L+=" "+T)}if(y.className=L,y.setAttribute("id",this.id+"_"+R),this.options.autoScope&&y.setAttribute("scope","col"),R&&!R.match("RowNumber")&&!R.match("RowStatus")){var k="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+b+"']/useFilter/@value",F=r.D.getBoolean(a.v.getConfiguration(k)),A=this.headCellInfoHash[R].getAttribute("useFilter");if((A=""===A||"string"!=typeof A||r.D.getBoolean(A))&&(F||"true"==y.getAttribute(m))){var E="width:100%;height:100%;",M="";this.options.filterShowAlways&&(E+="table-layout:fixed;",M="overflow:hidden;");var O=document.createElement("table");O.style.cssText=E;var N=document.createElement("tr"),B=document.createElement("td");B.style.cssText="width:100%;"+M;for(var H=y.childNodes.length,G=0;y.childNodes.length>0&&G<H;G++)B.appendChild(y.childNodes[0]);N.appendChild(B);var W=document.createElement("td"),V=WebSquare.language.getMessage("Grid_filter_button");if(W.innerHTML="<input type='button' id='"+this.id+"_"+R+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+R+"\");' title='"+V+"'/>",N.appendChild(W),O.appendChild(N),y.appendChild(O),this.options.filterShowAlways){var q=document.getElementById(this.id+"_"+R+"_filter");q&&q.parentNode&&(q.parentNode.style.width=q.offsetWidth+2+"px")}}}"true"===y.getAttribute(g)&&(y.className+=" w2grid_head_sortable"),this.headerObj[R]=C,y.disabled=!1;var j=y.getAttribute(f);j&&WebSquare.getBody().setToolTip(y,j)}}this.clearHeaderSort()}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.associateHeaderBody=function(){try{for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=0,i=-1,o="",a=r.D.getDataPrefix("colIndex"),n=r.D.getDataPrefix("header_id"),l=r.D.getDataPrefix("col_id"),h=0;h<t.length;h++){var d=t[h];if(d.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||d.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0);else{var u=d.getAttribute(a);parseInt(u)<=i&&e++,i=parseInt(u);var p=e;p+1>this.tempTr.rows.length&&(p=this.tempTr.rows.length-1);for(var c=null;p>=0;){for(var g=this.tempTr.rows[p],f=r.D.first(g);f;){if(u==f.getAttribute(a)){c=f;break}f=r.D.next(f)}if(c)break;p--}if(c){var m=d.getAttribute(n),y=c.getAttribute(l);o=y,this.headerToBodyRelation[m]=y,this.bodyToHeaderRelation[y]=m}else{m=d.getAttribute(n);this.passiveColSpanRelation[m]=o}}}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setConfigOptions=function(t,e){try{var i=r.D.getDataPrefix("col_id"),o=r.D.getDataPrefix("inputType"),n=t.getAttribute(i),l=this.options.pluginName,h=t.getAttribute(o);this.headerConfigOptions[n]=a.v.getConfig(l+"/header[@inputType='"+h+"']")}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderConfigValue=function(t,e,i){try{var o=r.D.getDataPrefix("col_id"),a=t.getAttribute(o),n=t&&(t.getAttribute(i)||t.getAttribute(i.toLowerCase())),l=this.headerConfigOptions[a]&&this.headerConfigOptions[a][i];return n||l||""}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setCheckboxHead=function(t,e){try{var i=r.D.getDataPrefix("col_id"),o=r.D.getDataPrefix("onChangeFunction"),n=r.D.getDataPrefix("onchangeFunction"),l=r.D.getDataPrefix("localeRef"),h=r.D.getDataPrefix("checkboxLabel"),d=r.D.getDataPrefix("colId"),p=t.getAttribute(i),c=t.getAttribute(o)||t.getAttribute(n),g="<INPUT type='checkbox' />",f=this.getHeaderConfigValue(t,e,h);if(this.options.useLocale){var m=t.getAttribute(l);if(m){var y=this.getLocaleValue(m);y&&(f=y)}}if(f){var b=this.uuid+"_header__"+p+"_checkboxLabel_",w=b+"_id",v=" for='"+w+"'";!1===this.options.useHeaderCheckboxLabelFor&&(v=""),
g="left"===this.getHeaderConfigValue(t,e,"checkboxLabelPosition")?"<label class='w2checkbox_label'"+v+">"+f+"</label><INPUT type='checkbox' name='"+b+"' id='"+w+"'/>":"<INPUT type='checkbox' name='"+b+"' id='"+w+"'/><label class='w2checkbox_label'"+v+">"+f+"</label>",t.getAttribute(h)||t.setAttribute(h,f)}t.innerHTML=g;var C=t.getElementsByTagName("input")[0];C.setAttribute(d,e),("true"==t.getAttribute("disabled")||r.D.isIE()&&parseInt(a.v.browserVersion(),10)<9&&"true"==this.headCellInfoHash[p].getAttribute("disabled"))&&C.setAttribute("disabled","disabled");var I=t.getAttribute("title");I&&C.setAttribute("title",I);var _=this;u.B.addListener(C,"onkeydown",(function(t){u.B.fireEvent(_,"onkeydown",t),"32"==(t.charCode?t.charCode:t.keyCode)&&u.B.stopPropagation(t)})),u.B.addListener(C,"ondblclick",(function(t){u.B.stopPropagation(t)})),u.B.addListener(C,"onfocus",(function(t){var e=_.headerToBodyRelation[p];_.getCellInfo(e).options.focusOutOnCheckHeaderClick&&(_.removeFocusedCell(),1==_.options.senseReader&&_.rowIndex>0&&_.addGridScroll(0-_.rowIndex))}));var x=this.uuid;return null!=c&&""!=c?u.B.addListener(C,"onclick",(function(t){if(!WebSquare.idCache[x].options.checkHeaderOnly){_.noevent=!0;var i=r.D.getGlobalFunction(c,_.scope_id);if("function"==typeof i)try{i.call(this,this.checked,e)}catch(t){s.w.printStackTrace(t,null,this)}_.options.preventMultipleClick&&u.B.fireEvent(_,"onheaderclick",p)}})):u.B.addListener(C,"onclick",(function(t){if(!WebSquare.idCache[x].options.checkHeaderOnly){_.noevent=!0;var e,i,o,a,r,n,l,h=_.headerToBodyRelation[p],d=_.getCellInfo(h),c=d,g=d.options.trueValue,f=d.options.falseValue,m=!(!_.isDrillDown||!_._dataList.options.depthColumn),y=!("checkbox"!==d.options.inputType||!_.options.ref);if(!0===y){var b=_._dataList._getXPath({colID:h,skipValueNode:!0});y=(e=WebSquare.ModelUtil.findInstanceNodes(b,null,_.scope_id)).length>=_.getTotalRow()}if("checkbox"===d.options.inputType||"custom"===d.options.inputType||"radio"===d.options.inputType){if(_.editedCell)try{r=_.editedCell.editRowIndex,n=_.getColumnIndex(_.editedCell.id);var w=_._dataList.getColumnIndex(_.editedCell.id);a=_._grid.getRealRowIndex(r)*_._dataList.getColumnCount()+w,o=_._dataList.dataArr[a]}catch(t){s.w.printStackTrace(t,null,this)}if(this.checked){for(var v=_.getUnCheckedIndex(h),C=0;C<v.length;C++)if("custom"==d.options.inputType&&0==d.internal&&(c=d.cellManagerHashByRowIndex[v[C]])&&(g=c.options.trueValue,f=c.options.falseValue),c.options.checkAlways||!_.___getEditReadOnly(v[C],h,m)&&!_._getEditDisabled(v[C],h,m)){var I=v[C];m?_._dataList._setCellData(I,h,g,!0,!0,null,null,y):_.dataList.setCellData(I,h,g,!0,!0,null,null,y),i=g;var S=I;m&&(S=_._dataList.getFilteredRowIndex(S)),null!=S&&_._dataList.broadcast({gridView:["notifyCellChanged",[S,h,null,!0]]}),c.options.checkHeaderOnViewchange&&u.B.fireEvent(_,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,colIndex:_.getColumnIndex(h),colId:_.getColumnID(_.getColumnIndex(h))})}}else{var D=_.getCheckedIndex(h);for(C=0;C<D.length;C++)if("custom"==d.options.inputType&&0==d.internal&&(c=d.cellManagerHashByRowIndex[D[C]])&&(g=c.options.trueValue,f=c.options.falseValue),c.options.checkAlways||!_.___getEditReadOnly(D[C],h,m)&&!_._getEditDisabled(D[C],h,m)){I=D[C];m?_._dataList._setCellData(I,h,f,!0,!0,null,null,y):_.dataList.setCellData(I,h,f,!0,!0,null,null,y),i=f;S=I;m&&(S=_._dataList.getFilteredRowIndex(S)),null!=S&&_._dataList.broadcast({gridView:["notifyCellChanged",[S,h,null,!0]]}),c.options.checkHeaderOnViewchange&&u.B.fireEvent(_,"onviewchange",{oldValue:f,newValue:g,rowIndex:I,colIndex:_.getColumnIndex(h),colId:_.getColumnID(_.getColumnIndex(h))})}}if(_.checkHeader(p),!0===y)for(C=0;C<e.length;C++){var R=e[C];(c.options.checkAlways||!_.___getEditReadOnly(C,h,m)&&!_._getEditDisabled(C,h,m))&&(_._dataList.valueNode?R.setAttribute(_._dataList.valueNode,i):WebSquare.xml.setTextNodeValue(R,i))}_._dataList.broadcast({linkedDataList:["notifyRowChanged"],fusionChart:["refresh"],
fwFunnelChart:["refresh"],fwSparkChart:["refresh"],fwPyramidChart:["refresh"],fwGanttChart:["refresh"],generalComp:"both"})}else if(_.options.titleAuto){var L=!0===this.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");this.setAttribute("title",L)}if(_.options.senseReader&&_.rowIndex<=0&&(_.senseReaderMode=!0,_._setGridBorderNoRefresh=!0),_.options.senseReader&&_.rowIndex<=0&&(_.senseReaderMode=!1,_._setGridBorderNoRefresh=!1),_.drawFooter(),_.drawHeader(),_.options.preventMultipleClick&&u.B.fireEvent(_,"onheaderclick",p),null!=a)try{var T=_._dataList.dataArr[a];l=_.getColumnID(n),o!=T&&u.B.fireEvent(_,"onviewchange",{oldValue:o,newValue:T,rowIndex:r,colIndex:n,colId:l})}catch(t){s.w.printStackTrace(t,null,this)}}})),C}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.checkHeader=function(t){try{if(this.headerObj){var e=this.headerObj[t],i=this.headerToBodyRelation[t],o=this.headerInfoHash[t];if(e&&o&&o.options&&"checkbox"==o.options.inputType){var a=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=this.getCellInfo(i),l=a?this.getTotalRow():this.getRowCount();if("checkbox"!==n.options.inputType&&"custom"!==n.options.inputType&&"radio"!==n.options.inputType){if(this.options.titleAuto){var h=!0===e.checked?WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose");e.setAttribute("title",h)}return}if(this.hasCustomInputType&&0==n.internal&&"custom"==n.options.inputType){for(var d=l,u=0;u<d;u++){var p=a?u:this.dataList.getRealRowIndex(u),c=n.cellManagerHashByRowIndex[p]?n.cellManagerHashByRowIndex[p]:n;"checkbox"!=c.options.inputType&&"radio"!=c.options.inputType&&l--}if(0===l)return}var g="exclude"===this.options.checkAllType?this.getCheckedIndex(i,!0):this.getCheckedIndex(i),f=g.length;if(0==l)e.checked=!1,e.indeterminate=!1;else if(l==f)e.checked=!0,e.indeterminate=!1;else if(f>0){var m=!1;if(n.options.checkAlways)n.options.usePartialCheck&&"uncheck"===n.options.partialCheckNextClick&&(m=!0);else{for(u=0;u<g.length;u++)if(!this.___getEditReadOnly(g[u],i,a)&&!this._getEditDisabled(g[u],i,a)){(n.options.usePartialCheck||r.D.isIEAllVersion())&&(m=!0);break}n.options.usePartialCheck&&"check"===n.options.partialCheckNextClick&&m&&(m=!1)}r.D.isIEAllVersion()?e.checked=!m:e.checked=m,n.options.usePartialCheck&&(e.indeterminate=!0)}else l-f==l&&(e.checked=!1,e.indeterminate=!1);if(this.options.titleAuto)h=e.checked?n.options.usePartialCheck&&e.indeterminate?WebSquare.language.getMessage("Grid_title_partial"):WebSquare.language.getMessage("Grid_title"):WebSquare.language.getMessage("Grid_title_not_choose"),e.setAttribute("title",h)}}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setSelectboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:select",i.A&&(i.A.style="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff");else{this.tmpSelectbox||(this.tmpSelectbox=new WebSquare.uiplugin.selectbox("___tmp_selectbox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",a.v._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:select xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:select>",!0).documentElement,this.tmpSelectbox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}r.D.isIE(8)&&"true"==this.headCellInfoHash[n].getAttribute("disabled")&&i.setAttribute("disabled","true")}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_selectbox_"+t.getAttribute("id"),{pluginType:"uiplugin.selectbox",pluginName:"selectbox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value)
;var g=r.D.getDataPrefix("onChangeFunction"),f=r.D.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=r.D.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.w.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),this.addControl(c),c}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setInputHead=function(t,e){try{t.innerHTML="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";var i=r.D.first(t),o=this,a=r.D.getDataPrefix("onChangeFunction"),n=r.D.getDataPrefix("onchangeFunction"),l=r.D.getDataPrefix("changeFuncName"),h=r.D.getDataPrefix("colId"),d=r.D.getDataPrefix("col_id"),p=t.getAttribute(a)||t.getAttribute(n);i.setAttribute(l,p),i.setAttribute(h,e),i.scope_id=this.scope_id,i.headerId=t.getAttribute(d);var c=WebSquare.idCache[this.uuid];return u.B.addListener(i,"onfocus",(function(){o.noevent=!0,o.headerFocus=!0})),u.B.addListener(i,"onblur",(function(t){o.headerFocus=!1;var e=r.D.getGlobalFunction(this.getAttribute(l),this.scope_id);if("function"==typeof e)try{e.call(this,this.value,this.getAttribute(h),this.headerId)}catch(t){s.w.printStackTrace(t,null,this)}})),u.B.addListener(i,"onclick",(function(t){o.noevent=!0})),u.B.addListener(i,"onkeyup",(function(t){13==t.keyCode&&this.blur()})),u.B.addListener(i,"onpaste",(function(t){c.options.preventPaste?u.B.preventDefault(t):13==t.keyCode&&this.blur()})),i}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setCheckcomboboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:checkcombobox",i.A={style:"width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"};else{this.tmpCheckcombobox||(this.tmpCheckcombobox=new WebSquare.uiplugin.checkcombobox("___tmp_checkcombobox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",a.v._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:checkcombobox xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:checkcombobox>",!0).documentElement,this.tmpCheckcombobox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_checkcombobox_"+t.getAttribute("id"),{pluginType:"uiplugin.checkcombobox",pluginName:"checkcombobox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=r.D.getDataPrefix("onChangeFunction"),f=r.D.getDataPrefix("onchangeFunction"),m=t.getAttribute(g)||t.getAttribute(f);return c.changeFuncName=m,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=r.D.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){s.w.printStackTrace(t,null,this)}})),c.addEvent("onclick",(function(t){o.noevent=!0})),c}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setTextImageHead=function(t,e){try{var i,o=t.getAttribute("id"),a=this.headCellInfoHash[o];"json"===a._elementType&&(i=a.cloneNode(!0)._element.A);var n=i.viewType,l=i.imageSrc?i.imageSrc:"",h=null!=i.value?i.value:"",d=i.imageStyle?'style="'+i.imageStyle+'"':"";if(t.innerHTML="","icon"==n){t.innerHTML=["<div>",this.dataTagOpen+h+this.dataTagClose,"<img src='"+l+"' "+d+"/>","</div>"].join("");var p=this,c=t.getElementsByTagName("img")[0];u.B.addListener(c,"onclick",(function(t){u.B.stopPropagation(t),p._getHeaderDisabled(o)||u.B.fireEvent(p,"onheadertextimageclick",o,h)}))}else t.innerHTML=this.dataTagOpen+h+this.dataTagClose
;var g=r.D.first(t),f=r.D.getDataPrefix("colId"),m=r.D.getDataPrefix("col_id");return g.setAttribute(f,e),g.scope_id=this.scope_id,g.headerId=t.getAttribute(m),g}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderDIV=function(t){return this.getHeaderLayer(t)},x.prototype.getHeaderLayer=function(t){try{for(var e=WebSquare.util.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),a=0;a<i.length;a++){var r=i[a],n=r.getAttribute(e);if("number"==typeof t)t=o[t+this.defaultColCnt].getAttribute(e);if(null!=n&&null!=t&&t.toLowerCase()==n.toLowerCase())return r}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderInfo=function(t){try{return this.headerInfoHash[t]||{options:{}}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getTotalHeaderCol=function(t){try{for(var e=0,i=this.htmlInfo.head.headerTdHtml,o=0,a=i.length;o<a;o++)e+=i[o].length;return t&&t.defaultColumn&&(e+=this.defaultColCnt),e}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderColumnVisible=function(t){var e=this.getHeaderInfo(t),i=this._getRealColIndex("head",t),o=i+this.defaultColCnt,s=!this.hiddenList[o];if(e&&(0===i||i)){for(var a=0;a<e.options.colSpan;a++)s=!this.hiddenList[o+a]||s;return s}p.k.printLog("[getHeaderColumnVisible] 존재하지 않는 header 컬럼입니다.")},x.prototype.setHeaderValue=function(t,e,i){var o=this.getHeaderLayer(t);if(o)if("function"==typeof e)e(o);else{var a=this.headerObj[t],n=e;i&&(e=this.getFormattedHeaderValue(t,e));var l=r.D.getDataPrefix("value");if(a)if("select"==a.headInputType||"checkcombobox"==a.headInputType)a.setValue(e);else if("checkbox"==a.headInputType)a.checked!=r.D.getBoolean(e)&&(a.click(),a.checked=r.D.getBoolean(e));else if("input"==a.headInputType){if(a.value!=e){a.value=e;var h=r.D.getGlobalFunction(a.getAttribute("changeFuncName"),this.scope_id);if("function"==typeof h)try{h.call(a,a.value,a.getAttribute("colId"))}catch(t){s.w.printStackTrace(t,null,this)}}}else"user"==a.headerInputType&&a.setValue(e);else{this.headerDataObj&&t&&(this.headerDataObj[t].value=n);var d=o.getElementsByTagName(this.options.dataTag)[0];d?("NOBR"==d.tagName||"SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1)&&(d.innerHTML=e):o.innerHTML=this.dataTagOpen+e+this.dataTagClose}o.setAttribute(l,e);for(var u=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],p=WebSquare.Elem.api.getElementsByTagName(u,"w2:column"),c=0;c<p.length;c++){var g=p[c];if(t==g.getAttribute("id")){g.setAttribute("value",e);break}}}},x.prototype.setHeaderNodeSet=function(t,e,i,o){if(this.getHeaderLayer(t)){var s=this.headerObj[t];s&&("select"!=s.headInputType&&"checkcombobox"!=s.headInputType||s.setNodeSet(e,i,o))}},x.prototype.setHeaderUserObject=function(t,e){this.headerObj[t]=e,e.headerInputType="user";var i=this.getHeaderLayer(t);i.innerHTML="",i.appendChild(e.getContent())},x.prototype._getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){r.D.getDataPrefix("inputtype"),r.D.getDataPrefix("usefilter"),r.D.getDataPrefix("value");var i=this.headerObj[t];if(i){var o="";if("select"==i.headInputType||"checkcombobox"==i.headInputType)o=i.getValue();else if("checkbox"==i.headInputType){o=!i.indeterminate&&i.checked;var s=this.headerToBodyRelation[t];if(this.options.returnTrueFalseValue&&s){var a=this.getCellInfo(s),n=a.options.trueValue,l=a.options.falseValue;o&&n?o=n:l&&(o=l)}}else"input"==i.headInputType?o=i.value:"user"==i.headerInputType&&(o=i.getValue());return o}var h=r.D.first(e),d=h.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(d)h=d;else for(d=h;d&&"NOBR"!=d.tagName&&!("SPAN"==d.tagName&&d.className.indexOf("w2grid_span")>-1);){if("TD"==d.tagName){h=r.D.first(d);break}d=r.D.first(d)}return h?h.innerHTML:""}},x.prototype.getHeaderValue2=function(t){return this._getHeaderValue(t)},x.prototype.getHeaderValue=function(t){var e=""
;if(t&&(e=this.getHeaderLayer(t)),e){var i=r.D.getDataPrefix("inputtype");r.D.getDataPrefix("usefilter"),r.D.getDataPrefix("value");if(!this.options.titleAuto||"text"!=e.getAttribute(i))return this._getHeaderValue(t);var o=e.getElementsByTagName(this.options.dataTag.toUpperCase())[0];if(o&&("NOBR"==o.tagName||"SPAN"==o.tagName&&o.className.indexOf("w2grid_span")>-1))return null!=o.textContent?o.textContent:o.innerHTML||""}},x.prototype.getFormattedHeaderValue=function(t,e){var i=this.getHeaderLayer(t);if(i){var o=r.D.getDataPrefix("header_id");return this.headerDataObj[i.getAttribute(o)]&&(e=this.headerDataObj[i.getAttribute(o)].formatter.format(e)),e}},x.prototype.getHeaderValueList=function(t){for(var e=[],i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=r.D.getDataPrefix("header_id"),s=r.D.getDataPrefix("inputtype"),a=0;a<i.length;a++)if(null==this.hiddenList[a]||1==t||1!=this.hiddenList[a]){var n=i[a],l=n.getAttribute(o);if(null!=l&&n)if(this.options.captionAuto||this.options.summaryOnlyAuto){if("text"!=n.getAttribute(s))continue;var h=n.getElementsByTagName(this.options.dataTag.toUpperCase())[0];(h&&"NOBR"==h.tagName||"SPAN"==h.tagName&&h.className.indexOf("w2grid_span")>-1)&&(null!=h.innerText&&""!=h.innerText&&"\n"!=h.innerText?e.push(h.innerText):null!=h.textContent&&""!=h.textContent?e.push(h.textContent):null!=h.innerHTML&&""!=h.innerHTML?e.push(h.innerHTML):e.push(""))}else{var d,u=this.headerObj[l];u&&("select"==u.headInputType||"checkcombobox"==u.headInputType?d=u.getValue():"checkbox"==u.headInputType?d=u.checked:"input"==u.headInputType?d=u.value:"user"==u.headerInputType&&(d=u.getValue()),e.push(d));for(var p=r.D.first(n),c=p;c&&"NOBR"!=c.tagName&&!("SPAN"==c.tagName&&c.className.indexOf("w2grid_span")>-1);){if("TD"==c.tagName){p=r.D.first(c);break}c=r.D.first(c)}p?e.push(p.innerHTML):e.push("")}}return e},x.prototype.getHeaderSpan=function(t,e){for(var i=0;i<this.htmlInfo.head.rowArr.length;i++)for(var o=0;o<this.htmlInfo.head.rowArr[i].length;o++)if(this.htmlInfo.head.rowArr[i][o].id===t){if("row"===e)return this.htmlInfo.head.rowArr[i][o].rowSpan;if("col"===e)return this.htmlInfo.head.rowArr[i][o].colSpan}},x.prototype.getHeaderInputType=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].inputType},x.prototype.getSortableArr=function(){for(var t=[],e=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),i=r.D.getDataPrefix("sortable"),o=0;o<e.length;o++)"true"===e[o].getAttribute(i)?t.push(!0):"false"===e[o].getAttribute(i)?t.push(!1):1==this.options.sortable?t.push(!0):t.push(!1);return t},x.prototype.getSortableStatus=function(){return this.headerSortStatusArr.slice(0)},x.prototype.setSortable=function(t,e,i){try{i=i||{};var o=this.getElementById(this.id+"_"+t);if(null==o)return void p.k.printLog("headerId : "+t+"를 찾을 수 없습니다.["+this.id+"]");if(!0!==e&&!1!==e)return;var a=r.D.getDataPrefix("sortable"),n=o.getAttribute(a)||this.options.sortable;if(r.D.getBoolean(n)!==r.D.getBoolean(e)&&(o.setAttribute(a,e),!0!==i.keepSortImage)){for(var l,h=0;h<this.headerSortStatusArr.length;h++){var d=this.headerToBodyRelation[t];if(d===this.headerSortStatusArr[h].colID){l=d;break}}l?!1===e?this.setHeaderSortImage(t,0,0):this.setHeaderSortImage(t,this.headerSortStatusArr[l].sortOrder,0):this.options.showSortableImage&&!0===e&&this.setHeaderSortImage(t,0,0)}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.clearHeaderSort=function(){this.headerSortStatusArr=[];for(var t=r.D.getDataPrefix("sortable"),e=r.D.getDataPrefix("header_id"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=this.htmlInfo.head.rowArr,s=0;s<i.length;s++){if("_headerRowNumber"!==(u=i[s].getAttribute(e))&&"_headerRowStatus"!==u&&("false"!==i[s].getAttribute(t)||!0===this.options.showSortableImage)){
if(o.length>1&&"top"==this.options.sortedImagePosition)for(var a=this.headerToBodyRelation[u],n=this.getColumnIndex(a),l=o[0],h=0;h<l.length;h++)if(l[h]["@col"]==n){u=l[h].id;break}var d=this.headerObj[u];d&&"user"==d.headerInputType||this.setHeaderSortImage(u,0,0)}}for(s=0;s<i.length;s++){var u="";i[s].getElementsByClassName("w2grid_customFilter_open").length>0?(u=i[s].getAttribute(e),this._lastHeaderElementType="filter"):i[s].getElementsByClassName("w2grid_head_sort_div_main_btn").length>0&&(u=i[s].getAttribute(e),this._lastHeaderElementType="sort"),u&&(this._lastHeaderElementId=u)}},x.prototype.drawHeaderSortImages=function(){for(var t=this.htmlInfo.head.rowArr,e=0;e<this.headerSortStatusArr.length;e++){var i="";if(t.length>1&&"top"==this.options.sortedImagePosition){for(var o=this.headerSortStatusArr[e].colID,s=this.getColumnIndex(o),a=t[0],r=0;r<a.length;r++)if(a[r]["@col"]==s){i=a[r].id;break}}else if(!(i=this.bodyToHeaderRelation[this.headerSortStatusArr[e].colID])){var n=this.headerSortStatusArr[e].colID,l=this.getColumnIndex(n);for(l--;l>=0&&(n=this.getColumnID(l),!(i=this.bodyToHeaderRelation[n]));)l--}i&&this.setHeaderSortImage(i,this.headerSortStatusArr[e].sortOrder,e+1)}},x.prototype.setHeaderSortImage=function(t,e,i){var o=this.getElementById(this.id+"_"+t);if(null!=o){e=parseInt(e,10),i=parseInt(i,10);isNaN(i)||i<=0||this.headerSortStatusArr.length<2?i="":i+="",this._clearHeaderSortImage(o,"table"),this._clearHeaderSortImage(o,"div");var n="",l=this.options.showSortableImage,h=r.D.getDataPrefix("sortable"),d=r.D.getDataPrefix("inputType");if(this.options.showSortableImage){var u=o.getAttribute(h);l=!!(n=u?r.D.getBoolean(u):this.options.sortable)}var c=o.getAttribute(d),g="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+c+"']/useFilter/@value",f=r.D.getBoolean(a.v.getConfiguration(g)),m=r.D.getDataPrefix("useFilter"),y=o.getAttribute(m);y=""===y||"string"!=typeof y||r.D.getBoolean(y);var b=!1,w=!1,v=!1;if(0===this.getDataLength()&&this.options.hideSortIconOnNoData&&(v=!0),0===this.getDataLength()&&this.options.hideFilterIconOnNoData&&(w=!0),y&&(f||"true"==o.getAttribute(m))){b=!0;var C=w?"none":"",I=o.getElementsByTagName("input");I&&I[0]&&(I[0].style.display=C)}if(!0!==this.options.showSortableImage){var _;if(0!==e){_=r.D.first(o);var x=null,S=null,D=null;try{this._useCheckboxLabel(t)&&(S=document.createElement("div"),x=r.D.next(_),S.appendChild(x))}catch(t){s.w.printStackTrace(t,null,this)}"nobr"==_.nodeName.toLowerCase()||"span"==_.nodeName.toLowerCase()&&_.className.indexOf("w2grid_span")>-1?(_=o.innerHTML,o.innerHTML=""):_=o.removeChild(_),this.headerObjArr[t]=_;var R=1==e?"w2grid_head_sort_asc":"w2grid_head_sort_desc",L=0,T="w2grid_head_sort_table_main",k="w2grid_head_sort_td",F="<table "+(z=r.D.getDataPrefix("sort"))+"='sort' class='"+T+"'><tr><td></td><td class='"+k+" "+R+"'>"+i+"</td></tr></table>";"left"===this.options.sortedIconPosition&&(L=1,F="<table "+z+"='sort' class='"+T+"'><tr><td class='"+k+" "+R+"'>"+i+"</td><td></td></tr></table>"),o.innerHTML=F;var A=o.getElementsByTagName("td");"string"==typeof _?A[L].innerHTML=_:(A[L].appendChild(_),x&&S&&(A[L].appendChild(S.removeChild(x)),S=null))}}else{var E=this.headerObj[t];if(E)E.render&&(E=E.render);else{var M=o.getElementsByTagName(this.options.dataTag)[0];(M&&"NOBR"==M.tagName||"SPAN"==M.tagName&&M.className.indexOf("w2grid_span")>-1)&&(E=M)}x=null;var O=null;try{this._useCheckboxLabel(t)&&("left"===this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?(O="left",S=document.createElement("div"),x=r.D.prev(E),S.appendChild(x)):(S=document.createElement("div"),x=r.D.next(E),S.appendChild(x)))}catch(t){s.w.printStackTrace(t,null,this)}try{b&&this.options.showSortableUseFilter&&(D=o.getElementsByTagName("input")[0])}catch(t){s.w.printStackTrace(t,null,this)}E.parentNode.removeChild(E);R="";var N="";switch(e){case 0:!1!==l||n?(R="w2grid_head_sort_none",
N=WebSquare.language.getMessage("Grid_sort_asc")):(R="w2grid_head_sort_image_none",N="");break;case 1:R="w2grid_head_sort_asc",N=WebSquare.language.getMessage("Grid_sort_desc");break;case-1:R="w2grid_head_sort_desc",N=WebSquare.language.getMessage("Grid_sort_none");break;default:R="w2grid_head_sort_none",N=WebSquare.language.getMessage("Grid_sort_asc")}if(this.options.sortHeaderDiv)if(!0===this.options.accessibility){R+="_btn";var B="_accessibility",H="w2grid_head_sort_div_main_btn";"left"===this.options.sortedIconPosition&&(R+="_left"),H+=B,R+=B;var G,W=v?"style = 'display:none'":"";z=r.D.getDataPrefix("sort");if(n?(o.innerHTML="<button "+z+"='sort' class='"+H+" "+R+"' "+W+"></button>",G=o.getElementsByTagName("button")[0]):(o.innerHTML="",G=o),G.appendChild(E),x&&S)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?G.appendChild(S.removeChild(x)):G.insertBefore(S.removeChild(x),E),S=null;else if(b&&this.options.showSortableUseFilter){var V=n?G:E;U=V.parentElement;(X=document.createElement("div")).appendChild(V),X.appendChild(D),this.addClass(X,"w2grid_head_sort_div_main_outer_box"),U.appendChild(X),this.addClass(D,"w2grid_customFilter_sortable_open"),r.D.isIE()&&parseInt(a.v.browserVersion(),10)<8?this.addClass(V,"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(V,"w2grid_head_sort_usefilter_div_main")}}else{R+="_btn";H="w2grid_head_sort_div_main_btn",W=v?"style = 'display:none'":"",z=r.D.getDataPrefix("sort");o.innerHTML="<div "+z+"='sort' class='w2grid_head_sort_div_main_outer'><button class='"+H+" "+R+"'"+W+" >"+N+"</button></div>";A=o.getElementsByTagName("div");var q=o.getElementsByTagName("button")[0];if(A[0].insertBefore(E,q),x&&S)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?A[0].insertBefore(S.removeChild(x),q):A[0].insertBefore(S.removeChild(x),E),S=null;else if(b&&this.options.showSortableUseFilter){U=A[0].parentElement;(X=document.createElement("div")).appendChild(A[0]),X.appendChild(D),this.addClass(X,"w2grid_head_sort_div_main_outer_box"),U.appendChild(X),this.addClass(D,"w2grid_customFilter_sortable_open"),r.D.isIE()&&parseInt(a.v.browserVersion(),10)<8?this.addClass(A[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(A[1],"w2grid_head_sort_usefilter_div_main")}}else{var j="w2grid_head_sort_div_main",P="w2grid_head_sort_div_sub";"left"===this.options.sortedIconPosition&&(j="w2grid_head_sort_div_main_left"),!0===this.options.showSortableImage&&(P="left"===this.options.sortedIconPosition?"w2grid_head_sort_div_sub_sortable_image_left":"w2grid_head_sort_div_sub_sortable_image"),v&&(R="");var z=r.D.getDataPrefix("sort");if(o.innerHTML="<div "+z+"='sort' class = '"+j+" "+R+"'><div class = '"+P+"'>"+i+"</div></div>",(A=o.getElementsByTagName("div"))[0].appendChild(E),x&&S)"left"===O?A[0].insertBefore(S.removeChild(x),E):A[0].appendChild(S.removeChild(x)),S=null;else if(b&&this.options.showSortableUseFilter){var X,U=A[0].parentElement;(X=document.createElement("div")).appendChild(A[0]),X.appendChild(D),this.addClass(X,"w2grid_head_sort_div_main_outer_box"),U.appendChild(X),this.addClass(D,"w2grid_customFilter_sortable_open"),r.D.isIE()&&parseInt(a.v.browserVersion(),10)<8?this.addClass(A[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(A[1],"w2grid_head_sort_usefilter_div_main")}}}if(n){var Z="none";switch(e){case 0:Z="none";break;case 1:Z="ascending";break;case-1:Z="desending";break;default:Z="none"}o.setAttribute("aria-sort",Z)}}else p.k.printLog("headerId : "+t+"를 찾을 수 없습니다.["+this.id+"]")},x.prototype._clearHeaderSortImage=function(t,e){var i=t.getElementsByTagName(e),o=r.D.getDataPrefix("sort"),a=r.D.getDataPrefix("header_id");if(i.length>0&&"sort"==i[0].getAttribute(o)){var n=t.getAttribute(a),l=this.headerObjArr[n];if(l)if("string"==typeof l)t.innerHTML=l;else{var h=null,d=null;try{this._useCheckboxLabel(n)&&(d=document.createElement("div"),h=r.D.next(l),d.appendChild(h))}catch(t){
s.w.printStackTrace(t,null,this)}l=t.appendChild(l),h&&d&&(t.appendChild(d.removeChild(h)),d=null),t.removeChild(l.previousSibling)}}},x.prototype.getColIdByHeaderId=function(t){return this.headerToBodyRelation[t]},x.prototype.setHeaderHide=function(t){if(t=r.D.getBoolean(t),this.options.hideHeader!=t){this.options.hideHeader=t;var e=this.getElementById(this.id+"_head_table"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));if(t){e.style.display="none";for(var o=0;o<i.length;o++){var s=i[o].getAttribute("class");null!=s&&(i[o].setAttribute("data-bkclass",s),i[o].removeAttribute("class"))}}else{e.style.display="";for(o=0;o<i.length;o++){var a=i[o].getAttribute("data-bkclass");null!=a&&(i[o].setAttribute("class",a),i[o].removeAttribute("data-bkclass"))}}this.refresh(),this.setScrollYHeight()}},x.prototype.setHeaderDisabled=function(t,e){try{e=r.D.getBoolean(e);var i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?(o.setDisabled?o.setDisabled(e):o.render?o.render.disabled=e:o.disabled=e,i.disabled=e):i.disabled=e}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype._getHeaderDisabled=function(t){try{var e=!1,i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?o.getDisabled?e=o.getDisabled():o.render?e=o.render.disabled:o.disabled&&(e=o.disabled):i.disabled&&(e=i.disabled)}return e}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderID=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,a=0;a<e.children.length;a++){var r=e.children[a].children;if((o+=r.length)>t){var n=r[i];return n?n.id.replace(this.id+"_",""):null}i-=r.length}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderIDArr=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,a=[],r=0;r<e.children.length;r++){var n=e.children[r].children;if((o+=n.length)>t){var l=n[i];l&&a.push(l.id.replace(this.id+"_",""))}else i-=n.length}return a}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderIndex=function(t){try{if("number"==typeof t)return t;var e=this.head_table;e||(e=this.getElementById(this.id+"_head_table"));for(var i=0,o=0;o<e.children.length;o++){for(var a=e.children[o].children,r=0;r<a.length;r++){if(a[r].id.replace(this.id+"_","")==t)return i+r-this.defaultColCnt}i+=a.length}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderRowIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return e},x.prototype.getHeaderColIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].colIndex},x.prototype.getHeaderColID=function(t,e){try{void 0!==e&&null!=e||(e={});for(var i="",o=this.struct.head.rowArr,a=!0===e.firstRow?1:o.length,r=0;r<a;r++){for(var n=o[r],l=0;l<n.length;l++)if(n[l].colIndex===t){i=n[l].id;break}if(i)break}return i}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setHeaderStyle=function(t,e,i){try{var o,a=r.D.getDataPrefix("header_id"),n=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(o=n[t+this.defaultColCnt]).getAttribute(a);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var l=0;l<n.length;l++)(o=n[l]).getAttribute(a)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.setHeaderClass=function(t,e){try{var i,o=r.D.getDataPrefix("header_id"),a=this.getElementById(this.id+"_head_table").getElementsByTagName("th")
;if("number"==typeof t)t=(i=a[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<a.length;n++)(i=a[n]).getAttribute(o)==t&&(this.addClass(i,e),this.headerCellClassObj[t]=e)}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.getHeaderClass=function(t){try{var e=r.D.getDataPrefix("header_id"),i=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=i[t+this.defaultColCnt].getAttribute(e);"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var o=0;o<i.length;o++)if(i[o].getAttribute(e)==t)return this.headerCellClassObj[t]}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.removeHeaderClass=function(t,e){try{var i,o=r.D.getDataPrefix("header_id"),a=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("number"==typeof t)t=(i=a[t+this.defaultColCnt]).getAttribute(o);else"$rownum"==t.wq_trim().toLowerCase()?t="_headerRowNumber":"$rowstatus"==t.wq_trim().toLowerCase()&&(t="_headerRowStatus");for(var n=0;n<a.length;n++)(i=a[n]).getAttribute(o)==t&&(this.removeClass(i,e),delete this.headerCellClassObj[t])}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.drawHeader=function(t,e){try{if(!this.head_table)return;null==this.headerDataObj&&this.initHeaderDataObj();var i=this.head_table.getElementsByTagName("th");this.headerTempSum=[];var o=r.D.getDataPrefix("header_id");if(t){t=this.getColumnID(t);for(var a=0;a<i.length;a++){if(d=(h=i[a]).getAttribute(o))if(u=this.headerDataObj[d])if("expression"==u.inputType){var n=u.expression.match(/headercol(sum|avg|max|min)\s*\([^\)]*/g);if(n)for(var l=0;l<n.length;l++)n[l].split("(")[1].wq_replaceAll("'","").wq_replaceAll('"',"").wq_trim()==t&&(u.value=new Function("_this","return "+u.expression)(this),isNaN(u.value)&&"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat),h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}else""===u.displayFormat||"number"!=u.dataType||"text"!=u.inputType&&"textarea"!=u.inputType&&"button"!=u.inputType&&"textImage"!=u.inputType||(h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}}else for(a=0;a<i.length;a++){var h,d,u;if(d=(h=i[a]).getAttribute(o))if(u=this.headerDataObj[d])if("expression"==u.inputType){try{u.value=new Function("_this","return "+u.expression)(this),isNaN(u.value)&&"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat)}catch(t){s.w.printStackTrace(t,null,this)}h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose}else""===u.displayFormat||"number"!=u.dataType||"text"!=u.inputType&&"textarea"!=u.inputType&&"button"!=u.inputType&&"textImage"!=u.inputType||(h.innerHTML=this.dataTagOpen+u.formatter.format(u.value)+this.dataTagClose)}!e||!e.sortIcon||this.headerSortStatusArr&&0!==this.headerSortStatusArr.length||this.clearHeaderSort()}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.initHeaderDataObj=function(){try{var t=this.head_table.getElementsByTagName("th");this.headerDataObj={};for(var e=r.D.getDataPrefix("header_id"),i=r.D.getDataPrefix("expression"),o=r.D.getDataPrefix("value"),n=r.D.getDataPrefix("localeRef"),l=r.D.getDataPrefix("inputType"),h=r.D.getDataPrefix("dataType"),d=r.D.getDataPrefix("displayFormat"),u=r.D.getDataPrefix("displayFormatter"),p=r.D.getDataPrefix("NaNFormat"),c=0;c<t.length;c++){var g=t[c],f={};f.id=g.getAttribute(e);var m=g.getAttribute(i)||"";if(""!=m&&(m=(m=(m=(m=m.replace(/[sS][uU][mM][\s]*[(]/g,"_this.headercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.headercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.headercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.headercolmin( ")),f.value=g.getAttribute(o)||"",this.options.useLocale){var y=g.getAttribute(n);if(y){var b=this.getLocaleValue(y);b&&(f.value=b)}}f.inputType=g.getAttribute(l),f.dataType=g.getAttribute(h)||"text",f.expression=m,
f.displayFormat=g.getAttribute(d)||"",f.displayFormatter=g.getAttribute(u)||"",f.formatter=WebSquare.format.createFormatter(f.dataType,f.displayFormat,f.displayFormatter,null,null,null,this.scope_id,this.id),f.NaNFormat=g.getAttribute(p)||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==f.NaNFormat&&(f.NaNFormat=""),this.headerDataObj[f.id]=f}}catch(t){s.w.printStackTrace(t,null,this)}},x.prototype.headercolsum=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].sum){var e="";if(this.groupbyStatus.grouped);else{var i=this.getColumnAllDataArray(t);e=r.D.sum(i)}this.headerTempSum[t].sum=e}return r.D.setPrecision(this.headerTempSum[t].sum)},x.prototype.headercolavg=function(t){var e=this.getColumnAllDataArray(t);this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={});var i="";if(this.groupbyStatus.grouped)return i;if(void 0===this.headerTempSum[t].sum){if(e.length>0){for(var o=0;o<e.length;o++)""==e[o].replace(/^\s+|\s+$/g,"")&&(e[o]="0");i=r.D.sum(e)}this.headerTempSum[t].sum=i}return""==this.headerTempSum[t].sum?"":this.headerTempSum[t].sum/e.length},x.prototype.headercolmax=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e<s)&&(e=s)}e=null==e?"":e,e=r.D.setPrecision(e)}this.headerTempSum[t].max=e}return this.headerTempSum[t].max},x.prototype.headercolmin=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e>s)&&(e=s)}e=null==e?"":e,e=r.D.setPrecision(e)}this.headerTempSum[t].min=e}return this.headerTempSum[t].min},x.prototype._getMatchedHeaderId=function(t){try{return this.bodyToHeaderRelation[t]}catch(t){s.w.printStackTrace(t,null,this)}};var S=function(t,e){try{this.options={id:"",value:"",inputType:"text",useFilter:!1,textAlign:""},this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),this.id=this.options.id}catch(t){s.w.printStackTrace(t,null,this)}};x.prototype._setHeaderInfo=function(t,e){this.headerInfoHash2[t]=e},x.prototype.setCheckboxHeader=function(t){try{"function"==typeof this.cellInfoHash[t].checkHeader&&this.cellInfoHash[t].checkHeader()}catch(t){s.w.printStackTrace(t,null,this)}},S.prototype.setOptions=function(t){this.options.useFilter=r.D.getBoolean(a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/useFilter/@value")),this.options.hideCustomFilter=r.D.getBoolean(a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/header/column/hideCustomFilter/@value"));var e=[];for(var i in this.options)e[i.toLowerCase()]=i;var o=this.mainGrid.headerConfigOptions[t.getAttribute("id")]||{};for(var i in o)this.options[i]=o[i];var s=WebSquare.Parser.parseAttribute(t);for(var n in s){var l=s[n];"class"==n?this.options.className=l:""!=String(l).wq_trim()&&(e[n]&&(n=e[n]),"boolean"==typeof this.options[n]?l=r.D.getBoolean(l):"number"==typeof this.options[n]&&(l=r.D.getNumber(l)),this.options[n]=l)}},x.prototype._useCheckboxLabel=function(t){try{var e=r.D.getDataPrefix("inputType"),i=r.D.getDataPrefix("checkboxLabel"),o=r.D.getDataPrefix("checkboxlabel"),a=this.getHeaderLayer(t);return"checkbox"===a.getAttribute(e)&&(a.getAttribute(i)||a.getAttribute(o))}catch(t){s.w.printStackTrace(t,null,this)}};var D=function(){};D.prototype.getLastFocusedCell=function(){if(this.focusedCell.length>0)return this.focusedCell[this.focusedCell.length-1];var t={focusedRowIndex:-1,
focusedColIndex:null};return this.options.groupbyDisplayRowIndex&&(t.groupbyDisplayRowIndex=-1),t},D.prototype.getFocusedRowIndex=function(){return this._getFocusedRowIndex(this.options.groupbyDisplayRowIndex)},D.prototype._getFocusedRowIndex=function(t){return this.getLastFocusedCell()[!0===t&&this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex"]},D.prototype.getFocusedRealRowIndex=function(){return this.getLastFocusedCell().focusedRealRowIndex},D.prototype.getAllFocusedIndex=function(){for(var t=this.focusedCell,e=[],i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<t.length;o++){var s={};s.col=t[o].focusedColIndex,s.row=t[o][i],e.push(s)}return e},D.prototype.getAllFocusedRowIndex=function(){for(var t=[],e={},i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<this.focusedCell.length;o++){e[this.focusedCell[o][i]]=!0}for(var s in e)t.push(parseInt(s,10));return t},D.prototype.getFocusedColumnIndex=function(){return this.getLastFocusedCell().focusedColIndex},D.prototype.getFocusedColumnID=function(){return this.getColumnID(this.getFocusedColumnIndex())},D.prototype.getFocusedRowStatus=function(){var t=this._getFocusedRowIndex(!0);return-1==t?null:this.dataList.getRowStatus(t)},D.prototype.setFocusedCell2=function(t,e,i,o){try{o=o||{};i=r.D.getBoolean(i),e=this.getColumnIndex(e);var a=!1;try{a=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){a=!1}var n=this.getLastFocusedCell(),l=i&&n.focusedColIndex==e;if((this.___getEditReadOnly(t,e)||this._getEditDisabled(t,e))&&(l=!1),this.editedCell&&!this.editedCell.handleEndEdit(null,l))return!1;if(a||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),y=t-(this.rowIndex>0?this.rowIndex:0)}}else{var h=this._getVisibleLastIndex(this.lastIndex+1),d=this.getDataLength(),u=this.rowIndex+this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex);!0===this.hiddenRowObj.init&&this.rowIndex===d-h&&(u=d-this._getVisibleLastIndex(1));var p=this.rowIndex,c=this.hiddenCellObj.length>0;if(c&&t===u&&(u=Math.max(u-1,0)),t<p||t>u){var g=t<p?t-p:t-u;if(t>u&&this.hasSubtotal){for(var f in this.rollbackCommitFlag=!1,this.subtotalTableList){if(u<d-1)this.dataList._getCellData(u,f)!=this.dataList._getCellData(u+1,f)&&g++}this.rollbackCommitFlag=!0}var m=this.rowIndex+g;m=(m=m<0?0:m)>d-h?d-h:m,c&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(m=Math.min(m,this.lastTopRowIndex)),m!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!0,m=Math.max(0,m),isNaN(this.lastTopRowIndex)||null==this.lastTopRowIndex||(m=Math.min(m,this.lastTopRowIndex)),this.drawData(m,0,"keymove",l),!0===this.hiddenRowObj.init||c||(this.lastIndex=this.getLastIndex(this.lastDisplayedRow)))}}var y=t-(this.rowIndex>0?this.rowIndex:0),b=this.data_td_list[e+y*this.oneRowDataLength];return!!b&&("rollback"==this.__setFocusedCell({ctrl:!1},b,{editMode:i,dont_hide:l,dont_fixScroll:!0,tabDirection:o.tabDirection})&&this._setFocusedCell(n.focusedRowIndex,n.focusedColIndex,!0,{tabDirection:o.tabDirection}),!0)}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.setFocusedCell=function(t,e,i,o){try{(o=o||{}).groupbyDisplayRowIndex=this.options.groupbyDisplayRowIndex;var a=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),r=t;if(a&&(r=this.getDisplayRowIndex(t)),!isNaN(r)){if(!0===o.keepFocusedCell)for(var n=this.getColumnIndex(e),l=0;l<this.focusedCell.length;l++)if(this.focusedCell[l].focusedRowIndex===t&&this.focusedCell[l].focusedColIndex===n)return;return this._setFocusedCell(r,e,i,o)}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype._setFocusedCell=function(t,e,i,o){try{if(o=o||{},"none"==this.options.focusMode)return;if(!0===o.groupbyDisplayRowIndex&&(t=this._getGroupbyGroupedRowIndex(t,!0)),0==arguments.length||1==arguments.length){
i=0!=arguments.length&&arguments[0];var a=this.colIndexInfo.body.colInfo.colIndexMatch;if(this.focusedCell.length>0)t=this.focusedCell[this.focusedCell.length-1].focusedRowIndex,e=this.focusedCell[this.focusedCell.length-1].focusedColIndex;else if(this.lastFocusedCell&&null!=this.lastFocusedCell.focusedColIndex&&this.lastFocusedCell.focusedRowIndex>=0)t=this.lastFocusedCell.focusedRowIndex,e=this.lastFocusedCell.focusedColIndex;else{var n=this.getLastFocusedCell();t=n.focusedRowIndex;if(null==(e=n.focusedColIndex)||-1==t)return this.focusedCell=[{focusedRowIndex:0,focusedColIndex:a.length-this.defaultColCnt-1}],this.moveHorizontal(null,"home"),void(i&&this._setFocusedCell(!0))}}var l=this.getDataLength(),h=this.getDataLength()-this._getVisibleLastIndex(1);if(e=this.getColumnIndex(e),t<0||t>h||e<0||e>=this.oneRowDataLength)return;var d=!1;try{d=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){d=!1}if(i=r.D.getBoolean(i),this.delayedDraw({rowIndex:t}))return this.focusedCell=[{focusedRowIndex:t,focusedColIndex:e}],this._linkedDataList?this._linkedDataList.setRowPosition(t):this._dataList.setRowPosition(t),void this._dataList.setColumnPosition(this.getColumnID(e));var u=this.getElementById(this.id+"_scrollY_div");!0!==this._isBrowserScroll()&&u&&0==u.scrollTop&&this.rowIndex>0&&(u.scrollTop=this.lastScrollYTop);var p=t-(this.rowIndex>0?this.rowIndex:0);if(d||!0===this._isBrowserScroll()){if(!0===this._isHybridScroll()){!0===this._drawDataHybrid(t)&&(o.hybridAsync=!0),p=t-(this.rowIndex>0?this.rowIndex:0)}}else if(p<0)this.scrollEvent=!1,u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0),p=0;else if(this.options.showLastRow&&p-this.lastIndex==1&&""===this.options.visibleRowNum);else if(p>this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex)){var c=this._getVisibleLastIndex(this.lastIndex+1);this.hiddenCellObj.length>0&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(c=l-this.lastTopRowIndex);var g=t+c>l?l-c:t;this.hiddenCellObj.length>0&&(g=Math.max(0,g)),g!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!o.isSort||"string"!=typeof this.options.filterFocusMode||"followfocus"!==this.options.filterFocusMode.toLowerCase(),u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g),g>this.rowIndex+c-1&&(this.adjustDraw_keepTop=!0),this.drawData(g,0),p=t-this.rowIndex)}var f=this.data_td_list[e+p*this.oneRowDataLength];if(f){for(var m=5;!0!==this._isBrowserScroll()&&this.hiddenCellObj.length>0&&0===f.offsetHeight&&m>0;){this.lastTopRowIndex++;var y=this.getElementById(this.id+"_size_y"),b=(u=this.getElementById(this.id+"_scrollY_div"),y.offsetHeight);b<1e6&&(b=parseInt(y.style.height,10)),y.style.height=u.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",this.drawData(this.lastTopRowIndex,0),p--,f=this.data_td_list[e+p*this.oneRowDataLength],m--}return o.editMode=i,this.__setFocusedCell({ctrl:!1},f,o)}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.removeFocusedCell=function(){try{this.lastFocusedCell=this.getLastFocusedCell(),this.applyFocusedCellOut(),this.focusedCell=[],this._dataList.setRowPosition(null)}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.applyFocusedCell=function(t,e){if(e||(this.applyFocusedCellOut(),this.focusedCell=[]),null!=t){this.applyFocusedCellIn(t);var i={};i.focusedTd=t,this.focusedCell.push(i)}},D.prototype.__setFocusedCell=function(t,e,i){try{i=i||{};var a=t.ctrlKey||i.ctrled,n=t.shiftKey||i.shifted,l=e.className,h="";if(this.options.focusDefaultColumn){if(l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1}else if(l.indexOf("_rowNum")>=0||l.indexOf("_rowStatus")>=0||l.indexOf("_groupby")>=0||l.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1
;var d=r.D.getDataPrefix("tdIndex"),p=r.D.getDataPrefix("colIndex"),c=parseInt(e.getAttribute(d)),g=parseInt(c/this.realRowDataLength),f=parseInt(e.getAttribute(p)),m=g+this.rowIndex,y=this._getGroupbyDisplayRowIndex(m),b=m;this.isDrillDown&&this._dataList.options.depthColumn&&(b=this.getRealRowIndex(m));var w=c%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),v=this.getColumnID(w),C=!0,I=this.getLastFocusedCell();this.focusedCell.length>0&&I.focusedTd==e&&(C=!1);var _,x={focuseChanged:C};if(o.x.extend(x,i),C&&this.editedCell&&!this.editedCell.handleEndEdit(t,!!i.dont_hide,x))return!1;_=this._linkedDataList?this._linkedDataList.setRowPosition(y):this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex?this._dataList.setRowPosition(y):this._dataList.setRowPosition(b);var S=this._dataList.setColumnPosition(v);if(!1===_||!1===S)return this.options.senseReader&&I&&I.focusedTd&&I.focusedTd.focus(),!1;var D=this._getFocusedRowIndex(),R=this.getFocusedColumnIndex(),L=!(r.D.getBoolean(this.options.useCtrlKey)&&a||r.D.getBoolean(this.options.useShiftKey)&&n||i.keepFocusedCell),T=!1;if(L&&r.D.getBoolean(i.allowContextMenuMultiCell)&&(L=!1,T=!0,this.focusedCell)){for(var k=!1,F=0;F<this.focusedCell.length;F++)if(this.focusedCell[F].focusedTd==e){k=!0;break}k||(L=!0,T=!1)}if(L&&(this.applyFocusedCellOut(),this.focusedCell=[]),i.tabDirection||(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),this.focusedCell.length>0&&r.D.getBoolean(this.options.useShiftKey)&&n){var A,E=(A=!0===this.options.ctrlShiftKey?this.focusedCell[this.focusedCell.length-1]:this.focusedCell[0]).focusedRowIndex,M=A.focusedColIndex,O=!1;if((this.options.focusDefaultColumn&&A.focusedColIndex<0&&w<0&&this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus")||this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")&&this.hasClass(e,"gridBodyDefault_rowStatus")||this.hasClass(e,"gridBodyDefault_rowNumber")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowNumber")||this.hasClass(e,"gridBodyDefault_rowStatus")&&this.hasClass(A.focusedTd,"gridBodyDefault_rowStatus"))&&(O=!0),O)return this.applyFocusedCellOut(),this.focusedCell=[],void this.__setFocusedCell(t,e);h="multiCell",this._applyFocusedMultiCell(E,M,m,w,i.ignoreFocusMode),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}else if(!T){var N;if(this.getCellInfo(e).options.blockSelect)return;var B={focusedTd:e,focusedRealRowIndex:b,focusedRowIndex:N=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>m-this.rowIndex||this.options.lastFixedRow>0&&m-this.rowIndex>this.lastIndex-this.options.lastFixedRow?m-this.rowIndex:m,focusedColIndex:w};this.options.groupbyDisplayRowIndex&&(B.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(N)),this.focusedCell.push(B),i.dont_fixScroll||(f>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds();var H=!0!==this._isBrowserScroll()&&!!i.editMode;if(this.applyFocusedCellIn(e,H,{tabDirection:i.tabDirection,ignoreFocusMode:i.ignoreFocusMode,customRowIndex:m}),"linear"===this.options.focusFlow&&!0===i.editMode&&(this.focusedByApi=!1),I=this.getLastFocusedCell(),i.ignoreFocusMode||"cell"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1);break}}else if("both"==this.options.focusMode){for(F=this.focusedCell.length-2;F>=0;F--)if(this.focusedCell[F].focusedTd==I.focusedTd){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex);break}}else if("row"==this.options.focusMode){
var G=r.D.getDataPrefix("trIndex"),W=I.focusedTd?I.focusedTd.parentNode:null;for(F=this.focusedCell.length-2;F>=0;F--){var V=this.focusedCell[F];if(null!=V.focusedTd){var q=V.focusedTd.parentNode;for(g=parseInt(q.getAttribute(G));g>0;)g--,q=r.D.prev(q);do{if(q==W){this._applyFocusedCellOut(this.focusedCell[F]),this.focusedCell.pop(),this.focusedCell.splice(F,1),this.changeFocusedCellPosition(this.rowIndex,!0);break}if(!(q=r.D.next(q)))break}while("0"!=q.getAttribute(G))}}}}var j=this.getCellInfo(w);if("custom"==j.options.inputType&&(j=j.cellManagerHashByRowIndex[m]),(D=this._getGroupbyDisplayRowIndex(D))==(m=this._getGroupbyDisplayRowIndex(m))&&R==w||u.B.fireEvent(this,"oncellindexchange",m,w,D,R),D!=m&&u.B.fireEvent(this,"onrowindexchange",m,D),R!=w&&u.B.fireEvent(this,"oncolumnindexchange",w,R),!0===this._isHybridScroll()&&!0!==i.hybridAsync){var P=document.getElementById(this.id+"_main_div"),z=document.getElementById(this.id+"_scrollY_div"),X=Math.round(z.scrollTop),U=this.getFooterHeight(),Z=document.getElementById(this.id+"_head_table").offsetHeight,K=P.offsetHeight,Y=e.offsetHeight,$=K-Z-U,J=X-this._hybridScrollYPos-e.offsetTop;r.D.isIEAllVersion()&&(J+=Z);var Q=Y-J-$;if(J>0){var tt=X-J;z.scrollTop=tt}else if(Q>0){tt=X+Q;z.scrollTop=tt}}if(i.editMode){var et=this.uuid,it=e.id;if(!0===this._isNativeScroll()){var ot=e.parentNode,st=this.id+"_dataLayer",at=document.getElementById(st),rt=(Z=this.head_table.offsetHeight,ot.offsetHeight*this.oneRowLength);tt=ot.offsetTop-at.offsetHeight+rt+2;r.D.requestAnimationFrame((function(){var t,e=document.getElementById(st);e.scrollTop<tt?e.scrollTop=tt:e.scrollTop>(t=tt+e.offsetHeight-Z-rt)&&(e.scrollTop=Math.max(t,0)),r.D.requestAnimationFrame((function(){var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)}))}))}else!0===this._isHybridScroll()?r.D.requestAnimationFrame((function(){var t=WebSquare.idCache[et],e=document.getElementById(it);t.setEditMode(e)})):this.setEditMode(e)}return h}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.applyFocusedCellOut=function(){if(this.focusedCell.length>0)for(var t=0;t<this.focusedCell.length;t++){var e=this.focusedCell[t];this._applyFocusedCellOut(e)}},D.prototype._applyFocusedCellOut=function(t){if("row"==this.options.focusMode||"both"==this.options.focusMode){if(null==(o=t.focusedTd)&&this.options.showLastRow){var e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&this.removeFocusRowStyle(o)}if("cell"==this.options.focusMode||"both"==this.options.focusMode){var o;if(null==(o=t.focusedTd)&&this.options.showLastRow){e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&("linear"!=this.options.focusFlow&&o.setAttribute("tabIndex",-1),this.removeClass(o,"focusedTd"),(!this.options.focusDefaultColumn||t.focusedColIndex>=0)&&(this.options.fixedRow>0&&t.focusedRowIndex-this.rowIndex>=0&&this.options.fixedRow>t.focusedRowIndex-this.rowIndex||this.options.lastFixedRow>0&&t.focusedRowIndex-this.rowIndex>this.lastIndex-this.options.lastFixedRow?this.applyCellStyleOptions(t.focusedRowIndex-this.rowIndex,t.focusedColIndex,!0):this.applyCellStyleOptions(t.focusedRowIndex,t.focusedColIndex,!0)),this.options.rowMouseOver&&this.addRowOverStyle(this.overElem))}},D.prototype.removeFocusRowStyle=function(t){try{if(null==t)return;for(var e=r.D.getDataPrefix("trIndex"),i=r.D.getDataPrefix("tdIndex"),o=r.D.getDataPrefix("style_bak"),a=t.parentNode,n=parseInt(a.getAttribute(e));n>0;)n--,a=r.D.prev(a);var l=r.D.first(a),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var u=d;d>=this.defaultColCnt&&(u=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var p=n*this.realRowDataLength+u,c=this.all_data_td_list[p];if(this.removeClass(c,"focusedTr"),d<this.defaultColCnt){
var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor="",c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor="",c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y,!0)}}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.applyFocusedCellIn=function(t,e,i){if("none"!=this.options.focusMode){var o=(i=i||{}).tabDirection,a=i.ignoreFocusMode,n=i.linkNoFocus,l=r.D.getDataPrefix("col_id"),h=r.D.getDataPrefix("tdIndex"),d=this.getCellInfo(t.getAttribute(l)),u=d.options.inputType||"text",p=!1;if("custom"==d.options.inputType&&"undefined"!==i.customRowIndex&&(u=(d=d.cellManagerHashByRowIndex[i.customRowIndex]?d.cellManagerHashByRowIndex[i.customRowIndex]:d).options.inputType||"text"),this.options.useTextMultiLink&&this.options.senseReader&&"user"===u&&d.options.customFormatter&&(p=!0),this.focusedByApi=!0,d.options.embeddedInput&&!1===p){if(e){var c=this.getElemRowIndex(t);if("text"!=u&&"link"!=u||!this._getEditDisabled(c,d.id)&&!this.__getEditReadOnly(t,c))this.getInput(d,t).focus();else t.focus()}else if(o){c=this.getElemRowIndex(t);if(this._getEditDisabled(c,d.id)||this.__getEditReadOnly(t,c))t.focus();else this.getInput(d,t).focus()}}else{var g=!1;try{var f=this.focusedCell[this.focusedCell.length-1].focusedRealRowIndex-this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&f>=0&&this.options.fixedRow>f||this.options.lastFixedRow>0&&f-this.rowIndex>this.lastIndex-this.options.lastFixedRow)&&(g=!0)}catch(t){s.w.printStackTrace(t,null,this)}if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum||this.___getEditReadOnly(f,t.getAttribute(l))&&!0===this.options.readOnlyTabIgnore||t.setAttribute("tabIndex",0),"custom"==u&&this.options.senseReader){c=this.getElemRowIndex(t);var m=d.cellManagerHashByRowIndex[c];u=m?m.options.inputType:"text"}if(e&&("text"==u||"secret"==u||"textarea"==u||"textImage"==u||"calendar"==u)||g);else if("button"==u&&this.options.senseReader){var y=t.getElementsByTagName("button");(y=y[0]).focus()}else if("link"==u&&this.options.senseReader){(v=(v=t.getElementsByTagName("a"))[0]).focus()}else if("checkbox"==u&&this.options.senseReader){t.getElementsByTagName("input")[0].focus()}else if("user"==u&&this.options.senseReader){var b;if(0==(v=t.getElementsByTagName("a")).length&&(v=t.getElementsByTagName("input")),-1!=this.focusedCellLinkIndex)if("right"==o){for(var w=0;w<v.length;w++)document.activeElement==v[w]&&(this.focusedCellLinkIndex=w);b=this.focusedCellLinkIndex+1}else b=this.focusedCellLinkIndex-1;else{if("right"==o)b=0;else if(null==o){if(b=0,document.activeElement)for(w=0;w<v.length;w++)document.activeElement==v[w]&&(b=w)}else b=v.length-1;this.focusedCellLinkLength=v.length}v=v[b],this.focusedCellLinkIndex=b,v?o&&v.focus():this._getEditDisabled(c,d.id)||this.__getEditReadOnly(t,c)?t.blur():t.focus()}else if("select"!=u||1!=this.options.senseReader||"ul"!=d.options.tableRender||this.isVirtualCursor())r.D.isIE(8)?"none"!=t.parentElement.style.display&&t.focus():n||t.focus();else{var v;(v=(v=t.getElementsByTagName("a"))[0]).focus()}}var C=!1;try{C=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){C=!1}if(!0===this._isHybridScroll())this._setHybridDataLayerTop();else if(!C&&!e&&!0!==this._isNativeScroll()){var I=this.getElementById(this.id+"_dataLayer");I.scrollLeft=0,I.scrollTop=0}var _=this.options.focusMode;if(a&&(_="cell"),"row"!=_&&"both"!=_||this.setFocusRowStyle(t),"cell"==_||"both"==_){this.addClass(t,"focusedTd");var x=parseInt(t.getAttribute(h)),S=parseInt(x/this.realRowDataLength),D=S+this.rowIndex
;(this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>S||this.options.lastFixedRow>0&&S>this.lastIndex-this.options.lastFixedRow)&&(D=S);var R=x%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.options.focusDefaultColumn&&R<0)return;this.applyCellStyleOptions(D,R,null,a)}}},D.prototype.setFocusRowStyle=function(t){try{if(null==t)return;for(var e=r.D.getDataPrefix("trIndex"),i=r.D.getDataPrefix("tdIndex"),o=r.D.getDataPrefix("style_bak"),a=t.parentNode,n=parseInt(a.getAttribute(e));n>0;)n--,a=r.D.prev(a);var l=r.D.first(a),h=parseInt(l.getAttribute(i));n=parseInt(h/this.realRowDataLength);for(var d=0;d<this.realRowDataLength;d++){var u=d;d>=this.defaultColCnt&&(u=Math.floor((d-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(d-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var p=n*this.realRowDataLength+u,c=this.all_data_td_list[p];if(this.addClass(c,"focusedTr"),d<this.defaultColCnt){var g=c.className;g.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""!=this.options.rowNumBackgroundColor&&!0!==this.options.rowNumRowMouseOverColor||(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o)):g.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(c.style.backgroundColor=this.options.selectedRowColor.wq_trim(),c.removeAttribute(o))}else{var f=parseInt(c.getAttribute(i)),m=n+this.rowIndex,y=f%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(m,y)}}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.outFocusedCell=function(){this.removeFocusedCell()},D.prototype.getFocusedCellData=function(){var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex(),i=this.getColumnID(e);return t>-1?this.dataList._getCellData(t,i):null},D.prototype.getFocusedRowData=function(){var t=this._getFocusedRowIndex();return t>-1?this.dataList.getRowData(t):null},D.prototype.getFocusedRowXML=function(){var t=this._getFocusedRowIndex(!0);return t>-1?this.dataList.getRowXML(t):null},D.prototype.removeRowFocus=function(t){for(var e=[],i=0;i<this.focusedCell.length;i++)t!=this.focusedCell[i].focusedRowIndex?e.push(this.focusedCell[i]):this._applyFocusedCellOut(this.focusedCell[i]);this.focusedCell=e},D.prototype.setFocusedHeaderObj=function(t){if(this.getHeaderLayer(t)){var e=this.headerObj[t];if(e)switch(e.headInputType){case"checkcombobox":case"select":case"checkbox":case"input":e.focus()}}},D.prototype.focus=function(t){try{if(this.options.senseReader&&this.options.useStartEndDiv){var e=this.getElementById(this.id+"_gridstart_div"),i=this.getElementById(this.id+"_gridend_div");t&&"object"===(0,l.Z)(t)&&(t.shiftKey?i.focus():e.focus())}else{var o=this.getLastFocusedCell(),a=-1!=o.focusedRowIndex?o.focusedRowIndex:0,r=null!=o.focusedColIndex?o.focusedColIndex:0;this._setFocusedCell(a,r,!1)}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.setFocusedMultiCell=function(t,e,i,o,a){try{a=a||{};var r=this.options.useShiftKey;this.options.useShiftKey=!0;var n=Number(t),l=Number(e),h=Number(i),d=Number(o);isNaN(n)||isNaN(l)||this._setFocusedCell(n,l,null,{ignoreFocusMode:a.ignoreFocusMode}),isNaN(h)||isNaN(d)||this._setFocusedCell(h,d,!1,{shifted:!0,ignoreFocusMode:a.ignoreFocusMode}),this.options.useShiftKey=r}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype.removeFocusedMultiCell=function(t,e,i,o){try{for(var a="focusedColIndex",r="focusedRowIndex",n=this.focusedCell.length-1;n>=0;n--){var l=this.focusedCell[n];l[r]>=t&&l[r]<=i&&l[a]>=e&&l[a]<=o&&(this._applyFocusedCellOut(l),this.focusedCell.splice(n,1))}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype._applyFocusedMultiCell=function(t,e,i,o,a){try{!0!==this.options.ctrlShiftKey&&(this.applyFocusedCellOut(),this.focusedCell=[]);var r=this.getLocationRowCol(t,e);t=r.rowIndex,e=r.colIndex;var n=t,l=e;"row"===this.options.focusMode&&(o=this.getColumnCount()-1);var h=this.getLocationRowCol(i,o);i=h.rowIndex,
o=h.colIndex;for(var d=i,u=o,p=t>i,c=e>o,g=this.htmlInfo.body.rowAttrArr.length,f=p?i:t,m=p?t:i,y=c?o:e,b=c?e:o,w=!0;w;){w=!1;var v=m,C=0;for(var I in this.cellMergeInfo)this.cellMergeInfo.hasOwnProperty(I)&&C++;m-f>g&&C<1&&(v=f+g);for(var _=y,x=f;x<=v;x++){var S=this.getOriginalRowCol(x,y);S.colSize>1&&_>(S=this.getLocationRowCol(S.rowIndex,S.colIndex)).colIndex&&(_=S.colIndex,w=!0),y=_}var D=b;for(x=f;x<=v;x++){var R=this.getOriginalRowCol(x,b);R.colSize>1&&D<(R=this.getLocationRowCol(R.rowIndex,R.colIndex)).colIndex+R.colSize-1&&(D=R.colIndex+R.colSize-1,w=!0),b=D}for(var L=f,T=y;T<=b;T++){var k=this.getOriginalRowCol(f,T);k.rowSize>1&&L>(k=this.getLocationRowCol(k.rowIndex,k.colIndex)).rowIndex&&(L=k.rowIndex,w=!0),f=L}var F=m;for(T=y;T<=b;T++){var A=this.getOriginalRowCol(m,T);A.rowSize>1&&F<(A=this.getLocationRowCol(A.rowIndex,A.colIndex)).rowIndex+A.rowSize-1&&(F=A.rowIndex+A.rowSize-1,w=!0),m=F}}i=p?f:m,e=c?b:y,o=c?y:b;for(x=t=p?m:f;p?x>=i:x<=i;p?x--:x++)for(T=e;c?T>=o:T<=o;c?T--:T++){var E=this.getOriginalRowCol(x,T),M=E.colIndex,O=E.rowIndex;if(!E.noLeftTop){var N=this.data_td_list[M+(O-this.rowIndex)*this.oneRowDataLength];if(O<this.rowIndex&&(N=null),!(this.groupbyStatus.grouped&&N&&this.hasClass(N,"w2grid_groupby"))){var B=this.getCellInfo(M),H=this._getRealColIndex("body",B.options.col_id)+this.defaultColCnt;if(!B.options.blockSelect&&!this.hiddenList[H]){var G={focusedTd:N,focusedRowIndex:O,focusedColIndex:M};if(this.options.groupbyDisplayRowIndex&&(G.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(O)),x==n&&T==l?this.focusedCell.unshift(G):this.focusedCell.push(G),null!=N){var W=!0;(B.options.embeddedInput||T==u&&x==d)&&(W=!1),this.applyFocusedCellIn(N,W,{ignoreFocusMode:a})}(""==B.options.inputType||"text"==B.options.inputType&&!B.options.embeddedInput||"textImage"==B.options.inputType||"calendar"==B.options.inputType)&&(this.getInput(B).options.editType=B.options.editType?B.options.editType:this.options.editType)}}}}}catch(t){s.w.printStackTrace(t,null,this)}},D.prototype._addFocus=function(t){try{var e=r.D.getDataPrefix("tdIndex"),i=parseInt(t.getAttribute(e)),o=parseInt(i/this.realRowDataLength)+this.rowIndex,a=o;this.isDrillDown&&this._dataList.options.depthColumn&&(a=this.getRealRowIndex(o));var n,l=i%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),h={focusedTd:t,focusedRealRowIndex:a,focusedRowIndex:n=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>o-this.rowIndex||this.options.lastFixedRow>0&&o-this.rowIndex>this.lastIndex-this.options.lastFixedRow?o-this.rowIndex:o,focusedColIndex:l};this.options.groupbyDisplayRowIndex&&(h.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(n)),this.focusedCell.push(h)}catch(t){s.w.printStackTrace(t,null,this)}};var R=function(t){};R.prototype._subtotalHidden=function(t){try{for(var e=0;e<t.length;e++){if(this.isIE6or7)for(var i=t[e].getElementsByTagName("td"),o=0;o<i.length;o++)i[o].style.borderWidth="0px";"none"!==t[e].style.display&&(this.drawedSubtotal&&this.drawedSubtotal.drawedRowLength--,t[e].style.display="none")}}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalHidden=function(t){try{if(!this.hasSubtotal)return;if(t){if("number"==typeof t.index)for(var e=this.drawedSubtotal.splice(t.index,1),i=0;i<e.length;i++)this._subtotalHidden(e[i]);if("number"==typeof t.rowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex==t.rowIndex){e=this.drawedSubtotal.splice(i,1);for(var o=0;o<e.length;o++)this._subtotalHidden(e[o])}if("number"==typeof t.startRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex>=t.startRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o]);if("number"==typeof t.endRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex<=t.endRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o])}else{
for(var a in this.subtotalTableList){var r=this.subtotalRowHash[a];r&&this._subtotalHidden(r)}this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0}}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.refreshSubtotalRow=function(t){try{for(var e=t-this.rowIndex,i=!0===this._isBrowserScroll()?this.getRowCount()-1:this.lastIndex,o=e;o<=i;o++)this.drawSubtotalRow(o+1,o+this.rowIndex);var n=WebSquare.BootLoader.fullViewed||!1,l=r.D.fullViewed||!1;if(!n&&!l){var h=this.options.adaptive,d=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==h&&!(r.D.isIE()&&parseInt(a.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=d){for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!0);this.removeAdaptiveGridSubtotalHeight(),this.setAdaptiveGridSubtotalHeight();for(o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}}}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.drawSubtotalRow=function(t,e,i){try{var o=0;if(!this.hasSubtotal||e<0||e>=this.getDataLength())return o;var a=NaN;if(i&&!isNaN(i.maxCount)&&(a=i.maxCount),a<=0)return o;for(var r in this.subtotalTableList){var n=this.dataList._getCellData(e,r),l=n+"_12";if(e<this.getDataLength()-1)l=this.dataList._getCellData(e+1,r);if(n!=l){var h=this.subtotalRowHash[r],d=this.subtotalTableList[r],u=d.rows.length,p=[];p.rowIndex=e,p.targetID=r;for(var c=0;c<u;c++){var g=h?h[t*u+c]:void 0;if(g){if(this.isIE6or7)for(var f=g.getElementsByTagName("td"),m=0;m<f.length;m++)f[m].style.borderWidth="";o>=a?g.style.display="none":(g.style.display="",o++),g.setAttribute("data-subtotalrowindex",e),p.push(g),this.lastSubtotalRow=g}}if(this.drawedSubtotal.push(p),this.drawedSubtotal.drawedRowLength+=o,this.setSubtotalData(d,r,n,e,p,i),o>=a)break}}return o}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.hasUpperSubtotalRow=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return!1;for(var e in this.subtotalTableList){var i=this.dataList._getCellData(t,e),o=i;if(t<this.getDataLength())o=this.dataList._getCellData(t-1,e);if(i!=o)return!0}return!1}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.getHasSubtotalCount=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return 0;var e=0;for(var i in this.subtotalTableList){var o=this.dataList._getCellData(t,i),a=o;t+1<this.getDataLength()?a=this.dataList._getCellData(t+1,i):t+1==this.getDataLength()&&e++,o!=a&&e++}return e}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.setSubtotalData=function(t,e,i,o,a,n){try{var l,h=this.subtotalDataArr[e+"_"+i];if(null==h&&(h=this.getSubtotalData(t,e,i,o)),this.options.subtotalStyleFormatter)try{"function"==typeof this.options.subtotalStyleFormatter?l=this.options.subtotalStyleFormatter:null!=(l=r.D.getGlobalFunction(this.options.subtotalStyleFormatter,this.scope_id))&&(this.options.subtotalStyleFormatter=l)}catch(t){l=null}for(var d=r.D.getDataPrefix("inputType"),u=r.D.getDataPrefix("NaNFormat"),p=r.D.getDataPrefix("colMerge"),c=r.D.getDataPrefix("value"),g=r.D.getDataPrefix("useLocale"),f=r.D.getDataPrefix("localeRef"),m=0;m<a.length;m++)for(var y=a[m].getElementsByTagName("td"),b=0;b<y.length;b++){var w=y[b],v=w.getAttribute("id");if(null!=h[v]){var C=h[v];if("expression"==w.getAttribute(d)&&isNaN(C)&&null!=w.getAttribute(u)&&"NaN"!=w.getAttribute(u)&&(C=w.getAttribute(u)),w.innerHTML=this.dataTagOpen+C+this.dataTagClose,"function"==typeof l){var I=h[v+"_org"];null==I&&(I=C);var _=l(I,C,w.id);if(w&&_){var x=w.getAttribute("data-bkclassname");null==x&&(x=w.className,w.setAttribute("data-bkclassname",x)),w.className=w.getAttribute("data-bkclassname")+" "+_}}
}else if("true"!=w.getAttribute(p)||this.groupbyStatus.grouped){var S=w.getAttribute(c),D=w.getAttribute(g),R=w.getAttribute(d);if("true"===D||this.options.useLocale&&!D){var L=w.getAttribute(f);if(L&&"expression"!==R){var T=this.getLocaleValue(L);T&&(S=T)}}S=null!=S?S:"",w.innerHTML=this.dataTagOpen+S+this.dataTagClose}else w.style.borderTopWidth="0px",w.style.borderBottomWidth="0px"}}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.getSubtotalData=function(t,e,i,o){try{var a=e,n=this.subtotalObj[e];if(null==n){n={};for(var l=r.D.getDataPrefix("inputType"),h=r.D.getDataPrefix("expression"),d=r.D.getDataPrefix("colindex"),u=r.D.getDataPrefix("dataType"),p=r.D.getDataPrefix("displayFormat"),c=r.D.getDataPrefix("displayFormatter"),g=0;g<t.rows.length;g++)for(var f=t.rows[g].getElementsByTagName("td"),m=0;m<f.length;m++){var y=f[m];if("expression"==y.getAttribute(l)){(k={}).id=y.getAttribute("id");var b,w=y.getAttribute(h)||"";if(""!=w){var v="";this.options.groupbyStatus||(w.toLowerCase().indexOf("sumifs")>-1?v="sumifs":w.toLowerCase().indexOf("sumif")>-1&&(v="sumif")),b=v?w.substring(w.indexOf("(")+1,w.indexOf(",")):w.substring(w.indexOf("(")+1,w.indexOf(")")),w=w.replace(/[sS][uU][mM][\s]*[(]/g,"this.subtotalcolsum( obfuscator_st, obfuscator_en ,"),this.options.groupbyStatus||(w=(w=w.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"this.subtotalcolsumif( obfuscator_st, obfuscator_en ,")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"this.subtotalcolsumifs( obfuscator_st, obfuscator_en ,")),w=(w=(w=(w=(w=(w=(w=w.replace(/[aA][vV][gG][\s]*[(]/g,"this.subtotalcolavg( obfuscator_st, obfuscator_en ,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.subtotalcolmax( obfuscator_st, obfuscator_en ,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.subtotalcolmin( obfuscator_st, obfuscator_en ,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"this.subtotalcolcnt( obfuscator_st, obfuscator_en ,")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][vV][aA][lL][uU][eE][\s]*[(]/g,"this.dataList._getCellData( obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][lL][aA][bB][eE][lL][\s]*[(]/g,"this.subtotaltargetcollabel( obfuscator_st, obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][fF][oO][oO][tT][eE][rR][vV][aA][lL][uU][eE][\s]*[(]/g,"this.subtotaltargetfootervalue( obfuscator_st, obfuscator_en,")}var C="text",I=parseInt(y.getAttribute(d))-this.defaultColCnt;if(I>=0&&(C=this._dataList.getCellInfo(I).options.dataType),"true"===this.options.useCurrency?k.dataType=y.getAttribute(u):k.dataType=y.getAttribute(u)||C,k.expression=w,!k.dataType){var _=this.getCellInfo(b),x=_&&_.options&&_.options.dataType;b&&"true"===this.options.useCurrency?(k.dataType=x,"function"==typeof _.options.customModelUnformatter?k.customModelUnformatter=_.options.customModelUnformatter:k.customModelUnformatter=r.D.getGlobalFunction(_.options.customModelUnformatter,this.scope_id)):k.dataType=C}k.displayFormat=y.getAttribute(p)||"",k.displayFormatter=y.getAttribute(c)||"","true"!==this.options.useCurrency||k.displayFormatter||(k.displayFormat=_.options.displayFormat||y.getAttribute(p)||"",k.displayFormatter=_.options.displayFormatter||""),k.formatter=WebSquare.format.createFormatter(k.dataType,k.displayFormat,k.displayFormatter,null,null,null,this.scope_id,this.id),n[k.id]=k}}this.subtotalObj[e]=n}for(var S=o;S>0&&i==this.dataList._getCellData(S-1,e);)S--;var D=S,R=o,L={};for(var T in n){var k=n[T],F=r.D.scopingFuncBody(k.expression,this.scope_id);this._subtotalDisplayFormat=k.displayFormat||"";var A=Function("obfuscator_st","obfuscator_en","obfuscator_targetID",F).call(this,D,R,a);k.customModelUnformatter&&(A=k.customModelUnformatter.call(this,A));var E=k.formatter.format(A);L[T]=E,this.options.subtotalStyleFormatter&&A!==E&&(L[T+"_org"]=A)}return this._subtotalDisplayFormat="",L}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.getSubtotalRowList=function(t){try{var e=[];t&&"object"===t.returnType&&(e={});var i=this.getDataLength()
;for(var o in this.subtotalStrList)for(var a=1;a<i;a++){this.dataList._getCellData(a-1,o)!=this.dataList._getCellData(a,o)&&(t&&"object"===t.returnType?e[a]=!0:e.push(a))}return e}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolsumif=function(t,e,i,o,a){try{var r=[],n=[],l=[];if(o){var h=this._getOperator(o);if(!h.operator||!h.value)return;return n.push(h.operator),l.push(h.value),r?r.push(a):r.push(i),this._subtotalcolsum(t,e,i,r,n,l)}}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolsumifs=function(t,e,i){try{for(var o=[],a=[],r=[],n=(arguments.length-3)/2,l=0;l<n;l++){var h=this._getOperator(arguments[2*l+3]),d=arguments[2*l+4];h.operator&&h.value&&(a.push(h.operator),r.push(h.value)),o.push(d)}return this._subtotalcolsum(t,e,i,o,a,r)}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolsum=function(t,e,i){try{try{return this._subtotalcolsum(t,e,i)}catch(t){s.w.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},R.prototype._subtotalcolsum=function(t,e,i,o,a,n){try{var l={};!this.options.groupbyStatus&&o&&(l={conditionColumn:o,targetOperator:a,conditionValue:n});var h,d=this.getColumnSubtotalRangeDataArray(t,e,i,l),u="";if(d.length>0)if(h=this.getColumnOption(i,"dataType"),u=0,"bigDecimal"===h)for(var p=0;p<d.length;p++)u=WebSquare.bigDecimal(u+"").plus(d[p]);else if("time"===h)for(p=0;p<d.length;p++){var c=WebSquare.text.fillZero(u,4);u=WebSquare.date.dateTimeAdd(c,d[p],"hour","time")}else u=r.D.sum(d,{displayFormat:this._subtotalDisplayFormat});return r.D.setPrecision(u)}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolavg=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),a="",r=this.getColumnOption(i,"dataType");if(o.length>0)if("bigDecimal"===r){for(var n in a="0",o)a=WebSquare.bigDecimal(a).plus(o[n]);a=a.divide(WebSquare.bigDecimal(o.length))}else a=WebSquare.util.sum(o,{displayFormat:this._subtotalDisplayFormat})/o.length;return a}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolmax=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),a=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===a)for(var l in o)n=null==n?o[l]:n.compare(o[l]);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n<h)&&(n=h)}return n=null==n?"":n,r.D.setPrecision(n)}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolmin=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),a=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===a)for(var l in o)n=null==n?o[l]:n.compare(o[l],!0);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n>h)&&(n=h)}return n=null==n?"":n,r.D.setPrecision(n)}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotalcolcnt=function(t,e,i,o){try{o=o||{};return(this.getColumnSubtotalRangeDataArray(t,e,i,o)||[]).length}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.subtotaltargetcollabel=function(t,e,i,o){var a="";try{a=this.dataList._getCellData(e,i);var r=this.getCellInfo(i),n=r.options.inputType;"select"!==n&&"autoComplete"!==n&&"checkcombobox"!==n||(a=r.getData(a,e))}catch(t){s.w.printStackTrace(t,null,this)}return a},R.prototype.subtotaltargetfootervalue=function(t,e,i,o){var a;try{this.hasFooter&&this.footerTempSum&&this.footerTempSum[i]&&(a=this.footerTempSum[i].sum)}catch(t){s.w.printStackTrace(t,null,this)}return a},R.prototype.getColumnSubtotalRangeDataArray=function(t,e,i,o){try{for(var a,r=[],n=this.getColumnID(i),h=this.getColumnOption(n,"dataType"),d=this.dataList.getDeletedIndex(),u=this.dataList.getModifiedIndex(),p=t;p<=e;p++){if(this.options.excludeDeletedRows){for(var c=!1,g=0;g<d.length;g++)if(d[g]===p){c=!0;break}if(c)continue}if(this.options.excludeModifiedRows){for(c=!1,g=0;g<u.length;g++)if(u[g]===p){c=!0;break}if(c)continue}if("object"===(0,l.Z)(o)&&o.conditionColumn&&o.conditionColumn.length>0){var f=!0
;for(g=0;g<o.conditionColumn.length;g++){var m=this.dataList.getCellData(p,o.conditionColumn[g]),y=o.targetOperator[g],b=o.conditionValue[g],w=this.getColumnOption(o.conditionColumn[g],"dataType");if(0==(f=this._isMatched(b,m,y,w)))break}if(0==f)continue}"bigDecimal"===h?a=WebSquare.bigDecimal(this.dataList._getCellData(p,i)):(a=this.dataList._getCellData(p,i),a+=""),void 0===a||""==a?(a="0","object"===(0,l.Z)(o)&&!1!==o.blank&&r.push(a)):r.push(a)}return r}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype._getLastSubtotalCount=function(){try{if(!this.hasSubtotal)return 0;for(var t=0,e=this.getDataLength(),i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength),0),o=0,a=e-1;a>=i;a--){for(var r=0;r<this.struct.subtotalArr.length;r++){var n=this.struct.subtotalArr[r],l=n.attr.targetColumnID,h=this.dataList._getCellData(a,l),d=h+"_12";if(a<e-1)d=this.dataList._getCellData(a+1,l);if(h!=d&&(t+=n.rowArr.length,this.options.initFixedHeightByRowNum>-1)){if(o+t>=this.options.initFixedHeightByRowNum){i=a+1;break}i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength-t),0)}}o++}return t}catch(t){s.w.printStackTrace(t,null,this)}},R.prototype.setSubtotalVisible=function(t){try{if(0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({subTotalVisible:t});!0!==t||this.hasSubtotal?!1===t&&this.hasSubtotal&&(this.subtotalHidden(),this.lastTopRowIndex=null,this.hasSubtotal=!1,this.setScrollYHeight()):(this.hasSubtotal=!0,this.lastTopRowIndex=null,this._applyRowVisible({subtotalDraw:!0}),this.setScrollYHeight())}catch(t){s.w.printStackTrace(t,null,this)}};var L=function(t){};L.prototype.initializeFooter=function(){try{if(!this.hasFooter)return;for(var t=r.D.getDataPrefix("footer_id"),e=r.D.getDataPrefix("inputType"),i=r.D.getDataPrefix("value"),o=r.D.getDataPrefix("useLocale"),a=r.D.getDataPrefix("localeRef"),n=this.getDomList("foot_tds","td",this.getElementById(this.id+"_foot_table")),l=0;l<n.length;l++){var h=n[l],d=h.getAttribute("id");if(d&&!h.getAttribute(t)){for(var u="",p=0;p<this.struct.foot.rowArr.length;p++)for(var c=0;c<this.struct.foot.rowArr[p].length;c++)if(this.struct.foot.rowArr[p][c].id==d&&(this.struct.foot.rowArr[p][c].class||this.struct.foot.rowArr[p][c].className)){u=this.struct.foot.rowArr[p][c].class||this.struct.foot.rowArr[p][c].className;break}if("_headerRowNumber"!==d&&"_headerRowStatus"!==d||(d+="_footer"),h.setAttribute(t,d),h.setAttribute("id",this.id+"_"+d),h.setAttribute("class",h.getAttribute("class")+" "+this.id+"_footer__column"+l+" "+u),"expression"!=h.getAttribute(e)){var g=h.getAttribute(i),f=h.getAttribute(o);if("true"===f||this.options.useLocale&&!f){var m=h.getAttribute(a);if(m){var y=this.getLocaleValue(m);y&&(g=y)}}g=null!=g?g:"",h.innerHTML=this.dataTagOpen+g+this.dataTagClose}}}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.drawFooter=function(t){try{if(!this.hasFooter||!this.drawFooterStatus)return;null==this.footerDataObj&&this.initFooterDataObj();var e=r.D.getDataPrefix("footer_id"),i=r.D.getDataPrefix("colindex"),o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if(this.footerTempSum=[],t){t=this.getColumnID(t);for(var a=0;a<o.length;a++){var n=(g=o[a]).getAttribute(e),l=parseInt(g.getAttribute(i))-this.defaultColCnt;if(n)if("expression"==(f=this.footerDataObj[n]).inputType){var h=f.expression.match(/footercol(sum|avg|max|min|custom)\s*\([^\)]*/g);if(h){for(var d=0;d<h.length;d++)if(h[d].indexOf(t)>=0){var u=r.D.scopingFuncBody(f.expression,this.scope_id);f.value=Function("_this",u).call(this,this),isNaN(f.value)?"NaN"!=f.NaNFormat&&(f.value=f.NaNFormat):"number"===f.dataType&&0===Number(f.value)&&(f.value=0);var c=f.value;f.customModelUnformatter&&(c=f.customModelUnformatter.call(this,c)),g.innerHTML=this.dataTagOpen+f.formatter.format(c)+this.dataTagClose}}else if(t==this.getCellInfo(l).id){try{
u=r.D.scopingFuncBody(f.expression,this.scope_id);f.value=Function("_this",u).call(this,this),isNaN(f.value)&&"NaN"!=f.NaNFormat&&(f.value=f.NaNFormat)}catch(t){s.w.printStackTrace(t,null,this)}c=f.value;f.customModelUnformatter&&(c=f.customModelUnformatter.call(this,c)),g.innerHTML=this.dataTagOpen+f.formatter.format(c)+this.dataTagClose}}}}else for(a=0;a<o.length;a++){var g;if(n=(g=o[a]).getAttribute(e)){var f;if("expression"==(f=this.footerDataObj[n]).inputType)try{u=r.D.scopingFuncBody(f.expression,this.scope_id);f.value=Function("_this",u).call(this,this),isNaN(f.value)?"NaN"!=f.NaNFormat&&(f.value=f.NaNFormat):"number"===f.dataType&&0===Number(f.value)&&(f.value=0)}catch(t){p.k.printLog("[Warning]:"+t.message)}c=f.value;f.customModelUnformatter&&(c=f.customModelUnformatter.call(this,c)),g.innerHTML=this.dataTagOpen+f.formatter.format(c)+this.dataTagClose}}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.initFooterDataObj=function(t){try{var e=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),i=-1,n=!1;t?(i=this.getColumnIndex(t),n=!0):this.footerDataObj={};for(var l=r.D.getDataPrefix("footer_id"),h=r.D.getDataPrefix("colindex"),d=r.D.getDataPrefix("value"),u=r.D.getDataPrefix("useLocale"),p=r.D.getDataPrefix("localeRef"),c=r.D.getDataPrefix("inputType"),g=r.D.getDataPrefix("dataType"),f=r.D.getDataPrefix("displayFormat"),m=r.D.getDataPrefix("displayFormatter"),y=r.D.getDataPrefix("NaNFormat"),b=r.D.getDataPrefix("expression"),w=0;w<e.length;w++){var v=e[w],C=v.getAttribute(l);C||(C="f_"+o.x.safeRandom().toString(),v.setAttribute(l,C));var I=parseInt(v.getAttribute(h))-this.defaultColCnt;if(!(i>=0&&i!==I)){var _={};_.id=C;var x=v.getAttribute(b)||"",S="";""!=x&&(this.options.groupbyStatus||(x.toLowerCase().indexOf("sumifs")>-1?S="sumifs":x.toLowerCase().indexOf("sumif")>-1&&(S="sumif")),x=x.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(x=(x=x.replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")).replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")),x=(x=(x=(x=(x=x.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( ")),_.value=v.getAttribute(d);var D,R,L=v.getAttribute(u);if("true"===L||this.options.useLocale&&!L){var T=v.getAttribute(p);if(T){var k=this.getLocaleValue(T);k&&(_.value=k)}}if(_.inputType=v.getAttribute(c),_.dataType=v.getAttribute(g),_.col_id=this.getColumnID(I),!_.dataType)try{if(_.dataType=this.getColumnOption(_.col_id,"dataType"),"true"===this.options.useCurrency){var F=this.getCellInfo(_.col_id);F&&(D=F.options.displayFormat,R=F.options.displayFormatter,F.options.customModelUnformatter&&("function"==typeof F.options.customModelUnformatter?_.customModelUnformatter=F.options.customModelUnformatter:_.customModelUnformatter=r.D.getGlobalFunction(F.options.customModelUnformatter,this.scope_id)))}else if("expression"===_.inputType)_.col_id=S?new Function("_this","return "+x.substring(x.indexOf("(")+1,x.indexOf(",")))(this):new Function("_this","return "+x.substring(x.indexOf("(")+1,x.indexOf(")")))(this),_.dataType=this._dataList.getCellInfo(_.col_id).options.dataType||"text";else{var A="text",E=I;E>=0&&(A=this._dataList.getCellInfo(E).options.dataType),_.dataType=A}}catch(t){_.dataType="text"}_.expression=x,_.displayFormat=v.getAttribute(f)||"",_.displayFormatter=v.getAttribute(m)||"","true"!==this.options.useCurrency||_.displayFormatter||(_.displayFormat=D||v.getAttribute(f)||"",_.displayFormatter=R||""),_.formatter=this._initFooterFormatter(_.col_id,_.dataType,_.displayFormat,_.displayFormatter,this.scope_id,this.id,n),
_.NaNFormat=v.getAttribute(y)||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==_.NaNFormat&&(_.NaNFormat=""),this.footerDataObj[_.id]=_}}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype._initFooterFormatter=function(t,e,i,o,r,n,l){try{if(t){var h=this.getCellInfo(t),d=e||h.options.dataType,u=i;return"euro"==d?(i||(u=this.options.euroMask||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/euroMask/@value')||""),".",","):"rupee"==d?(i||(u=this.options.rupeeMask||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/rupeeMask/@value')||""),",","."):"tenge"==d?(i||(u=this.options.tengeMask||a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+d+'"]/tengeMask/@value')||"")," ",","):!l||"number"!==d&&"float"!==d&&"bigDecimal"!==d||(i||(u=this.options.numberMask||a.v.getConfiguration('/WebSquare/input/dataType[@valueType="'+d+'"]/numberMask/@value')||""),",","."),WebSquare.format.createFormatter(e,u,o,null,null,null,r,n)}return WebSquare.format.createFormatter(e,i,o,null,null,null,r,n)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolsumif=function(t,e,i){try{var o=[],a=[],r=[];if(e){var n=this._getOperator(e);if(!n.operator||!n.value)return;return a.push(n.operator),r.push(n.value),o?o.push(i):o.push(t),this._footercolsum(t,o,a,r)}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolsumifs=function(t){try{for(var e=[],i=[],o=[],a=(arguments.length-1)/2,r=0;r<a;r++){var n=this._getOperator(arguments[2*r+1]),l=arguments[2*r+2];n.operator&&n.value&&(i.push(n.operator),o.push(n.value)),e.push(l)}return this._footercolsum(t,e,i,o)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolsum=function(t,e,i,o){try{return this._footercolsum(t)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype._footercolsum=function(t,e,i,o){try{this.footerTempSum||(this.footerTempSum=[]);var a=t;if(!this.options.groupbyStatus&&e&&e.length>0&&o&&o.length>0&&(a=t+"_"+o.join()),this.footerTempSum[a]||(this.footerTempSum[a]={}),void 0===this.footerTempSum[a].sum||""===this.footerTempSum[a].sum){var n="",l=5e3;if(this.groupbyStatus.grouped)n=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"SUM('"+t+"')");else{var h={};this.options.groupbyStatus||(h={conditionColumn:e,operator:i,conditionValue:o});var d=this.getColumnAllDataArray(t,h),u=this.getColumnOption(t,"dataType"),p=!1;if("bigDecimal"!==u&&"euro"!==u&&"tenge"!==u&&"rupee"!=u||(p=!0),d.length>0&&p||"true"===this.options.useCurrency){for(var c=WebSquare.bigDecimal("0"),g=0;g<d.length;g++)""==d[g].replace(/^\s+|\s+$/g,"")&&(d[g]="0");for(var f=0;f<d.length;f++)d[f]=WebSquare.bigDecimal(d[f]),c=c.plus(d[f]);n=c.toString()}else if(d.length>0)if(d.length>l){var m,y=Math.ceil(d.length/l),b=0;n=0;for(g=0;g<y;g++){for(var w=d.slice(b,l*(g+1)),v=0;v<w.length;v++)""==w[v].replace(/^\s+|\s+$/g,"")&&(w[v]="0"),w[v]=w[v]-0+"";m=r.D.sum(w),b=parseInt(b,10)+parseInt(w.length,10),n=parseFloat(n,10)+parseFloat(m,10)}}else n=r.D.sum(d)}this.footerTempSum[a].sum=n}return r.D.setPrecision(this.footerTempSum[a].sum)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolavg=function(t){try{var e=this.getColumnAllDataArray(t);this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={});var i="",o=5e3;if(this.groupbyStatus.grouped)return i=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"AVG('"+t+"')");if(void 0===this.footerTempSum[t].sum||""===this.footerTempSum[t].sum){var a=this.getColumnOption(t,"dataType");if(e.length>0&&("bigDecimal"==a||"true"===this.options.useCurrency)){
for(var n=WebSquare.bigDecimal("0"),l=0;l<e.length;l++)""==e[l].replace(/^\s+|\s+$/g,"")&&(e[l]="0");for(var h in e)e[h]=WebSquare.bigDecimal(e[h]),n=n.plus(e[h]);return n.divide(WebSquare.bigDecimal(e.length)).toString()}if(e.length>0)if(e.length>o){var d,u=Math.ceil(e.length/o),p=0;i=0;for(l=0;l<u;l++){for(var c=e.slice(p,o*(l+1)),g=0;g<c.length;g++)""==c[g].replace(/^\s+|\s+$/g,"")&&(c[g]="0");d=r.D.sum(c),p=parseInt(p,10)+parseInt(c.length,10),i=parseFloat(i,10)+parseFloat(d,10)}}else i=r.D.sum(e);this.footerTempSum[t].sum=i}return""===this.footerTempSum[t].sum?"":i=this.cellInfoHash[t]&&"bigDecimal"==this.cellInfoHash[t].options.dataType?WebSquare.bigDecimal(this.footerTempSum[t].sum).divide(WebSquare.bigDecimal(e.length)).toString():this.footerTempSum[t].sum/e.length}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolmax=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].max||""===this.footerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MAX('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var a,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),a=null==a?i[l]:a.compare(i[l],!1);e=a.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e<h)&&(e=h)}e=null==e?"":e,e=r.D.setPrecision(e)}this.footerTempSum[t].max=e}}return this.footerTempSum[t].max}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolmin=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].min||""===this.footerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MIN('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&("bigDecimal"==o||"true"===this.options.useCurrency)){for(var a,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),a=null==a?i[l]:a.compare(i[l],!0);e=a.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e>h)&&(e=h)}e=null==e?"":e,e=r.D.setPrecision(e)}this.footerTempSum[t].min=e}}return this.footerTempSum[t].min}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolcnt=function(t,e){try{e=e||{};return(this.getColumnAllDataArray(t,e)||[]).length}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getColumnAllDataArray=function(t,e){try{var i=[],o=this.getColumnID(t),a=this.dataList.getDeletedIndex(),n=this.dataList.getModifiedIndex();if(null!==o){for(var h=this.isDrillDown&&r.D.getBoolean(this.options.drilldownFooterExpressionAllData)?this.getTotalRow():this.getDataLength(),d=0;d<h;d++){if(this.options.excludeDeletedRows){for(var u=!1,c=0;c<a.length;c++)if(a[c]===d){u=!0;break}if(u)continue}if(this.options.excludeModifiedRows){for(u=!1,c=0;c<n.length;c++)if(n[c]===d){u=!0;break}if(u)continue}var g;if(this.isDrillDown&&r.D.getBoolean(this.options.drilldownFooterExpressionAllData)){if("object"===(0,l.Z)(e)&&e.conditionColumn&&e.conditionColumn.length>0){var f=!0;for(c=0;c<e.conditionColumn.length;c++){var m=this._dataList.getCellData(d,e.conditionColumn[c]),y=e.operator[c],b=e.conditionValue[c],w=this.getColumnOption(e.conditionColumn[c],"dataType");if(0==(f=this._isMatched(b,m,y,w)))break}if(0==f)continue}g=this._dataList.getCellData(d,o)}else{if("object"===(0,l.Z)(e)&&e.conditionColumn&&e.conditionColumn.length>0){for(f=!0,c=0;c<e.conditionColumn.length;c++){m=this.dataList.getCellData(d,e.conditionColumn[c]),y=e.operator[c],b=e.conditionValue[c],
w=this.getColumnOption(e.conditionColumn[c],"dataType");if(0==(f=this._isMatched(b,m,y,w)))break}if(0==f)continue}g=this.dataList._getCellData(d,o)}void 0===(g+="")||""==g?(g="0","object"===(0,l.Z)(e)&&!1!==e.blank&&i.push(g)):i.push(g)}return i}p.k.printLog("[Warning] Invalid colIndex("+t+"). ["+this.id+"] getColumnAllDataArray.")}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getFooterData=function(t,e){try{var i=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),o=r.D.getDataPrefix("footer_id");if("number"==typeof t){t=i[t+this.defaultColCnt].getAttribute(o);var a=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){var n=r.D.scopingFuncBody(h.expression,this.scope_id);a=Function("_this",n).call(this,this)}return"displayData"!=e?a:h.formatter.format(a)}for(var l=0;l<i.length;l++)if(i[l].getAttribute(o)==t){var h;a=(h=this.footerDataObj[t]).value;if("expression"==h.inputType){n=r.D.scopingFuncBody(h.expression,this.scope_id);a=Function("_this",n).call(this,this)}return"displayData"!=e?a:h.formatter.format(a)}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.setFooterValue=function(t,e){this.setFooterData(t,e)},L.prototype.setFooterData=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td"),a=r.D.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(a);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(a)==t){var l=this.footerDataObj[t];"text"==l.inputType&&(l.value=e,i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.setFooterDisplayFormat=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),a=r.D.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(a);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(a)==t){var l=this.footerDataObj[t];l.displayFormat=e,l.formatter=WebSquare.format.createFormatter(l.dataType,l.displayFormat,l.displayFormatter,null,null,null,this.scope_id,this.id),"number"==l.dataType&&(i.innerHTML=this.dataTagOpen+l.formatter.format(l.value)+this.dataTagClose)}var h=this.footerXml;if(h)for(var d=WebSquare.xml.getElementsByTagName(h,"w2:row"),u=0;u<d.length;u++){var p=WebSquare.xml.getElementsByTagName(d[u],"w2:column");for(n=0;n<p.length;n++){var c=p[n];if(c.getAttribute("id")==t){c.setAttribute("displayFormat",e);break}}}}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getFooterStyle=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),a=r.D.getDataPrefix("footer_id");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute(a);for(var n=0;n<o.length;n++)if((i=o[n]).getAttribute(a)==t)return WebSquare.style.getStyle(i,e)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.setFooterStyle=function(t,e,i){try{var o,a=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),n=r.D.getDataPrefix("footer_id");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber_footer";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus_footer";else if("number"==typeof t){t=(o=a[t+this.defaultColCnt]).getAttribute(n)}for(var l=0;l<a.length;l++)(o=a[l]).getAttribute(n)==t&&WebSquare.style.setStyle(o,e,i)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getExcelAllFooterXML=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=[];e.push("<array><![CDATA["),e.push('["'),this.footerDataObj||this.initFooterDataObj();for(var i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0].getChildNodes(),n=0;n<o.length;n++){var l=o[n];if(1==l.nodeType)for(var h=l.getChildNodes(),d=0;d<h.length;d++){var u=h[d];if(1==u.nodeType){var p=u.getAttribute("id"),c=this.footerDataObj[p];if("expression"!=c.inputType)i=c.value,i=c.formatter.format(i);else{
var g=r.D.scopingFuncBody(c.expression,this.scope_id);i=Function("_this",g).call(this,this),i=c.formatter.format(i)}e.push(i),e.push('"'+t+'"')}}}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getExcelAllFooterXMLDisplay=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=r.D.getDataPrefix("footer_id"),i=[];i.push("<array><![CDATA["),i.push('["');var o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td");if(this.groupbyStatus.grouped){this.footerDataObj||this.initFooterDataObj();var n=0;if(this.options.rowNumVisible){var l=(f=this.footerDataObj[o[n].getAttribute(e)]).value||"";i.push(l),i.push('"'+t+'"'),n++}if(this.options.rowStatusVisible){l=(f=this.footerDataObj[o[n].getAttribute(e)]).value||"";i.push(l),i.push('"'+t+'"')}}this.footerDataObj||this.initFooterDataObj();l="";for(var h=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0].getChildNodes(),d=0;d<h.length;d++){var u=h[d];if(1==u.nodeType)for(var p=u.getChildNodes(),c=0;c<p.length;c++){var g=p[c];if(1==g.nodeType){var f,m=g.getAttribute("id");if("expression"!=(f=this.footerDataObj[m]).inputType)l=f.value,l=f.formatter.format(l);else{var y=r.D.scopingFuncBody(f.expression,this.scope_id);l=Function("_this",y).call(this,this),l=f.formatter.format(l)}i.push(l),i.push('"'+t+'"')}}}return i[i.length-1]='"]',i.push("]]></array>"),i.join("")}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getExcelAllFooterXMLRaw=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";this.footerDataObj||this.initFooterDataObj();for(var e=[],i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0].getChildNodes(),r=0;r<o.length;r++){var n=o[r];if(1==n.nodeType)for(var l=n.getChildNodes(),h=0;h<l.length;h++){var d=l[h];if(1==d.nodeType){var u=d.getAttribute("id"),p=this.footerDataObj[u];i=p.value,i=p.formatter.format(i),e[e.length]=i}}}return e[0]='<array><![CDATA[["'+e[0],e[e.length-1]+='"]]]></array>',e.join('"'+t+'"')}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.getExpressionValue=function(t){try{return this.hasFooter||(this.footerTempSum=[]),t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( "),this.options.groupbyStatus||(t=(t=t.replace(/[sS][uU][mM][iI][fF][sS][\s]*[(]/g,"_this.footercolsumifs( ")).replace(/[sS][uU][mM][iI][fF][\s]*[(]/g,"_this.footercolsumif( ")),t=(t=(t=(t=(t=t.replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( "),new Function("_this","return "+t)(this)}catch(t){s.w.printStackTrace(t,null,this)}},L.prototype.footercolcustom=function(t,e){try{var i=r.D.getGlobalFunction(t,this.scope_id),o="";return"function"==typeof i&&(o=i(this.getColumnAllDataArray(e),this.getColumnOption(e,"dataType"))),o}catch(e){p.k.printLog("[Warning] "+t+" is not valid function.["+this.id+"]")}},L.prototype.getFooterHeight=function(){try{var t=0;if(this.hasFooter){var e=document.getElementById(this.id+"_foot_table");e&&(t=e.offsetHeight)}return t}catch(t){return s.w.printStackTrace(t,null,this),0}};var T=i(8220),k=function(t){};k.prototype.setStartRowNumber=function(t){this.startRowNumber=t;for(var e=0;e<=this.lastIndex;e++)this._drawRowNumData(e,e+this.rowIndex)},k.prototype.setNoResultMessage=function(t){this.options.noResultMessage=t,this.displayNoResultMessage()},k.prototype.setNoResultMessageVisible=function(t){this.options.noResultMessageVisible=t,this.displayNoResultMessage()},k.prototype.checkAll=function(t,e){var i=!1,o=this.getCellInfo(t),s=o.id;if("checkbox"!=o.options.inputType){if("custom"!=o.options.inputType){
var a=WebSquare.language.getMessage("Grid_warning1")||"선택하신 컬럼은 checkbox가 아닙니다.";return void $l(a)}i=!0}var r=o.options.trueValue,n=o.options.falseValue;this.drawFooterStatus=!1;var l,h=!(!this.isDrillDown||!this._dataList.options.depthColumn),d=h?this.getTotalRow():this.getDataLength(),u=!1,p=!1;if(this._linkedDataList){(p=this._linkedDataList.getBroadcast())&&this._linkedDataList.setBroadcast(!1);for(var c=0;c<d;c++){var g=this._linkedDataList.initialRowIndexArr[c],f=h?g:this._dataList.getFilteredRowIndex(g);if(i){if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;r=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==r)l!=r&&this._dataList.setCellData(f,s,r);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{var m=l==r?n:r;this._dataList.setCellData(f,s,m)}}}else{(u=this._dataList.getBroadcast())&&this._dataList.setBroadcast(!1);for(f=0;f<d;f++){if(i){var y;g=this.dataList.getRealRowIndex(f);if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;r=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==r)l!=r&&this._dataList.setCellData(f,s,r);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{m=l==r?n:r;this._dataList.setCellData(f,s,m)}}}p&&this._linkedDataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]}),u&&this._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]}),this.drawFooterStatus=!0,this.drawFooter(),this.drawHeader()},k.prototype.getColumnType=function(t){return this.getCellInfo(t).options.inputType},k.prototype.getColumnNodeSet=function(t){return this.getCellInfo(t).itemsetObj},k.prototype.getDefaultStyle=function(){return this.options.style},k.prototype.setCellChecked=function(t,e,i){if("boolean"==typeof i){var o=this.getCellInfo(e),s=o.id,a=!1;if(0==o.internal&&"custom"==o.options.inputType){var r=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[r]?o.cellManagerHashByRowIndex[r]:o,a=!0}if("checkbox"==o.options.inputType||"radio"==o.options.inputType){if("radio"==o.options.inputType&&0!=i){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn),l=n?this.getTotalRow():this.getDataLength();if(this._linkedDataList)if(a);else for(var h=0;h<l;h++){r=this._linkedDataList.initialRowIndexArr[h];var d=n?r:this._dataList.getFilteredRowIndex(r);this._dataList.setCellData(d,s,o.options.falseValue)}else if(a);else for(d=0;d<l;d++)this._dataList.setCellData(d,s,o.options.falseValue);this.drawColumnData(e)}i=1==i?o.options.trueValue:o.options.falseValue,this._dataList.setCellData(t,s,i)}else{var u=WebSquare.language.getMessage("Grid_warning3")||"checkbox나 radio가 아닙니다.";alert(u)}}else{var p=WebSquare.language.getMessage("Grid_warning2")||"입력데이터가 옳바르지 않습니다. true/false boolean 타입으로 입력하세요";alert(p)}},k.prototype.getGridHTML=function(){alert("현재 구현중")},k.prototype.redrawColumn=function(t,e){try{var i=void 0===e||e;this.drawColumnData(t,i)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getDrawCount=function(){return this.getVisibleRowNum()},k.prototype.getVisibleRowNum=function(){return this.rowIndex>=0?this.lastIndex+1:0},k.prototype.getTopRowIndex=function(){return this.rowIndex},k.prototype.setTopRowIndex=function(t,e,i){if(!0!==this._isNativeScroll())if(!0!==this._isHybridScroll()){var o=this.getElementById(this.id+"_scrollY_div");if(t<=0&&(t=0),null!==this.lastTopRowIndex)t>this.lastTopRowIndex&&(t=parseInt(this.lastTopRowIndex+.5,10));else if(o.offsetHeight<o.scrollHeight){if(this.rowIndex<t){var s=this._getVisibleLastIndex(this.lastIndex+1);(t=t+s>this.getDataLength()?this.getDataLength()-s:t)>this.rowIndex+s-1&&(this.adjustDraw_keepTop=!0)}}else t=0;if(this.rowIndex!=t){if(this.delayedDraw({rowIndex:t}))return;this.scrollEvent=!1,this.checkScrollEnd=!e,i&&this.setFocusedCell2(0,0,!1),this.drawData(t),
o.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t)}}else this._drawDataHybrid(t);else this.drawData(0)},k.prototype.getBottomRowIndex=function(){return this.rowIndex>=0?this.rowIndex+this.lastIndex:-1},k.prototype.setBottomRowIndex=function(t){this.drawBottomData(t)},k.prototype.getCellPosition=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=this.data_td_list[e+t*this.oneRowDataLength];if(!o){var s=t-this.rowIndex;o=this.data_td_list[e+s*this.oneRowDataLength]}if(o){if("top"==i)return o.offsetTop;if("left"==i)return o.offsetLeft}return null},k.prototype.getCellSize=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=t-this.rowIndex,s=this.data_td_list[e+o*this.oneRowDataLength];return"width"==i?s.clientWidth:"height"==i?s.clientHeight:null},k.prototype.getHeaderPosition=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);if("top"==e){var o=i.offsetTop;return this.options.groupbyZone&&(o+=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),o}return"left"==e?i.offsetLeft:null},k.prototype.getHeaderSize=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);return"width"==e?i.clientWidth:"height"==e?i.clientHeight:null},k.prototype.setSummary=function(t){!0!==r.D.isHTML5()&&this.getElementById(this.id+"_body_table").setAttribute("summary",t)},k.prototype.setFooterSummary=function(t){this.hasFooter&&this.getElementById(this.id+"_foot_table").setAttribute("summary",t)},k.prototype.setCaption=function(t){var e=this.getElementById(this.id+"_body_table").getElementsByTagName("caption")[0];if(e)e.innerHTML=t;else{(e=document.createElement("caption")).innerHTML=t;var i=this.render.getElementsByTagName("colgroup")[0];i.parentNode.insertBefore(e,i)}var o=e.className;e.className=o&&""!=o?o+" setcaption":"setcaption"},k.prototype.setCaptionAuto=function(t){for(var e=this.getHeaderValueList(),i="",o="",s=0;s<e.length;s++)i.length>0&&(o=","),i=i+o+e[s];t&&(this.options.captionTitle=t),this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+i+WebSquare.language.getMessage("Grid_caption")):this.setCaption(i+WebSquare.language.getMessage("Grid_caption"))},k.prototype.setFooterCaption=function(t){if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table"),i=e.getElementsByTagName("caption")[0];if(i)i.innerHTML=t;else{(i=document.createElement("caption")).innerHTML=t;var o=e.getElementsByTagName("colgroup")[0];o.parentNode.insertBefore(i,o)}}},k.prototype.groupby=function(t){try{this.hideCustomFilterList(),this._clearMergeCellBackground(),this.clearSearchData({clearValue:!0});var e="string"==typeof(t=t||{}).sortIndex?t.sortIndex.split(" "):t.sortIndex,i="string"==typeof t.sortOrder?t.sortOrder.split(" "):t.sortOrder,a=e.length;if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<a)return void p.k.printLog("groupby max column count has been exceeded.["+this.id+"]");for(var n=0;n<a;n++){var h=parseInt(e[n],10);e[n]=isNaN(h)?this.getColumnIndex(e[n]):h}if(!t.filter&&!this.groupbyStatus.grouped&&this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var d=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()];if(!d.groupbyOptions&&d.customFilterListFilterInfo){t.filter=JSON.parse(d.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"===(0,l.Z)(i)&&i.constructor===RegExp?i:"object"===(0,l.Z)(i)&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}}));var u=e.length-1,c=!1;for(var g in t.filter){var f=!1;for(n=u;n>=0;n--)if(this.tdIdList[e[n]]===g){f=!0;break}f||(e.push(this.bodyIdColIndexMap[g]),i.push(i[i.length-1]),c=!0)}c&&(t.sortIndexArr=e,t.sortOrderArr=i),this.groupbyFilterList||this.createGroupbyFilterList({noDraw:!0}),
this.groupbyStatus.filter=t.filter,this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],a=e.length}}this.removeFocusedCell(),this._dataList.clearFilter(!0),this.clearHeaderSort(),this.headerSortStatusArr=[],this.groupbyStatus.groupbyOptions=JSON.stringify(t,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e}));var m={};if(t.filter){var y="",b="";for(var g in t.filter){var w,v=t.filter[g];y=',"'+g+'"'+y,b=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+b,"func"===v.type?(v.noRefresh=!0,v.noRefreshAfter=!0,m[this.bodyToHeaderRelation[v.colIndex]]=!0,this.dataList.setColumnFilter(v)):(v.constructor===/a/.constructor?w=v:t.filterRegExp&&t.filterRegExp[g]&&t.filterRegExp[g].constructor===/a/.constructor?w=t.filterRegExp[g]:"object"===(0,l.Z)(v)&&(v=0==v.length?"/^[a-z0-9_-]{3,16}$/":"^"+v.join("$|^")+"$",w=new RegExp(v,"gi")),w&&this.dataList.setColumnFilter({type:"regExp",colIndex:g,key:w,condition:"and",noRefresh:!0,noRefreshAfter:!0}))}if(this.groupbyFilterList){var C='{"column":['+(y=y.slice(1)+"],")+'"filteredRowIndexArr":['+(b=b.slice(1)+"]}");if(this.groupbyFilterList.filterHistory=JSON.parse(C),this.getRowCount()<=0)for(;this.groupbyFilterList.filterHistory.filteredRowIndexArr.length>0&&this.groupbyFilterList.filterHistory.filteredRowIndexArr[0].length<=0;)this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift()}t.noRefreshAfter||this._dataList.broadcast({gridView:["notifyAfterSettedColumnFilter"]})}if(t.sortIndex){var I=o.x.extend({},t);I.noRefresh=!0,I.sortIndex=[];for(n=0;n<e.length;n++)I.sortIndex.push(this.getColumnID(e[n]));if(t.sortFunc)if(I.sortFuncArr=[],"string"==typeof t.sortFunc)(_=r.D.getGlobalFunction(t.sortFunc,this.scope_id))&&I.sortFuncArr.push(_);else if(t.sortFunc.constructor==Array)for(n=0;n<t.sortFunc.length;n++){var _;(_=r.D.getGlobalFunction(t.sortFunc[n],this.scope_id))&&I.sortFuncArr.push(_)}this.dataList.multisort(I)}this.groupbyInfo={},this.statusArr=[];var x=this._linkedDataList?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr,S=[],D=[],R=0,L=[],T=[];for(var k in this.groupbyStatus.groupedRowIndexArr=[],this.groupbyStatus.groupbyRowIndexArr=x.slice(),this.groupbyStatus.groupbyDepthDelimiter="||",this.customFilterStatusObj={},m)this.customFilterStatusObj[k]=!0;this.groupbyStatus.grouped=!0,this.groupbyStatus.filter=t.filter||{},this.groupbyStatus.sortIndexArr=e,this.groupbyStatus.sortOrderArr=i,this.groupbyStatus.headerValueObj={},this.groupbyStatus.footerValueObj={},t.keepDisplayOptions||(this.groupbyDisplayOptions={},this.groupbyDisplayOptions.rowNumHeader=t.rowNumHeader||{},this.groupbyDisplayOptions.rowStatusHeader=t.rowStatusHeader||{},this.groupbyDisplayOptions.groupbyHeader=t.groupbyHeader||[],this.groupbyDisplayOptions.rowNumFooter=t.rowNumFooter||{},this.groupbyDisplayOptions.rowStatusFooter=t.rowStatusFooter||{},this.groupbyDisplayOptions.groupbyFooter=t.groupbyFooter||[],this.groupbyDisplayOptions.closeGroup=t.closeGroup||!1,this.groupbyDisplayOptions.showDisplayData=t.showDisplayData||!1,this.groupbyDisplayOptions.showOnlyLastDepth=t.showOnlyLastDepth||!1,this.groupbyDisplayOptions.hideHeader=t.hideHeader||!1,this.groupbyDisplayOptions.hideFooter=t.hideFooter||!1);for(n=0;n<x.length;n++){L=T,T=[];for(var F=x[n],A=F*this._dataList.cellIdList.length,E=0;E<a;E++){var M=this.tdIdList[e[E]],O=this.cellInfoHash[M];O&&"expression"==O.options.inputType?T[E]=O.getExpressionValue(F):T[E]=this._dataList.dataArr[A+this._dataList.bodyIdColIndexMap[M]]||""}if(n>0){var N=!1,B=[];for(E=0;E<a;E++)if(N||L[E]!==T[E]){var H=L.slice(0,E+1).join(this.groupbyStatus.groupbyDepthDelimiter);N=!0;var G={type:"footer",groupId:H,depth:E,status:"open",index:""};this.groupbyInfo[H]=this.groupbyInfo[H]?this.groupbyInfo[H]:{},this.groupbyInfo[H].footer=G,B.push(G)}for(E=B.length-1;E>=0;E--)B[E].index=S.length,this.groupbyDisplayOptions.hideFooter||(S.push(B[E]),
D.push("footer"))}var W=!1;for(E=0;E<a;E++)if(W||0==n||L[E]!==T[E]){H=T.slice(0,E+1).join(this.groupbyStatus.groupbyDepthDelimiter);W=!0;G={type:"header",groupId:H,depth:E,status:"open",index:S.length};this.groupbyInfo[H]={header:G},this.groupbyDisplayOptions.hideHeader||(S.push(G),D.push("header"))}S.push(x[n]),D.push(R++)}if(D.length>0)for(n=a-1;n>=0;n--){G={type:"footer",groupId:H=T.slice(0,n+1).join(this.groupbyStatus.groupbyDepthDelimiter),depth:n,status:"open",index:S.length};this.groupbyInfo[H]=this.groupbyInfo[H]?this.groupbyInfo[H]:{},this.groupbyInfo[H].footer=G,this.groupbyDisplayOptions.hideFooter||(S.push(G),D.push("footer"))}if(this.groupbyStatus.groupedRowIndexArr=S,this.rowNumArr=D,this.options.foldAll)for(var H in this.groupbyInfo){"open"==(q=this.groupbyInfo[H].header).status&&0==q.depth&&this._foldRow(q)}else if(this.groupbyDisplayOptions.closeGroup&&D.length>0)for(var V in this.groupbyInfo){var q;a==(q=this.groupbyInfo[V].header).groupId.split(this.groupbyStatus.groupbyDepthDelimiter).length&&"number"!=typeof q&&this.groupbyStatus.groupedRowIndexArr[q.index]==q&&this._foldRow(q)}this.lastTopRowIndex=null,this.rowIndex=0,this.setScrollYHeight(),t.sortIndex?(this._dataList.broadcast({gridView:["notifyMultisort"]}),this._dataList.broadcast({gridView:["notifySettedFilter",[{isSort:!0,keepTop:t.keepTop}]],generalComp:"both"})):this.notifyDataChanged(),this.options.groupbyZoneMessage&&this.hideGroupbyZoneMessage(),this.options.groupbyZone&&this.syncWithGroupbyZone();var j=e.length;if(this.groupbyStatus.beforeSortIndexLength=j,r.D.isIE("8")&&this.drawData(0,null,"async"),this.groupbyStatus.grouped&&!this.options.groupbyFilterIcon){var P=r.D.getDataPrefix("useFilter"),z=(r.D.getDataPrefix("header_id"),this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")));for(n=0;n<z.length;n++){var X=z[n],U=X.getAttribute("id");if(U&&!U.match("RowNumber")&&!U.match("RowStatus")&&"true"==X.getAttribute(P)){var Z=this.getElementById(U+"_filter");Z&&(Z.style.display="none")}}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.clearGroupby=function(){try{this.clearGrouping=!0,this.groupbyStatus={},this.groupbyZoneStatus.beforeOpenedColIndex=null,this.groupbyZoneStatus.beforeOpenedColTagName=null,this.groupbyZoneStatus.clickedHeaderInfo=null,this.groupbyDisplayOptions=null,this.rowIndex=0,this.dataList.clearFilter(),this.clearHeaderSort(),this.clearGroupbyZone(),r.D.isIE("8"),this.options.groupbyZoneMessage&&this.showGroupbyZoneMessage(),this.groupbyFilterList&&this.hideGroupbyFilterList();var t=this.getDataLength();if(t<this.rowIndex+this.drawedRowLength)for(var e=t-this.rowIndex;e<this.drawedRowLength;e++)this.clearGroupedRow(e,e+this.rowIndex);this.clearGrouping=!1;var i=r.D.getDataPrefix("useFilter"),o=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(e=0;e<o.length;e++){var a=o[e],n=a.getAttribute("id");if(n&&!n.match("RowNumber")&&!n.match("RowStatus")&&"true"==a.getAttribute(i)){var l=document.getElementById(n+"_filter");l&&(l.style.display="")}}if(this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var h=this.groupbyFilterBox_select.getSelectedIndex();this.groupbyFilterBox_history[h].groupbyOptions&&(this.notifyBeforeSettedColumnFilter(),this.refreshCustomFilterHistory(h),this.notifyAfterSettedColumnFilter())}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.toggleGroup=function(t){if(this.groupbyInfo[t]){var e=this.groupbyInfo[t].header;"number"!=typeof e&&this.dataList.getRealRowIndex(e.index)==e&&("open"==e.status?this._foldRow(e):this._unfoldRow(e),this.lastTopRowIndex=null,this.setScrollYHeight(),"open"==e.status?this.notifyRowInserted(e.index):this.notifyRowChanged(e.index),this.removeFocusedCell(),this.drawFooter())}},k.prototype._foldRow=function(t){if("open"==t.status){if(t.status="closed",this.groupbyDisplayOptions.hideFooter){
for(var e,i=t.index+1;i<this.rowNumArr.length&&!("header"==this.rowNumArr[i]&&this.groupbyStatus.groupedRowIndexArr[i].depth<=t.depth);i++)e=i;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,e-t.index)}else{var o=this.groupbyInfo[t.groupId].footer;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,o.index-t.index-1)}var s=[],a=t.closedChildArr.slice(0).sort();for(i=0;i<this.groupbyStatus.groupbyRowIndexArr.length;i++){for(var r=!1,n=0,l=a.length-1,h=0,d=this.groupbyStatus.groupbyRowIndexArr[i];n<=l;){if(d==a[h=Math.floor((n+l)/2)]){r=!0;break}d<a[h]?l=h-1:n=h+1}r||s.push(this.groupbyStatus.groupbyRowIndexArr[i])}this.groupbyStatus.groupbyRowIndexArr=s;var u=this.groupbyStatus.groupedRowIndexArr.length,p=0;this.rowNumArr=[];for(i=0;i<u;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?this.rowNumArr.push(p++):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},k.prototype._unfoldRow=function(t){if("closed"==t.status){t.status="open",t.closedChildArr.unshift(t.index+1,0),[].splice.apply(this.groupbyStatus.groupedRowIndexArr,t.closedChildArr),t.closedChildArr=[];var e=0;this.rowNumArr=[],this.groupbyStatus.groupbyRowIndexArr=[];for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?(this.rowNumArr.push(e++),this.groupbyStatus.groupbyRowIndexArr.push(this.groupbyStatus.groupedRowIndexArr[i])):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},k.prototype.foldAll=function(){for(var t in this.groupbyInfo){var e=this.groupbyInfo[t].header;"open"==e.status&&0==e.depth&&this._foldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},k.prototype.unfoldAll=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++){var e=this.groupbyStatus.groupedRowIndexArr[t];"number"!=typeof e&&"header"==e.type&&"closed"==e.status&&this._unfoldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},k.prototype.drawGroupData=function(t,e,i){var o,s,a,r=t,n=i*this.realRowDataLength,h=this.realRowDataLength;if("header"==e.type)o=this.groupbyDisplayOptions.rowNumHeader,s=this.groupbyDisplayOptions.rowStatusHeader,a=this.groupbyDisplayOptions.groupbyHeader;else{if("footer"!=e.type)return void(t.innerHTML="");o=this.groupbyDisplayOptions.rowNumFooter,s=this.groupbyDisplayOptions.rowStatusFooter,a=this.groupbyDisplayOptions.groupbyFooter}this.options.rowNumVisible&&(this._drawGroupData(r,e,o),o.hidden||(h-=o.colSpan||1),n++,r=this.all_data_td_list[n]),this.options.rowStatusVisible&&(this._drawGroupData(r,e,s),s.hidden||(h-=s.colSpan||1),n++,r=this.all_data_td_list[n]);for(var d={},u=0;u<h;u++)if(!d["domIndex_"+n]){n++;var p={};if(a instanceof Array?p=a[u]||{}:a instanceof Object&&"object"==(0,l.Z)(a)&&(p=a["depth_"+e.depth][u]||{}),Number(p.targetIndex)>-1){var c=i*this.realRowDataLength+p.targetIndex;d["domIndex_"+c]=!0,this._drawGroupData(this.all_data_td_list[c],e,p)}else this._drawGroupData(r,e,p);r=this.all_data_td_list[n]}},k.prototype._drawGroupData=function(t,e,i){try{var o=i.className||"",a="gridBodyDefault w2grid_groupby w2grid_groupby_depth_"+e.depth+" "+o;t.className=a,t.innerHTML="";var n,l=i.colSpan,h=i.value||"",d=i.inputType||"",u=i.depthVisible||!1,p=i.align||"",c=i.expression||"",g=(l=i.colSpan||1,i.hidden?"none":""),f=i.displayFormatType||"text",m=i.displayFormat||"",y=i.displayFormatter||null;if(t.setAttribute("colSpan",l),
t.style.align="",t.style.textAlign="",t.style.display=g,t.style.borderTopWidth="1px",t.style.borderBottomWidth="1px",d){var b=r.D.getDataPrefix("col_id");switch((m||y)&&(n=new WebSquare.format.createFormatter(f,m,y,null,null,null,this.scope_id,this.id)),d){case"toggleButton":var w="<span class='"+("open"==e.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block;"+(p?"float:"+p+";":"")+" margin-left:"+20*e.depth+"px;'></span>";t.innerHTML+=w;break;case"expression":if(c){var v=this.groupbyInfo[e.groupId].header;v.colID=t.getAttribute(b);var C=0;if("open"==v.status){for(var I,_=!0,x=0,S=v.index;S<this.groupbyStatus.groupedRowIndexArr.length;S++){var D=this.groupbyStatus.groupedRowIndexArr[S];if(this.groupbyDisplayOptions.hideFooter&&_){_=!1;for(var R=S+1;R<this.groupbyStatus.groupedRowIndexArr.length;R++){var L=this.groupbyStatus.groupedRowIndexArr[R];if("header"==L.type&&D.depth>=L.depth)break;x=R}}if(this.groupbyDisplayOptions.hideFooter){if(S>=x){I=S;break}}else if("footer"==D.type&&D.depth==v.depth){I=D.index;break}}C=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,v.index,I,c,v)}else C=this.groupExpression(v.closedChildArr,0,v.closedChildArr.length-1,c,v);n&&(C=n.format(C));var T="<span style='display:inline-block;"+(p?"float:"+p+";":"")+"''>"+C+"</span>";t.innerHTML+=T}}}if(u){var k="";"toggleButton"!=d&&(k="margin-left: "+20*e.depth+"px"),t.innerHTML+="<span style='display:inline-block;"+(p?"float:"+p+";":"")+" "+(k||"")+"'>"+e.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - ")+"</span>"}h&&(n&&(h=n.format(h)),t.innerHTML+="<span style='display:inline-block;"+(p?"float:"+p+";":"")+"'>"+h+"</span>")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.groupExpression=function(t,e,i,o,a){try{var r=o;return r=(r=(r=(r=(r=(r=(r=(r=r.replace(/[sS][uU][mM][\s]*[(]/g,"_this.groupbySum(arr, startIndex, endIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.groupbyAvg(arr, startIndex, endIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.groupbyMax(arr, startIndex, endIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.groupbyMin(arr, startIndex, endIndex,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.groupbyCount(arr, startIndex, endIndex,")).replace(/[dD][eE][pP][tT][hH][\s]*[(]/g,"_this.groupbyDepth(header")).replace(/[tT][oO][gG][gG][lL][eE][\s]*[(]/g,"_this.groupbyToggle(header")).replace(/[dD][eE][pP][tT][hH][sS][tT][rR][\s]*[(]/g,"_this.groupbyDepthStr(header"),r=new Function("_this","arr","startIndex","endIndex","expression","header","return "+r)(this,t,e,i,o,a)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.groupbySum=function(t,e,i,o){for(var s=this.getColumnIndex(o),a=0,r=e;r<=i;r++)"number"==typeof t[r]?a+=parseFloat(this.dataList._getCellData(t[r],this.getColumnID(s),3))||0:"header"==t[r].type&&"closed"==t[r].status&&(a+=this.groupbySum(t[r].closedChildArr,0,t[r].closedChildArr.length-1,o));return a},k.prototype.groupbyAvg=function(t,e,i,o){var s=this._groupbyAvg(t,e,i,o);return s.sum/s.number},k.prototype._groupbyAvg=function(t,e,i,o){for(var s=this.getColumnIndex(o),a={sum:0,number:0},r=e;r<=i;r++)if("number"==typeof t[r])a.sum+=parseFloat(this.dataList._getCellData(t[r],this.getColumnID(s),3))||0,a.number++;else if("header"==t[r].type&&"closed"==t[r].status){var n=this._groupbyAvg(t[r].closedChildArr,0,t[r].closedChildArr.length-1,o);a.sum+=n.sum,a.number+=n.number}return a},k.prototype.groupbyMax=function(t,e,i,o){for(var s=this.getColumnIndex(o),a=0,r=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?a=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(s),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(a=this.groupbyMax(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(r=n=a),n&&r<a&&(r=a);return r},k.prototype.groupbyMin=function(t,e,i,o){
for(var s,a=this.getColumnIndex(o),r=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?r=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(a),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(r=this.groupbyMin(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(s=n=r),n&&s>r&&(s=r);return s},k.prototype.groupbyToggle=function(t){return"<span class='"+("open"==t.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block; margin-left:"+20*t.depth+"px;'></span>"},k.prototype.groupbyDepth=function(t){return t.depth},k.prototype.groupbyDepthStr=function(t){try{for(var e=t.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - "),i=!1,o=e.split(" - "),a=0;a<this.groupbyStatus.sortIndexArr.length;a++){if("true"==(g=this.getCellInfo(this.groupbyStatus.sortIndexArr[a])).options.groupbyDepthStrLabel)try{i=!0;var n=o[a];if(g.dataComp){var l=r.D.getComponentById(g.dataComp,g.scope_id);if(l){var h,d;g.itemsetObj&&(h=g.itemsetObj.label||"label",d=g.itemsetObj.value||"value"),g.element&&(h=g.element.getValue("w2:label","ref"),d=g.element.getValue("w2:value","ref"));for(var u=l.getAllJSON(),p=0;p<u.length;p++){var c=u[p];if(n==c[d]){o[a]=!0!==this.groupbyDisplayOptions.showDisplayData?c[h]:g.getDisplayData(c[h]);break}}}}else for(p=0;p<g.itemArr.length;p++)if(n==g.itemArr[p].value){o[a]=!0!==this.groupbyDisplayOptions.showDisplayData?g.itemArr[p].label:g.getDisplayData(g.itemArr[p].label);break}}catch(t){break}}if(i&&(e=o.join(" - ")),1==this.groupbyDisplayOptions.showDisplayData&&!i){for(a=0;a<o.length;a++){var g=this.getCellInfo(this.groupbyStatus.sortIndexArr[a]);o[a]=g.getDisplayData(o[a])}e=o.join(" - ")}if(1==this.groupbyDisplayOptions.showOnlyLastDepth){var f=e.split(" - ");e=f[f.length-1]}return e}catch(t){s.w.printStackTrace(t)}},k.prototype.groupbyCount=function(t,e,i){for(var o=0,s=e;s<=i&&s<t.length;s++)"number"==typeof t[s]?o++:"header"==t[s].type&&"closed"==t[s].status&&(o+=this.groupbyCount(t[s].closedChildArr,0,t[s].closedChildArr.length-1));return o},k.prototype._drawGroupbyZone=function(){try{var t=this.uuid;if(this.options.groupbyZone){this.groupbyZoneStatus.groupbyZoneRender=this.dom[this.id+"_groupbyZone_div"];var e=null!=this.options.groupbyZoneHeight.match("%"),i=parseInt(this.options.groupbyZoneHeight),o=i+"px";this.groupbyZoneStatus.groupbyZoneRender.style.height=o,e&&(this.groupbyZoneStatus.groupbyZoneRender.style.height=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px");var a=this.getElementById(this.id+"_main_div"),n=WebSquare.style.getStyle(this.groupbyZoneStatus.groupbyZoneRender,"border-left-width").replace("px","");if(this.groupbyZoneStatus.groupbyZoneBorder=2*n,this.groupbyZoneStatus.groupbyZoneRender.style.width=a.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder+"px",this.dom[this.id+"_main_div"]&&(this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px"),this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){s.w.printStackTrace(t,null,this)}if(this.dom[this.id+"_scrollY_div"].style.top="0px",this.options.groupbyZoneMessage){var l=document.createElement("div");l.innerHTML+=this.options.groupbyZoneMessage,l.className+=" w2grid_groupbyZone_message ",this.groupbyZoneStatus.groupbyZoneRender.appendChild(l),l.style.marginTop=-l.offsetHeight/2+"px",l.style.marginLeft=-l.offsetWidth/2+"px",this.groupbyZoneStatus.groupbyZoneMessageRender=l}if(this.options.groupbyZoneSearch){var h=document.getElementById(this.id+"_groupbyZone_search");this.groupbyZone_searchinput=new WebSquare.uiplugin.input(this.id+"_groupbyZone_searchinput",{className:"w2grid_groupbyZone_searchinput"}),requires("uiplugin.trigger"),this.groupbyZone_searchbtn=new WebSquare.uiplugin.trigger(this.id+"_groupbyZone_searchbtn",{className:"w2grid_groupbyZone_searchbtn"}),this.addControl(this.groupbyZone_searchinput),this.addControl(this.groupbyZone_searchbtn),
h.innerHTML=this.groupbyZone_searchinput.toHTML()+this.groupbyZone_searchbtn.toHTML(),this.groupbyZone_searchbtn.activate(),this.groupbyZone_searchinput.activate();var d=this.groupbyZone_searchinput.uuid;this.groupbyZone_searchbtn.bind("onclick",(function(){WebSquare.idCache[d].show()}));var p=this.id;this.groupbyZone_searchinput.bind("onkeydown",(function(e){u.B.stopPropagation(e),r.D.setTimeout((function(){var e=WebSquare.idCache[t];e._groupbyZoneSearch(),e.groupbyZone_searchinput.focus()}),{key:p+"_groupbyZone_search",delay:50})})),this.groupbyZone_searchinput.hide()}}if(this.options.groupbyZone&&this.options.groupbyFilterBox){this.groupbyZoneStatus.groupbyFilterBoxRender=this.dom[this.id+"_groupbyFilterBox_div"];var c=this.getElementById(this.id+"_groupbyFilterBox_select");this.groupbyFilterBox_select=new WebSquare.uiplugin.selectbox(this.id+"_groupbyFilterBox_select",{className:"w2grid_groupbyFilterBox_select",labelWidthAuto:!1,readOnly:!0,direction:"top"===this.options.groupbyFilterBoxLocation?"down":"up",visibleRowNum:this.options.filterBoxvisibleRowNum}),this.addControl(this.groupbyFilterBox_select),c.innerHTML=this.groupbyFilterBox_select.toHTML(),this.groupbyFilterBox_select.activate(),this.groupbyFilterBox_select.bind("onclick",(function(t){this.handleClickEvent()})),this.groupbyFilterBox_select.bind("onchange",(function(){WebSquare.idCache[t].applyFilterHistory()}));var g=this.getElementById(this.id+"_groupbyFilterBox_div");"bottom"===this.options.groupbyFilterBoxLocation?this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+g.offsetHeight+"px":"top"===this.options.groupbyFilterBoxLocation&&(this.dom[this.id+"_main_div"].style.top=i+g.offsetHeight+"px",this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+"px",this.groupbyZoneStatus.groupbyZoneRender.style.top=g.offsetHeight+"px");var f=this.getElementById(this.id+"_groupbyFilterBox_main"),m=this.getElementById(this.id+"_groupbyFilterBox_buttons");f.style.paddingLeft=m.offsetWidth+"px";var y=this.getElementById(this.id+"_groupbyFilterBox_apply"),b=this.getElementById(this.id+"_groupbyFilterBox_delete");y.onclick=function(){var e=WebSquare.idCache[t];this.checked?e.applyFilterHistory():e.groupbyStatus.grouped?e.clearGroupby():e._dataList.clearFilter()},b.onclick=function(){WebSquare.idCache[t].clearFilterHistory()},this.handlerResize_drawInitializer()}}catch(t){s.w.printStackTrace(t)}},k.prototype.getCellInputType=function(t,e){try{var i=this.getCellInfo(e);if("custom"==i.options.inputType){var o=this.getRealRowIndex(t);return i.cellManagerHashByRowIndex[o].options.inputType}return i.options.inputType}catch(t){s.w.printStackTrace(t)}},k.prototype.setCellOption=function(t,e,i,o){var s=this.getColumnIndex(e),a=this.getExtraDataObj("cell",t,s);if("viewType"===i)a.key=o,this.rowIndex>=0&&this.drawCellData(t-this.rowIndex,t,s);else{var r=WebSquare.language.getMessage("Grid_warning4",this.id,i)||"["+this.id+"] "+i+"에 대한 변경은 처리할 수 없습니다.";$l(r)}},k.prototype.getCellOption=function(t,e,i){var o=this.getColumnIndex(e),s=this.getCellInfo(e);if("custom"!=s.options.inputType){var a=this.getExtraDataObj("cell",t,o);return null==a.key?s.options[i]:a.key}var r=s.cellManagerHashByRowIndex[t];if(r)return r.options[i]},k.prototype.getCustomCellOptions=function(t,e){try{var i=this.getCellInfo(e),o={};if("custom"==i.options.inputType){var a=this.getRealRowIndex(t),r=i.cellManagerHashByRowIndex[a];for(var n in r.initializeInfo)"id"!=n&&"displayRowIndex"!=n&&"realRowIndex"!=n&&(o[n]=r.initializeInfo[n])}return o}catch(t){s.w.printStackTrace(t)}},k.prototype.ungroupColumn=function(t){try{if(this.groupbyStatus.grouped){var e;"string"==typeof t?e=this.getColumnIndex(t):"number"==typeof t&&(e=t);for(var i=!0,o=this.groupbyStatus.sortIndexArr.length-1;o>=0;o--)if(this.groupbyStatus.sortIndexArr[o]==e){this.groupbyStatus.sortIndexArr.splice(o,1),this.groupbyStatus.sortOrderArr.splice(o,1),delete this.groupbyStatus.filter[this.getColumnID(e)],i=!1;break}if(i)return
;if(this.groupbyFilterList&&this.groupbyFilterList.filterHistory.column.length>0)if(this.groupbyFilterList.filterHistory.column[0]===this.getColumnID(e))this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift();else{var a=this.groupbyFilterList.filterHistory.column.length,r=this.groupbyFilterList.filterHistory.filteredRowIndexArr[a-1].slice(0),n=0;for(o=0;o<a;o++)if(this.groupbyFilterList.filterHistory.column[o]===this.getColumnID(e)){this.groupbyFilterList.filterHistory.column.splice(o,1),this.groupbyFilterList.filterHistory.filteredRowIndexArr.splice(o,1),n=1;break}for(o=0;o<a-n;o++)this.groupbyFilterList.filterHistory.filteredRowIndexArr[o]=r}if(this.clearSearchData({clearValue:!0}),0==this.groupbyStatus.sortIndexArr.length)this.clearGroupby();else{var l=this.groupbyDisplayOptions;l.filter=this.groupbyStatus.filter,l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(l)}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.changeGroupDepth=function(t,e){try{if(this.groupbyStatus.grouped){var i,o,a,r;"string"==typeof t?i=this.getColumnIndex(t):"number"==typeof t&&(i=t),"string"==typeof e?o=this.getColumnIndex(e):"number"==typeof e&&(o=e);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)this.groupbyStatus.sortIndexArr[n]==i&&(r=n),this.groupbyStatus.sortIndexArr[n]==o&&(a=n);if("number"!=typeof r||"number"!=typeof a||r==a)return;this.groupbyStatus.sortIndexArr.splice(r,1),this.groupbyStatus.sortIndexArr.splice(a,0,i);var l=this.groupbyStatus.sortOrderArr.splice(r,1);this.groupbyStatus.sortOrderArr.splice(a,0,l);var h=this.groupbyDisplayOptions;h.filter=this.groupbyStatus.filter,h.sortIndex=this.groupbyStatus.sortIndexArr,h.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(h)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.removeGroupbyFilterList=function(){try{this.groupbyFilterList&&this.groupbyFilterList.remove()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getGroupbyDisplayRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyDisplayRowIndex(t,e):t}catch(e){return s.w.printStackTrace(e,null,this),t}},k.prototype.__getGroupbyDisplayRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;var i=this._dataList.getFilteredRowIndex(this.getRealRowIndex(t));return null==i&&!0!==e&&(i=t),i}catch(e){return s.w.printStackTrace(e,null,this),t}},k.prototype._getGroupbyGroupedRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyGroupedRowIndex(t,e):t}catch(e){return s.w.printStackTrace(e,null,this),t}},k.prototype.__getGroupbyGroupedRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;for(var i,o=this._dataList.getRealRowIndex(t),a=0;a<this.groupbyStatus.groupedRowIndexArr.length;a++)if(o===this.groupbyStatus.groupedRowIndexArr[a]){i=a;break}return null==i&&!0!==e&&(i=t),i}catch(e){return s.w.printStackTrace(e,null,this),t}},k.prototype.isEditing=function(){try{return!!this.editedCell}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.readExcelFile=function(t,e,i,o,s,a,r,n){this.readFile(t,e,i,o,s,"excel",null,a,r,n)},k.prototype.readFile=function(t,e,i,o,s,a,r,n,l,h){o=void 0===o||"string"!=typeof o?this.options.excelUploadPopupURL:this.getURL(o),void 0!==s&&"string"==typeof s||(s="top=280,height=80,left=160,width=400,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no"),o+=1==(t=parseInt(t,10))?"?header=true":"?header=false",o+=1==(e=parseInt(e,10))?"&append=true":"&append=false",o+=1==n?"&fillHidden=true":"&fillHidden=false",o+=1==(i=parseInt(i,10))?"&hidden=true":"&hidden=false",o+=1==(h=h||0)?"&type=true":"&type=false",r&&(o+="&"+r),o+="&action="+this.options.excelUploadURL,o+="&gridID="+this.id
;for(var d=[],u=this.defaultColCnt;u<this.hiddenList.length;u++)1==this.hiddenList[u]&&d.push(u-this.defaultColCnt);o+="&columnNum="+this.getTotalCol(),o+="&expressionColumns="+this.getExpressionColumnArr().join(","),o+="&hiddenColumns="+d.join(","),o+="&headerRows="+this.getElementById(this.id+"_head_table").rows.length,o+=l?"&gridStartRow="+l:"&gridStartRow=1",WebSquare.domain&&(o+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain)),window.open(o,"fileupWindow",s)},k.prototype.getExpressionColumnArr=function(t){var e,i=[];e=t&&"1"==t.ignoreSpan?this.getColCnt():this.getTotalCol();for(var o=0;o<e;o++)"expression"==this.getCellInfo(o).options.inputType?i.push("true"):i.push("false");return i},k.prototype.saveExcelFile=function(t,e,i,o,s,a,r,n){var l={};l.fileName=t,l.hidden=e,l.checkButton=i,l.type=o,l.hiddenExpand=s,l.saveList=a,l.useEuroLocale=r,l.httpReadOnly=n,this.saveExcel(l)},k.prototype.saveExcel=function(t){var e=t.processMsg;e&&e.length>0?WebSquare.layer.showProcessMessage(e,{scope:this.scope_id||""}):WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""});for(var i=t.fileName||"default",o=t.hidden||0,s=t.checkButton||0,r=t.type+""||"0",n=t.hiddenExpand||0,l=t.saveList||[],h=t.useEuroLocale||"false",d=t.password||"",u=new T.h.Hashtable,p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],c=WebSquare.Elem.api.getElementsByTagName(p,"w2:column"),g=0;g<c.length;g++){var f=c[g],m=f.getAttribute("id");f.setAttribute("value",this.getHeaderValue(m))}if(u.put("style",WebSquare.xml.serialize(this.element._element)),"0"==r||""==r)u.put("data",this.getExcelAllXML()),u.put("footer_data",this.getExcelAllFooterXML());else if("2"==r){var y=this.getExcelAllXMLRaw();u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLRaw())}else{y=this.getExcelAllXMLDisplay(r);u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLDisplay())}var b=[];for(g=0;g<this.getTotalCol();g++){var w=this.getCellInfo(g).options.inputType;"checkbox"!=w&&"radio"!=w&&"button"!=w||b.push('"'+g+'"')}u.put("hiddenArr",this.getHiddenColumnArr()),u.put("fileName",i),u.put("hidden",o),u.put("checkButton",s),u.put("type",r),u.put("rowNumVisible",this.options.rowNumVisible+"");var v=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var C=this.getLocaleValue(this.options.rowNumLocaleRef);C&&(v=C)}u.put("rowNumHeaderValue",v),u.put("hiddenExpand",n),u.put("checkButtonArr","<array><![CDATA[["+b.join(",")+"]]]></array>"),u.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),u.put("useEuroLocale",h),u.put("password",d),t.scopeId=this.scope_id||"",a.v.excelDownload(this.options.excelDownloadURL,u.toString(),"post",t)},k.prototype.saveExcelFile2=function(t,e,i,o,s,a){var r={};if(r.fileName=t,r.type=o,e+""=="0"){for(var n=[],l=this.defaultColCnt;l<this.hiddenList.length;l++)this.hiddenList[l]&&n.push(l-this.defaultColCnt);r.removeColumns=n.join(",")}var h=[];if(i+""=="0")for(l=0;l<this.getTotalCol();l++){var d=this.getCellInfo(l).options.inputType;"checkbox"!=d&&"radio"!=d&&"button"!=d||h.push(this.getCellInfo(l).options.colIndex-this.defaultColCnt)}for(l=this.defaultColCnt;l<this.hiddenList.length;l++)e+""=="1"&&s+""=="0"&&1==this.hiddenList[l]&&h.push(l-this.defaultColCnt);r.foldColumns=h.join(","),this.advancedExcelDownload(r)},k.prototype.getHiddenColumnArr=function(){for(var t=[],e=this.defaultColCnt;e<this.hiddenList.length;e++)t.push(this.hiddenList[e]);return'<array><![CDATA[["'+t.join('","')+'"]]]></array>'},k.prototype.fireFileReadEnd=function(t){var e=this;setTimeout((function(){u.B.fireEvent(e,"onfilereadend",t)}),10)},k.prototype.readCSV=function(t){var e={};t=t||{};e.wframe=t.wframe||!1
;var i=t.type||"1",s=t.delim||",",n=t.escapeChar||"",h=t.header||"1",d=t.footer||"1",u=t.startRowIndex||"0",p=t.startColumnIndex||"0",c=t.append||"0",g=t.hidden||"0",f=t.advancedHidden||"0",m=t.fillHidden||"0",y=t.skipSpace||"0",b=t.removeColumns||"",w=t.optionParam||"",v=document.location.protocol+"//"+document.location.host+"/",C=t.popupUrl?v+t.popupUrl:o.x.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.js"),I=t.popupUrl||this.options.csvUploadPopupURL;I+="?";var _,x=t.processMsg||"",S="";if(e.name=t.name||"FILE UPLOAD",this.options.dataList){var D=this.modelControl.getDataComp(this.options.dataList);null!=D&&(S=D.id)}var R=t.status||"R",L=t.expression||"1",T=t.ignoreSpan||"0",k=t.maxFileSize||-1,F=t.csvUploadURL||t.action||"",A=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",E=t.columnOrder||"",M=t.useModalDisable||"false",O=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false",N=t.filePath||"",B=t.trim||"0";if(t.useDialog=t.useDialog+""!="false",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,void 0===t.features||"string"!=typeof t.features)_="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else if(1==t.wframe){for(var H=t.features.split(","),G={},W=0;W<H.length;W++)0!=H[W].toLowerCase().indexOf("top")?0!=H[W].toLowerCase().indexOf("left")?0!=H[W].toLowerCase().indexOf("height")?0!=H[W].toLowerCase().indexOf("width")||(G.width=parseInt(H[W].split("=")[1])):G.height=parseInt(H[W].split("=")[1]):G.left=parseInt(H[W].split("=")[1]):G.top=parseInt(H[W].split("=")[1]);_=G}else _=t.features;e.sFeatures=_,h=parseInt(h,10),c=parseInt(c,10),g=parseInt(g,10),i=i||0,e.type=1==i?"true":"false",e.uploadType=i,e.delim=s,e.escapeChar=n,e.header=1==h?"true":"false",e.footer=1==d?"true":"false",e.append=1==c?"true":"false",e.hidden=1==g?"true":"false",1==f?(I+="&advancedHidden=true",e.advancedHidden="true"):(I+="&advancedHidden=false",e.advancedHidden="false"),e.fillHidden=1==m?"true":"false",e.skipSpace=1==y?"true":"false",e.removeColumns=b,e.optionParam=w,I+="&gridID="+this.id,e.gridID=this.id;var V=[];for(W=this.defaultColCnt;W<this.hiddenList.length;W++)1==this.hiddenList[W]&&V.push(W-this.defaultColCnt);var q=this.getExpressionColumnArr(t);e.expressionColumns=q.join(","),e.columnNum=q.length,e.hiddenColumns=V.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=u||"1",e.gridStartCol=p||"1",WebSquare.domain?(I+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain),e.domain=WebSquare.text.URLEncoder(WebSquare.domain)):e.domain="";var j,P=t.msaName||this._getMsaName()||"";if(""!=P){var z="";""!=F&&(z=F),F=a.v.getServletURL(this,P,"csvToXML.wq",z),A=!0}if(""==F&&(F=this.options.csvUploadURL),e.msaName=P,e.action=F,e.processMsg=WebSquare.text.BASE64URLEncoder(x),e.dataList=S,1==T){var X=[],U={},Z=0;for(W=0;W<this.cellIdList.length;W++){for(var K=this.cellInfoHash[this.cellIdList[W]],Y=parseInt(K.options.rowSpan)||1,$=parseInt(K.options.colSpan)||1,J=Z,Q=0;Q<this.getRowCount()*this.getColCnt()&&X[J+Q];Q++)Z++;for(var tt=0;tt<$;tt++){var et=Z;X[et]=K.id,U[et]=!0;for(Q=1;Q<Y;Q++){var it=Z+Q*this.getColCnt();X[it]=K.id,U[it]=!0}Z+=1}}j=X.join(",")}else j=this.cellIdList.join(",");e.columnIds=j,e.expression=1==L?"false":"true",e.status=R,e.maxFileSize=k,e.postMsg=A,e.columnOrder=E,e.useModalDisable=M,e.useXHR=O,e.filePath=N,e.useDialog=t.useDialog,e.trim=1==B?"true":"false";var ot=r.D.getBoolean(e.wframe);if(this._csvUploadInfo=JSON.stringify(e),0==t.useDialog){var st=new FormData;st.append("type",e.type),st.append("uploadType",e.uploadType),st.append("delim",e.delim),st.append("escapeChar",e.escapeChar),st.append("header",e.header),st.append("footer",e.footer),st.append("append",e.append),st.append("hidden",e.hidden),st.append("fillHidden",e.fillHidden),st.append("advancedHidden",e.advancedHidden),
st.append("skipSpace",e.skipSpace),st.append("removeColumns",e.removeColumns),st.append("action",e.action),st.append("gridID",e.gridID),st.append("columnNum",e.columnNum),st.append("expressionColumns",e.expressionColumns),st.append("hiddenColumns",e.hiddenColumns),st.append("headerRows",e.headerRows);var at=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),rt=WebSquare.Elem.api.getElementsByTagName(at[0],"w2:row");st.append("bodyRows",rt.length),st.append("headerRows",e.headerRows),st.append("gridStartRow",e.gridStartRow);var nt="";nt="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),st.append("gridStyle",nt),st.append("columnIds",e.columnIds),st.append("dataList",e.dataList),st.append("expression",e.expression),st.append("status",e.status),st.append("optionParam",e.optionParam),st.append("columnOrder",e.columnOrder),st.append("useXHR",e.useXHR),st.append("filePath",e.filePath),st.append("useDialog",e.useDialog),x&&x.length>0?WebSquare.layer.showProcessMessage(x,t):WebSquare.layer.showProcessMessage("upload...",t);var lt=this,ht=new XMLHttpRequest;ht.onreadystatechange=function(){if(4==ht.readyState)if(200==ht.status)try{var i=ht.responseText,o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var a,n=o.getElementsByTagName("deniedCodeList")[0],l="";if("102"==(l=void 0===n||null==l||void 0===(l=n.firstChild)||null==l||""==l?"":l.nodeValue))h=Upload_msg2;else{var h=o.getElementsByTagName("message")[0].firstChild;h=WebSquare.language.getMessage("Upload_msg3")}(a=t.onFailureCallback||null)&&a(e.action,h)}else{var d=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=r.D.getBoolean(e.append));var u="",p={columnInfo:e.columnIds.split(","),data:d};if(""!=e.dataList){u=e.dataList;var c=r.D.getComponentById(u),g=c.getRowCount();if(1==e.uploadType||2==e.uploadType?c.setArrayFile(p,e.append,e.gridID,e.uploadType):c.setArray(p,e.append),"C"==e.status){var f=c.getRowCount();e.append?c.modifyRangeStatus(g,f,"C"):c.modifyRangeStatus(0,f,"C")}}else{u=e.gridID;g=this.getRowCount();if(1==e.uploadType||2==e.uploadType?this.setDataFile(d,e.append,p.columnInfo,e.gridID,e.uploadType):this.setData(d,e.append),"C"==e.status){f=this.getRowCount();e.append?this.modifyRangeStatus(g,f,"C"):this.modifyRangeStatus(0,f,"C")}}var m=t.onSuccessCallback||null;m&&m(e.action);var y=N.split("\\");lt.fireFileReadEnd(y[y.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}else(a=t.onFailureCallback||null)&&a(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})},ht.open("POST",e.action,!0),ht.send(st)}else if(!0===ot){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),r.D.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):r.D.isIE(7)||r.D.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):r.D.isIE(9)||r.D.isIE(10)?(e.sizeInfo.height=204,e.sizeInfo.width=446):r.D.isIEAllVersion(11)?(e.sizeInfo.height=197,e.sizeInfo.width=455):r.D.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):r.D.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=198,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=200,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):r.D.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):r.D.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,
e.sizeInfo.width=454):r.D.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==(0,l.Z)(e.sFeatures)&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var dt={type:"json",name:"csvPopupParam",data:e},ut={id:this.id+"_csvPop",type:"wframePopup",dataObject:dt,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:C,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]&&(ut.scope_uuid=this.scope_obj.uuid),r.D.openPopup(ut.popupUrl,ut)}else I=WebSquare.BootLoader.getEngineUri(I),window.open(I,"csvupWindow",e.sFeatures)},k.prototype.saveCSV=function(t){var e=t.maxCellCount||-1;if(-1!=(e=parseInt(e,10))&&e<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var i=WebSquare.language.getMessage("Grid_warning8",e)||"Cell 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+e;return void alert(i)}var o=t.maxRowCount||-1;if(-1!=(o=parseInt(o,10))&&o<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){i=WebSquare.language.getMessage("Grid_warning10",o)||"Row 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+o;return void alert(i)}WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var s=(t=t||{}).fileName||"csvfile.csv",n=t.type||"1",l=t.delim||";",h=t.displayDelim||"true",d=t.removeColumns||"",u=t.header||"1",p=t.hidden||"0",c=t.checkButton||"1",g=t.removeQuotation||"1",f=t.removeNewLine||"1",m=t.saveList||"",y=this.options.rowNumHeaderValue||"";this.options.useLocale&&this.options.rowNumLocaleRef&&((q=this.getLocaleValue(this.options.rowNumLocaleRef))&&(y=q));var b="";"1"!=t.rowNumVisible&&"true"!=t.rowNumVisible&&1!=t.rowNumVisible||(b=this.options.rowNumVisible||"false");var w=t.textTable||"false",v=t.textTableAlign||"right",C=t.useFooter||"false",I=t.columnMove+""=="true",_=t.columnOrder||"",x=t.optionParam||"",S=t.aposPrefixOnNum||"0",D=t.aposPrefixOnText||"0",R=t.ignoreSpan||"0",L=t.maxDataSize||-1;L=parseInt(L,10);var k=t.csvDownloadURL||t.action||"",F=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=F+""=="true";for(var A=t.openFile||"false",E=t.sameSite||"",M=t.useHeaderCheckBoxLabel+""=="true",O=t.opencsv+""=="true",N=t.msaName||"",B=t.trim||"0",H=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],G=WebSquare.Elem.api.getElementsByTagName(H,"w2:column"),W=0;W<G.length;W++){var V=G[W];if("checkbox"===V.getAttribute("inputType")&&!0===M){var q,j=V.getAttribute("checkboxLabel")||V.getAttribute("value"),P=V.getAttribute("localeRef");if(this.options.useLocale&&P)(q=this.getLocaleValue(P))&&(j=q);V.setAttribute("value",j+"")}else{var z=V.getAttribute("id");V.setAttribute("value",this.getHeaderValue(z)+"")}}var X=new T.h.Hashtable,U="",Z=(U="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element)).indexOf("<w2:gridView");if(U.indexOf("xmlns:w2")<0&&Z>=0){var K=" xmlns:w2='"+WebSquare.core._XML_NAMESPACE.W2+"' ";Z+=12,U=U.slice(0,Z)+K+U.slice(Z)}X.put("style",U),"0"==n?(X.put("data",this.getExcelAllXML()),
"true"==C?X.put("footer_data",this.getExcelAllFooterXML()):X.put("footer_data","<array><![CDATA[[]]]></array>")):(X.put("data",this.getExcelAllXMLDisplay(n)),"true"==C?X.put("footer_data",this.getExcelAllFooterXMLDisplay()):X.put("footer_data","<array><![CDATA[[]]]></array>"));var Y,$=[];for(W=0;W<this.getTotalCol();W++){var J=this.getCellInfo(W).options.inputType;"checkbox"!=J&&"radio"!=J&&"button"!=J||$.push('"'+W+'"')}I&&(Y=""==_?this.getColumnOrder()||"":_.split(","));var Q=[];if(""!=d){var tt=(d+="").split(",");if(I)for(W=0;W<tt.length;W++)for(var et=0;et<Y.length;et++)tt[W]==Y[et]&&Q.push(et);else Q=tt;Q.sort((function(t,e){return 1*t-1*e})),d=Q.join(",")}var it=d;it='"'+it.wq_replaceAll(",",'","')+'"',X.put("hiddenArr",this.getHiddenColumnArr()),X.put("fileName",s),X.put("hidden",p),X.put("checkButton",c),X.put("type",n),X.put("rowNumVisible",b),X.put("rowNumHeaderValue",y),X.put("removeQuotation",g),X.put("delim",l),X.put("displayDelim",h),X.put("header",u),X.put("textTable",w),X.put("textTableAlign",v),X.put("useFooter",C),X.put("columnMove",I),X.put("columnOrder",Y),X.put("optionParam",x),X.put("aposPrefixOnNum",S),X.put("aposPrefixOnText",D),X.put("ignoreSpan",R),X.put("removeNewLine",f),X.put("checkButtonArr","<array><![CDATA[["+$.join(",")+"]]]></array>"),""!=m&&X.put("saveList",'<array><![CDATA[["'+m.join('","')+'"]]]></array>'),X.put("removeColumns","<array><![CDATA[["+it+"]]]></array>"),X.put("openFile",A),""!=E&&X.put("sameSite",E),X.put("opencsv",O),X.put("useXHR",F),X.put("msaName",N),X.put("trim",B);var ot=X.toString();if(-1!=L&&L<r.D.getByteLengthUtf8(ot)){i=WebSquare.language.getMessage("Grid_warning9",L)||"전송 data가 제한 크기를 초과 하였습니다.\n 제한 크기 : "+e+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(i)}if(""!=(N=N||this._getMsaName()||"")){var st="";""!=k&&(st=k),k=a.v.getServletURL(this,N,"xmlToCSV.wq",st),t.useXHR=!0}""==k&&(k=this.options.csvDownloadURL),t.scopeId=this.scope_id||"",a.v.excelDownload(k,ot,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0))},k.prototype.saveCSVFile=function(t,e,i,o,s,r,n,l,h){WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),n+="";var d=new T.h.Hashtable,u="";u="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),d.put("style",u),"0"==n||""==n?(d.put("data",this.getExcelAllXML()),d.put("footer_data",this.getExcelAllFooterXML())):(d.put("data",this.getExcelAllXMLDisplay(n)),d.put("footer_data",this.getExcelAllFooterXMLDisplay()));for(var p=[],c=0;c<this.getTotalCol();c++){var g=this.getCellInfo(c).options.inputType;"checkbox"!=g&&"radio"!=g&&"button"!=g||p.push('"'+c+'"')}var f=h||"";f='"'+f.wq_replaceAll(",",'","')+'"',d.put("hiddenArr",this.getHiddenColumnArr()),d.put("fileName",t),d.put("hidden",o),d.put("checkButton","1"),d.put("type",n),d.put("rowNumVisible",this.options.rowNumVisible);var m=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var y=this.getLocaleValue(this.options.rowNumLocaleRef);y&&(m=y)}d.put("rowNumHeaderValue",m),d.put("removeQuotation",r),d.put("delim",e),d.put("header",i),d.put("checkButtonArr","<array><![CDATA[["+p.join(",")+"]]]></array>"),void 0!==l&&l&&d.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),d.put("removeColumns","<array><![CDATA[["+f+"]]]></array>"),a.v.excelDownload(this.options.csvDownloadURL,d.toString(),"post",{scopeId:this.scope_id||""})},k.prototype.getExcelUploadInfo=function(t){
var e={},i=(t=t||{}).type||"0",o=t.removeColumns||"",s=t.startRowIndex||"0",r=t.startColumnIndex||"0",n=t.endColumnIndex||"-1",l=t.ignoreStartRowIndexInSAX+""||"1",h=t.ignoreStartColumnIndexInSAX+""||"1",d=t.sheetNo||"0",u=t.sheetName||"",p=t.activeSheet||!1,c=t.headerExist||"0";0===t.footerExist&&(t.footerExist="0");var g=t.footerExist||"1",f=t.append||"0",m=t.hidden||"0",y=t.fillHidden||"0",b=t.optionParam||"",w=t.skipSpace||"0",v=t.insertColumns||[],C=t.processMsg||"",I="";if(this.options.dataList){var _=this.modelControl.getDataComp(this.options.dataList);null!=_&&(I=_.id)}var x=t.status||"R",S=t.delim||",",D="",R="",L="",T=t.pwd||"",k=t.loadingMode||"",F=t.maxFileSize||"-1",A=t.cellDataConvertor||"",E=t.decimal||"4",M=t.applyDecimal||"0",O=t.useModalDisable||"false",N=t.useMaxByteLength||"false",B=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",H=t.dateFormat||"yyyy-MM-dd",G=t.byteCheckEncoding||"EUC-KR",W=t.columnOrder||"",V=t.columnMove+""=="true",q=t.chunkNum||0,j=t.trim||0,P=t.useXHR+""=="true",z=t.filePath||"";t.useDialog=t.useDialog+""!="false";for(var X=t.countSkipRow||"",U=0;U<v.length;U++){var Z=v[U],K=Z.columnIndex+""||"",Y=Z.columnValue+""||"";""!=K&&(D=D+R+K+","+Y,R="|")}if(void 0===t.features||"string"!=typeof t.features)L="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else{var $=t.features.split(","),J={};for(U=0;U<$.length;U++)0!=$[U].toLowerCase().indexOf("top")?0!=$[U].toLowerCase().indexOf("left")?0!=$[U].toLowerCase().indexOf("height")?0!=$[U].toLowerCase().indexOf("width")||(J.width=parseInt($[U].split("=")[1])):J.height=parseInt($[U].split("=")[1]):J.left=parseInt($[U].split("=")[1]):J.top=parseInt($[U].split("=")[1]);1==t.wframe?L=J:(L=t.features,e.userFeatures=J)}e.sFeatures=L,c=parseInt(c,10),f=parseInt(f,10),m=parseInt(m,10),g=parseInt(g,10),e.header=1==c?"true":"false",e.footer=1==g?"true":"false",e.append=1==f?"true":"false",e.removeColumns=o,e.fillHidden=1==y?"true":"false",e.hidden=1==m?"true":"false",e.type=1==i?"true":"false",e.uploadType=i,e.skipSpace=1==w?"true":"false",e.insertColumns=D,e.optionParam=b;var Q=t.advancedExcelUploadURL||t.action||"";e.action=Q||this.options.advancedExcelUploadURL;var tt=t.msaName||this._getMsaName()||"";if(""!=tt){var et="";Q&&(et=Q),e.action=a.v.getServletURL(this,tt,"excelToGrid2.wq",et),B=!0}e.gridID=this.id;var it=[];for(U=this.defaultColCnt;U<this.hiddenList.length;U++)1==this.hiddenList[U]&&it.push(U-this.defaultColCnt);if(e.columnNum=this.getTotalCol(),e.expressionColumns=this.getExpressionColumnArr().join(","),e.hiddenColumns=it.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=s||"1",e.gridStartCol=r||"1",e.gridEndCol=n,e.ignoreStartRowIndexInSAX="0"==l?"true":"false",e.ignoreStartColumnIndexInSAX="0"==h?"true":"false",e.gridSheetNo=d||"0",e.gridSheetName=u,e.activeSheet=p,e.applyDecimal="0"==M?"false":"true",WebSquare.domain&&(e.domain=WebSquare.text.URLEncoder(WebSquare.domain)),e.processMsg=WebSquare.text.BASE64URLEncoder(C),e.delim=S,e.dataList=I,!0===V){var ot=this.htmlInfo.body.rowAttrArr.length,st=this.getColumnOrder(),at=st.length,rt=new Array(at);for(U=0;U<ot;U++)for(var nt=0;nt<at;nt++)rt[at*U+nt]=this.getColumnID(at*U+st[nt]);e.columnIds=rt.join(",")}else e.columnIds=this.cellIdList.join(",");return e.trim=1==j,e.countSkipRow=1==X,e.status=x,e.pwd=T,e.loadingMode=k,e.maxFileSize=F,e.cellDataConvertor=A,e.decimal=E,e.useModalDisable=O+"",e.useMaxByteLength=N+"",e.postMsg=B+"",e.dateFormat=H,e.byteCheckEncoding=G,e.columnOrder=W,e.wframe=t.wframe||!1,e.name=t.name||"FILE UPLOAD",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,e.chunkNum=parseInt(q,10),e.useXHR=P,e.filePath=z,e.useDialog=t.useDialog,e.msaName=tt,t.convertIndex&&(t.convertIndex=t.convertIndex.wq_replaceAll(" ",""),e.convertIndexArr=t.convertIndex.split(",")),
"grid"==this.initializeType&&this.options.ref&&t.instanceBind&&(e.instanceBind=t.instanceBind),e},k.prototype.advancedExcelUpload=function(t){var e=this.getExcelUploadInfo(t),i=t.popupUrl||this.options.advancedExcelUploadPopupURL,s=document.location.protocol+"//"+document.location.host+"/",a=t.popupUrl?s+t.popupUrl:o.x.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.js"),n=t.advancedHidden||"0",h="";i+="?gridID="+e.gridID,WebSquare.domain&&(i+="&domain="+e.domain),1==n?(i+="&advancedHidden=true",e.advancedHidden="true"):(i+="&advancedHidden=false",e.advancedHidden="false"),""!=e.pwd&&(h=WebSquare.text.BASE64Encoder(e.pwd)),e.pwd=h;var d=r.D.getBoolean(e.wframe);if(this._excelUploadInfo=JSON.stringify(e),0==t.useDialog){var u=new FormData;u.append("header",e.header),u.append("footer",e.footer),u.append("append",e.append),u.append("hidden",e.hidden),u.append("columnNum",e.columnNum),u.append("hiddenColumns",e.hiddenColumns),u.append("removeColumns",e.removeColumns),u.append("headerRows",e.headerRows);var p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody"),c=WebSquare.Elem.api.getElementsByTagName(p[0],"w2:row");u.append("bodyRows",c.length),u.append("delim",e.delim),u.append("fillHidden",e.fillHidden),u.append("gridStartRow",e.gridStartRow),u.append("gridStartCol",e.gridStartCol),u.append("gridEndCol",e.gridEndCol),u.append("gridEndCol",e.gridEndCol),u.append("gridSheetNo",e.gridSheetNo),u.append("gridSheetName",e.gridSheetName),u.append("activeSheet",e.activeSheet),u.append("expressionColumns",e.expressionColumns);var g="";g="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),u.append("gridStyle",g),u.append("type",e.type),u.append("uploadType",e.uploadType),u.append("skipSpace",e.skipSpace),u.append("insertColumns",e.insertColumns),u.append("dataList",e.dataList),u.append("instanceBind",e.instanceBind),u.append("columnIds",e.columnIds),u.append("status",e.status),u.append("pwd",e.pwd),u.append("loadingMode",e.loadingMode),u.append("optionParam",e.optionParam),u.append("cellDataConvertor",e.cellDataConvertor),u.append("decimal",e.decimal),u.append("applyDecimal",e.applyDecimal),u.append("useMaxByteLength",e.useMaxByteLength),u.append("dateFormat",e.dateFormat),u.append("byteCheckEncoding",e.byteCheckEncoding),u.append("columnOrder",e.columnOrder),u.append("chunkNum",e.chunkNum||0),u.append("trim",e.trim),u.append("useXHR",e.useXHR),u.append("filePath",e.filePath),u.append("useDialog",e.useDialog),u.append("countSkipRow",e.countSkipRow);var f=WebSquare.text.BASE64URLDecoder(e.processMsg);f&&f.length>0?WebSquare.layer.showProcessMessage(f,t):WebSquare.layer.showProcessMessage("upload...",t);var m=this,y=new XMLHttpRequest;y.onreadystatechange=function(){if(4==y.readyState)if(200==y.status){var i=y.responseText;try{var o=WebSquare.xml.parse(i),s=o.getElementsByTagName("Exception");if(s.length>0){var a=o.getElementsByTagName("deniedCodeList")[0],n="";if(void 0===a?n="":void 0!==(n=WebSquare.xml.getTextNodeValue(a))&&null!=n&&""!=n||(n=""),"102"==n)l=WebSquare.language.getMessage("Upload_msg2");else if("101"==n)l=WebSquare.language.getMessage("Upload_msg9");else if("200"==n)l=WebSquare.language.getMessage("Upload_msg10");else if("201"==n)l=WebSquare.language.getMessage("Upload_msg11");else if("202"==n)l=WebSquare.language.getMessage("Upload_msg8");else if("203"==n)l=WebSquare.language.getMessage("Upload_msg12");else if("204"==n)l=WebSquare.language.getMessage("Upload_msg13");else if("205"==n)l=WebSquare.language.getMessage("Upload_msg14");else if("206"==n)l=WebSquare.language.getMessage("Upload_msg15");else if("207"==n)l=WebSquare.language.getMessage("Upload_msg16");else if("208"==n)l=WebSquare.language.getMessage("Upload_msg17");else{var l=WebSquare.xml.getTextNodeValue(o.getElementsByTagName("message")[0])
;void 0!==l&&null!=l&&""!=l||(l=WebSquare.language.getMessage("Upload_msg3"))}(b=t.onFailureCallback||null)&&b(e.action,l)}else{var h=o.getElementsByTagName("array")[0].firstChild.nodeValue;"string"==typeof e.append&&(e.append=r.D.getBoolean(e.append));var d={columnInfo:e.columnIds.split(","),data:h};if(""!=e.dataList){var u=r.D.getComponentById(e.dataList);d.data=d.data.replaceAll("\\n","\n");var p=u.getRowCount();if(1==e.uploadType||2==e.uploadType?","!=e.delim?u.setArrayFile(d,e.append,e.gridID,e.uploadType,e.delim):u.setArrayFile(d,e.append,e.gridID,e.uploadType):0==e.uploadType&&(","!=e.delim?u.setArray(d,e.append,null,null,e.delim):u.setArray(d,e.append)),"C"==status){var c=u.getRowCount();e.append?u.modifyRangeStatus(p,c,"C"):u.modifyRangeStatus(0,c,"C")}}else{p=this.getRowCount();if(!this.options.ref||1!=e.instanceBind&&"true"!=e.instanceBind?1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==uploadType&&this.setData(h,e.append):(this.options.instanceBindBySetData=!0,1==e.uploadType||2==e.uploadType?this.setDataFile(h,e.append):0==e.uploadType&&this.setData(h,e.append),this.options.instanceBindBySetData=!1),"C"==e.status){c=this.getRowCount();e.append?this.modifyRangeStatus(p,c,"C"):this.modifyRangeStatus(0,c,"C")}}var g=t.onSuccessCallback||null;g&&g(e.action);var f=t.filePath.split("\\");m.fireFileReadEnd(f[f.length-1])}}catch(t){s.printStackTrace(t)}finally{WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}}else{var b;(b=t.onFailureCallback||null)&&b(e.action),WebSquare.layer.hideProcessMessage({scope:this.scope_id||""})}},y.open("POST",e.action,!0),y.send(u)}else if(!0===d){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),r.D.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):r.D.isIE(7)||r.D.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):r.D.isIE(9)?(e.sizeInfo.height=204,e.sizeInfo.width=446):r.D.isIE(10)?(e.sizeInfo.height=162,e.sizeInfo.width=455):r.D.isIEAllVersion(11)?(e.sizeInfo.height=198,e.sizeInfo.width=455):r.D.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):r.D.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=164,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):r.D.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):r.D.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):r.D.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==(0,l.Z)(e.sFeatures)&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var b={type:"json",name:"popupParam",data:e},w={id:this.id+"_excelPop",type:"wframePopup",dataObject:b,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,useModalStack:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:a,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};r.D.openPopup(w.popupUrl,w)}else i=WebSquare.BootLoader.getEngineUri(i),window.open(i,"fileupWindow",e.sFeatures)},k.prototype.advancedExcelDownload=function(t,e){try{var i=t.maxCellCount||-1
;if(-1!=(i=parseInt(i,10)))if(i<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var o=WebSquare.language.getMessage("Grid_warning8",i)||"Cell 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+i;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}var a=t.maxRowCount||-1;if(-1!=(a=parseInt(a,10)))if(a<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){o=WebSquare.language.getMessage("Grid_warning10",a)||"Row 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+a;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var r=parseInt(t.rowsByN);switch(t.rowsByN=r>100?r:100,t.dataLength=this.getDataLength(),t.multiexcel=!1,t.dataProvider=t.dataProvider||"",t.splitProvider=t.splitProvider||"",t.scope=this.scope_id||"",t.type+""){case"":case"0":t.type=0;break;case"2":t.type=2;break;default:t.type=1}if(!1===t.showProcess)WebSquare.getBody().showModal("w2modal_gridDownload");else if(!0===t.showConfirm)t.massStorage=!0,window.downloadGridId=this.id,WebSquare.getBody().showModal(),this.showSendExcelLayer();else{var n=t.processMsg;n&&n.length>0?WebSquare.layer.showProcessMessage(n,t):WebSquare.layer.showProcessMessage("download...",t)}if(0===t.type||1===t.type||2==t.type){t.cellInfo=[],t.isPlainDataCol=[],t.isSelectCol=[],t.isBasicCol=[],t.isExpCol=[],t.isCustomCol=[],t.isCustomModelCol=[],t.isCustomType=[],t.isEscapeFormatter=[];for(var l=this.oneRowDataLength,h=0;h<l;h++){var d=this.getCellInfo(h),u=d.options.inputType;t.cellInfo[h]=d,t.isCustomType[h]="custom"===u,t.isPlainDataCol[h]="checkbox"===u||"image"===u||"radio"===u,t.isSelectCol[h]="select"===u||"checkcombobox"===u||"autoComplete"===u,t.isExpCol[h]="expression"===u,t.isCustomCol[h]=d.useCustomFormatter,t.isCustomModelCol[h]=d.useCustomModelFormatter,t.isBasicCol[h]=!(t.isPlainDataCol[h]||t.isSelectCol[h]||t.isExpCol[h]||t.isCustomCol[h]||t.isCustomModelCol[h]||t.isCustomType[h]),t.isEscapeFormatter[h]=d.useEscapeFormatter}}if(t.dataHandler=t.dataHandler||"",""!=t.dataHandler){this.sendExcelData(t,e,"")}else this.makeExcelData(0,[],t,e)}catch(t){WebSquare.layer.hideProcessMessage(),s.w.printStackTrace(t,null,this)}},k.prototype.showSendExcelLayer=function(){if(void 0!==window.gridExceldownloadIframe){window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.style.display="block";var t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.visibility="visible",window.gridExceldownloadIframe.contentWindow.initialize()}else{window.gridExceldownloadIframe=document.createElement("iframe"),window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.setAttribute("id","gridDownLoadLayer"),window.gridExceldownloadIframe.setAttribute("src",this.options.advancedExcelDownloadPopupURL),window.gridExceldownloadIframe.setAttribute("frameBorder","0"),window.gridExceldownloadIframe.className="w2grid_downloadIframe",window.gridExceldownloadIframe.style.width="300px",window.gridExceldownloadIframe.style.overflow="hidden",document.body.appendChild(window.gridExceldownloadIframe);t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",
window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.position="absolute",window.gridExceldownloadIframe.style.visibility="visible"}},k.prototype.checkUpload=function(){var t=this;setTimeout((function(){1==t.downloadInit?window.gridExceldownloadIframe.contentWindow.checkUpload("end"):t.checkUpload()}),10)},k.prototype.sendExcelData=function(t,e,i){try{"boolean"==typeof t.useFooter&&(t.useFooter=t.useFooter+"");var o=WebSquare.xml.encode(t.fileName)||"excel",s=t.sheetName||"sheet",n=t.type||"0",l="false";if(1==t.multiexcel){var h=t.multipleSheet;void 0===t.multipleSheet&&(h=""),l=h+""=="true"||h+""==""?"true":"false"}else l="false";var d=t.removeColumns||"",u=t.removeHeaderRows||"",p=t.foldColumns||"",c=t.startRowIndex||"0",g=t.startColumnIndex||"0",f=t.headerColor||"",m=t.headerFontName||"",y=t.headerFontSize||"",b=t.headerFontColor||"",w=t.headerFontBold||"",v=t.bodyColor||"",C=t.bodyFontName||"",I=t.bodyFontSize||"",_=t.bodyFontColor||"",x=t.bodyFontBold||"",S=t.footerColor||"",D=t.footerFontName||"",R=t.footerFontSize||"",L=t.footerFontColor||"",T=t.footerFontBold||"",k=t.subTotalColor||"",F=t.subTotalFontName||"",A=t.subTotalFontSize||"",E=t.subTotalFontColor||"",M=t.subTotalFontBold||"",O=t.rowNumHeaderColor||"",N=t.rowNumHeaderFontName||"",B=t.rowNumHeaderFontSize||"",H=t.rowNumHeaderFontColor||"",G=t.rowNumBodyColor||"",W=t.rowNumBodyFontName||"",V=t.rowNumBodyFontSize||"",q=t.rowNumBodyFontColor||"",j=t.rowNumFooterColor||"",P=t.rowNumFooterFontName||"",z=t.rowNumFooterFontSize||"",X=t.rowNumFooterFontColor||"",U=t.rowNumSubTotalColor||"",Z=t.rowNumSubTotalFontName||"",K=t.rowNumSubTotalFontSize||"",Y=t.rowNumSubTotalFontColor||"",$=t.groupbyColor||"";t.groupbyColor=$;var J=t.groupbyFontName||"";t.groupbyFontName=J;var Q=t.groupbyFontSize||"";t.groupbyFontSize=Q;var tt=t.groupbyFontColor||"";t.groupbyFontColor=tt;var et=t.dataProvider||"",it=t.footerDataProvider||"",ot=t.splitProvider||"",st=t.providerRequestXml||"",at=t.userDataXml||"",rt=t.optionParam||"",nt=t.bodyWordwrap||"",lt=t.subtotalWordwrap||"",ht=t.footerWordwrap||"",dt=t.useEuroLocale||"false",ut=t.numberLocale||"",pt=t.useHeader||"true",ct=t.useSubTotal||"false",gt=t.useFooter||"true";t.printSet=t.printSet||{};var ft=t.printSet.fitToPage||"false",mt=t.printSet.landScape||"false",yt=t.printSet.fitWidth||"1",bt=t.printSet.fitHeight||"1",wt=t.printSet.scale||"100",vt=t.printSet.pageSize||"A4",Ct=t.separator||",",It=t.subTotalScale||-1,_t=t.subTotalRoundingMode||"",xt=t.footerScale||-1,St=t.footerRoundingMode||"",Dt=t.useStyle+""=="true",Rt=t.useClass+""=="true";t.useClass=Rt;var Lt=t.setFontSize+""=="true",Tt=t.freezePane||"",kt=t.autoSizeColumn||"false",Ft=t.autoSizeAdjustWith||512,At=t.displayGridlines||"",Et=t.colMerge||"false",Mt=t.colMergeValue||"false",Ot=t.colMergeTextAlign||"center",Nt=t.useDataFormat||"false",Bt=t.useHeaderDataFormat||"",Ht=t.applyDataFormat||"false",Gt=t.customToDataType||"false",Wt=t.useSubTotalData+""=="true",Vt=t.useFooterData+""=="true",qt=t.calcFooter+""=="true",jt=t.columnMove+""=="true",Pt=t.columnOrder||"";qt&&(jt=!1);var zt=t.columnMoveWithSubTotal||"",Xt=t.columnMoveWithFooter||"",Ut=t.oddRowBackgroundColor||"",Zt=t.evenRowBackgroundColor||"",Kt=t.indent||"0",Yt=WebSquare.xml.encode(this.options.rowNumHeaderValue)||t.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef)(ci=this.getLocaleValue(this.options.rowNumLocaleRef))&&(Yt=ci);var $t=t.rowNumVisible+""=="true",Jt=this.options.startRowNumber||"1",Qt=t.bodyNumberDefaultValue||"",te=t.numberToText||"false",ee=t.rowHeight||"-1",ie=t.headerRowHeight||"-1",oe=t.maxDataSize||-1;oe=parseInt(oe,10);var se=t.pwd||"",ae=t.useImage||"false",re=t.headerAutoFilter||"false",ne=t.filterRowIndex||"-1",le=t.mergeCell+""=="true",he=t.noMerge+""=="true";t.httpReadOnly=t.httpReadOnly+""=="true";var de=t.advancedExcelDownloadURL||t.action||"",ue=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=ue+""=="true"
;var pe,ce=t.openFile||"false",ge=t.macroFileName||"",fe=t.useMacro||"false",me=t.showDialog||"false",ye=t.dialogFilter||"",be=t.keepType||"false",we=t.useHeaderCheckBoxLabel+""=="true",ve=t.lazyInfoArr||"false",Ce=t.decimal||"",Ie=t.sameSite||"",_e=t.customProvider||"",xe=t.customProviderIndex||"",Se=t.rowAccessWindowSize||"",De=t.trim||"",Re=t.desc||"",Le=t.footerTop||"",Te=t.msaName||"",ke=t.chart||{};if(ke.chartName)var Fe=ke.chartName||"line",Ae=ke.chartType||"",Ee=ke.title||"",Me=ke.xTitle||"",Oe=ke.yTitle||"",Ne=ke.startRowIndex||0,Be=ke.startColIndex||0,He=ke.endRowIndex||0,Ge=ke.endColIndex||0,We=ke.serAxis||"true",Ve=ke.catAxis||"true",qe=ke.catAxisRange||{},je=qe.startColIndex||0,Pe=qe.startRowIndex||0,ze=qe.endColIndex||0,Xe=qe.endRowIndex||0,Ue=ke.serAxisRange||{},Ze=Ue.startColIndex||0,Ke=Ue.startRowIndex||0,Ye=Ue.endColIndex||0,$e=Ue.endRowIndex||0,Je=ke.dataAxisRange||{},Qe=Je.startColIndex||0,ti=Je.startRowIndex||0,ei=Je.endColIndex||0,ii=Je.endRowIndex||0,oi=ke.catGridLines||"true",si=ke.serGridLines||"true",ai=ke.legend||"true",ri=ke.legendPosition||"bottom";jt&&(pe=""==Pt?this.getColumnOrder()||"":Pt.split(","));var ni=[];if(""!=d){var li=(d+="").split(",");if(jt)for(var hi=0;hi<li.length;hi++)for(var di=0;di<pe.length;di++)li[hi]==pe[di]&&ni.push(di);else ni=li;ni.sort((function(t,e){return 1*t-1*e})),d=ni.join(",")}var ui=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],pi=WebSquare.Elem.api.getElementsByTagName(ui,"w2:column");for(hi=0;hi<pi.length;hi++){if("checkbox"===(Ti=pi[hi]).getAttribute("inputType")&&!0===we){var ci,gi=Ti.getAttribute("checkboxLabel")||Ti.getAttribute("value"),fi=Ti.getAttribute("localeRef");if(this.options.useLocale&&fi)(ci=this.getLocaleValue(fi))&&(gi=ci);Ti.setAttribute("value",gi+"")}else{var mi=Ti.getAttribute("id");Ti.setAttribute("value",this.getHeaderValue2(mi)+"")}}var yi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody");if(yi.length>0){var bi=yi[0],wi=WebSquare.Elem.api.getElementsByTagName(bi,"w2:row");for(hi=0;hi<wi.length;hi++)for(pi=WebSquare.Elem.api.getElementsByTagName(wi[hi],"w2:column"),di=0;di<pi.length;di++){mi=(Ti=pi[di]).getAttribute("id");var vi=this.getCellInfo(mi);vi.options.displayFormat&&Ti.setAttribute("displayFormat",vi.options.displayFormat);var Ci=Ti.getAttribute("excelCellType"),Ii="";(Ii=null==Ci?this._dataList.getColumnOption(mi,"dataType"):Ci)?Ti.setAttribute("dataType",Ii):Ti.setAttribute("dataType","text");var _i=Ti.getAttribute("excelFormatter");if(ki=r.D.getGlobalFunction(_i,this.scope_id)){var xi=ki.call(this,mi);Ti.setAttribute("excelFormat",xi)}}}var Si=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:subTotal");for(hi=0;hi<Si.length;hi++){wi=WebSquare.Elem.api.getElementsByTagName(Si[hi],"w2:row");for(di=0;di<wi.length;di++){pi=WebSquare.Elem.api.getElementsByTagName(wi[di],"w2:column");for(var Di=0;Di<pi.length;Di++){mi=(Ti=pi[Di]).getAttribute("id"),_i=Ti.getAttribute("excelFormatter");if(ki=r.D.getGlobalFunction(_i,this.scope_id)){xi=ki.call(this,mi);Ti.setAttribute("excelFormat",xi)}}}}var Ri=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:footer");if(Ri.length>0){var Li=Ri[0];wi=WebSquare.Elem.api.getElementsByTagName(Li,"w2:row");for(hi=0;hi<wi.length;hi++)for(pi=WebSquare.Elem.api.getElementsByTagName(wi[hi],"w2:column"),di=0;di<pi.length;di++){var Ti,ki;mi=(Ti=pi[di]).getAttribute("id"),_i=Ti.getAttribute("excelFormatter");if(ki=r.D.getGlobalFunction(_i,this.scope_id)){xi=ki.call(this,mi);Ti.setAttribute("excelFormat",xi)}}}var Fi=[];Fi.push("<vector result='1'>"),Fi.push("<data vectorkey='0'><hashtable>");var Ai=this.element._elementType,Ei="";if(Ei="json"===Ai?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),Fi.push("<data hashkey='style'>"+Ei+"</data>"),t.dataHandler=t.dataHandler||"",""!=t.dataHandler){var Mi=WebSquare.util.getGlobalFunction(t.dataHandler,this.scope_id)
;if("function"==typeof Mi){var Oi=Mi.call(this,this.id);Ct=t.separator||",";i='<array><![CDATA[["'+Oi.join('"'+Ct+'"')+'"]]]></array>'}}Fi.push("<data hashkey='data'>"+i+"</data>"),(this.startedDisplayNone||0==this.resizeObj.width||0==this.resizeObj.height)&&this.drawFooter(),Fi.push("<data hashkey='groupby' value='"+this.groupbyStatus.grouped+"'/>"),this.groupbyStatus.grouped?(Fi.push("<data hashkey='groupbyStyle'>"+this.getExcelGroupbyStyle()+"</data>"),Fi.push("<data hashkey='groupbyHeaderValue'>"+this.getExcelGroupbyHeaderValue(Ct)+"</data>"),Fi.push("<data hashkey='groupbyFooterValue'>"+this.getExcelGroupbyFooterValue(Ct)+"</data>"),Fi.push("<data hashkey='groupbyStatusValue'>"+this.getExcelGroupbyStatusValue(Ct)+"</data>"),Fi.push("<data hashkey='groupbyStyleData'>"+this.getExcelGroupbyStyleData(t)+"</data>"),Fi.push("<data hashkey='rowNumVisible' value='"+this.options.rowNumVisible+"'/>"),Fi.push("<data hashkey='rowStatusVisible' value='"+this.options.rowStatusVisible+"'/>"),""!=$&&Fi.push("<data hashkey='groupbyColor' value='"+$+"'/>"),""!=J&&Fi.push("<data hashkey='groupbyFontName' value='"+J+"'/>"),""!=Q&&Fi.push("<data hashkey='groupbyFontSize' value='"+Q+"'/>"),""!=tt&&Fi.push("<data hashkey='groupbyFontColor' value='"+tt+"'/>"),r.D.isEmptyObject(this.groupbyDisplayOptions.rowNumHeader)&&r.D.isEmptyObject(this.groupbyDisplayOptions.rowStatusHeader)||Fi.push("<data hashkey='rowNone' value='true'/>")):Fi.push("<data hashkey='rowNumVisible' value='"+$t+"'/>"),0==n?Fi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXML(Ct)+"</data>"):1==n?Fi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLDisplay(Ct)+"</data>"):Fi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLRaw(Ct)+"</data>"),Fi.push("<data hashkey='fileName' value='"+o+"'/>"),Fi.push("<data hashkey='sheetName' value='"+s+"'/>"),Fi.push("<data hashkey='multipleSheet' value='"+l+"'/>"),Fi.push("<data hashkey='stRowIndex' value='"+c+"'/>"),Fi.push("<data hashkey='stColIndex' value='"+g+"'/>"),Fi.push("<data hashkey='removeColumns' value='"+d+"'/>"),Fi.push("<data hashkey='removeHeaderRows' value='"+u+"'/>"),Fi.push("<data hashkey='foldColumns' value='"+p+"'/>"),Fi.push("<data hashkey='headerColor' value='"+f+"'/>"),Fi.push("<data hashkey='headerFontName' value='"+m+"'/>"),Fi.push("<data hashkey='headerFontSize' value='"+y+"'/>"),Fi.push("<data hashkey='headerFontColor' value='"+b+"'/>"),Fi.push("<data hashkey='headerFontBold' value='"+w+"'/>"),Fi.push("<data hashkey='bodyColor' value='"+v+"'/>"),Fi.push("<data hashkey='bodyFontName' value='"+C+"'/>"),Fi.push("<data hashkey='bodyFontSize' value='"+I+"'/>"),Fi.push("<data hashkey='bodyFontColor' value='"+_+"'/>"),""!=x&&Fi.push("<data hashkey='bodyFontBold' value='"+x+"'/>"),Fi.push("<data hashkey='footerColor' value='"+S+"'/>"),Fi.push("<data hashkey='footerFontName' value='"+D+"'/>"),Fi.push("<data hashkey='footerFontSize' value='"+R+"'/>"),Fi.push("<data hashkey='footerFontColor' value='"+L+"'/>"),""!=T&&Fi.push("<data hashkey='footerFontBold' value='"+T+"'/>"),Fi.push("<data hashkey='subTotalColor' value='"+k+"'/>"),Fi.push("<data hashkey='subTotalFontName' value='"+F+"'/>"),Fi.push("<data hashkey='subTotalFontSize' value='"+A+"'/>"),Fi.push("<data hashkey='subTotalFontColor' value='"+E+"'/>"),""!=M&&Fi.push("<data hashkey='subTotalFontBold' value='"+M+"'/>"),$t&&(Fi.push("<data hashkey='rowNumHeaderColor' value='"+O+"'/>"),Fi.push("<data hashkey='rowNumHeaderFontName' value='"+N+"'/>"),Fi.push("<data hashkey='rowNumHeaderFontSize' value='"+B+"'/>"),Fi.push("<data hashkey='rowNumHeaderFontColor' value='"+H+"'/>"),Fi.push("<data hashkey='rowNumBodyColor' value='"+G+"'/>"),Fi.push("<data hashkey='rowNumBodyFontName' value='"+W+"'/>"),Fi.push("<data hashkey='rowNumBodyFontSize' value='"+V+"'/>"),Fi.push("<data hashkey='rowNumBodyFontColor' value='"+q+"'/>"),Fi.push("<data hashkey='rowNumFooterColor' value='"+j+"'/>"),Fi.push("<data hashkey='rowNumFooterFontName' value='"+P+"'/>"),
Fi.push("<data hashkey='rowNumFooterFontSize' value='"+z+"'/>"),Fi.push("<data hashkey='rowNumFooterFontColor' value='"+X+"'/>"),Fi.push("<data hashkey='rowNumSubTotalColor' value='"+U+"'/>"),Fi.push("<data hashkey='rowNumSubTotalFontName' value='"+Z+"'/>"),Fi.push("<data hashkey='rowNumSubTotalFontSize' value='"+K+"'/>"),Fi.push("<data hashkey='rowNumSubTotalFontColor' value='"+Y+"'/>")),Fi.push("<data hashkey='footerDataProvider' value='"+it+"'/>"),Fi.push("<data hashkey='dataProvider' value='"+et+"'/>"),Fi.push("<data hashkey='splitProvider' value='"+ot+"'/>"),Fi.push("<data hashkey='providerRequestXml' value=''>"+st+"</data>"),Fi.push("<data hashkey='userDataXml' value=''>"+at+"</data>"),Fi.push("<data hashkey='optionParam' value='"+rt+"'/>"),""!=nt&&Fi.push("<data hashkey='bodyWordwrap' value='"+nt+"'/>"),""!=lt&&Fi.push("<data hashkey='subtotalWordwrap' value='"+lt+"'/>"),""!=ht&&Fi.push("<data hashkey='footerWordwrap' value='"+ht+"'/>"),Fi.push("<data hashkey='useEuroLocale' value='"+dt+"'/>"),Fi.push("<data hashkey='numberLocale' value='"+ut+"'/>"),Fi.push("<data hashkey='useHeader' value='"+pt+"'/>"),Fi.push("<data hashkey='useSubTotal' value='"+ct+"'/>"),Fi.push("<data hashkey='useFooter' value='"+gt+"'/>"),Fi.push("<data hashkey='fitToPage' value='"+ft+"'/>"),Fi.push("<data hashkey='landScape' value='"+mt+"'/>"),Fi.push("<data hashkey='fitWidth' value='"+yt+"'/>"),Fi.push("<data hashkey='fitHeight' value='"+bt+"'/>"),Fi.push("<data hashkey='scale' value='"+wt+"'/>"),Fi.push("<data hashkey='pageSize' value='"+vt+"'/>"),Fi.push("<data hashkey='separator' value='"+Ct+"'/>"),Fi.push("<data hashkey='subTotalScale' value='"+It+"'/>"),Fi.push("<data hashkey='subTotalRoundingMode' value='"+_t+"'/>"),Fi.push("<data hashkey='footerScale' value='"+xt+"'/>"),Fi.push("<data hashkey='footerRoundingMode' value='"+St+"'/>"),Fi.push("<data hashkey='useStyle' value='"+Dt+"'/>"),1==Lt&&Fi.push("<data hashkey='setFontSize' value='"+Dt+"'/>"),Fi.push("<data hashkey='freezePane' value='"+Tt+"'/>"),Fi.push("<data hashkey='autoSizeColumn' value='"+kt+"'/>"),Fi.push("<data hashkey='autoSizeAdjustWith' value='"+Ft+"'/>"),Fi.push("<data hashkey='displayGridlines' value='"+At+"'/>"),Fi.push("<data hashkey='colMerge' value='"+Et+"'/>"),Fi.push("<data hashkey='colMergeValue' value='"+Mt+"'/>"),Fi.push("<data hashkey='colMergeTextAlign' value='"+Ot+"'/>"),Fi.push("<data hashkey='useDataFormat' value='"+Nt+"'/>"),""!=Bt&&Fi.push("<data hashkey='useHeaderDataFormat' value='"+Bt+"'/>"),Fi.push("<data hashkey='customToDataType' value='"+Gt+"'/>"),Fi.push("<data hashkey='applyDataFormat' value='"+Ht+"'/>"),Fi.push("<data hashkey='useSubTotalData' value='"+Wt+"'/>"),Fi.push("<data hashkey='useFooterData' value='"+Vt+"'/>"),Fi.push("<data hashkey='calcFooter' value='"+qt+"'/>"),Fi.push("<data hashkey='columnMove' value='"+jt+"'/>"),Fi.push("<data hashkey='columnOrder' value='"+pe+"'/>"),""!=zt&&Fi.push("<data hashkey='columnMoveWithSubTotal' value='"+zt+"'/>"),""!=Xt&&Fi.push("<data hashkey='columnMoveWithFooter' value='"+Xt+"'/>"),Fi.push("<data hashkey='oddRowBgColor' value='"+Ut+"'/>"),Fi.push("<data hashkey='evenRowBgColor' value='"+Zt+"'/>"),Fi.push("<data hashkey='indent' value='"+Kt+"'/>"),Fi.push("<data hashkey='rowNumHeaderValue' value='"+Yt+"'/>"),Fi.push("<data hashkey='startRowNumber' value='"+Jt+"'/>"),Fi.push("<data hashkey='bodyNumberDefaultValue' value='"+Qt+"'/>"),Fi.push("<data hashkey='numberToText' value='"+te+"'/>"),Fi.push("<data hashkey='rowHeight' value='"+ee+"'/>"),Fi.push("<data hashkey='headerRowHeight' value='"+ie+"'/>"),Fi.push("<data hashkey='pwd' value='"+se+"'/>"),Fi.push("<data hashkey='useImage' value='"+ae+"'/>"),Fi.push("<data hashkey='headerAutoFilter' value='"+re+"'/>"),Fi.push("<data hashkey='filterRowIndex' value='"+ne+"'/>"),Fi.push("<data hashkey='mergeCell' value='"+le+"'/>"),Fi.push("<data hashkey='noMerge' value='"+he+"'/>"),
Dt&&Fi.push("<data hashkey='styleData'><array><![CDATA[["+this._getExcelStyle(t)+"]]]></array></data>"),Wt&&Fi.push("<data hashkey='subtotalData'><array><![CDATA[["+this._getExcelSubtotalData(Ct)+"]]]></array></data>");var Ni="",Bi=t.mergeCellHeaderInfo||"";le&&(ct=r.D.getBoolean(ct),Ni=this.getMergeAll(d,ct)),Fi.push("<data hashkey='mergeCellInfo'><array><![CDATA[["+Ni+"]]]></array></data>"),Fi.push("<data hashkey='mergeCellHeaderInfo'><array><![CDATA[["+Bi+"]]]></array></data>"),Fi.push("<data hashkey='openFile' value='"+ce+"'/>"),Fi.push("<data hashkey='macroFileName' value='"+ge+"'/>"),Fi.push("<data hashkey='useMacro' value='"+fe+"'/>"),Fi.push("<data hashkey='showDialog' value='"+me+"'/>"),Fi.push("<data hashkey='dialogFilter' value='"+ye+"'/>"),Fi.push("<data hashkey='keepType' value='"+be+"'/>"),Fi.push("<data hashkey='lazyInfoArr' value='"+ve+"'/>"),Fi.push("<data hashkey='decimal' value='"+Ce+"'/>"),""!=Ie&&Fi.push("<data hashkey='sameSite' value='"+Ie+"'/>"),Fi.push("<data hashkey='customProvider' value='"+_e+"'/>"),Fi.push("<data hashkey='customProviderIndex' value='"+xe+"'/>"),Fi.push("<data hashkey='rowAccessWindowSize' value='"+Se+"'/>"),Fi.push("<data hashkey='trim' value='"+De+"'/>"),Fi.push("<data hashkey='useXHR' value='"+ue+"'/>"),Fi.push("<data hashkey='desc' value='"+Re+"'/>"),""!=Le&&Fi.push("<data hashkey='footerTop' value='"+Le+"'/>"),""!=(Te=Te||this._getMsaName()||"")&&Fi.push("<data hashkey='msaName' value='"+Te+"'/>"),ke.chartName&&(Fi.push("<data hashkey='c_chartName' value='"+Fe+"'/>"),Fi.push("<data hashkey='c_chartType' value='"+Ae+"'/>"),Fi.push("<data hashkey='c_title' value='"+Ee+"'/>"),Fi.push("<data hashkey='c_xTitle' value='"+Me+"'/>"),Fi.push("<data hashkey='c_yTitle' value='"+Oe+"'/>"),Fi.push("<data hashkey='c_startRowIndex' value='"+Ne+"'/>"),Fi.push("<data hashkey='c_startColIndex' value='"+Be+"'/>"),Fi.push("<data hashkey='c_endRowIndex' value='"+He+"'/>"),Fi.push("<data hashkey='c_endColIndex' value='"+Ge+"'/>"),Fi.push("<data hashkey='c_serAxis' value='"+We+"'/>"),Fi.push("<data hashkey='c_catAxis' value='"+Ve+"'/>"),Fi.push("<data hashkey='c_catAxisStartX' value='"+je+"'/>"),Fi.push("<data hashkey='c_catAxisStartY' value='"+Pe+"'/>"),Fi.push("<data hashkey='c_catAxisEndX' value='"+ze+"'/>"),Fi.push("<data hashkey='c_catAxisEndY' value='"+Xe+"'/>"),Fi.push("<data hashkey='c_serAxisStartX' value='"+Ze+"'/>"),Fi.push("<data hashkey='c_serAxisStartY' value='"+Ke+"'/>"),Fi.push("<data hashkey='c_serAxisEndX' value='"+Ye+"'/>"),Fi.push("<data hashkey='c_serAxisEndY' value='"+$e+"'/>"),Fi.push("<data hashkey='c_dataAxisStartX' value='"+Qe+"'/>"),Fi.push("<data hashkey='c_dataAxisStartY' value='"+ti+"'/>"),Fi.push("<data hashkey='c_dataAxisEndX' value='"+ei+"'/>"),Fi.push("<data hashkey='c_dataAxisEndY' value='"+ii+"'/>"),Fi.push("<data hashkey='c_catGridLines' value='"+oi+"'/>"),Fi.push("<data hashkey='c_serGridLines' value='"+si+"'/>"),Fi.push("<data hashkey='c_legend' value='"+ai+"'/>"),Fi.push("<data hashkey='c_legendPosition' value='"+ri+"'/>")),null!=e&&void 0!==e||(e=[]),Fi.push("<data hashkey='information'><vector result='"+e.length+"'>");for(hi=0;hi<e.length;hi++){var Hi=e[hi];for(var Gi in Fi.push("<data vectorkey='"+hi+"'><hashtable>"),Hi)"text"==Gi?Fi.push("<data hashkey='"+Gi+"' value='"+WebSquare.xml.encode(Hi[Gi])+"'/>"):Fi.push("<data hashkey='"+Gi+"' value='"+Hi[Gi]+"'/>");Fi.push("</hashtable></data>")}if(Fi.push("</vector></data>"),0!=t.multiexcel)return Fi.push("</hashtable></data>"),Fi.push("</vector>"),Fi;Fi.push("</hashtable></data>"),Fi.push("</vector>");var Wi=Fi.join("");if(-1!=oe&&oe<r.D.getByteLengthUtf8(Wi)){var Vi=WebSquare.language.getMessage("Grid_warning9",oe)||"전송 data가 제한 크기를 초과 하였습니다.\n 제한 크기 : "+oe+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(Vi)}if(""!=Te){var qi="";""!=de&&(qi=de),
de=a.v.getServletURL(this,Te,"xmlToExcel2.wq",qi),t.useXHR=!0,t.userExcel=!0}""==de&&(de=this.options.advancedExcelDownloadURL),t.scopeId=this.scope_id||"",a.v.excelDownload(de,Wi,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0)),this.xmlData=null,!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm&&this.hideDownloadLayer()}catch(t){throw t}},k.prototype.saveFile=function(t){var e=t.type||"xml",i=t.fileName||"gridView",o=t.extension||"xml",s=t.sameSite||"",r=[];r.push("<vector result='1'>"),r.push("<data vectorkey='0'><hashtable>"),r.push("<data hashkey='type' value='"+e+"'/>"),r.push("<data hashkey='fileName' value='"+i+"'/>"),r.push("<data hashkey='extension' value='"+o+"'/>"),r.push("<data hashkey='sameSite' value='"+s+"'/>"),r.push("</hashtable></data>"),r.push("</vector>");var n=r.join("");n+="\x3c!----VALUESTR----!>",n+=WebSquare.xml.serialize(this.getAllXML());var l=t.action||WebSquare.baseServletURI+"gridToFile.wq";a.v.excelDownload(l,n,"post",t)},k.prototype.getExcelExpression=function(t){var e,i="";return void 0!==t.type&&void 0!==t.id&&void 0!==t.attr&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",a.v._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",a.v._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0]),void 0!==e&&(i=this._getAttribute(e,t))),i},k.prototype.setExcelExpression=function(t){var e;void 0!==t.type&&void 0!==t.id&&void 0!==t.excelExpression&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",a.v._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",a.v._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",a.v._XML_NAMESPACE.W2)[0]),void 0!==e&&this._setAttribute(e,t))},k.prototype._getAttribute=function(t,e){for(var i="",o=0;o<t.childNodes.length;o++){var s=t.childNodes[o];if(1==s.nodeType)for(var a=0;a<s.childNodes.length;a++){var r=s.childNodes[a];if(1==r.nodeType){if(("body"==e.type?r.getAttribute("col_id"):r.getAttribute("id"))==e.id){i=r.getAttribute(e.attr);break}}}}return i},k.prototype._setAttribute=function(t,e){for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes[i];if(1==o.nodeType)for(var s=0;s<o.childNodes.length;s++){var a=o.childNodes[s];if(1==a.nodeType){if(("body"==e.type?a.getAttribute("col_id"):a.getAttribute("id"))==e.id){a.setAttribute("excelExpression",e.excelExpression);break}}}}},k.prototype.cancleDownload=function(){clearTimeout(this.excelTime),this.hideDownloadLayer()},k.prototype.hideDownloadLayer=function(){window.gridExceldownloadIframe.style.display="none",this.excelOptions=null,this.excelInfoArr=null,this.excelFinalStr=null,window.downloadGridId=null,WebSquare.getBody().hideModal(!0)},k.prototype.saveBigExcelFile=function(t,e,i){i&&(t.rowsByN=i),t.massStorage=!0,this.advancedExcelDownload(t,e)},k.prototype._getExcelStyle=function(t){try{for(var e={},i={},o={},a={},n={},l=this.getColumnCount(),h=0;h<l;h++){var d=(p=this.getCellInfo(h)).options.className;if(d){var u=document.querySelector("."+d);if(u)e[h]={"text-align":WebSquare.style.getComputedStyle(u,"text-align")},"underline"!=(F=WebSquare.style.getComputedStyle(u,"text-decoration"))&&"line-through"!=F||(e[h]["text-decoration"]=F)}}for(var h in this.columnStyleValueObj){var p,c={};for(var g in this.columnStyleValueObj[h])"style"!=g&&(c[g]=this.columnStyleValueObj[h][g]);if(p=this.getCellInfo(parseInt(h,10)))"underline"!=(F=this.getColumnStyleValue(parseInt(h,10),"text-decoration"))&&"line-through"!=F||(c["text-decoration"]=F)
;if(p&&p.options.textAlign){var f="";""==(f=this.getColumnStyleValue(parseInt(h,10),"text-align"))&&""==(f=p.options.textAlign)&&(f="center"),c["text-align"]=f}e[h]=c}for(h=0;h<this.rowStyleArr.length;h++)if(this.rowStyleArr[h]){c={};for(var g in this.rowStyleValueObj[this.rowStyleArr[h]])"style"!=g&&(c[g]=this.rowStyleValueObj[this.rowStyleArr[h]][g]);var m=this.getDisplayRowIndex(h);isNaN(m)||(i[m]=c)}for(var y in this.cellStyleArr)if(this.cellStyleArr[y]&&!isNaN(y)){c={};var b=parseInt(y/this.oneRowDataLength,10),w=(m=this.getDisplayRowIndex(b),y%this.oneRowDataLength);for(var g in this.cellStyleValueObj[this.cellStyleArr[y]])"style"!=g&&this.cellStyleValueObj[this.cellStyleArr[y]][g]&&(c[g]=this.cellStyleValueObj[this.cellStyleArr[y]][g]);o[m+","+w]=c}if(1==t.useClass)for(h=0;h<this.cellClassArr.length;h++)if(this.cellClassArr[h]){c={},b=parseInt(h/this.oneRowDataLength,10),m=this.getDisplayRowIndex(b),w=h%this.oneRowDataLength;var v=WebSquare.util.getStyleFromCssStr(this.cellClassArr[h],["backgroundColor","color","textAlign","fontSize","fontWeight","fontFamily","text-decoration"]);o[m+","+w]&&(c=o[m+","+w]),v&&(v.backgroundColor&&(c["background-color"]=v.backgroundColor),v.color&&(c.color=v.color),v.textAlign&&(c["text-align"]=v.textAlign),v.fontSize&&(c["font-size"]=v.fontSize),v.fontWeight&&(c["font-weight"]=v.fontWeight),v.fontFamily&&(c["font-family"]=v.fontFamily),"underline"!=v["text-decoration"]&&"line-through"!=v["text-decoration"]||(c["text-decoration"]=v["text-decoration"])),0!==Object.keys(c).length&&(o[m+","+w]=c)}if(this.options.disabledBackgroundColor||this.options.disabledFontColor){c={};this.options.disabledBackgroundColor&&(c["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(c.color=this.options.disabledFontColor);l=this.getColumnCount();var C=this.getRowCount(),I=!(!this.isDrillDown||!this._dataList.options.depthColumn);for(h=0;h<l;h++)for(g=0;g<C;g++)this._getEditDisabled(h,g,I)&&(o[h+","+g]?(this.options.disabledBackgroundColor&&(o[h+","+g]["background-color"]=this.options.disabledBackgroundColor),this.options.disabledFontColor&&(o[h+","+g].color=this.options.disabledFontColor)):o[h+","+g]=c)}var _=r.D.getDataPrefix("header_id"),x="",S=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(h=this.defaultColCnt;h<S.length;h++){var D="",R=S[h].id.replace(this.id+"_",""),L=this.headerCellStyleValueObj[R];x=L&&L["background-color"]?L["background-color"]:t.headerColor?t.headerColor:WebSquare.style.getStyle(S[h],"background-color"),D+="color:"+WebSquare.style.getStyle(S[h],"color")+";",D+="background-color:"+x+";",D+="font-weight:"+WebSquare.style.getStyle(S[h],"font-weight")+";",D+="font-family:"+WebSquare.style.getStyle(S[h],"font-family")+";",D+="text-align:"+WebSquare.style.getStyle(S[h],"text-align")+";","underline"!=(F=WebSquare.style.getStyle(S[h],"text-decoration"))&&"line-through"!=F||(D+="text-decoration:underline;"),a[S[h].getAttribute(_)]=D}if(this.hasFooter){var T=r.D.getDataPrefix("footer_id"),k=this.getDomList("foot_tds","th",this.getElementById(this.id+"_foot_table"));for(h=this.defaultColCnt;h<k.length;h++){var F;D="";D+="color:"+WebSquare.style.getStyle(k[h],"color")+";",D+="background-color:"+WebSquare.style.getStyle(k[h],"background-color")+";",D+="font-weight:"+WebSquare.style.getStyle(k[h],"font-weight")+";",D+="font-family:"+WebSquare.style.getStyle(k[h],"font-family")+";",D+="text-align:"+WebSquare.style.getStyle(k[h],"text-align")+";","underline"!=(F=WebSquare.style.getStyle(k[h],"text-decoration"))&&"line-through"!=F||(D+="text-decoration:underline;"),n[k[h].getAttribute(T)]=D}}return JSON.stringify({row:i,col:e,cell:o,header:a,footer:n})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getExcelSubtotalData=function(t){t||(t=",");var e=[];e.push('"');for(var i=r.D.getDataPrefix("colMerge"),o=r.D.getDataPrefix("value"),s=this.getDataLength(),a=0;a<s;a++){var n=a;for(var l in this.subtotalTableList){
var h=this.dataList._getCellData(n,l),d=h+"_12";if(n<s-1)d=this.dataList._getCellData(n+1,l);if(h!=d){var u=this.subtotalTableList[l],p=this.subtotalDataArr[l+"_"+h];null==p&&(p=this.getSubtotalData(u,l,h,n));for(var c="",g=u.getElementsByTagName("td"),f=0;f<g.length;f++){var m=g[f],y=m.getAttribute("id");if(!y.startsWith("_headerRowNumber")&&!y.startsWith("_headerRowStatus")){if(null!=p[y])c=p[y];else if("true"==m.getAttribute(i))c="";else{c=null!=(c=m.getAttribute(o))?c:""}e.push(c),e.push('"'+t+'"')}}}}}return e[e.length-1]='"',e.join("")},k.prototype.getExcelGroupbyStyle=function(){try{if(this.groupbyStatus.grouped){var t={rowNumHeader:{type:"H",index:2},rowNumFooter:{type:"F",index:2},rowStatusHeader:{type:"H",index:3},rowStatusFooter:{type:"F",index:3},groupbyHeader:{type:"H",index:-1},groupbyFooter:{type:"F",index:-1}},e=4,i=4,o=!1,a=!1,r=[],n=[],l=[],h={};r.push("<w2:groupby>"),n.push("<w2:groupbyHeader>"),l.push("<w2:groupbyFooter>"),n.push("<w2:row>"),l.push("<w2:row>");var d=this.defaultColCnt+this.getColCnt(),u=0,p=0;this.options.rowNumVisible&&(this.groupbyDisplayOptions.rowNumHeader&&(this.groupbyDisplayOptions.rowNumHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowNumHeader.colSpan,10)||1)<=d&&(h.rowNumHeader=this.groupbyDisplayOptions.rowNumHeader)),this.groupbyDisplayOptions.rowNumFooter&&(this.groupbyDisplayOptions.rowNumFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowNumFooter.colSpan,10)||1)<=d&&(h.rowNumFooter=this.groupbyDisplayOptions.rowNumFooter))),this.options.rowStatusVisible&&(this.groupbyDisplayOptions.rowStatusHeader&&(this.groupbyDisplayOptions.rowStatusHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowStatusHeader.colSpan,10)||1)<=d&&(h.rowStatusHeader=this.groupbyDisplayOptions.rowStatusHeader)),this.groupbyDisplayOptions.rowStatusFooter&&(this.groupbyDisplayOptions.rowStatusFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowStatusFooter.colSpan,10)||1)<=d&&(h.rowStatusFooter=this.groupbyDisplayOptions.rowStatusFooter))),h.groupbyHeader=[],h.groupbyFooter=[];for(var c=this.groupbyDisplayOptions.groupbyHeader,g=0;g<c.length;g++)c[g].hidden||(p+=parseInt(c[g].colSpan,10)||1,h.groupbyHeader[g]=c[g]);var f=this.groupbyDisplayOptions.groupbyFooter;for(g=0;g<f.length;g++)f[g].hidden||(u+=parseInt(f[g].colSpan,10)||1,h.groupbyFooter[g]=f[g]);if(e<d){var m=d-p;for(g=0;g<m;g++)h.groupbyHeader.push({temp:!0})}if(i<d)for(m=d-u,g=0;g<m;g++)h.groupbyFooter.push({temp:!0});for(var y in this.groupbyStatus.excelDisplayOptions=h,h){var b,w=[];switch(y){case"rowNumHeader":case"rowNumFooter":case"rowStatusHeader":case"rowStatusFooter":w.push("<w2:column");var v=h[y],C=!1;for(var I in v)if("align"==I||"hidden"==I||"colSpan"==I){if("hidden"==I){C=!0;break}w.push(" "+I+'="'+v[I]+'"'),"rowNumHeader"!=y&&"rowNumFooter"!=y||"colspan"==I.toLowerCase()&&v[I]>=this.defaultColCnt+this.getColCnt()&&("rowNumHeader"==y?o=!0:a=!0)}if(C)break;if("rowStatusHeader"==y&&o)break;if("rowStatusFooter"==y&&a)break;y.match("rowNum")?w.push(' type="rowNum"'):y.match("rowStatus")&&w.push(' type="rowStatus"'),w.push("/>"),b=t[y];break;case"groupbyHeader":case"groupbyFooter":C=!1;var _=h[y];if(_.length>0){var x,S=0,D=0,R=0,L=0,T=this.htmlInfo?this.htmlInfo.body.rowArr:this.struct.body.rowArr;for(g=0;g<T.length;g++){for(var k=T[g],F=0;F<k.length;F++){var A=k[F];S+=parseInt(A.colSpan,10)||1}D<S&&(D=S),S=0}x=new Array(D);for(g=0;g<_.length;g++){var E=[];for(var I in E.push("<w2:column"),_[g])if("align"==I||"hidden"==I||"colSpan"==I||"rowSpan"==I||"displayFormat"==I){if("hidden"==I){E.pop();break}E.push(" "+I+'="'+_[g][I]+'"')}E.push("/>"),w.push(E.join(""));var M=parseInt(_[g].colSpan,10)||1,O=parseInt(_[g].rowSpan,10)||1;if(0===L){if(void 0===x[R])if(M>1)for(var N=0;N<M;N++)x[R+N]=O;else x[R]=O}else{x[R]>1?x[R]-=1:x[R]=O;for(var B=R+1;1!==x[B]&&B<D;)x[B]-=1,R+=1,B+=1}D<=(R+=M)&&g!=_.length-1&&(w.push("</w2:row><w2:row>"),R=0,L+=1)}}b=t[y]}b&&("H"==b.type?-1==b.index?(n[e]=w.join(""),
e++):n[b.index]=w.join(""):"F"==b.type&&(-1==b.index?(l[i]=w.join(""),i++):l[b.index]=w.join(""))),b=null}return n.push("</w2:row>"),l.push("</w2:row>"),n.push("</w2:groupbyHeader>"),l.push("</w2:groupbyFooter>"),r.push(n.join("")),r.push(l.join("")),r.push("</w2:groupby>"),r.join("")}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getExcelGroupbyHeaderValue=function(t){this.groupbyStatus.headerValueObj={},this.getAllGroupbyHeaderValueObj();var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("header"==o.type){for(var s=this.groupbyStatus.headerValueObj[o.groupId],a=0;a<s.length;a++)null!=s[a]&&(e.push('"'+s[a]+'"'),a<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},k.prototype.getExcelGroupbyFooterValue=function(t){this.groupbyStatus.footerValueObj={},this.getAllGroupbyFooterValueObj();var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("footer"==o.type){for(var s=this.groupbyStatus.footerValueObj[o.groupId],a=0;a<s.length;a++)null!=s[a]&&(e.push('"'+s[a]+'"'),a<s.length-1&&e.push(t));s.length>0&&e.push(t)}}return e.pop(),e.push("]"),e.push("]]></array>"),e.join("")},k.prototype.getExcelGroupbyStatusValue=function(t){var e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("number"==typeof o)e.push('"0B"');else{switch(o.type){case"header":var s='"'+o.depth+'H"';break;case"footer":s='"'+o.depth+'F"'}e.push(s)}i<this.groupbyStatus.groupedRowIndexArr.length-1&&e.push(t)}return e.push("]"),e.push("]]></array>"),e.join("")},k.prototype.getExcelGroupbyStyleData=function(t){var e=this.getElementById(this.id+"_body_tbody").childNodes,i=[];i.push("<array><![CDATA["),i.push("[");for(var o=0;o<this.groupbyStatus.groupedRowIndexArr.length;o++){var s=this.groupbyStatus.groupedRowIndexArr[o];if("number"!=typeof s){var a=e[s.index];if(!i[s.depth+2]){var r,n='"';for(var l in 0!=o&&(n=',"'),this.groupbyStatus.excelDisplayOptions){var h=!1;switch(l){case"rowNumHeader":h=!0,r=0;break;case"rowStatusHeader":h=!0,r=this.defaultColCnt-1;break;case"groupbyHeader":h=!0,r=this.defaultColCnt}if(h)break}var d=a.getElementsByTagName("TD")[r];""==t.groupbyColor&&(n+="background-color:"+WebSquare.style.getStyle(d,"background-color")+";"),""==t.groupbyFontSize&&(n+="font-size:"+WebSquare.style.getStyle(d,"font-size")+";"),""==t.groupbyFontColor&&(n+="color:"+WebSquare.style.getStyle(d,"color")+";"),n+="font-weight:"+WebSquare.style.getStyle(d,"font-weight")+";",""==t.groupbyFontName&&(n+="font-family:"+WebSquare.style.getStyle(d,"font-family")+";"),n+='"',i[s.depth+2]=n}}}return i.push("]"),i.push("]]></array>"),i.join("")},k.prototype.getAllGroupbyHeaderValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumHeader),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusHeader),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyHeader.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyHeader[o]),i++}},k.prototype.getAllGroupbyFooterValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumFooter),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusFooter),
i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyFooter.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyFooter[o]),i++}},k.prototype.getGroupbyData=function(t){try{if(this.options.groupbyZone&&this.groupbyStatus&&this.groupbyStatus.grouped)return!1===t?this.groupbyStatus.groupbyOptions:JSON.parse(this.groupbyStatus.groupbyOptions)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setGroupbyData=function(t,e,i){try{var o,a,r=(i=i||{}).value||"",n=i.inputType||"",l=i.depthVisible||!1,h=i.expression||"",d=i.hidden?"none":"",u=i.displayFormatType||"text",p=i.displayFormat||"",c=i.displayFormatter||null;if(n)switch((p||c)&&(o=new WebSquare.format.createFormatter(u,p,c,null,null,null,this.scope_id,this.id)),n){case"toggleButton":a="open"==t.status?"-":"+";break;case"expression":if(h){var g=this.groupbyInfo[t.groupId].header;g.colIndex=e;var f=0;if("open"==g.status){for(var m,y=g.index;y<this.groupbyStatus.groupedRowIndexArr.length;y++){if("footer"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}if(!m){for(y=g.index+1;y<this.groupbyStatus.groupedRowIndexArr.length;y++){var b;if("header"==(b=this.groupbyStatus.groupedRowIndexArr[y]).type&&b.depth==g.depth){m=b.index;break}}m||(m=this.groupbyStatus.groupedRowIndexArr.length-1)}f=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,g.index,m,h,g)}else f=this.groupExpression(g.closedChildArr,0,g.closedChildArr.length-1,h,g);if(o&&(f=o.format(f)),"string"==typeof(a=f)&&(a.match("w2grid_minus")||a.match("w2grid_plus"))){var w=a.lastIndexOf("</span>");w>-1&&(w+=7,a=a.slice(w),"open"==t.status?a="-||"+a:"closed"==t.status&&(a="+||"+a))}}}if(l&&(a=t.groupId),r&&(o&&(r=o.format(r)),a=r),!a){a="";y=0;for(var v in i)y++;0==y&&(d="none")}"none"!=d&&("header"==t.type?(this.groupbyStatus.headerValueObj[t.groupId]||(this.groupbyStatus.headerValueObj[t.groupId]=[]),this.groupbyStatus.headerValueObj[t.groupId][e]=a):"footer"==t.type&&(this.groupbyStatus.footerValueObj[t.groupId]||(this.groupbyStatus.footerValueObj[t.groupId]=[]),this.groupbyStatus.footerValueObj[t.groupId][e]=a))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getTotalRow=function(){return this.dataList.getTotalRow()},k.prototype.getTotalCol=function(){return this.oneRowDataLength},k.prototype.editEndBeforeGetData=function(){this.editedCell&&this.rollbackCommitFlag&&1==this.options.rollbackCommit&&(1==this.options.moveKeyEditModeAll&&1==this.checkScrollEnd||(this.rollbackCommitFlag=!1,this.editedCell.handleEndEdit(),this.rollbackCommitFlag=!0))},k.prototype.getExtraDataObj=function(t,e,i){var o=this.extraData;return"grid"==t?o.grid:"row"==t?(o.row[e]||(o.row[e]={}),o.row[e]):"col"==t?(o.col[e]||(o.col[e]={}),o.col[e]):"cell"==t?(o.cell[e]||(o.cell[e]=[]),o.cell[e][i]||(o.cell[e][i]={}),o.cell[e][i]):null},k.prototype.finalize=function(){try{for(var t in null!=this.tempDiv&&null!=this.tempDiv.parentNode&&(this.tempDiv.innerHTML=""),null!=this.tempTr&&null!=this.tempTr.parentNode&&(this.tempTr.innerHTML=""),n.s.removeCheckResize(this.uuid),r.D.clearInterval(this.id+"_dragSelectAutoScroll"),a.v.clearTimer(this.id+"initializeEvent"),a.v.clearTimer(this.id+"_autofit"),this.dom)this._removeDom(t);for(var e in this._dataList&&this._dataList.childCompHash&&delete this._dataList.childCompHash[this.id],null!=this._manager&&this._manager.destroy(),null!=this.customFilter&&this.customFilter.remove(),this.cellInfoHash){var i=this.cellInfoHash[e];i&&i.comp&&"function"==typeof i.comp.remove&&i.comp.remove()}this.orgSubtotalHeightArr=[]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setFixedColumn=function(t){try{t=parseInt(t,10),t=isNaN(t)?0:t;var e=0;if(!(t<this.getColumnCount()))return;if(t>0){this.getFixedColumnLastIndex();for(var i=0;i<=t+this.defaultColCnt;i++)this.hiddenList[i]||(e+=this.colWidthList[i])}if(e>this.getElementById(this.id+"_dataLayer").offsetWidth)return;if(this.options.fixedColumn>0){var o=this.getColumnCount()
;for(i=0;i<this.lastIndex+1;i++){var a=this.data_td_list[i*o+this.options.fixedColumn];a&&this.removeClass(a,"w2grid_fixedColumn");var r=parseInt(this.options.fixedColumn);if(t<r)for(var n=t;n<r;n++){var l=this.data_td_list[i*o+n];l&&this.removeClass(l,"w2grid_fixedColumn_td")}}}this.options.fixedColumn=t,this.options.fixedColumnScrollReset&&this.setScrollLeft(0),this.arrangeOverflowXScroll(),this.displayFixedColumnLine()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setFixedRightColumn=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRightColumn>0)for(var e=this.getColumnCount(),i=this.getFixedRightColumnLastIndex()-this.defaultColCnt,o=0;o<this.lastIndex+1;o++){var a=this.data_td_list[o*e+i];if(a&&this.removeClass(a,"w2grid_fixedRightColumn"),i<e-t)for(var r=e-t-1;r>=i;r--){var n=this.data_td_list[o*e+r];n&&this.removeClass(n,"w2grid_fixedRightColumn_td")}}this.options.fixedRightColumn=t,this.arrangeOverflowXScroll(),this._handleScrollX()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.options.fixedRow-1)];e&&this.removeClass(e,"w2grid_fixedRow")}this.options.fixedRow=t,this.applyRowStyleOptions(t-1)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setLastFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.lastFixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.lastIndex-this.options.lastFixedRow)];e&&this.removeClass(e,"w2grid_lastFixedRow")}this.options.lastFixedRow=t,this.drawData(this.rowIndex,this.lastIndex-t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getOverflowX=function(){return this.options.overflowX},k.prototype.getOverflowY=function(){return this.options.overflowY},k.prototype.getColumnVisible=function(t){try{var e=t,i=(t=this.getColumnIndex(t),a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/getColumnVisible/@useRealColIndex"));if(r.D.getBoolean(i)){if("number"!=typeof e){for(var o=this.getCellInfo(e),n=this._getRealColIndex("body",e),l=n+this.defaultColCnt,h=!this.hiddenList[l],d=0;d<o.options.colSpan;d++)h=!this.hiddenList[l+d]||h;return 0===n||n?h:void p.k.printLog("[getColumnVisible] 존재하지 않는 body 컬럼입니다.")}t=e%this.columnOrder.length;for(var u=0;u<this.columnOrder.length;u++)if(this.columnOrder[u]==t){t=u;break}if(e>this.columnOrder.length||u===this.columnOrder.length)return void p.k.printLog("[getColumnVisible] 존재하지 않는 body 컬럼입니다.")}return!this.hiddenList[this.defaultColCnt+t]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getColumnWidth=function(t,e){try{var i=e?this.defaultColCnt:0;if(t=this.getColumnIndex(t)+i,this.colWidthList[t])return this.colWidthList[t]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnWidth=function(t,e,i){try{if(!this.render)return void p.k.printLog("[setColumnWidth] "+this.options.pluginName+" is not initialized yet");if(0===this.render.offsetHeight&&0===this.render.offsetWidth){var o=!1;if("string"==typeof t&&(o=!0,t=this.getDisplayColumnIndex(t)),this.delayedDrawObj.newColumnOrder)for(var a=0;a<this.delayedDrawObj.newColumnOrder.length;a++)if(this.delayedDrawObj.newColumnOrder[a]==t){t=o?this.delayedDrawObj.newColumnOrder[a]:a;break}}else t=this.getDisplayColumnIndex(t);var r=this.colWidthList[t],n=!0===i?0:this.defaultColCnt;if(this.colWidthList[t]){this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!0),this.options.autoFit&&!this.hiddenList[t+n]?(this.autoFitColWidthList=null,this._setAutoFit({exceptCol:n+t,exceptWidth:e})):this._setColumnWidth(n+t,e),this.__bResizeObj&&(this.__bResizeObj.isColumnResizing=!1);var l=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],h=WebSquare.Elem.api.getElementsByTagName(l,"w2:column");for(a=0;a<h.length;a++){var d=h[a],c=d.getAttribute("id");if(this.getHeaderIndex(c)+n==t+n){d.setAttribute("width",e+"");break}}}i&&(t-=this.defaultColCnt),
u.B.fireEvent(this,"oncolumnwidthchange",{columnIndex:t,columnID:this.getColumnID(t),oldWidth:r,newWidth:e})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.isColumnResizable=function(t){try{if(t<this.defaultColCnt)return!0===this.options.rowNumStatusResize;if(void 0===t||""===t)return!1;if(isNaN(t)&&(t=this.getColumnIndex(t)+this.defaultColCnt),isNaN(t)||t>=this.getColumnCount()+this.defaultColCnt)return!0;for(var e,i=!0,o=0;o<this.htmlInfo.head.rowArr.length;o++)for(var a=this.htmlInfo.head.rowArr[o],n=0;n<a.length;n++)if(a[n].colIndex==this.columnOrder[t]&&"string"==typeof a[n].fixColumnWidth&&"true"===a[n].fixColumnWidth.toLowerCase()){i=!1;break}if(!this.cellInfoHash||r.D.isEmptyObject(this.cellInfoHash))(e=this.cellInfoHash2[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&!0===r.D.getBoolean(e.getAttribute("fixColumnWidth"))&&(i=!1);else(e=this.cellInfoHash[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&e.options.fixColumnWidth&&(i=!1);return i}catch(t){return s.w.printStackTrace(t,null,this),!0}},k.prototype.setColumnDisableEdit=function(t,e){try{var i=this.getCellInfo(t);"autoComplete"==i.options.inputType&&i.setColumnDisableEdit(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnNodeSet=function(t,e,i,o){try{var a=this.getCellInfo(t);("select"==a.options.inputType||"autoComplete"==a.options.inputType||"checkcombobox"==a.options.inputType)&&a.setColumnNodeSet(e,i,o),a.hasRef&&(a.refHash=[]),a.itemsetObj&&a.mainGrid.refresh()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnGridItemset=function(t,e){try{var i=this.getCellInfo(t);("select"==i.options.inputType||"autoComplete"==i.options.inputType||"checkcombobox"==i.options.inputType)&&i.setColumnGridItemset(e),i.hasRef&&(i.refHash=[]),i.itemsetObj&&i.mainGrid.refresh()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);if(i.options.displayFormat=e,i._changeDisplayFormat=!0,i.options.embeddedInput)for(var o=WebSquare.format.createFormatter(i.options.dataType,i.options.displayFormat,i.options.displayFormatter,i.options.ioFormat,null,null,i.mainGrid.scope_id,i.mainGrid.id),a=0;a<i.mainGrid.getDataLength();a++){var r=i.mainGrid.dataList._getCellData(a,t);t=i.mainGrid.getColumnIndex(t);var n=i.mainGrid.data_td_list[t+a*i.mainGrid.oneRowDataLength],l=i.mainGrid.getInput(i,n,r);l&&(l.formatter=o)}return i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnIoFormat=function(t,e,i){try{"object"===(0,l.Z)(arguments[0])?this._setColumnIoFormat(arguments[0]):this._setColumnIoFormat({colIndex:t,ioFormat:e,dateMask:i})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setColumnIoFormat=function(t){try{var e=t.colIndex,i=t.ioFormat,o=t.dateMask,a=t.useMonthYearFormat,r=t.calendarDisplayFormat,n=this.getCellInfo(e);if(!n||"date"!==n.options.dataType)return;var l=!1,h=n.options.ioFormat;if("string"==typeof i&&(l=i!==h,n.options.ioFormat=i),"string"==typeof o&&(n.options.displayFormat=o),"calendar"===n.options.inputType&&(n.options.useMonthYearFormat=a,"string"==typeof r&&(n.options.calendarDisplayFormat=r)),n.initFormatter(),!0===l){var d=this.getInput(n);if(d&&"function"==typeof d.setIoFormat){t={ioFormat:i,displayFormat:o,useMonthYearFormat:a,calendarDisplayFormat:r};d.setIoFormat(t)}if(n.options.useMonthYearFormat)this.drawColumnData(e);else for(var u=this.getRowCount(),p=WebSquare.format.createFormatter(n.options.dataType,i,"",h,null,null,this.scope_id,this.id),c=0;c<u;c++){var g=this.dataList._getCellData(c,n.colID),f=p.format(g);this.dataList.__setCellData(c,n.colID,f)}}else this.drawColumnData(e)}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.setColumnEditFormat=function(t,e){try{t=this.getColumnIndex(t);var i=this.getCellInfo(t),o=i.id,a=i.options.inputType;if("text"!=a&&"input"!=a)return $l("cell의 inputType이 올바르지 않습니다."),!1;var r=this.getInput(i);if(r&&r.options&&"input"===r.options.pluginName){i.options.editFormat=e,r.setEditFormat(e);for(var n=this.getTotalRow(),l=0;l<n;l++){var h=this.dataList.getCellData(l,o),d=WebSquare.text.dynamicMask(h,r._editFormat,r._editTokens);this.dataList.setCellData(l,o,d.orgValue)}this.drawColumnData(t)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnChooseOption=function(t,e,i){try{var o=this.getCellInfo(t);"select"==o.options.inputType&&o.setColumnChooseOption(e,i)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnVisibleColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setVisibleColumn&&o[o.options.inputType].setVisibleColumn(e,i))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnEnableColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setEnableColumn&&o[o.options.inputType].setEnableColumn(e,i))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDisplayMode=function(t,e){try{if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var i=this.getCellInfo(t);if(!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]){var o=i.options.displayMode;i.options.displayMode=e,i._initDisplayMode(),o!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDisplayMode(e),i.resetMatchInfo=!0,this.drawColumnData(t))}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDelimiter=function(t,e){try{var i=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[i.options.inputType]&&i.options.delimiter!=e&&(i.options.delimiter=e||"\t","0"!=i.options.displayMode&&"3"!=i.options.displayMode&&(i[i.options.inputType]&&i[i.options.inputType].setDelimiter(e),i.resetMatchInfo=!0,this.drawColumnData(t)))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.showChooseOption=function(t,e){try{var i=this.getCellInfo(t);"select"==i.options.inputType&&i.showChooseOption(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setRowNumColumnWidth=function(t){this.options.rowNumVisible&&!isNaN(Number(t))&&this._setColumnWidth(0,t)},k.prototype.setRowStatusColumnWidth=function(t){var e=0;this.options.rowNumVisible&&(e=1),this.options.rowStatusVisible&&(this.options.autoFit&&!this.hiddenList[e]?(this.autoFitColWidthList=null,this._setColumnWidth(e,t),this._setAutoFit()):this._setColumnWidth(e,t))},k.prototype.setGridHeight=function(t){try{parseInt(t)+""==t&&(t+="px"),this._setGridHeightBefore(),this.setStyle("height",t),this.handleScrollY({},{changedHeight:!0}),this.handleResize(),this._setGridHeightAfter()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setGridHeightBefore=function(t){try{this._onSetHeight=!0,this.lastTopRowIndex=null,-1!==this.options.initFixedHeightByRowNum&&(this.options.initFixedHeightByRowNum=-1,this.options.visibleRowNum="")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setGridHeightAfter=function(t){try{this._onSetHeight=!1}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setGridWidth=function(t){parseInt(t)+""==t&&(t+="px"),this.setStyle("width",t),this.handlerResize_drawInitializer()},k.prototype.setGridSize=function(t,e){var i=parseInt(t),o=parseInt(e);i>=0&&o>=0?(this.setGridWidth(t),this.setGridHeight(e)):p.k.printLog("[Warning] Number of Entered in the width and height must be a valid integer greater than 0.["+this.id+"]")},k.prototype.setGridReadOnly=function(t){try{
t=r.D.getBoolean(t),this.options.readOnly=t,this.notifyDataChanged()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getGridReadOnly=function(){try{return this.options.readOnly}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.initGrid=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.removeAllFinish=!0,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1;var t=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:t,row:{},init:!1},this.clearCellVisible({skipDraw:!0}),this.initHeightCompleted=!1,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj();var e=this.dataList.removeAll();return this.removeAllFinish=!1,this.dataList.clearFilter(),this.initColumns(),e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setInitValue=function(){try{this.initGrid()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);return i.element&&i.element.setAttribute("displayFormat",e),i.options.displayFormat=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setFormat=function(t,e){try{var i=this.getCellInfo(t);if(e.ioFormat){var o=i.mainGridId+i.id,a=this.dom[o];a&&a.setFormat({ioFormat:e.ioFormat,displayFormat:e.ioFormat});for(var r=WebSquare.format.createFormatter("date",e.ioFormat,"",i.options.ioFormat,null,null,this.scope_id,this.id),n=0;n<this.getDataLength();n++){var l=this.getColumnID(t),h=this.dataList._getCellData(n,l),d=r.format(h);this.dataList.__setCellData(n,l,d)}}return i.options.ioFormat=e.ioFormat||i.options.ioFormat,i.options.displayFormat=e.displayFormat||i.options.displayFormat,i.options.displayFormatter=e.displayFormatter||i.options.displayFormatter,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCustomFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.customFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setAllowChar=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return $l("cell의 inputType이 올바르지 않습니다."),!1;var a=this.getInput(i);return i.options.allowChar=e,void(a&&a.options&&("input"===a.options.pluginName||"textarea"===a.options.pluginName)&&a.setAllowChar(e))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.changeCurrency=function(t,e,i,o,a,r,n){try{return 1===arguments.length&&"object"===(0,l.Z)(arguments[0])?this._changeCurrency(arguments[0]):this._changeCurrency({colID:t,type:e,format:i,delimiter:o,decimalDelimiter:a,customModelFormatter:r,customModelUnformatter:n})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._changeCurrency=function(t){try{var e=t.colID||"",i=t.type||"",o=t.format,r=t.delimiter||"",n=t.decimalDelimiter||"",l=t.customModelFormatter,h=t.customModelUnformatter,d=this.getColumnIndex(e),u=this.getCellInfo(d);if(!i||"float"!==i&&"number"!==i&&"euro"!==i&&"rupee"!==i&&"tenge"!==i)return;"number"===i&&"true"===this.options.floatNumber&&(i="float");var p=i;switch(i){case"number":case"float":case"bigDecimal":p="number",o||(this.options.numberMask||(this.options.numberMask=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/numberMask/@value')||""),o=this.options.numberMask),u.options.delimiter=r||",",u.options.decimalDelimiter=n||".";break;case"euro":o||(this.options.euroMask||(this.options.euroMask=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/euroMask/@value')||""),o=this.options.euroMask),u.options.delimiter=r||".",
u.options.decimalDelimiter=n||",";break;case"rupee":o||(this.options.rupeeMask||(this.options.rupeeMask=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/rupeeMask/@value')||""),o=this.options.rupeeMask),u.options.delimiter=r||",",u.options.decimalDelimiter=n||".";break;case"tenge":o||(this.options.tengeMask||(this.options.tengeMask=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/tengeMask/@value')||""),o=this.options.tengeMask),u.options.delimiter=r||" ",u.options.decimalDelimiter=n||","}if(!o)return;u.options.dataType=i,u.options.displayFormat=o,void 0!==l?u.options.customModelFormatter=l:u.options.customModelFormatter||(u.options.customModelFormatter=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/customModelFormatter/@value')||""),void 0!==h?u.options.customModelUnformatter=h:u.options.customModelUnformatter||(u.options.customModelUnformatter=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+p+'"]/customModelUnformatter/@value')||""),u.initFormatter(),this.drawColumnData(d),this.subtotalObj={},this.refreshSubtotalRow(0,{changeCurrency:!0}),this.hasFooter&&(this.initFooterDataObj(!0),this.drawFooter(d));var c=u.mainGridId+u.id;delete this.dom[c]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDataType=function(t,e,i){try{if(!e||"number"!=e&&"text"!=e&&"float"!=e&&"date"!=e)return;var o=this.getCellInfo(t);if(o.options.dataType==e)return;o.options.dataType;o.options.dataType=e;var a=this.getColumnID(t);this.setColumnOption(a,"dataType",e);var r=o.mainGrid.getElementById(o.mainGridId+a);if(o.options.displayFormat="",r){switch(r.validator.clearCommand(),e){case"number":r.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9"));break;case"float":r.validator.addCommand(new WebSquare.validator.floatCommand(r.options.delimiter,r.options.decimalDelimiter,r.options.applyFormat))}var n=r.options.maxlength&&parseInt(r.options.maxlength)>-1?r.options.maxlength:null;n||(n=r.options.maxLength&&parseInt(r.options.maxLength)>-1?r.options.maxLength:null),n&&("float"==e?(o.setFloatMaxLength(n),r.render&&"input"==r.render.tagName.toLowerCase()&&r.render.removeAttribute("maxLength")):o.setMaxLength(n))}o.initFormatter(),o._changeDisplayFormat=!0,i&&i.displayFormat&&this.setColumnDisplayFormat(t,i.displayFormat),o.mainGrid.refreshColumn(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDefaultDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!==i.options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;var o=this.getInput(i);i.options.defaultDate=e,o&&o.setDefaultDate(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.disableBeforeDate=function(t,e){this.setDisableBeforeDate(t,e)},k.prototype.setDisableBeforeDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var a=0;a<this.drawedRowLength;a++){var r=this.data_td_list[t+a*this.oneRowDataLength];r&&(i=this.getInput(o,r))&&i.setDisableBeforeDate(e)}else(i=this.getInput(o))&&i.setDisableBeforeDate(e);o.options.disableBeforeDate=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.disableAfterDate=function(t,e){this.setDisableAfterDate(t,e)},k.prototype.setDisableAfterDate=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var a=0;a<this.drawedRowLength;a++){var r=this.data_td_list[t+a*this.oneRowDataLength];r&&(i=this.getInput(o,r))&&i.setDisableAfterDate(e)}else(i=this.getInput(o))&&i.setDisableAfterDate(e);o.options.disableAfterDate=e}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.setDisableBeforeMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var a=0;a<this.drawedRowLength;a++){var r=this.data_td_list[t+a*this.oneRowDataLength];r&&(i=this.getInput(o,r))&&i.setDisableBeforeMonth(e)}else(i=this.getInput(o))&&i.setDisableBeforeMonth(e);o.options.disableBeforeMonth=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDisableAfterMonth=function(t,e){try{var i,o=this.getCellInfo(t);if("calendar"!==o.options.inputType)return $l(WebSquare.language.getMessage("Grid_incorrect_inputType")),!1;if(o.options.embeddedInput)for(var a=0;a<this.drawedRowLength;a++){var r=this.data_td_list[t+a*this.oneRowDataLength];r&&(i=this.getInput(o,r))&&i.setDisableAfterMonth(e)}else(i=this.getInput(o))&&i.setDisableAfterMonth(e);o.options.disableAfterMonth=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setMaxLength=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"textarea"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o&&"autoComplete"!=o)return;"text"==o&&"float"==i.options.dataType?i.setFloatMaxLength(e):i.setMaxLength(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getMaxLength=function(t){try{var e=this.getCellInfo(t),i=e.options.inputType;if("text"!=i&&"textarea"!=i&&"input"!=i&&"textImage"!=i&&"secret"!=i)return;return e.options.maxLength}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.spanAll=function(t){try{"number"==typeof t?this.showDepth=t+"":(t=r.D.getBoolean(t),this.showDepth=1==t?"9999":"1"),this.initDrilldown(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.drawData(0,0),this.setScrollYHeight({noDraw:!0}),this.drawFooter(),this.displayNoResultMessage(),this.displayFixedColumnLine()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCellDisplayData=function(t,e){try{var i=(this._linkedDataList||this._dataList).getRealRowIndex(t);return this._getDisplayData(i,e)}catch(t){s.w.printStackTrace(t)}},k.prototype._getCellDisplayData=function(t,e,i){try{i=i||{},"string"==typeof e&&(e=e.trim());var o=this.getRealRowIndex(t);return this._getDisplayData(o,e,i)}catch(t){s.w.printStackTrace(t)}},k.prototype._getDisplayData=function(t,e,i){try{i=i||{},this.editEndBeforeGetData();e=this.getColumnID(e);var o=this.getColumnIndex(e),a=this.cellInfoHash[e];0==a.internal&&"custom"==a.options.inputType&&a.cellManagerHashByRowIndex[t]&&(a=a.cellManagerHashByRowIndex[t]);var n=this.dataList._getData(t,e),l=this.getDisplayRowIndex(t),h=this._getGroupbyDisplayRowIndex(l);if(a.options.customModelUnformatter){var d=r.D.getGlobalFunction(a.options.customModelUnformatter,this.scope_id);"function"==typeof d&&(n=d.call(this,n,h,o))}if(a.options.maskFormat&&a.options.displayFormat&&(n=this.getInput(a[o]).maskFormatModelUnFormat(n)),a.useEscapeFormatter){var u=r.D.getGlobalFunction(a.options.escapeFormatter,this.scope_id);"function"==typeof u&&(n=u.call(this,n,h,o))}if(a.useCustomFormatter&&1!=this.options.keepBeforeDisplayData){var p="true"===a.getEscape()?a.getDisplayData(WebSquare.xml._encode(n+""),t):a.getDisplayData(n,t),c=r.D.getGlobalFunction(a.options.customFormatter,this.scope_id);"function"==typeof c&&(n=this.options.customFormatterRealRowIndex?c.call(this,n,p,t,o):c.call(this,n,p,h,o))}else 0==a.internal&&"custom"==a.options.inputType&&(a=a.cellManagerHashByRowIndex[t]?a.cellManagerHashByRowIndex[t]:a),n=a.getDisplayData(n,t,i);if(!0===i.removeTag){var g=document.createElement("div");g.innerHTML=n,n=g.innerText}return null==n&&(n=""),n}catch(t){s.w.printStackTrace(t)}},k.prototype.initPasteDrilldown=function(){try{var t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""};"string"==typeof t.depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",
t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.pasteDrilldownInitialize(this,t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.initDrilldown=function(t){try{"string"==typeof(t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""}).depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.initialize(this,t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getRealRowIndex=function(t){return this.dataList.getRealRowIndex(t)},k.prototype.toggle=function(t){try{if("number"!=typeof t)return!1;var e=t;if(this.options.drilldownRealRowIndexAll&&"number"!=typeof(e=this.getDisplayRowIndex(t)))return!1;this._toggle(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._toggle=function(t){try{t=parseInt(t),this.drilldown.toggle(t);var e={};this.options.drilldownToggleScrollFix&&(e.keepScrollTop=!0),this.lastTopRowIndex=null,!0===this._isHybridScroll()?this.hasSubtotal&&(e.keepHybridHash=!0):this.setScrollYHeight(e),this.notifyRowChanged(t,e),this.options.autoFit&&this.autoFitFunc()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.drillTo=function(t){try{var e=this.drilldown.drillTo(t),i=this.options.drilldownToggleScrollFix?{keepScrollTop:!0}:null;this.setScrollYHeight(i),this.notifyRowChanged(e,i),this.options.autoFit&&this.autoFitFunc()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getParentRowIndex=function(t){return t=parseInt(t),this.drilldown.getParentRowIndex(t)},k.prototype.getChildrenRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildrenRowArr(t)},k.prototype.getAncestorRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getAncestorRowArr(t)},k.prototype.getDescendantRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildRowArr(t,!0)},k.prototype.getOpenStatus=function(t){var e=t=parseInt(t);return(!this.options.drilldownRealRowIndexAll||"number"==typeof(e=this.getDisplayRowIndex(t)))&&this.drilldown.isOpen(e)},k.prototype.getDataLength=function(){var t;if(this.successBinding)if(this.groupbyStatus.grouped){for(var e in this.customFilterStatusObj)if(this.customFilterStatusObj[e])return this._dataList.getDataLength();t=this.groupbyStatus.groupedRowIndexArr.length}else t=this._dataList.getDataLength();else t=0;return t},k.prototype.focusedRowMoveUp=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUp(t)},k.prototype.focusedRowMoveDown=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDown(t)},k.prototype.focusedRowMoveUpFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUpFiltered(t)},k.prototype.focusedRowMoveDownFiltered=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDownFiltered(t)},k.prototype.initStyleArr=function(t){t<=0&&(this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[]);var e=this.getTotalRow(),i=e*this.oneRowDataLength;t<=0?(this.rowStyleArr=new Array(e),this.rowReadOnlyArr=new Array(e),this.rowDisabledArr=new Array(e),this.rowStyleFixedArr=new Array(e),this.rowStyleDataArr=new Array(e),this.cellStyleArr=new Array(i),this.cellClassArr=new Array(i),this.cellReadOnlyArr=new Array(i),this.cellDisabledArr=new Array(i),this._cellSelectedIndex=new Array(i)):(this.rowStyleArr[e-1]=void 0,this.rowStyleFixedArr[e-1]=void 0,this.rowStyleDataArr[e-1]=void 0,this.rowReadOnlyArr[e-1]=void 0,this.rowDisabledArr[e-1]=void 0,this.cellStyleArr[i-1]=void 0,this.cellClassArr[i-1]=void 0,this.cellReadOnlyArr[i-1]=void 0,this.cellDisabledArr[i-1]=void 0,this._cellSelectedIndex[i-1]=void 0)},k.prototype.modifyCheckedStatus=function(t,e){try{var i=this.getCheckedIndex(t);if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage()
;this.notifyStatusChanged({rowIndex:i})}else p.k.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.modifyUncheckStatus=function(t,e){try{if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var i=this.getUnCheckedIndex(t),o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else p.k.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getVisibleColData=function(t){var e=[];t=this.getColumnIndex(t);for(var i=this.getColumnID(t),o=this.getDataLength(),s=0;s<o;s++)e.push(this.dataList._getCellData(s,i));return e},k.prototype.getCheckedIndex=function(t,e){try{var i,o=[],a=[],r=0,n=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==n.options.inputType||"radio"==n.options.inputType||"custom"==n.options.inputType){i=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var h=n,d=0;d<i.length;d++){if(0==n.internal&&"custom"==n.options.inputType){var u=this.dataList.getRealRowIndex(d);if("checkbox"!=(h=n.cellManagerHashByRowIndex[u]?n.cellManagerHashByRowIndex[u]:n).options.inputType&&"radio"!=h.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==(0,l.Z)(this.dataList.getRealRowIndex(d)))continue;if(e){a.push(d);var p=!(!this.isDrillDown||!this._dataList.options.depthColumn);this.___getEditReadOnly(d,t,p)||this._getEditDisabled(d,t,p)?r++:i[d]==h.options.trueValue&&o.push(d)}else i[d]==h.options.trueValue&&o.push(d)}}return e&&r!==a.length&&r+o.length==a.length?a:o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getUnCheckedIndex=function(t){return this.getUncheckedIndex(t)},k.prototype.getUncheckedIndex=function(t){try{var e=[],i=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==i.options.inputType||"radio"==i.options.inputType||"custom"==i.options.inputType){var o=[];o=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var a=i,r=0;r<o.length;r++){if(0==i.internal&&"custom"==i.options.inputType){var n=this.dataList.getRealRowIndex(r);if("checkbox"!=(a=i.cellManagerHashByRowIndex[n]?i.cellManagerHashByRowIndex[n]:i).options.inputType&&"radio"!=a.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==(0,l.Z)(this.dataList.getRealRowIndex(r)))continue;o[r]!=a.options.trueValue&&e.push(r)}}return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getAllDisplayData=function(){try{var t=this._linkedDataList||this._dataList;if(t.getTotalRow()==t.getDataLength())return this.getAllVisibleData();this._endEdit();for(var e=this.getTotalRow(),i=this.getColumnCount(),o=[],a=0;a<e;a++)for(var r=0;r<i;r++)o.push(this._getDisplayData(a,r));return o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getAllDisplayJSON=function(t){try{t||(t={emptyValue:"$$_blank_"});var e=this._linkedDataList||this._dataList;if(e.getTotalRow()==e.getDataLength())return this.getAllVisibleJSON(t);this._endEdit();for(var i=this.getTotalRow(),o=this.getColumnCount(),a=[],r=0;r<i;r++){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._getDisplayData(r,l,t);a.push(n)}return a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getAllVisibleJSON=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),a=[],r=0;r<i;r++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[r]){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._grid._getCellDisplayData(r,l,t);a.push(n)}return a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getAllDisplayXML=function(){try{var t=this._linkedDataList||this._dataList
;return t.getTotalRow()==t.getDataLength()?this.getAllVisibleXML("displayData"):(this._endEdit(),this.getAllArrXML("displayData",this.id))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getAllVisibleXML=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=[],a=0;a<i;a++)e&&"number"!=typeof this.groupbyStatus.groupedRowIndexArr[a]||o.push(a);return this.getArrXML(o,t,e)}catch(t){s.w.printStackTrace(t)}},k.prototype.getAllVisibleData=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),a=[],r=0;r<i;r++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[r])for(var n=0;n<o;n++)"displayData"===t?a.push(this._getCellDisplayData(r,n)):a.push(this.dataList.getCellData(r,n));return a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.changeToRealRowIndexArr=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCheckedXML=function(t){try{this._endEdit();var e=this.getCheckedIndex(t);return this.getArrXML(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getUncheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getUncheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getUncheckedXML=function(t){try{this._endEdit();var e=this.getUncheckedIndex(t);return this.getArrXML(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCellChecked=function(t,e){try{var i=this.cellInfoHash[this.getColumnID(e)],o=i.id;if(0==i.internal&&"custom"==i.options.inputType){var a=this.dataList.getRealRowIndex(t);i=i.cellManagerHashByRowIndex[a]?i.cellManagerHashByRowIndex[a]:i}if("checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)return!1;var r=this.dataList._getCellData(t,o);return r=r==i.options.trueValue}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.hasChild=function(t){return this.drilldown.hasChild(t)},k.prototype.comparator=function(t,e){return parseInt(e)==parseInt(t)?0:parseInt(e)>parseInt(t)?1:-1},k.prototype.getExcelAllXML=function(t){try{var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=0;i<this.getDataLength();i++)for(var o=0;o<this.getTotalCol();o++)e.push(this.dataList._getCellData(i,this.getColumnID(o))),e.push('","');return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getExcelAllXMLDisplay=function(t){try{null==t&&(t=1);var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=this.getDataLength(),o=this.getColumnCount(),a=0;a<i;a++)for(var r=0;r<o;r++){var n,l=this.getCellInfo(r);if("custom"==l.options.inputType){var h=this.dataList.getRealRowIndex(a);l.cellManagerHashByRowIndex[h]||(this.drawData(a),l=l.cellManagerHashByRowIndex[h]||l)}(n=l.useCustomFormatter||"custom"==l.options.inputType?this._getDisplayData(this.dataList.getRealRowIndex(a),r):1==t?l.getDisplayData(this.dataList._getCellData(a,this.getColumnID(r)),a):this.dataList._getCellData(a,this.getColumnID(r))+"").indexOf("javascript:")>-1&&(n=n.wq_replaceAll("javascript:","")),
e.push(n),e.push('","')}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getExcelAllXMLRaw=function(t){try{var e=this.dataArr.length,i=this.dataArr[0],o=this.dataArr[e-1];this.dataArr[0]='<array><![CDATA[["'+i,this.dataArr[e-1]=o+'"]]]></array>';var a=this.dataArr.join('","');return this.dataArr[0]=i,this.dataArr[e-1]=o,a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.makeExcelData=function(t,e,i,o){try{var n=e.length,l=t+i.rowsByN;l=l<i.dataLength?l:i.dataLength;var h,d=this.oneRowDataLength,u=i.separator||",";if(i.convertIndex&&(h=i.convertIndex.split(",")),""==i.dataProvider&&""==i.splitProvider)if(0===i.type)for(var p=t;p<l;p++){if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(var c=0;c<d;c++){var g=!1;if(h)for(var f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelDisplayData(b,c,e,i,p)).length:(e=this._getExcelRealData(b,c,e,i)).length}}else if(1===i.type||2==i.type)for(p=t;p<l;p++){if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(c=0;c<d;c++){g=!1;if(h)for(f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelRealData(b,c,e,i)).length:(e=this._getExcelDisplayData(b,c,e,i,p)).length}}else l=i.dataLength,n=(e=this.dataList.getAllData()).length;var m=this;if(l<i.dataLength&&""==i.dataProvider&&""==i.splitProvider)if(!1!==i.massStorage)this.excelTime=setTimeout((function(){try{!0===i.showConfirm&&window.gridExceldownloadIframe.contentWindow.checkUpload(e.length/m.dataArr.length)}catch(t){s.w.printStackTrace(t,null,this)}if(0!=i.multiexcel)return m.makeExcelData(l,e,i,o);m.makeExcelData(l,e,i,o)}),10);else{if(0!=i.multiexcel)return this.makeExcelData(l,e,i,o);this.makeExcelData(l,e,i,o)}else{var y;if(""==i.dataProvider&&""==i.splitProvider)if(e.length>=2){if(i.groupby&&this.groupbyStatus.grouped&&this.defaultColCnt>0){var b=1,w=this.oneRowDataLength,v=[];for(p=0;p<e.length;p++){if((p%w==0||0==p)&&(b=parseInt(p/w,10),this.options.rowNumVisible&&v.push(b+1),this.options.rowStatusVisible)){var C=this.getRowStatus(b);v.push(C)}v.push(e[p])}n=(e=v).length}if(n>0){var I=e[0],_=e[n-1];e[0]='<array><![CDATA[["'+I,e[n-1]=_+'"]]]></array>',y=e.join('"'+u+'"'),e[0]=I,e[n-1]=_}else y="<array><![CDATA[["+e+"]]]></array>"}else{y="<array><![CDATA[["+(1===e.length?'"'+e[0]+'"':"")+"]]]></array>"}else y="<array><![CDATA[[ ]]]></array>";if(!0===i.showConfirm)this.excelOptions=i,this.excelInfoArr=o,this.excelFinalStr=y,this.checkUpload();else{if(0!=i.multiexcel)return this.sendExcelData(i,o,y);this.sendExcelData(i,o,y)}}}catch(t){var x=a.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/excel/download/errorHandler/@value"),S=r.D.getGlobalFunction(x,this.scope_id);"function"==typeof S&&S.call(this,this.id),s.w.printStackTrace(t,null,this)}},k.prototype._getExcelRealData=function(t,e,i,o){try{var a=o.cellInfo,r=o.isExpCol,n=i;if(r[e])n.push(a[e].getExpressionValue(t));else{var l=this.dataList._getData(t,e);n.push(null!=l?l:"")}return n}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getExcelDisplayData=function(t,e,i,o,a){try{var r,n=o.cellInfo,l=o.isSelectCol,h=o.isBasicCol,d=o.isExpCol,u=o.isCustomCol,p=o.isCustomModelCol,c=o.isCustomType,g=o.isEscapeFormatter,f=i;if(d[e]&&(r=n[e].getExpressionValue(t)),u[e]||p[e]||g[e]?r=this._getDisplayData(t,e):(r=this.dataList._getData(t,e),n[e].options.useMonthYearFormat&&"calendar"===n[e].options.inputType&&(r=WebSquare.date.getIOFormatDate(r,n[e].options.ioFormat,n[e].options.calendarValueType)),r=null!=r?r:""),h[e]||d[e])n[e].options.maskFormat&&n[e].options.displayFormat&&(r=this.getInput(n[e]).maskFormatModelUnFormat(r)),r=n[e].formatter?n[e].formatter.format(r):r;else if(!l[e]||u[e]||p[e]){if(c[e]){x=null;var m,y=n[e].cellManagerHashByRowIndex[a];y?m=(n=y).options.inputType:(n=n[e],m="text")
;var b=n.useCustomFormatter,w=n.useCustomModelFormatter,v=n.useEscapeFormatter,C="select"===m||"checkcombobox"===m||"autoComplete"===m,I="expression"===m,_=!("checkbox"===m||"image"===m||"radio"===m||C||I||b||w||v);if(b||w||v?r=this._getDisplayData(t,e):(r=this.dataList._getData(t,e),n.options.useMonthYearFormat&&"calendar"===n.options.inputType&&(r=WebSquare.date.getIOFormatDate(r,n.options.ioFormat,n.options.calendarValueType)),r=null!=r?r:""),_||I)n.options.maskFormat&&n.options.displayFormat&&(r=this.getInput(n).maskFormatModelUnFormat(r)),r=n.formatter?n.formatter.format(r):r;else if(C&&!b&&!w){x=null;null==(x=2==o.type?this.dataList._getData(t,e):n.getData(r,t))&&(x=""),r=x}}}else{var x=null;if(2==o.type)x=this.dataList._getData(t,e);else{var S=n[e].dataComp,D=t;if(S){var R=this.modelControl.getDataComp(S);R&&"linkedDataList"===R.initializeType&&(D=a)}x=n[e].getData(r,D)}null==x&&(x=""),r=x}return"string"==typeof r&&r.indexOf("javascript:")>-1&&(r=r.wq_replaceAll("javascript:","")),f.push(r),f}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getStyleRowIndex=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);return null==e?e=null:"number"!=typeof e&&(e=e.type+"_"+e.groupId),e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getRowStyleClassName=function(t,e){try{var i=e?t:this._getStyleRowIndex(t);return null==i?null:this.rowStyleArr[i]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setRowStyleClassName=function(t,e,i){try{var o=i?t:this._getStyleRowIndex(t);if(null==o)return;this.rowStyleArr[o]=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCellStyleClassName=function(t,e,i){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var o=i?t:this._getStyleRowIndex(t);return null==o?void 0:"number"==typeof o?this.cellStyleArr[o*this.oneRowDataLength+e]:this.cellStyleArr[o+"_"+e]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellStyleClassName=function(t,e,i,o){try{e=this.getColumnIndex(e);var a=o?t:this._getStyleRowIndex(t);if(null==a)return;"number"==typeof a?this.cellStyleArr[a*this.oneRowDataLength+e]=i:this.cellStyleArr[a+"_"+e]=i}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getCellClass=function(t,e){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var i=this._getStyleRowIndex(t);return null==i?void 0:"number"==typeof i?this.cellClassArr[i*this.oneRowDataLength+e]:this.cellClassArr[i+"_"+e]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellDefaultStyleClassName=function(t,e,i){try{e=this.getColumnIndex(e);var o=this.getCellStyleClassName(t,e,i);return null==o&&(this.cellStyleIndex++,o=this.id+"_cellstyle_"+this.cellStyleIndex+"_",this.setCellStyleClassName(t,e,o,i)),null==this.cellStyleValueObj[o]&&(this.cellStyleValueObj[o]={}),o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellClass=function(t,e,i,o){try{var a,r;e=this.getColumnIndex(e);var n,l=!(!this.isDrillDown||!this._dataList.options.depthColumn);if(o?(a=t,r=this.getDisplayRowIndex(t)-this.rowIndex):(a=this._getStyleRowIndex(t),r=l?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex),r>=0&&(n=this.data_td_list[r*this.oneRowDataLength+e]),null==a)return;if("number"==typeof a){var h=this.tdCellClassArr[r*this.oneRowDataLength+e];h&&this.removeClass(n,h),this.cellClassArr[a*this.oneRowDataLength+e]=i}else this.cellClassArr[a+"_"+e]=i;n&&(this.tdCellClassArr[r*this.oneRowDataLength+e]=i,this.addClass(n,i))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.removeCellClass=function(t,e,i){try{e=this.getColumnIndex(e);var o,a=this._getStyleRowIndex(t);if(o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex,null==a)return;"number"==typeof a?this.cellClassArr[a*this.oneRowDataLength+e]=void 0:this.cellClassArr[a+"_"+e]=void 0;var r=this.data_td_list[o*this.oneRowDataLength+e];r&&(i||(i=this.tdCellClassArr[o*this.oneRowDataLength+e]),
this.tdCellClassArr[o*this.oneRowDataLength+e]=void 0,this.removeClass(r,i))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._removeAllTDCellClass=function(){try{for(var t=this.tdCellClassArr.length,e=0;e<t;e++){var i=this.tdCellClassArr[e],o=this.data_td_list[e];o&&i&&this.removeClass(o,i)}this.tdCellClassArr=[]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setColumnClass=function(t,e){try{var i=this.getColumnIndex(t);if(this.columnClassObj[i]){var o=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim();this.columnClassObj[i]=o+" "+e}else this.columnClassObj[i]=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._setColumnClass(t,i[o]);for(o=this.getColumnIndex(t);o<this.data_td_list.length;o+=this.oneRowDataLength){var a=this.data_td_list[o];a&&this.addClass(a,e)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._removeColumnClass=function(t,e){try{var i=this.getColumnIndex(t);this.columnClassObj[i]=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim(),this.columnClassObj[i]||delete this.columnClassObj[i];for(var o=i;o<this.data_td_list.length;o+=this.oneRowDataLength){var a=this.data_td_list[o];a&&this.removeClass(a,e)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.removeColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._removeColumnClass(t,i[o])}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getColumnClass=function(t){try{var e=this.getColumnIndex(t);return this.columnClassObj[e]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._refreshColumnClass=function(){try{for(var t in this.columnClassObj)this.setColumnClass(this.columnClassObj[t])}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getRowStyleFixedClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleFixedArr[e]}catch(t){$l("getRowStyleFixedClassName :"+t.message),s.w.printStackTrace(t,null,this)}},k.prototype.setRowStyleFixedClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleFixedArr[i]=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getRowStyleDataClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleDataArr[e]}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setRowStyleDataClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleDataArr[i]=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.refreshColumnItemset=function(t){try{var e=this.getCellInfo(t);if(e.resetMatchInfo=!0,e.options.embeddedInput){t=this.getColumnIndex(e.options.col_id);for(var i=0;i<this.drawedRowLength;i++){var o=this.data_td_list[t+i*this.oneRowDataLength];if(o){var a=this.dom[o.getAttribute("id")+"_select"];a&&a.refreshItemset()}}}else"select"==e.options.inputType?(e.hasRef&&(e.refHash=[]),e.select&&e.select.refreshItemset(),e.itemsetObj&&e.mainGrid.refresh()):"checkcombobox"==e.options.inputType&&(e.refreshItemArr(),e.checkcombobox)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.refreshRadioGroup=function(t){try{for(var e={},i=[],o=0;o<this.oneRowDataLength;o++){"radio"==(l=this.getCellInfo(o)).options.inputType&&l.options.groupName==t&&(l.options.groupRef&&(l.options.groupValue=WebSquare.ModelUtil.getInstanceValue(l.options.groupRef,null,this.scope_id)),e[l.options.groupValue]=l,i.push(l))}if(0==i.length)return;var a=this.getDataLength();for(o=0;o<a;o++){var r=e[this.dataList._getCellData(o,t)];if(r)this.dataList.__setCellData(o,r.id,r.options.trueValue);else{for(var n=0;n<i.length;n++){var l=i[n];this.dataList.__setCellData(o,l.id,l.options.defaultValue)}var h=this.getCellInfo(t);h&&this.dataList.__setCellData(o,t,h.options.defaultValue)}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.resetRadioGroup=function(t,e){return this._resetRadioGroup.call(this,t,e,!0)
},k.prototype._resetRadioGroup=function(t,e,i){try{for(var o=[],a=0;a<this.oneRowDataLength;a++){"radio"==(h=this.getCellInfo(a)).options.inputType&&h.options.groupName==e&&o.push(h)}if(0==o.length)return;if("number"==typeof t)var r=t,n=t+1;else r=0,n=this.getDataLength();for(a=r;a<n;a++){for(var l=0;l<o.length;l++){var h=o[l];this.dataList.__setCellData(a,h.id,h.options.defaultValue)}if(i){var d=this.getCellInfo(e);d&&this.dataList.__setCellData(a,e,d.options.defaultValue)}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.xmlData2ArrData=function(t,e,i){try{if(null==t)return;if(9==t.nodeType)a=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);else if(o=i&&i.baseNode?i.baseNode:this.options.baseNode,i&&i.isRepeatNode)a=(t=WebSquare.xml.parse(WebSquare.xml.serialize(t))).selectNodes("/"+i.repeatNode);else if(o.startsWith(t.tagName))var o=o.replace(t.tagName,"."),a=t.selectNodes(o+"/"+this.options.repeatNode);else t=WebSquare.xml.parse(WebSquare.xml.serialize(t)),a=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);for(var n=[],l=this.options.valueNode,h=null==l||""==l,d=r.D.getTextNodeValue,u=a.length,p=this.tdIdList.length,c=[],g=[],f=[],m=0;m<p;m++){c[m]=this.getCellInfo(this.tdIdList[m]);var y=c[m].options;null!=y.importFormatter&&""!=y.importFormatter&&(g[m]=!0),null!=y.importExp&&""!=y.importExp&&(f[m]=!0)}for(m=0;m<u;m++){for(var b=m,w=a[m],v=n.length,C=0;C<p;C++){var I=a[m].selectSingleNode(this.tdIdList[C]);n[v+C]=null!=I?h?d(I):I.getAttribute(l):c[C].options.defaultValue}for(C=0;C<p;C++)if(g[C])try{var _=r.D.getGlobalFunction(c[C].options.importFormatter,this.scope_id);"function"==typeof _&&(n[v+C]=_.call(this,w,b))}catch(t){n[v+C]=c[C].options.defaultValue,s.w.printStackTrace(t,null,this)}for(C=0;C<p;C++)if(f[C])try{var x=new Function("_this","obfuscator_rowXml","return "+c[C].options.importExp)(this,w);n[v+C]=x}catch(t){n[v+C]=c[C].options.defaultValue,s.w.printStackTrace(t,null,this)}for(C=0;C<p;C++){if("radio"==c[C].options.inputType&&c[C].options.groupName&&this.cellInfoHash[c[C].options.groupName]){var S=c[C].options.trueValue,D=c[C].options.falseValue;switch(c[C].options.valueType){case"binary":S="1",D="0";break;case"boolean":S="true",D="false"}this.columnValue(w,c[C].options.groupName)==c[C].options.groupValue?n[v+C]=S:n[v+C]=D}this.options.xmlEncode&&null!=n[v+C]&&(n[v+C]=WebSquare.xml.decode(n[v+C]))}}return n}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.jsonData2ArrData=function(t){try{if(null==t)return;for(var e=[],i=t.length,o=this.cellIdList.length,a=[],n=0;n<o;n++)a[n]=this.getCellInfo(this.cellIdList[n]);for(n=0;n<i;n++)for(var l=n,h=t[n],d=e.length,u=0;u<o;u++)if(a[u].options.importFormatter)try{var p=r.D.getGlobalFunction(a[u].options.importFormatter,this.scope_id);"function"==typeof p&&(e[d+u]=p.call(this,h,l))}catch(t){e[d+u]=a[u].options.defaultValue,s.w.printStackTrace(t,null,this)}else if(a[u].options.importExp)try{var c=new Function("_this","obfuscator_rowXml","return "+a[u].options.importExp)(this,h);e[d+u]=c}catch(t){e[d+u]=a[u].options.defaultValue,s.w.printStackTrace(t,null,this)}else{var g=t[n][this.cellIdList[u]];e[d+u]=null!=g?g:a[u].options.defaultValue}return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.xpathValue=function(t,e){try{var i=WebSquare.xml.findNode(t,e);if(null==i)return"";if(1!=i.nodeType)return i.nodeValue;for(var o=i.firstChild;null!=o;o=o.nextSibling)if(3==o.nodeType)return o.nodeValue}catch(t){$l("xpath exeption"),s.w.printStackTrace(t,null,this)}return""},k.prototype.getAllArrXML=function(t){try{var e=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var i=0;i<this.tagNmArr.length;i++)if(null!=this.tagNmArr[i]&&""!=this.tagNmArr[i].wq_trim())if(e)a.push(o.createElement(this.tagNmArr[i])),a[i-1].appendChild(a[i]);else{
var o=WebSquare.xml.parse("<"+this.tagNmArr[i]+"/>"),a=[];a.push(o.documentElement),e=!0}var n=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),l=null;for(i=0;i<this.getTotalRow();i++){var h=i;l=[];for(var d=null,u=0;u<n.length;u++)if(""!=n[u]){var p=o.createElement(n[u]);l.push(p),0==u?a[a.length-1].appendChild(p):l[u-1].appendChild(l[u])}(d=l[n.length-1]).setAttribute("status",this.dataList._getRowStatusValue(h)),d.setAttribute("statusValue",this.dataList._getRowStatus(h)),d.setAttribute("id",h);for(var c=this.getColumnCount(),g=new Array(c),f=0;f<c;f++){var m="";m="displayData"!=t?this._dataList._getData(h,f):this._getDisplayData(h,f),this.options.xmlEncode&&(m=WebSquare.xml.encode(m));var y=this.getColumnID(f),b=this.getCellInfo(f);if(""!=b.options.exportFormatter)try{var w=r.D.getGlobalFunction(b.options.exportFormatter,this.scope_id);"function"==typeof w&&w(d,m,h,y)}catch(t){s.w.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(g[f]=o.createElement(this.getColumnID(f)),""==this._dataList.options.valueAttribute){var v=o.createTextNode(m);g[f].appendChild(v)}else g[f].setAttribute(this._dataList.options.valueAttribute,m);d.appendChild(g[f])}}}return o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getArrXML=function(t,e,i){try{if(t instanceof Array){var o=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var a=0;a<this.tagNmArr.length;a++)if(null!=this.tagNmArr[a]&&""!=this.tagNmArr[a].wq_trim())if(o)l.push(n.createElement(this.tagNmArr[a])),l[a-1].appendChild(l[a]);else{var n=WebSquare.xml.parse("<"+this.tagNmArr[a]+"/>"),l=[];l.push(n.documentElement),o=!0}var h=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),d=null;for(a=0;a<t.length;a++){var u=t[a];d=[];for(var p=null,c=0;c<h.length;c++)if(""!=h[c]){var g=n.createElement(h[c]);d.push(g),0==c?l[l.length-1].appendChild(g):d[c-1].appendChild(d[c])}(p=d[h.length-1]).setAttribute("status",this.dataList.getRowStatusValue(u)),p.setAttribute("statusValue",this.dataList.getRowStatus(u)),!0===i?p.setAttribute("id",this._getGroupbyDisplayRowIndex(u)):p.setAttribute("id",u);for(var f=this.getColumnCount(),m=new Array(f),y=0;y<f;y++){var b="";"displayData"!=e?null==(b=this.dataList._getCellData(u,y))&&(b=""):null==(b=this._getCellDisplayData(u,y))&&(b=""),this.options.xmlEncode&&(b=WebSquare.xml.encode(b));var w=this.getColumnID(y),v=this.getCellInfo(y);if(""!=v.options.exportFormatter)try{var C=r.D.getGlobalFunction(v.options.exportFormatter,this.scope_id);"function"==typeof C&&C(p,b,u,w)}catch(t){s.w.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(m[y]=n.createElement(this.getColumnID(y)),""==this._dataList.options.valueAttribute){var I=n.createTextNode(b);m[y].appendChild(I)}else m[y].setAttribute(this._dataList.options.valueAttribute,b);p.appendChild(m[y])}}}return n}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getDisplayRowIndex=function(t){try{return(this._linkedDataList||this._dataList).getFilteredRowIndex(t)}catch(t){s.w.printStackTrace(t)}},k.prototype.getOption=function(t){try{return this.options[t]}catch(t){s.w.printStackTrace(t)}},k.prototype.getDataList=function(){try{var t=this._linkedDataList||this._dataList;return t?t.id:null}catch(t){s.w.printStackTrace(t)}},k.prototype.getRowNumVisible=function(){try{return this.options.rowNumVisible}catch(t){s.w.printStackTrace(t)}},k.prototype.makeCustomFilter=function(t){try{null!=this.customFilter&&this.customFilter.remove(),this.customFilter=new WebSquare.uiplugin.floatingLayer(this.id+"_customFilter",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter",useModal:!0,useModalStack:!0,frameModal:this.options.customFilterFrameModal+"",headerLeftClass:"w2grid_customFilter_HL",headerRightClass:"w2grid_customFilter_HR",headerCenterClass:"w2grid_customFilter_HC",bodyLeftClass:"w2grid_customFilter_BL",
bodyRightClass:"w2grid_customFilter_BR",bodyCenterClass:"w2grid_customFilter_BC",bodyLeftBottomClass:"w2grid_customFilter_FL",bodyRightBottomClass:"w2grid_customFilter_FR",bodyBottomClass:"w2grid_customFilter_FC",closeButtonClass:"w2grid_customFilter_btnClose",_scope_obj_uuid:this.options._scope_obj_uuid,title:WebSquare.language.getMessage("Grid_filter_title")||"사용자 지정 필터",titleClass:"w2grid_customFilter_title"});var e=new WebSquare.uiplugin.textbox(this.id+"_text1_"+this.headerID,{style:"position:absolute; margin:10px;",className:"w2grid_customFilter_text",label:WebSquare.language.getMessage("Grid_filter_search_label")||"찾을 조건"});this.customFilter.addControl(e),this.selectboxItemSet=["=","<>",">",">=","<","<=",WebSquare.language.getMessage("Grid_filter_condition7")||"= (메타문자 사용)",WebSquare.language.getMessage("Grid_filter_condition1")||"시작문자",WebSquare.language.getMessage("Grid_filter_condition2")||"제외할 시작 문자",WebSquare.language.getMessage("Grid_filter_condition3")||"끝 문자",WebSquare.language.getMessage("Grid_filter_condition4")||"제외할 끝 문자",WebSquare.language.getMessage("Grid_filter_condition5")||"포함",WebSquare.language.getMessage("Grid_filter_condition6")||"포함하지 않음"],this._selectboxIgnoreOperatorItemSet=[">",">=","<","<="],this.customFilterItemCnt=0,this.groupList=[];var i=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute; width:100%; height:22px; margin-bottom:5px; background-color:transparent;"});this.customFilter.addControl(i),this.groupList.push(i);var o=this,a=new WebSquare.uiplugin.selectbox(i.id+"_selectbox_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",wheelRows:1,xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var t=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(t.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? 기호를 사용하여 한문자를 나타낼 수 있습니다."),e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* 기호를 사용하여 여러 문자를 나타낼 수 있습니다."),o.setChildrenPosition(),o.customFilterMetacharPos|=1):(o.customFilterMetacharPos&=-2,o.customFilterMetacharPos<=0&&(t.setLabel(""),e.setLabel(""),o.setChildrenPosition()))}}}]});i.addControl(a);var n=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",l=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",p=new WebSquare.uiplugin.autoComplete(i.id+"_autocomplete_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,wheelRows:1,submenuSize:n,displayMode:l,searchTarget:d,delimiter:h});if(p.__setSelectedIndex1=p.setSelectedIndex1,p.setSelectedIndex1=function(t,e){p.__setSelectedIndex1(t,e);var i=p.getValue(),s=this.parentControl.id;if(s)var a=r.D.getComponentById(s+"_selectbox_"+o.headerID);if(a){if(isNaN(i)){for(var n=0;n<a.itemArr.length;n++)void 0!==a.itemArr[n]._hidden&&(a.itemArr[n]._hidden=!0);for(var l=a.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&a.setSelectedIndex(0)}else for(n=0;n<a.itemArr.length;n++)!0===a.itemArr[n]._hidden&&(a.itemArr[n]._hidden=!1);a.setSelectOptions(a.itemArr)}},i.addControl(p),"label"==l||"value delim label"==l||"label delim value"==l)for(var c=this.changeItemValue("label",this.targetColID,this.colDataList,!1),g=0;g<this.colDataList.length;g++)p.addItem(c[g],this.colDataList[g]);else if(this.colDataList)for(g=0;g<this.colDataList.length;g++)p.addItem(this.colDataList[g],this.colDataList[g])
;for(var f=this.headCellInfoHash[this.headerID].getAttribute("customFilterItemCnt")||2,m=0;m<f-1;m++)this.addCustomFilterItem(m);var y=new WebSquare.uiplugin.textbox(this.id+"_text2_"+this.headerID,{style:"position:absolute; margin-left:10px; margin-top:5px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(y);var b=new WebSquare.uiplugin.textbox(this.id+"_text3_"+this.headerID,{style:"position:absolute; margin:5px; margin-bottom:10px; margin-left:10px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(b);var w=new WebSquare.uiplugin.group(this.id+"_buttonGroup_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_buttonGroup"});if(this.customFilter.addControl(w),this.options.showCustomFilterReset){var v=new WebSquare.uiplugin.textbox(this.id+"_btnReset_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",label:WebSquare.language.getMessage("Grid_filter_reset")||"초기화",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.groupbyStatus&&o.groupbyStatus.grouped&&o.options.groupbyFilterBox;for(var e=0;e<o.groupList.length;e++)for(var i=o.groupList[e].getChildren(),s=0;s<i.length;s++){var a=i[s];if(-1!=a.id.indexOf("_selectbox")){var r=o.itemValueObj[o.targetColID]["select"+e];a.setSelectedIndex(r||0)}else if(-1!=a.id.indexOf("_autocomplete")){var n=o.itemValueObj[o.targetColID]["auto"+e];a.setValue(n||"")}else if(-1!=a.id.indexOf("_radio")){var l=o.itemValueObj[o.targetColID]["radio"+e];a.setSelectedIndex(l||0)}}}}}]});w.addControl(v),v.addEvent("onmousedown",(function(){v.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),v.addEvent("onmouseup",(function(){v.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),v.addEvent("onmouseout",(function(){v.toggleClass("w2grid_customFilter_button_selected")}))}var C=new WebSquare.uiplugin.textbox(this.id+"_btnConform_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_confirm")||"확인",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.setCustomFilterExpression()}}},{name:"onkeydown",action:"script",param:{handler:function(t){13==(t.charCode?t.charCode:t.keyCode)&&(o.setCustomFilterExpression(),o.hideCustomFilterList())}}}]});w.addControl(C),C.addEvent("onmousedown",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),C.addEvent("onmouseup",(function(){C.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),C.addEvent("onmouseout",(function(){C.toggleClass("w2grid_customFilter_button_selected")}));var I=new WebSquare.uiplugin.textbox(this.id+"_btnCancel",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_cancel")||"취소",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide()}}},{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9==e?(I.tabOrderMoveStart=!1,t.shiftKey||(I.tabOrderMoveStart=!0,u.B.preventDefault(t))):13==e&&(o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide(),o.hideCustomFilterList())}}},{name:"onkeyup",action:"script",param:{handler:function(t){9==(t.charCode?t.charCode:t.keyCode)&&(t.shiftKey||I.tabOrderMoveStart&&(I.tabOrderMoveStart=!1,o.customFilter.render.getElementsByClassName("w2floatingLayer_close_button")[0].focus()))}}}]});w.addControl(I),I.addEvent("onmousedown",(function(){I.toggleClass("w2grid_customFilter_button_selected")})),I.addEvent("onmouseup",(function(){I.toggleClass("w2grid_customFilter_button_selected")})),
I.addEvent("onmouseout",(function(){I.toggleClass("w2grid_customFilter_button_selected")})),this.customFilter.writeTo(WebSquare.getBody()),this.customFilter.activate(),this.customFilter.dom.closeButton.addEventListener("keydown",(function(t){9==(t.charCode?t.charCode:t.keyCode)&&t.shiftKey&&I.focus()})),this.setChildrenPosition(),this.setDefaultValue(t),I.render.style.left=w.render.offsetWidth-I.render.offsetWidth-10+"px",C.render.style.left=parseInt(I.render.style.left,10)-C.render.offsetWidth-5+"px",this.options.showCustomFilterReset&&(v.render.style.left=parseInt(C.render.style.left,10)-I.render.offsetWidth-17+"px"),this.customFilter.hide()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setDefaultValue=function(t){for(var e=0;e<this.groupList.length;e++)for(var i=this.groupList[e].getChildren(),o=0;o<i.length;o++){var s,a=i[o];if(-1!=a.id.indexOf("_selectbox")){s=a;for(var r=0;r<this.selectboxItemSet.length;r++)">"===this.selectboxItemSet[r]||">="===this.selectboxItemSet[r]||"<"===this.selectboxItemSet[r]||"<="===this.selectboxItemSet[r]?a.addItemArr(this.selectboxItemSet[r],this.selectboxItemSet[r],!1):a.addItemArr(this.selectboxItemSet[r],this.selectboxItemSet[r]);var n=this.itemValueObj[this.targetColID]["select"+e];a.setSelectedIndex(n||0)}else if(-1!=a.id.indexOf("_autocomplete")){var l=this.itemValueObj[this.targetColID]["auto"+e];a.setValue(l||"");var h=a.getValue();if(s){if(isNaN(h))for(r=0;r<s.itemArr.length;r++)void 0!==s.itemArr[r]._hidden&&(s.itemArr[r]._hidden=!0);else for(r=0;r<s.itemArr.length;r++)!0===s.itemArr[r]._hidden&&(s.itemArr[r]._hidden=!1);s.setSelectOptions(s.itemArr)}s=null}else if(-1!=a.id.indexOf("_radio")){a.addItem("OR","OR","0"),a.addItem("AND","AND","0");var d=this.itemValueObj[this.targetColID]["radio"+e];a.setSelectedIndex(d||0)}}},k.prototype.getUniqueValueOfArray=function(t,e){try{if(this._isNumberType(e))if("bigDecimal"!==e||isNaN(WebSquare.bigDecimal("").big))t.sort((function(t,e){return parseFloat(t)-parseFloat(e)}));else{var i,o;t.sort((function(t,e){if(""===t&&""===e)return 0;i=WebSquare.bigDecimal(t),o=WebSquare.bigDecimal(e);var s=i.minus(o);return"0"===s.toString()?0:"0"!==s.compare("0")?1:-1}))}else t.sort();for(var a=[],r=0;r<t.length;r++)(0===a.length||a[a.length-1]!==t[r]&&a[a.length-1]+""!=t[r]+"")&&a.push(t[r]);return a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setAutoCompleteItem=function(t,e){var i=[];if(this.options.useFilterSearch&&this.customFilterList&&this.customFilterList.filterHistory.column.length>0){var o=this.getCustomFilterListJSON({colID:t,headerID:e}),s=this.headerInfoHash[e],a=0;s&&s.options.hideCustomFilter&&(a=1);for(var n=2-a;n<o.length;n++)i.push(o[n].id2)}else i=this.dataList.getColData(t);for(var l in this.itemValueObj[this.targetColID])-1!=l.indexOf("auto")&&""!=this.itemValueObj[this.targetColID][l]&&i.push(this.itemValueObj[this.targetColID][l]);this.colDataList=this.getUniqueValueOfArray(i),this.colDataList.sort((function(t,e){var i=t-e;r.D.isIE("6 7")&&(i=(t+"").localeCompare(e+""));return i}))},k.prototype.showFilterOptions=function(t){this.options.useFilterList?(this.options.searchFilter,this.customFilterList&&this.customFilterScrollView?this.toggleCustomFilterList(t):this.createCustomFilterList(t)):this.showCustomFilter(t)},k.prototype.showCustomFilter=function(t){if(this.noevent=!0,this.options.useFilterList)if(this.groupbyStatus.grouped)if(this.options.groupbyFilterIcon){var e=this.headerToBodyRelation[t];if(e){for(var i=!1,o=this.getColumnIndex(e),s=0;s<this.groupbyStatus.sortIndexArr.length;s++)if(this.groupbyStatus.sortIndexArr[s]==o){i=!0;break}var a={};a.render=this.getElementById(this.id+"_"+t),a.parentRender=this.render.getElementsByTagName("div")[0],a.headerID=t,a.headerIndex=this.getHeaderIndex(a.headerID),a.isGroupbyColumn=i,this.groupbyFilterList?this.toggleGroupbyFilterList(a):this.createGroupbyFilterList(a)}}else this._showCustomFilter(t);else this.showFilterOptions(t);else this._showCustomFilter(t)},
k.prototype.showCustomFilter2=function(t){this.noevent=!0,this._showCustomFilter(t)},k.prototype._showCustomFilter=function(t){var e,i;(this.headerID=t,this.targetColID=this.getColIdByHeaderId(t),null==this.customFilter&&(this.itemValueObj={},this.customFilterStatusObj={}),this.itemValueObj[this.targetColID]||(this.itemValueObj[this.targetColID]={}),this.setAutoCompleteItem(this.targetColID,t),this.makeCustomFilter(this.targetColID,t),"BODY"==this.render.parentNode.tagName)?(e=this.render.offsetTop,i=this.render.offsetLeft):(e=WebSquare.style.getAbsoluteTop(this.render),i=WebSquare.style.getAbsoluteLeft(this.render),r.D.isIEAllVersion("5 6 7")||(e-=WebSquare.style.getAbsoluteTop(document.body)));var o=this.getHeaderPosition(t,"top"),s=this.getHeaderPosition(t,"left"),a=this.getHeaderSize(t,"width"),n=this.getHeaderSize(t,"height"),l=0,h=0;"number"==typeof window.innerWidth?(l=window.innerWidth,h=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(l=document.body.clientWidth,h=document.body.clientHeight);var d,u,p=parseInt(r.D.getStyleProperty(this.customFilter.render,"width"),10),c=parseInt(r.D.getStyleProperty(this.customFilter.render,"height"),10),g=0,f=0;r.D.isIE("6 7 8")?(d=document.documentElement.scrollTop,u=document.documentElement.scrollLeft):(d=window.pageYOffset,u=window.pageXOffset),g=i+s+a+p<=l+u?i+s+a:i+s-p,f=e+o+n+c<=h+d?e+o+n:e+this.render.offsetHeight-c,g<u&&(g=(l-p)/2+u,(f=e+this.render.offsetHeight)+c>h+d&&(f=e-c)),f<d&&(f=(h-c)/2+d),this.customFilter.render.style.left=g+"px",this.customFilter.render.style.top=f+"px",this.customFilter.show();var m=r.D.getComponentById(this.id+"_item_0_selectbox_"+this.headerID);m&&m.focus()},k.prototype.addCustomFilterItem=function(t){this.customFilterItemCnt++;var e=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute;",className:"w2grid_customFilter_item"});this.customFilter.addControl(e),this.groupList.push(e);var i=new WebSquare.uiplugin.radio(e.id+"_radio",{style:"position:absolute; left:50px; height:20px;",className:"w2grid_customFilter_radio",selectedIndex:0,cols:2,rows:1});e.addControl(i);var o=this,s=new WebSquare.uiplugin.selectbox(e.id+"_selectbox",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],i=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? 기호를 사용하여 한문자를 나타낼 수 있습니다."),i.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* 기호를 사용하여 여러 문자를 나타낼 수 있습니다."),o.setChildrenPosition(),o.customFilterMetacharPos|=1<<t+1):(o.customFilterMetacharPos&=~(1<<t+1),o.customFilterMetacharPos<=0&&(e.setLabel(""),i.setLabel(""),o.setChildrenPosition()))}}}]});e.addControl(s);var a=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",n=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",l=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=new WebSquare.uiplugin.autoComplete(e.id+"_autocomplete",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,submenuSize:a,displayMode:n,searchTarget:l,delimiter:h});if(d.__setSelectedIndex1=d.setSelectedIndex1,d.setSelectedIndex1=function(t,e){d.__setSelectedIndex1(t,e);var i=d.getValue(),s=this.parentControl.id;if(s)var a=r.D.getComponentById(s+"_selectbox");if(a){if(isNaN(i)){
for(var n=0;n<a.itemArr.length;n++)void 0!==a.itemArr[n]._hidden&&(a.itemArr[n]._hidden=!0);for(var l=a.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&a.setSelectedIndex(0)}else for(n=0;n<a.itemArr.length;n++)!0===a.itemArr[n]._hidden&&(a.itemArr[n]._hidden=!1);a.setSelectOptions(a.itemArr)}},e.addControl(d),"label"==n||"value delim label"==n||"label delim value"==n)for(var u=this.changeItemValue("label",this.targetColID,this.colDataList,!1),p=0;p<this.colDataList.length;p++)d.addItem(u[p],this.colDataList[p]);else if(this.colDataList)for(p=0;p<this.colDataList.length;p++)d.addItem(this.colDataList[p],this.colDataList[p])},k.prototype.setChildrenPosition=function(){for(var t=this.customFilter.getChildren(),e=1;e<=t.length;e++){var i=WebSquare.style.getStyle(t[e-1].render,"top");if(i="auto"===i?"0":i,e===t.length)break;var o=WebSquare.style.getStyle(t[e-1].render,"margin-bottom");o="auto"===o?"0":o,t[e].render.style.top=t[e-1].render.offsetHeight+5+parseInt(i||"0",10)+parseInt(o||"0",10)+"px"}var s=this.customFilter.dom.closeButton.parentNode.offsetHeight,a=t[e-1].render.offsetHeight+10+parseInt(i||"0",10);this.customFilter.setSize(this.customFilter.render.offsetWidth,s+a+6)},k.prototype.replacechar=function(t){return"^"==t||"$"==t||"."==t||"["==t||"]"==t||"{"==t||"}"==t||"+"==t||"("==t||")"==t||"|"==t||"*"==t||"?"==t||"\\"==t?"\\"+t:void 0},k.prototype.setCustomFilterExpression=function(){this.dataList.removeColumnFilter(this.targetColID,{noRefreshAfter:!0});for(var t=!0,e=[],i=0;i<this.groupList.length;i++){for(var o={},s=this.groupList[i].getChildren(),a=0;a<s.length;a++){var r=s[a];if(-1!=r.id.indexOf("_selectbox"))o.select=r.getSelectedIndex(),this.itemValueObj[this.targetColID]["select"+i]=r.getSelectedIndex(),t=t&&0==r.getSelectedIndex(),o.dataType=this.getDataType(this.targetColID);else if(-1!=r.id.indexOf("_autocomplete")){var n=this;o.auto=r.getValue()!=r.options.chooseOptionLabel?(r.getValue()+"").replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return n.replacechar(t)})):"",this.itemValueObj[this.targetColID]["auto"+i]=r.getValue(),t=t&&r.getValue()==r.options.chooseOptionLabel}else-1!=r.id.indexOf("_radio")&&(o.radio=r.getSelectedIndex(),this.itemValueObj[this.targetColID]["radio"+i]=r.getSelectedIndex())}o.select&&e.push(o)}this.customFilterStatusObj[this.headerID]=!0;var h={type:"func",colIndex:this.targetColID,key:this.customFilterOperator,condition:"and",columnfilterchangeFire:!1,param:e},d=!1;if(this.customFilterList&&this.customFilterList.customFilterListFilterInfo){var p=this.customFilterList.customFilterListFilterInfo[this.targetColID];this.customFilterList.customFilterListFilterInfo[this.targetColID]=JSON.stringify(h,(function(t,e){return"function"==typeof e||"object"===(0,l.Z)(e)&&e.constructor===RegExp?e.toString():e})),p!==this.customFilterList.customFilterListFilterInfo[this.targetColID]&&(d=!0,u.B.fireEvent(n._dataList,"onbeforecolumnfilterchange"))}this.dataList.setColumnFilter(h),d&&u.B.fireEvent(n._dataList,"onaftercolumnfilterchange");var c=this.getElementById(this.id+"_"+this.headerID+"_filter");t||0==e.length?WebSquare.style.removeClass(c,"w2grid_customFilter_filter"):WebSquare.style.addClass(c,"w2grid_customFilter_filter"),this.customFilter.hide()},k.prototype.customFilterOperator=function(t,e,i){for(var o=!0,s=0;s<e.length;s++){var a,r=!0,n=e[s].dataType,l=e[s].select,h=e[s].auto,d=e[s].auto.replace(".*","~~").replace(".","~"),u=d,p=t;if(l>=3&&l<=6)if("bigDecimal"===n){d=h.replace("\\.",".");var c=WebSquare.bigDecimal(d);"NaN"===c.big?!1:(u=c,p=WebSquare.bigDecimal(t))}else"number"!==n&&"float"!==n||(u=(d=h.replace("\\.",".")).toString().indexOf(".")>-1?parseFloat(d):parseInt(d,10));switch(e[s].select){case 1:(a=new RegExp(h,"g")).lastIndex=0,r=t==a.exec(t);break;case 2:(a=new RegExp(h,"g")).lastIndex=0,r=t!=a.exec(t);break;case 3:r="bigDecimal"===n?p.minus(u)>0:p>u;break;case 4:r="bigDecimal"===n?p.minus(u)>=0:p>=u;break;case 5:
r="bigDecimal"===n?p.minus(u)<0:p<u;break;case 6:r="bigDecimal"===n?p.minus(u)<=0:p<=u;break;case 7:h=(h=h.replace(/\\\*/g,".*")).replace(/\\\?/g,".");var g=(a=new RegExp(h,"g")).exec(t);r=t==g||h==g;break;case 8:r=""==h?t==h:!!(a=new RegExp("^("+h+")","g")).test(t);break;case 9:r=!!(a=new RegExp("^[^("+h+")]","g")).test(t);break;case 10:r=""==h?t==h:!!(a=new RegExp("("+h+")$","g")).test(t);break;case 11:r=!!(a=new RegExp("[^("+h+")]$","g")).test(t);break;case 12:r=""==h?t==h:!!(a=new RegExp(h,"g")).test(t);break;case 13:r=""==h?t!=h:!!(a=new RegExp("^(?!.*"+h+").*","g")).test(t);break;default:r=t==h}if(1===e.length){o=r;break}0!==s?o=0==e[s].radio?o&&r:o||r:o=r}return o},k.prototype.syncWithSortStatus=function(){try{this.headerSortStatusArr=[];for(var t=this._linkedDataList||this._dataList,e=0;e<t.sortStatusArr.length;e++){var i=t.sortStatusArr[e];"number"==typeof this.getColumnIndex(i.colID)&&(this.headerSortStatusArr.push(i),this.headerSortStatusArr[i.colID]=i)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getFixedColumnLastIndex=function(t){try{if(!this.options.rowNumStatusFixed&&0===this.options.fixedColumn||!1===t)var e=this.options.fixedColumn;else e=this.options.fixedColumn+this.defaultColCnt;if(e<1)return 0;if(!this.options.fixedColumnWithHidden)for(var i=0,o=0;o<this.hiddenList.length;o++)if(this.hiddenList[o]||i++,i==e)return o+1;return e}catch(t){return s.w.printStackTrace(t,null,this),this.options.fixedColumn+this.defaultColCnt}},k.prototype.getFixedRightColumnLastIndex=function(){try{var t=this.colWidthList.length-this.options.fixedRightColumn,e=0;if(this.colWidthList.length!=t)for(var i=this.hiddenList.length-1;i>=0;i--)if(this.hiddenList[i])t--;else if(e++,this.options.fixedRightColumn==e)break;return t}catch(t){return s.w.printStackTrace(t,null,this),this.colWidthList.length-this.options.fixedRightColumn}},k.prototype.columnValue=function(t,e){try{return e=this.getColumnID(e),null!=t.nodeType&&void 0!==t.selectSingleNode?null==this.options.valueNode||""==this.options.valueNode?r.D.getTextNodeValue(t.selectSingleNode(e)):t.selectSingleNode(e).getAttribute(this.options.valueNode):t[e]}catch(t){s.w.printStackTrace(t,null,this)}return""},k.prototype.rowIndexValue=function(t){return t},k.prototype.getColumnOption=function(t,e){try{var i="";if(this.successBinding){var o=this.cellInfoHash[t];if("dataType"==e)if(o){var a=o.options.dataType;i=a||this._dataList.getColumnOption(t,e)}else(i=this._dataList.getColumnOption(t,e))||(i="text");else i=o.options[e]||"";return i}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnOption=function(t,e,i){try{this.successBinding&&this._dataList.setColumnOption(t,e,i)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getColumnDataListInfo=function(t){try{var e=this.getCellInfo(t);return"select"==e.options.inputType||"autoComplete"==e.options.inputType||"checkcombobox"==e.options.inputType?e.getColumnDataListInfo():null}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setInitStyle=function(t){if(WebSquare.initStyle[this.id]){for(var e,i=/([\w-]*)\s*:\s*([^;]*)/g,o={};e=i.exec(WebSquare.initStyle[this.id].style);)o[e[1]]=e[2].wq_trim();var s=o[t]?t:"";if(s){var a=s.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()})),r=o[s]?o[s]:o[s.toUpperCase()];document.getElementById(this.id).style[a]=r}else document.getElementById(this.id).style.cssText=WebSquare.initStyle[this.id].style,this.rowStyleArr=[],this.colStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this._cellSelectedIndex=[],this._removeAllTDCellClass(),this.applyStyleOptions(this.getTotalRow());document.getElementById(this.id).className=WebSquare.initStyle[this.id].className}},k.prototype.refresh=function(t){try{this._dataList.broadcast({gridView:["notifyRefresh",[t]]})}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.checkAdaptiveGridType=function(){try{if(this.options.groupbyZone){var t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return!1}if(!this.render)return!1;var e=this.htmlInfo.head.rowAttrArr.length,i=this.htmlInfo.body.rowAttrArr.length,o=0;if(this.hasSubtotal)for(var a=this.htmlInfo.subtotalArr,n=0;n<a.length;n++)o+=a[n].rowAttrArr.length;if(1==e&&1==i&&(this.adaptiveGridType=1),1==e&&2==i?this.adaptiveGridType=2:2==e&&1==i?this.adaptiveGridType=3:2==e&&2==i?this.adaptiveGridType=4:3==e&&1==i&&(this.adaptiveGridType=5),e>3||i>2||o>3){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return $l(t),!1}if(e+(i>o?i:o)>4){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return $l(t),!1}return!(r.D.isIE(6)||r.D.isIE(7)||r.D.isIE(8)||r.D.isIE(9))}catch(t){s.w.printStackTrace(t)}},k.prototype.setAdaptiveGridBodyHeight=function(){try{for(var t=function(t){var e=this.getColumnIndex(t),i=parseInt(this.getAdaptiveColumnStyleValue(e,"height"),10);isNaN(i)||(this.orgBodyHeightObj[t]=this.getColumnStyleValue(e,"height"),this.setColumnStyle(t,"height",i+"px"))},e=this.htmlInfo.head.rowArr,i=0;i<e.length;i++)for(var o=e[i],a=0;a<o.length;a++){var r=o[a],n=parseInt(r.colSpan,10),l=r.id,h=this.headerToBodyRelation[l],d=this.getColumnIndex(h);if(!isNaN(n)&&n>1)for(var u=0;u<n;u++)t.call(this,this.getColumnID(d+u));else t.call(this,h)}}catch(t){s.w.printStackTrace(t)}},k.prototype.removeAdaptiveGridBodyHeight=function(){try{for(var t in this.orgBodyHeightObj)this.setColumnStyle(t,"height",this.orgBodyHeightObj[t])}catch(t){s.w.printStackTrace(t)}},k.prototype.setAdaptiveGridHeaderHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"),10),i=parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"),10);0===e&&null!=this.oldOptions.headerPaddingTop&&(e=parseInt(this.oldOptions.headerPaddingTop,10)),0===i&&null!=this.oldOptions.headerPaddingBottom&&(i=parseInt(this.oldOptions.headerPaddingBottom,10));for(var o=e+i,a=this.htmlInfo.head.rowArr,r=0;r<a.length;r++)for(var n=a[r],l=0;l<n.length;l++){var h=n[l],d=parseInt(h.colSpan,10),u=h.id,p=this.headerToBodyRelation[u],c=this.getColumnIndex(p),g=parseInt(this.getCellInfo(c).options.colSpan,10),f=0,m=0,y=this.headerInfoHash[u];if(y&&y.options&&"string"==typeof y.options.style)for(var b=y.options.style.split(";"),w=0;w<b.length;w++){if("height"==(I=b[w].split(":"))[0]){m=parseInt(I[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);if(null!=c)if(d>0){var v=d;for(w=c;w<c+d;w++)this.hiddenList[w]?v--:(f+=parseInt(this.getColumnStyleValue(w,"height"),10),f+=o);m!=(f-=o-(v-1))&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),v>0&&this.setHeaderStyle(u,"height",f+"px"))}else if(f=parseInt(this.getColumnStyleValue(c,"height"),10),g>1){f-=(o+1)*(g-1);var C=Math.round(f/g);for(w=l;w<l+g;w++){if(u=(h=n[w]).id,this.headerInfoHash[u])for(b=this.headerInfoHash[u].options.style.split(";"),w=0;w<b.length;w++){var I;if("height"==(I=b[w].split(":"))[0]){m=parseInt(I[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);w==l+g-1?(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",f+"px")):(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",C+"px"),f-=C)}}else m!=f&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),this.hiddenList[c]||this.setHeaderStyle(u,"height",f+"px"))}if(this.hasFooter){var _=this.htmlInfo.foot.rowArr;for(r=0;r<_.length;r++){var x=_[r];for(l=0;l<x.length;l++){var S=x[l],D=parseInt(S.colSpan),R=S.id,L=(c=l,f=0,parseInt(this.getFooterStyle(R,"height")));if(D>0){for(w=c;w<c+D;w++)f+=parseInt(this.getColumnStyleValue(w,"height")),f+=o;f-=o-(D-1)}else f=parseInt(this.getColumnStyleValue(c,"height"));L!=f&&(this.orgFooterHeightObj[R]=L+"px",
this.setFooterStyle(R,"height",f+"px"))}}}}catch(t){s.w.printStackTrace(t)}},k.prototype.removeAdaptiveGridHeaderHeight=function(){try{for(var t in this.orgHeaderHeightObj)this.setHeaderStyle(t,"height",this.orgHeaderHeightObj[t]);for(var t in this.orgFooterHeightObj)this.setFooterStyle(t,"height",this.orgFooterHeightObj[t])}catch(t){s.w.printStackTrace(t)}},k.prototype.setAdaptiveGridSubtotalHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"))+parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"));if(0==this.orgSubtotalHeightArr.length)for(var i=0;i<this.drawedSubtotal.length;i++)for(var o=0;o<this.drawedSubtotal[i].length;o++)for(var a=this.drawedSubtotal[i][o].childNodes,r=this.defaultColCnt;r<a.length;r++){var n=parseInt(a[r].getAttribute("colSpan")),l=0,h=a[r].style.height;if(null!=n&&n>0){for(var d=r;d<r+n;d++)l+=parseInt(this.getColumnStyleValue(d-this.defaultColCnt,"height")),l+=e;l-=e-(n-1)}else l=h;h!=l&&(this.orgSubtotalHeightArr.push({height:h,elem:a[r]}),a[r].style.height=l+"px")}}catch(t){s.w.printStackTrace(t)}},k.prototype.removeAdaptiveGridSubtotalHeight=function(){try{for(var t=0;t<this.orgSubtotalHeightArr.length;t++){var e=this.orgSubtotalHeightArr[t];e.elem.style.height=e.height}this.orgSubtotalHeightArr=[]}catch(t){s.w.printStackTrace(t)}},k.prototype.setDrillDownDragDrop=function(t){try{this.drillDownDragDrop=r.D.getBoolean(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getDataListInfo=function(){try{if(this.successBinding){var t={};return t.id=this.options.dataList,t}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getInputType=function(t){try{return this.getCellInfo(t).options.inputType}catch(t){s.w.printStackTrace(t)}},k.prototype.getDataType=function(t){try{return this.getCellInfo(t).options.dataType||this._dataList.getCellInfo(t).options.dataType}catch(t){s.w.printStackTrace(t)}},k.prototype.getFakeExpressionArr=function(){try{for(var t=[],e=[],i=0;i<this.dataList.getRowCount();i++)(t=this._dataList.getRowData(i)).push(""),e=e.concat(t);return e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setUseFilterList=function(t){try{this.options.useFilterList=r.D.getBoolean(t),this.options.sortable&&this.options.showSortableImage&&(this.options.showSortableUseFilter=!0)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setUseFilter=function(t,e){try{var i=t,o=this.headerInfoHash[i];if(null==o&&(i=this.bodyToHeaderRelation[i],null==(o=this.headerInfoHash[i])))return!1;var a=o.options.useFilter,n=r.D.getBoolean(e);if(a===n)return!1;o.options.useFilter=n;var l,h=this.getHeaderLayer(i);if(!0===a)null!=(l=document.getElementById(this.id+"_"+i+"_filter"))&&(l.style.display="none");else if(null!=(l=document.getElementById(this.id+"_"+i+"_filter")))l.style.display="";else{var d=this.headerObj[i],u=h.innerHTML;if(d&&(u=""),h.innerHTML="<table style='width:100%;height:100%;'><tr><td style='width:100%;'>"+u+"</td><td><input type='button' id='"+this.id+"_"+i+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+i+"\");'/></td></tr></table>",d)h.getElementsByTagName("td")[0].appendChild(d)}var p=r.D.getDataPrefix("useFilter");if(n?h.setAttribute(p,n):h.removeAttribute(p),this.headerSortStatusArr[t]||this.options.sortable){var c=this.headerSortStatusArr[t]?this.headerSortStatusArr[t].sortOrder:0;this.setHeaderSortImage(i,c)}return!0}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getFixedRow=function(){var t=parseInt(this.options.fixedRow,10);return t=isNaN(t)?0:t},k.prototype.getLastFixedRow=function(){var t=parseInt(this.options.lastFixedRow,10);return t=isNaN(t)?0:t},k.prototype.isVirtualCursor=function(){try{if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum)if(this.getLastFocusedCell().focusedRowIndex>this.lastIndex&&0==this.getElementById(this.id+"_scrollY_div").scrollTop)return!0;return!1}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.mergeCell=function(t){try{if(null==t||null==t.rowIndex||null==t.colIndex)return void p.k.printLog("gridView mergeCell error : invalid argument ["+this.id+"]");null==t.rowSpan&&(t.rowSpan=1),null==t.colSpan&&(t.colSpan=1);var e=parseInt(t.rowIndex,10),i=parseInt(t.colIndex,10),o=parseInt(t.rowSpan,10),a=parseInt(t.colSpan,10),n=this.getRealRowIndex(e);o>1||a>1?(this.cellMergeInfo[e+"_"+i]={rowSpan:o,colSpan:a},this.cellMergeRealInfo[e+"_"+i]=n):null!=this.cellMergeInfo[e+"_"+i]&&(delete this.cellMergeInfo[e+"_"+i],delete this.cellMergeRealInfo[e+"_"+i]);for(var l=!(!this.isDrillDown||!this._dataList.options.depthColumn),h=l?e:n,d=this.dataList._getCellData(h,i,"3"),u=0;u<o;u++)for(var c=0;c<a;c++)if(0!==u||0!==c){var g={filteredRowIndex:e+u,colID:i+c,data:d,useRealRowIndex:l};this.dataList._setCellData(g),this.cellMergeInfo[e+u+"_"+(i+c)]&&delete this.cellMergeInfo[e+u+"_"+(i+c)]}this.dynamicMergeHTML(),this.options.oddEvenColorDisplay&&!0===this._isBrowserScroll()&&r.D.setTimeout(this.redrawTable,{key:this.id+"_mergeCell",delay:100,caller:this})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeFocusedCell=function(){try{if(this.focusedCell.length>1){var t=this.focusedCell.length-1;this.mergeCell({rowIndex:this.focusedCell[0].focusedRowIndex,colIndex:this.focusedCell[0].focusedColIndex,rowSpan:this.focusedCell[t].focusedRowIndex-this.focusedCell[0].focusedRowIndex+1,colSpan:this.focusedCell[t].focusedColIndex-this.focusedCell[0].focusedColIndex+1})}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeSplitFocusedCell=function(){try{for(var t=0;t<this.focusedCell.length;t++)this.mergeCell({rowIndex:this.focusedCell[t].focusedRowIndex,colIndex:this.focusedCell[t].focusedColIndex,rowSpan:1,colSpan:1})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeClear=function(t){try{void 0!==t&&null!=t||(t={}),this.cellMergeInfo={},this.cellMergeRealInfo={},this.options.mergeCells="never",this.options.mergeCellsFixedCols="never",this.options.mergeCellsFixedRows="never",!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeNotifyRowChanged=function(t,e){try{var i="removeRow"===t?-1:1,o={};for(var a in this.cellMergeInfo){var r=a.split("_"),n=parseInt(r[0],10),l=parseInt(r[1],10),h=this.cellMergeInfo[a];if(n<=e&&e<n+h.rowSpan)if(-1===i){if(h.rowSpan--,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}else if(n<e){var d=h.rowSpan-(e-n);if((d>1||1==d&&h.colSpan>1)&&(o[e+1+"_"+l]={rowSpan:d,colSpan:h.colSpan}),h.rowSpan-=d,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}(n>e||n==e&&-1!==i)&&(n+=i),o[n+"_"+l]=h}this.cellMergeInfo=o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeNotifyFilter=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols){var t={};for(var e in this.cellMergeRealInfo._hidden){var i=e.split("_"),o=parseInt(i[0],10),a=parseInt(i[1],10),r=this.getDisplayRowIndex(o);isNaN(r)||(t[r+"_"+a]=this.cellMergeRealInfo._hidden[e],delete this.cellMergeRealInfo._hidden[e],this.cellMergeRealInfo[r+"_"+a]=o)}for(var n in this.cellMergeInfo){var l=n.split("_"),h=(a=parseInt(l[1],10),this.cellMergeInfo[n]);o=this.cellMergeRealInfo[n],r=this.getDisplayRowIndex(o);isNaN(r)?(this.cellMergeRealInfo._hidden||(this.cellMergeRealInfo._hidden={}),this.cellMergeRealInfo._hidden[o+"_"+a]=h,delete this.cellMergeRealInfo[n]):(t[r+"_"+a]=h,delete this.cellMergeRealInfo[n],this.cellMergeRealInfo[r+"_"+a]=o)}this.cellMergeInfo=t}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByFree=function(t,e,i,o){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:i-t+1,colSpan:o-e+1})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.unmergeByFree=function(t,e){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:1,colSpan:1})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeCells=function(t,e){try{this._mergeCells(t,e,{type:"mergeCells"})
}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByCol=function(t){try{this._mergeCells("bycol",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByRow=function(t){try{this._mergeCells("byrow",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByColRec=function(t){try{this._mergeCells("bycolrec",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByRowRec=function(t){try{this._mergeCells("byrowrec",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByRestricCol=function(t){try{this._mergeCells("byrestriccol",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeByRestricRow=function(t){try{this._mergeCells("byrestricrow",t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeCells=function(t,e,i){try{var o=this.options.rollbackCommit;this.options.rollbackCommit=!1;var a=t.toLowerCase();switch(void 0!==i&&null!=i||(i={type:"mergeCells"}),this.options[i.type]=a,a){case"never":this.cellMergeInfo={},this.cellMergeRealInfo={},e&&!0===e.noDraw||this.dynamicMergeHTML();break;case"bycol":this._mergeByCol(e);break;case"byrow":this._mergeByRow(e);break;case"bycolrec":this._mergeByColRec(e);break;case"byrowrec":this._mergeByRowRec(e);break;case"byrestriccol":this._mergeByRestricCol(e);break;case"byrestricrow":this._mergeByRestricRow(e)}this.options.rollbackCommit=o}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeRefresh=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols)return;var t={noDraw:!0};this.cellMergeInfo={},this.cellMergeRealInfo={},"never"!==this.options.mergeCells&&this.mergeCells(this.options.mergeCells,t),this.options.mergeCellsFixedColsFirst?("never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t),"never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t)):("never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t),"never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeByCol=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,a=this.options.fixedColumn,r=i-this.options.fixedRightColumn,n=e,l={},h=this.getSubtotalRowList({returnType:"object"});!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var d={};!0===t.keepMerge&&(d=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,a=0,r=i);var u=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(a=i-this.options.fixedRightColumn,r=i):0==this.options.fixedRightColumn?(a=0,r=this.options.fixedColumn):(a=0,r=i,u=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var p=!(!this.isDrillDown||!this._dataList.options.depthColumn),c=a;c<r;c++){if(t.mergeCol){if(!1===t.mergeCol[c])continue}else if(!1===this.mergeColObj[c])continue;if(!(u&&c>=this.options.fixedColumn&&c<r-this.options.fixedRightColumn)&&!(this.htmlInfo.body.rowAttrArr.length>1&&1==this.colIndexInfo.body.colInfo.rowSpanArr[c]))for(var g=this.tdIdList[c],f=o;f<n;f++){var m=p?this.getRealRowIndex(f):f,y=this.dataList._getCellData(f,g),b=1;if(!0===t.keepMerge&&(b=0),!0===t.upperColumn&&(l[f]=!0),t.mergeRow){if(!1===t.mergeRow[m])continue}else if(!1===this.mergeRowObj[m])continue;for(;b<n-f&&!this._isExcludeValue(y);){var w=p?this.getRealRowIndex(f+b):f+b;if(t.mergeRow){if(!1===t.mergeRow[w])break}else if(!1===this.mergeRowObj[w])break;if(f+b>n)break;if(y!=(0===b?y:this.dataList._getCellData(f+b,g)))break;if(!0===t.keepMerge&&!0===d[w+"_"+c])break;if(!0===t.upperColumn&&!0===l[f+b])break;if(!0===h[f+b])break;b++}b>1&&(this.cellMergeInfo[m+"_"+c]={rowSpan:b,colSpan:1},f=f+b-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){
s.w.printStackTrace(t,null,this)}},k.prototype._mergeByRow=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,a=this.options.fixedColumn,r=i-this.options.fixedRightColumn,n=e,l={};!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var h={};!0===t.keepMerge&&(h=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,a=0,r=i);var d=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(a=i-this.options.fixedRightColumn,r=i):0==this.options.fixedRightColumn?(a=0,r=this.options.fixedColumn):(a=0,r=i,d=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var u=!(!this.isDrillDown||!this._dataList.options.depthColumn),p=o;p<n;p++){var c=u?this.getRealRowIndex(p):p;if(t.mergeRow){if(!1===t.mergeRow[c])continue}else if(!1===this.mergeRowObj[c])continue;for(var g=a;g<r;g++)if(!(d&&g>=this.options.fixedColumn&&g<r-this.options.fixedRightColumn)){var f=this.dataList._getCellData(p,this.tdIdList[g]),m=1;if(!0===t.keepMerge&&(m=0),!0===t.upperRow&&(l[g]=!0),t.mergeCol){if(!1===t.mergeCol[g])continue}else if(!1===this.mergeColObj[g])continue;for(;m<r-g&&!this._isExcludeValue(f);){if(t.mergeCol){if(!1===t.mergeCol[g+m])break}else if(!1===this.mergeColObj[g+m])break;if(d){if(g+m>=this.options.fixedColumn&&g+m<r-this.options.fixedRightColumn)break}else if(g+m>r)break;if(f!=(0===m?f:this.dataList._getCellData(p,this.tdIdList[g+m])))break;if(!0===t.keepMerge&&!0===h[c+"_"+(g+m)])break;if(!0===t.upperRow&&!0===l[g+m])break;m++}m>1&&(this.cellMergeInfo[c+"_"+g]={rowSpan:1,colSpan:m},g=g+m-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeByColRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t),i=o.x.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByCol(e),this._mergeByRow(i),this._mergeAdjacentCell("col"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeByRowRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t),i=o.x.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByRow(e),this._mergeByCol(i),this._mergeAdjacentCell("row"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeAdjacentCell=function(t){try{var e="row"===t?[0,1]:"col"===t?[1,0]:null;if(null==e)return;var i={},o={},a=this.getSubtotalRowList({returnType:"object"});for(var r in this.cellMergeInfo){var n=r.split("_"),l=parseInt(n[e[0]],10),h=parseInt(n[e[1]],10),d=0===e[0]?this.cellMergeInfo[r].colSpan:this.cellMergeInfo[r].rowSpan,u=0===e[0]?this.cellMergeInfo[r].rowSpan:this.cellMergeInfo[r].colSpan;null!=i[h+"_"+d]?(null==o[h+"_"+d]&&(o[h+"_"+d]=[i[h+"_"+d]]),o[h+"_"+d].push({row:l,rowSpan:u})):i[h+"_"+d]={row:l,rowSpan:u}}for(var r in o){var p=parseInt(r.split("_")[0]),c=0===e[0]?"rowSpan":"colSpan";o[r].sort((function(t,e){return t.row>e.row}));for(var g=o[r].length-1;g>=1;g--){var f=!0===a[o[r][g].row];if(o[r][g-1].row+o[r][g-1].rowSpan>=o[r][g].row&&!f)if((0===e[0]?this.dataList._getCellData(o[r][g-1].row,p):this.dataList.getCellData(p,o[r][g-1].row))===(0===e[0]?this.dataList._getCellData(o[r][g].row,p):this.dataList.getCellData(p,o[r][g].row))){o[r][g-1].rowSpan=o[r][g].row+o[r][g].rowSpan-o[r][g-1].row;var m=0===e[0]?o[r][g].row+"_"+p:p+"_"+o[r][g].row;delete this.cellMergeInfo[m];var y=0===e[0]?o[r][g-1].row+"_"+p:p+"_"+o[r][g-1].row;this.cellMergeInfo[y][c]=o[r][g-1].rowSpan}}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeByRestricCol=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t);e.upperColumn=!0,this._mergeByCol(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._mergeByRestricRow=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t);e.upperRow=!0,this._mergeByRow(e)}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.mergeCellsFixedRows=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedRows){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedRows=!0,e.fixedCols=!1,this._mergeCells(t,e,{type:"mergeCellsFixedRows"})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeCellsFixedCols=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedCols){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedCols=!0,e.fixedRows=!1,this._mergeCells(t,e,{type:"mergeCellsFixedCols"})}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeCol=function(t,e){try{t=this.getColumnIndex(t);isNaN(t)||(this.mergeColObj[t]=e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.mergeRow=function(t,e){try{this.mergeRowObj[t]=e}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getMerged=function(t,e){try{if(this.cellMergeInfo[t+"_"+e])return!0;for(var i in this.cellMergeInfo){var o=i.split("_"),a=this.cellMergeInfo[i],r=parseInt(o[0],10),n=parseInt(o[1],10);if(r<=t&&n<=e&&r+a.rowSpan-1>=t&&n+a.colSpan-1>=e)return!0}}catch(t){s.w.printStackTrace(t,null,this)}return!1},k.prototype.getMergedInfo=function(t,e){try{var i={merged:!1};if(this.cellMergeInfo[t+"_"+e])i.merged=!0,i.startRowIndex=t,i.startColIndex=e;else for(var o in this.cellMergeInfo){var a=o.split("_"),r=this.cellMergeInfo[o],n=parseInt(a[0],10),l=parseInt(a[1],10);n<=t&&l<=e&&n+r.rowSpan-1>=t&&l+r.colSpan-1>=e&&(i.merged=!0,i.startRowIndex=n,i.startColIndex=l,i.endRowIndex=n+r.rowSpan-1,i.endColIndex=l+r.colSpan-1)}}catch(t){s.w.printStackTrace(t,null,this)}return i},k.prototype.getMergeAll=function(t,e){try{for(var i,o=[],a=[],r=t.split(","),n=0;n<r.length;n++)o[n]=parseInt(r[n],10);for(var l in!0===e&&this.hasSubtotal&&(i=this.getSubtotalRowList().sort((function(t,e){return t-e}))),this.cellMergeInfo){var h=l.split("_"),d=this.cellMergeInfo[l],u=parseInt(h[0],10),p=parseInt(h[1],10),c=d.rowSpan,g=d.colSpan,f=p+g-1,m=0,y=0,b=0,w=0;if(!0===e&&this.hasSubtotal){for(var v=0;v<i.length&&u>=i[v];v++)w++;var C=1;for(var I in this.subtotalTableList)C=this.subtotalTableList[I].rows.length;u+=w*C}if(""!=t){o=o.sort();for(n=0;n<o.length;n++)p>(m=o[n])?b++:p<=m&&m<=f&&(p==m&&1==g?g=-1:y++);g-=y,p-=b}-1!=g&&(g>1||c>1)&&a.push({x:p,y:u,r:c,c:g})}return JSON.stringify(a)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getMergedCells=function(){try{var t={};for(var e in this.cellMergeInfo){var i=e.split("_"),o=this.cellMergeInfo[e],a=parseInt(i[0],10),r=parseInt(i[1],10),n=o.rowSpan||1,l=o.colSpan||1;if(l>1||n>1)for(var h=0;h<n;h++)for(var d=0;d<l;d++)t[a+h+"_"+(r+d)]=!0}return t}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._isExcludeValue=function(t){try{if(this.options.mergeExcludeValue)for(var e=this.options.mergeExcludeValue.split(","),i=0;i<e.length;i++){if(t.constructor==Number&&(t+=""),e[i]==t)return!0;if("$blank"==e[i]&&""===t)return!0}return!1}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.refreshGrid=function(t){try{var e=null,i=t.op;this.hiddenRowObj.length>0&&"setInstanceValue"!=i&&(e=JSON.stringify(this.hiddenRowObj),this.clearRowVisible());var o,a,r=t.xpath;if("setInstanceValue"==i){o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.options.repeatNode,null,this.scope_id);var n,l=(c=r.split("/"))[c.length-1],h=this.getColumnIndex(l);if(h>=0){n=this.getCellInfo(l),c.pop();var d=WebSquare.ModelUtil.findInstanceNode(c.join("/"),null,this.scope_id);a=this.getInstanceIndex(o,d);var u=this._dataList.getFilteredRowIndex(a);"radio"==n.options.inputType&&t.value+""==n.options.trueValue&&n.resetOthers(u,!0),u>=0?this._dataList.setCellData(u,h,t.value):this._dataList._setData(a,h,t.value)}}else if("setInstanceNode"==i){if(!(m=this.options.ref==t.replacexpath&&"replace"==t.type?this.xmlData2ArrData(t.replaceNode,!0):this.xmlData2ArrData(t.node,!0)).length)return
;this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type?this.insertRow(null,{insertData:m}):"insertBeforeSibling"==t.type?(a=this.getInstanceIndex(o,t.node),this.insertRow(a,{insertData:m})):"replace"==t.type&&this._dataList.setData(m),this.insertRowByInstance=!1}else if("setInstanceChildNodes"==i){if(this.options.ref==t.replacexpath&&"replace"==t.type)m=this.xmlData2ArrData(t.replaceNode,!0);else t.baseNode&&t.baseNode!=this.options.baseNode&&(f=t.baseNode),m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if(!m.length&&"append"==t.type)return;var p=this.getTotalCol();if(this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type)for(;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});else"replace"==t.type&&this._dataList.setData(m);this.insertRowByInstance=!1}else if("setInstanceLastNodeChildNodes"==i||"copyLastNodeChildrenNodes"==i){if(!(m=this.xmlData2ArrData(t.node,!0,{repeatNode:t.repeatNode,isRepeatNode:!0})).length)return;this.insertRowByInstance=!0,"replace"!=t.type&&"replaceAll"!=t.type&&"append"!=t.type||this.setRowData(parseInt(t.changeIndex)-1,m,!0),this.insertRowByInstance=!1}else if("removeInstanceNode"==i)this.removeRowByInstance=!0,a=t.deleteIndex,this.removeRow(a),this.removeRowByInstance=!1;else if("removeInstanceNodeAll"==i)this.removeRowByInstance=!0,this.dataList.removeAll(),this.removeRowByInstance=!1;else if("copyChildrenNodes"==i){var c,g,f;t.copiedXPath&&(g=(c=t.copiedXPath.split("/"))[c.length-1]),t.baseNode&&g!=this.options.baseNode&&(f=g);var m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if("replaceAll"==t.type)this.setData(m);else if("append"==t.type){var y;p=this.getTotalCol();for(this.insertRowByInstance=!0;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});this.insertRowByInstance=!1}}e&&"setInstanceValue"!=i&&(this.hiddenRowObj=JSON.parse(e),this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),this.setScrollYHeight(),this._mergeRefresh(),this.applyStyleOptions(this.lastIndex))}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getInstanceIndex=function(t,e){try{if(!Array.prototype.indexOf||r.D.isIEAllVersion()&&parseInt(a.v.browserVersion(),10)>8){for(var i=t.length;i--;)if(t[i]===e)return i;return}return t.indexOf(e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getArrayIndexOf=function(t,e){try{if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]==e)return i;return}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setRef=function(t){try{if(t&&t.ref){this.options.ref=t.ref,t.baseNode&&(this.options.baseNode=t.baseNode),t.repeatNode&&(this.options.repeatNode=t.repeatNode);var e=null==t.aliasDataCollection?this.scope_id:t.aliasDataCollection,i=WebSquare.ModelUtil.findInstanceNode(this.options.ref,null,e);this.setXML(i,null,{ref:this.options.ref,aliasDataCollection:e})}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setRef=function(t,e){try{this.filteredRepeatNode=!1,this.repeatNodeChildTagName=[],this.repeatNodeTagName=this.options.repeatNode.split("/"),this.filteredRepeatNodeTagName=[];this.options.ref;for(var i=0;i<this.repeatNodeTagName.length;i++){var o=this.repeatNodeTagName[i];i==this.repeatNodeTagName.length-1&&o.indexOf("[")>=0&&(o.indexOf("[@")>=0||(this.repeatNodeTagNameFilter=!0,o=o.split("[")[0])),1==this.repeatNodeTagNameFilter?this.filteredRepeatNodeTagName.push(o):this.filteredRepeatNodeTagName.push(this.repeatNodeTagName[i]),i!=this.repeatNodeTagName.length-1&&"/"+this.repeatNodeTagName[i]}for(var a=0;a<WebSquare.WebSquaredoc.instanceRefElement.length;a++){var r=WebSquare.WebSquaredoc.instanceRefElement[a].id;try{r==this.id&&WebSquare.WebSquaredoc.instanceRefElement.splice(a,1)}catch(t){s.w.printStackTrace(t,null,this)}}
var n=this.options.aliasDataCollection?this.options.aliasDataCollection:this.scope_id;for(var l in WebSquare.WebSquaredoc.instanceRefElement.push(new WebSquare.ModelUtil.createInstanceRefElement(this.options.ref,this.id,this.options.baseNode,this.repeatNodeTagName,this.cellIdList,n)),this.cellInfoHash)this.repeatNodeChildTagName.push(l)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setImageSrc=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if(!e||"textImage"!=o)return;i.options.imageSrc=e,this.refreshColumn(t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setSyncScroll=function(t,e){try{this.options.syncScroll=t,null!=e&&(this.options.syncScrollId=e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.resetExpressionFunc=function(){try{if(this.useExpression)for(var t=this.getTotalCol(),e=0;e<t;e++){var i=this.getCellInfo(e);if(i&&i.options&&"expression"==i.options.inputType)for(var o=this.drawedRowLength,a=0;a<o;a++)i.options.expressionFunc&&i.options.expressionFunc[a]&&i.options.expressionFunc[a].changeCount&&(i.options.expressionFunc[a]={})}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellDataType=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e),r=a.id;if(0!=a.internal||"custom"!=a.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);a=a.cellManagerHashByRowIndex[n]?a.cellManagerHashByRowIndex[n]:a,!0;var l=a.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(a);h.setValue(this._dataList.getCellData(o,r));var d=h.getValue();h.setDataType(i),a.options.dataType="float";var u=h.formatter.unformat(d),p=h.validator.validateString(u);h.setValueNM(p),d!==p&&this._dataList.setCellData(o,r,p)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellAllowChar=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e),r=a.id;if(0!=a.internal||"custom"!=a.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);a=a.cellManagerHashByRowIndex[n]?a.cellManagerHashByRowIndex[n]:a,!0;var l=a.options.inputType;if("text"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(a);if(h&&h.options&&("input"===h.options.pluginName||"textarea"===h.options.pluginName)){h.setValue(this._dataList.getCellData(o,r)),h.setAllowChar(i);var d=h.getValue();this._dataList.setCellData(o,r,d)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellDisplayFormat=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e);if(0!=a.internal||"custom"!=a.options.inputType)return!1;var r=this.dataList.getRealRowIndex(o);a=a.cellManagerHashByRowIndex[r]?a.cellManagerHashByRowIndex[r]:a,!0;var n=a.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;if(a.options.displayFormat=i,a.initFormatter(),a.options.embeddedInput){var l=this.data_td_list[e+(o-this.rowIndex)*this.oneRowDataLength];if(l){var h=this.getInput(a,l);h&&"function"==typeof h.setDisplayFormat&&h.setDisplayFormat(i)}}this.refreshCell(o,e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellDisplayFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e);if(0!=a.internal||"custom"!=a.options.inputType)return!1;var r=this.dataList.getRealRowIndex(o);a=a.cellManagerHashByRowIndex[r]?a.cellManagerHashByRowIndex[r]:a,!0;var n=a.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;a.options.displayFormatter=i,a.initFormatter(),this.refreshCell(o,e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellMaxLength=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e),r=a.id;if(0!=a.internal||"custom"!=a.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o)
;a=a.cellManagerHashByRowIndex[n]?a.cellManagerHashByRowIndex[n]:a,!0;var l=a.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(a);h.setValue(this._dataList.getCellData(o,r)),"float"===a.options.dataType?a.setFloatMaxLength(i.toString()):a.setMaxLength(i);var d=h.getValue();this._dataList.setCellData(o,r,d)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellCustomFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e);if(0!=a.internal||"custom"!=a.options.inputType)return!1;var r=this.dataList.getRealRowIndex(o);a=a.cellManagerHashByRowIndex[r]?a.cellManagerHashByRowIndex[r]:a,!0;var n=a.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;a.options.customFormatter=i,a.initFormatter(),this.refreshCell(o,e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setCellDisableEdit=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,a=this.getCellInfo(e);if("custom"!=a.options.inputType)return!1;var r=this.dataList.getRealRowIndex(o);if("autoComplete"!=(a=a.cellManagerHashByRowIndex[r]?a.cellManagerHashByRowIndex[r]:a).options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;a.options.disableEdit=i,a.autoComplete&&(a.autoComplete.options.disableEdit=i),this.refreshCell(o,e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._removeDom=function(t){try{var e=this.dom[t];if(e){var i=WebSquare.idCache[e.uuid];i&&"function"==typeof i.remove&&i.remove(),delete this.dom[t]}}catch(t){s.w.printStackTrace(t)}},k.prototype.setCellInputType=function(t,e,i){try{if(i&&i.inputType)if(e=this.getColumnID(e)){if(this._linkedDataList){var o=this._linkedDataList.filteredRowIndexArr[t];"number"!=typeof(t=this._dataList.getFilteredRowIndex(o))&&(t=o)}var a={};for(var r in i)a[r]=i[r];this._setCellInputType(t,e,null,a)}}catch(t){s.w.printStackTrace(t)}},k.prototype._setCellInputType=function(t,e,i,o){try{null==i&&(i=""),null==this.editedCell||this.getCellOption(t,e,"embeddedInput")||this.editedCell.handleCancelEdit();var a=this._dataList.getTotalRow();this.groupbyStatus&&this.groupbyStatus.grouped&&(a=this._dataList.filteredRowIndexArr.length);this._dataList.getTotalCol();var r,n=!0;r=this.options&&"grid"===this.options.pluginName&&this.isDrillDown&&this.options.drilldownRealRowIndex||o&&!0===o.useRealRowIndex?t:this.dataList.getRealRowIndex(t);var l=this.getDisplayRowIndex(r);(isNaN(l)||l<0)&&(n=!1);var h=t,d=(e=this.getColumnID(e),this.getColumnIndex(e));this._dataList.getColumnIndex(e);if(t>=0&&t<a){var u=this.cellInfoHash[this.tdIdList[d]];if("custom"==u.options.inputType&&!u.options.embeddedInput){var p;p=!0===o.useRealRowIndex?l-(this.rowIndex>0?this.rowIndex:0):t-(this.rowIndex>0?this.rowIndex:0);var c,g=this.data_td_list[d+p*this.oneRowDataLength];if(g&&n)!1===(c=u.getCellManager({element:u.element,rowIndex:h,realRowIndex:r,options:o,td:g,dynamicInputType:!0}))?g.innerHTML=this.dataTagOpen+o.value+this.dataTagClose:(u.clearStyle(c,g),null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)),c.setInnerHTML(g,i,h,d));else(c=u.getCellManager({element:u.element,rowIndex:h,realRowIndex:r,options:o,dynamicInputType:!0}))&&(null!=c.customValue?(i=c.customValue,this.dataList.setCellData(h,e,i,null,!0,!0)):null==o.value||!0===c.existGridViewItemsetNode?i=this.dataList._getCellData(h,e):(i=o.value,this.dataList.setCellData(h,e,i,null,!0,!0)))}}}catch(t){s.w.printStackTrace(t)}},k.prototype.setDataDragDrop=function(t){try{if("boolean"==typeof t&&(this.options.dataDragDrop=t,t))if(1==this.isMobile){if(this.isHammerEnabled()){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i]
;o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else!1===this._bindDrag&&(this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getDataDragDrop=function(){try{return this.options.dataDragDrop}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._fireOnviewchange=function(t,e,i,a){try{a=a||{};var r,n=this.getCellInfo(t),l=n.editRowIndex,h=this._dataList.getColumnIndex(n.id),d=this.getColumnIndex(n.id),p=this.getRealRowIndex(l),c=this._dataList.dataArr[p*this._dataList.getColumnCount()+h],g=n.comp&&n.comp.selectedIndex,f=this.lastEvent;a.beforeFunc&&a.beforeFunc.apply(a.beforeFunc,a.beforeFuncArgs);var m=!1;if(e)if("handleEndEdit"!=e&&"_handleEndEdit_focus"!=e&&"handleScrollY"!=e||i[2]&&i[2].otherClick)r=n[e].apply(n,i);else{m=!0;var y=i.slice(0);y[2]={from_fireOnviewchange:!0},o.x.extend(y[2],i[2]),r=n[e].apply(n,y)}if(a&&a.checkFunc&&!1===a.checkFunc(r))return!1;var b=this._dataList.dataArr[p*this._dataList.getColumnCount()+h];if(0===c&&(c="0"),0===b&&(b="0"),c!=b){var w={oldValue:c,newValue:b,rowIndex:l,colIndex:d,colId:this.getColumnID(d)};isNaN(g)||(w.oldSelectedIndex=g,w.newSelectedIndex=n.comp&&n.comp.selectedIndex),u.B.fireEvent(this,"onviewchange",w)}var v=this._getGroupbyDisplayRowIndex(l);return this.options.viewChangeAfterEdit&&1==m&&u.B.fireEvent(this,"onafteredit",v,d,b,f),!0}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._refreshInstance=function(t,e){try{if(!this.options.ref)return;e||WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],scopeId:this.scope_id,gridNoRefresh:!0}),t||(t=this._dataList.dataArr);var i,o=t.length/this.oneRowDataLength,a=[],r=this.repeatNodeTagName[0],n=WebSquare.xml.parse("<"+r+"></"+r+">").documentElement,l=this._dataList.getBroadcast();this._dataList.setBroadcast(!1);for(var h=0;h<o;h++)if(this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){if(0==h){var d,u=n,p=r;this.repeatNodeTagName.length>1&&(p=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(var c=1;c<this.repeatNodeTagName.length;c++)u=WebSquare.xml.createNode(u,this.repeatNodeTagName[c],!1);i=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(n,p):n;for(c=0;c<this.repeatNodeChildTagName.length;c++){if(d=WebSquare.xml.createNode(i,this.repeatNodeChildTagName[c],!1),a.push(d),f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){var g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}}else for(c=0;c<this.repeatNodeChildTagName.length;c++){var f;if(d=a[c],f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}WebSquare.ModelUtil.setInstanceNode(n,this.options.ref,null,"append",!1,this.scope_id)}this._dataList.setBroadcast(l)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.isHammerEnabled=function(){try{return(this.isMobile||r.D.isTouchDevice())&&this.options.hammerEnabled}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.endEdit=function(){try{this._endEdit()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getColumnIdListMultiRow=function(){try{for(var t=[],e=this.colIndexes.bodyColInfo.colIndexMatch,i={},o=this.defaultColCnt;o<e.length;o++)for(var a=e[o],r=0;r<a.length;r++){null==t[r]&&(t[r]=[]);var n=this.getColumnID(a[r]-this.defaultColCnt);null==i[n]&&(t[r].push(n),i[n]=!0)}return t}catch(t){s.w.printStackTrace(t,null,this)}},
k.prototype.getLocationRowCol=function(t,e){try{var i,o,a=this.struct.body.rowAttrArr.length,r=this.getColumnOrder(),n=[];for(var l in r)n[r[l]]=parseInt(l,10);var h,d=this.cellMergeInfo;for(var u in d){var p=u.split("_"),c=parseInt(p[0]),g=parseInt(p[1]),f=d[u].rowSpan,m=d[u].colSpan;if(t>=c&&t<c+f&&e>=g&&e<g+m){i=f,o=m;break}}for(var y=0,b=e;b>=0;)h=b,b-=this.struct.body.rowArr[y].length,y++;if(y--,this.options.focusDefaultColumn&&y<0)o=1,i=1,w=t,h=e;else{o=o||parseInt(this.struct.body.rowArr[y][h].colSpan||1),i=i||parseInt(this.struct.body.rowArr[y][h].rowSpan||1),h=this.struct.body.rowArr[y][h]["@col"];var w=t*a+y;h=n[h]}return{rowIndex:w,colIndex:h,rowSize:i,colSize:o}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.getOriginalRowCol=function(t,e){try{for(var i=this.htmlInfo.body.rowAttrArr.length,o=(this.getColumnOrder(),!1),a=!0,r=t%i,n=1,l=1,h=[],d=0;d<i;d++){for(var u=[],p=0;p<this.htmlInfo.body.rowArr[d].length;p++)u.push({colSpan:parseInt(this.htmlInfo.body.rowArr[d][p].colSpan||1),rowSpan:parseInt(this.htmlInfo.body.rowArr[d][p].rowSpan||1),oriColIndex:parseInt(this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[d][p].col_id]),positionCalColIndex:parseInt(this.htmlInfo.body.rowArr[d][p]["@col"])});h.push(u)}for(d=0;d<i;d++){var c=0;for(p=0;p<h[d].length;p++){if(h[d][p].rowSpan>1)for(var g=1;g<h[d][p].rowSpan;g++)if(d+g<i){var f={oriRowAttrNum:d,rowIndex:d+g,oriColIndex:h[d][p].oriColIndex,colIndex:c,rowSpan:1,colSpan:h[d][p].colSpan,oriRowSpan:h[d][p].rowSpan,positionCalColIndex:h[d][p].positionCalColIndex};h[d+g].splice(h[d][p].positionCalColIndex||c,0,f)}c+=h[d][p].colSpan}}for(d=0;d<i;d++)h[d].sort((function(t,e){return t.positionCalColIndex-e.positionCalColIndex}));var m,y=h[r],b=0;for(p=0;p<y.length;p++){var w=parseInt(y[p].colSpan);if((b+=w)>e){e!==b-w&&(e=b-w,o=!0,a=!1),l=w,m=p;break}}n=y[m].rowSpan,void 0!==y[m].oriRowAttrNum&&(r+=y[m].oriRowAttrNum-y[m].rowIndex,n=y[m].oriRowSpan,o=!0),m=y[m].oriColIndex;var v=Math.floor(t/i),C=this.cellMergeInfo;for(var I in C){var _=I.split("_"),x=(u=parseInt(_[0]),parseInt(_[1])),S=C[I].rowSpan,D=C[I].colSpan;if(v>=u&&v<u+S&&m>=x&&m<x+D){if(v==u&&m==x){n=S,l=D;break}m!=x&&(a=!1),v=u,m=x,n=S,l=D,o=!0;break}}return{rowIndex:v,colIndex:m,rowSize:n,colSize:l,noLeftTop:o,leftCell:a}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setImeMode=function(t,e){try{var i=this.getCellInfo(t);"text"!=i.options.inputType&&"textImage"!=i.options.inputType&&"textArea"!=i.options.inputType&&"drilldown"!=i.options.inputType||(i.options.imeMode=e)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._isGridViewItemTable=function(){try{return!(!this.parentControl||!this.parentControl.options||"gridItemTable"!==this.parentControl.options.pluginName&&"gridViewItemTable"!==this.parentControl.options.pluginName)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.searchData=function(t){try{void 0!==t&&null!=t||(t={}),this.clearSearchData({noRefresh:!0});var e=t.column;e=e?e.split(","):this.tdIdList.slice(0);for(var i=this.getRowCount(),o=[],a=[],r=0;r<i;r++){for(var n=!1,h=this.__getGroupbyGroupedRowIndex(r),d=this.getRealRowIndex(h),u=0;u<e.length;u++){var p=this.getColumnIndex(e[u]);this.getCellDisplayData(r,p).indexOf(t.data)>=0&&(n=!0,a.unshift([d,p]))}n&&o.push(d)}if(this.groupbyStatus.grouped){var c={};for(r=0;r<o.length;r++)c[o[r]+""]=!0;this.groupbyStatus.groupbyRowIndexArr=o.slice(0);var g=this.groupbyStatus.groupedRowIndexArr;this._beforeSearch={groupbyRowIndexArr:o.slice(0),groupedRowIndexArr:g.slice(0)};var f=[];for(r=0;r<g.length;r++)if("object"===(0,l.Z)(g[r])){if(0===g[r].depth&&f.length>0&&"object"===(0,l.Z)(f[f.length-1]))for(;f.length>0&&"object"===(0,l.Z)(f[f.length-1]);)f.pop();f.push(g[r])}else!0===c[g[r]+""]&&f.push(g[r]);for(;f.length>0&&"object"===(0,l.Z)(f[f.length-1]);)f.pop();this.groupbyStatus.groupedRowIndexArr=f}var m={type:"direct",key:o,filterId:this.id+"_searchData"};this.dataList.setFilter(m);for(r=0;r<a.length;r++){
var y=this.getDisplayRowIndex(a[r][0]),b=this.__getGroupbyGroupedRowIndex(y);this.setFocusedCell(b,a[r][1],!1,{ctrled:!0})}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.clearSearchData=function(t){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;void 0!==t&&null!=t||(t={});var e={filterId:this.id+"_searchData",noRefresh:t.noRefresh};this.groupbyStatus.grouped&&this._beforeSearch&&(this.groupbyStatus.groupbyRowIndexArr=this._beforeSearch.groupbyRowIndexArr.slice(0),this.groupbyStatus.groupedRowIndexArr=this._beforeSearch.groupedRowIndexArr.slice(0)),this._beforeSearch=null,this.dataList.removeFilter(e),this.removeFocusedCell(),!0===t.clearValue&&this.groupbyZone_searchinput.setValue("")}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._groupbyZoneSearch=function(){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;var t=this.groupbyZone_searchinput.getValue();if(""===t)this.clearSearchData();else{var e={};e.data=t,this.searchData(e)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setBlockSelect=function(t,e){try{if(!0!==e&&!1!==e)return;var i=this.getCellInfo(t);if(i&&i.options.blockSelect!==e){var o=this.getColumnIndex(t);i.options.blockSelect=e;for(var a=0;a<this.focusedCell.length;a++)if(this.focusedCell[a].focusedColIndex===o){var r=this.focusedCell[a];this._applyFocusedCellOut(r)}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setVisibleRowNum=function(t){try{if(t=parseInt(t,10),isNaN(t)||t<=0)return!1;this.options.initFixedHeightByRowNum>-1&&(this.options.initFixedHeightByRowNum=t);for(var e=this.options.visibleRowNum,i=this.getColumnOrder(),o=this.getColCnt(),a=[],r=0;r<o;r++)a.push(r);var n=!1,l=!0;("all"==e||""==e||parseInt(e,10))&&(n=!0);for(r=0;r<i.length;r++)if(i[r]!==a[r]){l=!1;break}this.options.visibleRowNum=t,this._dynamicVisibleRowNum=t,!l&&n&&this.setColumnOrder(a);var h=this._getVisibleRowNumHeight(!0);this.setTrRowTable(),this.getScrollTop()>0?(this.setSize(null,h),this.handleResize({startPoint:"0"}),this.scrollEvent=!1,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0):this.setSize(null,h),!l&&n&&this.setColumnOrder(i)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.enableAllDate=function(t){try{var e=this.getCellInfo(t);if("calendar"!=e.options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;var i=this.getInput(e);e.options.disableBeforeDate="",e.options.disableAfterDate="",i&&i.enableAllDate()}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setEditModeEvent=function(t,e){try{if(t&&(this.options.editModeEvent=t,e))for(var i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);o.options.editModeEvent&&(o.options.editModeEvent=t,this.refreshColumn(o.colID))}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setColumnEditModeEvent=function(t,e){try{if(e){var i=this.getCellInfo(t);if(bRefreshColumn)for(var o=0;o<this.getColumnCount();o++){(i=this.getCellInfo(o)).options.editModeEvent&&(i.options.editModeEvent=e,this.refreshColumn(i.colID))}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype.setFocusMode=function(t){try{if(this.options.focusMode===t||"cell"!==t&&"row"!==t&&"both"!==t)return;this.removeFocusedCell(),this.options.focusMode=t}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setRedrawTextAreaColumn=function(t){try{for(var e=!1,i=0;i<this.getColumnCount();i++){var o=this.getCellInfo(i);"textarea"==o.options.inputType&&"all"==o.options.displayType&&(e=!0,t||this.redrawColumn(i))}if(t&&e&&"all"===this.options.visibleRowNum&&!0!==this._isBrowserScroll()&&this.getRowCount()>0){var a=document.getElementById(this.id+"_body_table").offsetHeight;this.render.offsetHeight!=a&&this.setSize(null,a)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getSelectedIndex=function(t,e){try{var i=this.getCellInfo(e);if(i&&"select"==i.options.inputType){var o=this.getColumnIndex(e),a=this._getStyleRowIndex(t);if(null==a)return;if("number"==typeof a){
var r=this._cellSelectedIndex[a*this.oneRowDataLength+o];return void 0===r&&(this._cellSelectedIndex[a*this.oneRowDataLength+o]=-1,r=-1),r}}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setSelectedIndex=function(t,e,i){try{e=this.getColumnIndex(e);var o=this._getStyleRowIndex(t);if(null==o)return;"number"==typeof o&&(this._cellSelectedIndex[o*this.oneRowDataLength+e]=i)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._setFirsCellFocus=function(t){try{for(var e=0,i=this.getRowCount()-1,o=this.getLeftMostFocusableColIndex(e);e<i&&null==o;)e+=1,o=this.getRightMostFocusableColIndex(e);var a=this.getCellInfo(o);if("button"===a.options.inputType||"radio"===a.options.inputType||"checkbox"===a.options.inputType||"user"===a.options.inputType){var r=0,n=this.getCheckedIndex(a.colID)[0];n>0&&(r=n),this._setFocusedCell(r,o,!1,{tabDirection:"right"}),WebSquare.event.stopEvent(t)}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._isNumberType=function(t){try{return!(!t||"float"!=t&&"number"!=t&&"bigDecimal"!=t&&"euro"!=t&&"tenge"!=t&&"rupee"!=t)}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._getOperator=function(t){try{var e,i;return 0==t.indexOf(">=")?(i=t.replace(">=",""),e=">="):0==t.indexOf(">")?(i=t.replace(">",""),e=">"):0==t.indexOf("<=")?(i=t.replace("<=",""),e="<="):0==t.indexOf("<")?(i=t.replace("<",""),e="<"):0==t.indexOf("==")?(i=t.replace("==",""),e="=="):0==t.indexOf("!=")?(i=t.replace("!=",""),e="!="):t&&(e="==",i=t),{operator:e,value:i}}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._isMatched=function(t,e,i,o){try{var a=!0,r=t,n=e;return this._isNumberType(o)&&(r=parseFloat(r),n=parseFloat(n),isNaN(Number(n))&&(n=0)),">"==i?n>r||(a=!1):">="==i?n>=r||(a=!1):"<"==i?n<r||(a=!1):"<="==i?n<=r||(a=!1):"!="==i?n==r&&(a=!1):"=="==i&&n!=r&&(a=!1),a}catch(t){s.w.printStackTrace(t,null,this)}},k.prototype._ShiftKeyMultiCheck=function(t,e,i){try{var o=this.getCellInfo(i),a=o.id,r=this.getColumnIndex(a);if(t.beforeChecked){for(var n=parseInt(t.beforeChecked.rowIndex),l=parseInt(e.rowIndex),h=Math.min(n,l),d=Math.max(n,l),u=0;u<t.getDataLength()&&!(u>d);u++)h<=u&&u<=d&&t._dataList.setCellData(u,a,o.options.trueValue);o.options.blockSelect||(t.applyFocusedCellOut(),t.focusedCell=[],t._applyFocusedMultiCell(n,r,l,r)),!0!==e.checked&&(i.getElementsByTagName("input")[0].checked=!0)}}catch(t){s.w.printStackTrace(t,null,this)}};var F=function(){};F.prototype.getColumnReadOnly=function(t){var e=this.getCellInfo(t);return""!=e.options.readOnly?r.D.getBoolean(e.options.readOnly):""},F.prototype.setColumnReadOnly=function(t,e){try{var i=this.getCellInfo(t);""!=e&&(e=r.D.getBoolean(e));var o=i.options.readOnly;if(i.options.readOnly=e,o!==e){if(null!=this.editedCell){var a=r.D.getDataPrefix("tdindex"),n=parseInt(this.editedCell.editTd.getAttribute(a))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=n==t}else this.rollbackCommitFlag=!1;this.drawColumnData(t),this.applyStyleOptions(this.lastIndex)}}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getRowReadOnly=function(t,e){try{var i=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===e?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),o=this.rowReadOnlyArr[i];return 1!=o&&0!=o?"":o}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setRowReadOnly=function(t,e,i){try{var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),a=o||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));""!=e&&(e=r.D.getBoolean(e));var n=o||!0===i?this.getDisplayRowIndex(a):this._getGroupbyGroupedRowIndex(t),l=this.rowReadOnlyArr[a];this.rowReadOnlyArr[a]=e,l!==e&&(null!=this.editedCell&&this.editedCell.editRowIndex==a?this.rollbackCommitFlag=!0:this.rollbackCommitFlag=!1,n>=0&&(this.drawRowData(n-this.rowIndex,n,!0),this.applyRowStyleOptions(n)))}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getCellReadOnly=function(t,e,i){try{
e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),a=this.cellReadOnlyArr[o*this.oneRowDataLength+e];return 1!=a&&0!=a?"":a}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setCellReadOnly=function(t,e,i){try{if(""!=i&&(i=r.D.getBoolean(i)),(e=this.getColumnIndex(e))>=this.getColumnCount())return;var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),a=o?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),n=o?this.getDisplayRowIndex(a):this._getGroupbyGroupedRowIndex(t),l=this.cellReadOnlyArr[a*this.oneRowDataLength+e];if(this.cellReadOnlyArr[a*this.oneRowDataLength+e]=i,l!==i){var h=this.rollbackCommitFlag;if(null!=this.editedCell&&this.editedCell.editRowIndex==a){var d=r.D.getDataPrefix("tdindex"),u=parseInt(this.editedCell.editTd.getAttribute(d))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=u==e}else this.rollbackCommitFlag=!1;n>=0&&(this.notifyCellChanged(n,e),this.rollbackCommitFlag=h,this.applyCellStyleOptions(n,e))}}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getColumnDisabled=function(t){var e=this.getCellInfo(t);return r.D.getBoolean(e.options.disabled)},F.prototype.setColumnDisabled=function(t,e){try{e=r.D.getBoolean(e);var i=this.getCellInfo(t),o=i.options.disabled;i.options.disabled=e,o!==e&&(this.drawColumnData(t),this.applyColumnStyleOptions(t))}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getRowDisabled=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));return r.D.getBoolean(this.rowDisabledArr[e])}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setRowDisabled=function(t,e){try{e=r.D.getBoolean(e);var i=!(!this.isDrillDown||!this._dataList.options.depthColumn),o=i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),a=i?this.getDisplayRowIndex(o):this._getGroupbyGroupedRowIndex(t),n=this.rowDisabledArr[o];this.rowDisabledArr[o]=e,n!==e&&a>=0&&(this.drawRowData(a-this.rowIndex,a,!0),this.applyRowStyleOptions(a))}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getCellDisabled=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));i&&(o=t);var a=this.cellDisabledArr[o*this.oneRowDataLength+e];return 1!=a&&0!=a?"":a}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setCellDisabled=function(t,e,i,o){try{i=r.D.getBoolean(i);e=this.getColumnIndex(e);var a=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=a?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),l=a?this.getDisplayRowIndex(n):this._getGroupbyGroupedRowIndex(t);o&&(n=t,l=this.getDisplayRowIndex(t));var h=this.cellDisabledArr[n*this.oneRowDataLength+e];this.cellDisabledArr[n*this.oneRowDataLength+e]=i,h!==i&&l>=0&&(this.notifyCellChanged(l,e),this.applyCellStyleOptions(l,e))}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setTDStyle=function(t,e,i,o,s){""!=this.options.readOnlyBackgroundColor&&this.___getEditReadOnly(e,i)&&(s="background-color:"+this.options.readOnlyBackgroundColor+";"+s),this._getEditDisabled(e,i)?(t.disabled=!0,""!=this.options.disabledBackgroundColor&&(s+=";background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(s+=";color:"+this.options.disabledFontColor)):t.disabled=!1,t.style.cssText=o+";"+s},F.prototype.setStyleAll=function(t){try{var e=t.type,i=e.charAt(0).toUpperCase()+e.slice(1),o=t.target||"";"all"!==o&&"default"!==e&&"init"!==e||(o=""),"cell"!==e&&"disabledCell"!==e||(o="");var a=o?o.charAt(0).toUpperCase()+o.slice(1):"",r=t.styleName,n=t.styleValue,l=t.noRefresh,h=t.rowIndex,d=t.useRealRowIndex;d||(h=this._getGroupbyGroupedRowIndex(h));var u,c=t.colIndex
;if("column"===e||"cell"===e||"default"===e||"init"===e){if(c=this.getColumnIndex(c),!this.getColumnID(c)&&!this.successBinding)return;if(!this.getColumnID(c)&&!this._dataList.getColumnID(c))return void p.k.printLog("[Warning] Invalid colIndex("+c+").["+this.id+"] set"+i+"Style"+a)}var g="ValueObj";"column"===e||"adaptiveColumn"===e||"default"===e||"init"===e?(u=c,i="Column"):"disabledCell"===e?(u=h+"_"+c,i="Cell",g="Obj"):null==(u=null==c?this["get"+i+"Style"+a+"ClassName"](h,d):this["get"+i+"Style"+a+"ClassName"](h,c,d))&&(this[e+"Style"+a+"Index"]++,u=this.id+"_"+e+"style"+o+"_"+this[e+"Style"+a+"Index"]+"_",null==c?this["set"+i+"Style"+a+"ClassName"](h,u,d):this["set"+i+"Style"+a+"ClassName"](h,c,u)),null==(t=this[e+"Style"+a+g][u])&&(t={}),t[r]=n;var f=[];for(var r in t){var m=t[r];"style"!=r&&""!=m&&f.push(r+":"+m)}if(t.style=f.join(";"),this[e+"Style"+a+g][u]=t,!0!==l)if(null==h)this["apply"+i+"StyleOptions"](c);else!(!this.isDrillDown||!this._dataList.options.depthColumn)&&!d&&(h=this.getDisplayRowIndex(h)),!d||"cell"!=e&&"row"!=e?this["apply"+i+"StyleOptions"](h,c):"cell"==e?this["apply"+i+"StyleOptions"](h,c,void 0,void 0,d):this["apply"+i+"StyleOptions"](h,d)}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setRowBackgroundColor=function(t,e,i){this.setRowStyle(t,"background-color",e,i)},F.prototype.setRowColor=function(t,e,i){this.setRowStyle(t,"color",e,i)},F.prototype.setRowStyle=function(t,e,i,o){this.setStyleAll({type:"row",rowIndex:t,styleName:e,styleValue:i,useRealRowIndex:o})},F.prototype.getRowBackgroundColor=function(t){return this.getRowStyleValue(t,"background-color")},F.prototype.getRowColor=function(t){return this.getRowStyleValue(t,"color")},F.prototype.getRowStyleValue=function(t,e){t=this._getGroupbyGroupedRowIndex(t);var i=this.getRowStyleClassName(t);return null==i?"":this.rowStyleValueObj[i][e]||""},F.prototype._getRowStyleStr=function(t){return this.rowStyleValueObj[t].style},F.prototype.setColumnBackgroundColor=function(t,e){this.setColumnStyle(t,"background-color",e)},F.prototype.setColumnColor=function(t,e){this.setColumnStyle(t,"color",e)},F.prototype.setColumnStyle=function(t,e,i){this.setStyleAll({type:"column",colIndex:t,styleName:e,styleValue:i})},F.prototype.setDefaultStyle=function(t,e,i){this.setStyleAll({type:"default",colIndex:t,styleName:e,styleValue:i})},F.prototype._setInitStyle=function(t,e,i){this.setStyleAll({type:"init",colIndex:t,styleName:e,styleValue:i})},F.prototype.setAdaptiveColumnStyle=function(t,e,i){this.setStyleAll({type:"adaptiveColumn",colIndex:t,styleName:e,styleValue:i,noRefresh:!0})},F.prototype.getColumnBackgroundColor=function(t){return this.getColumnStyleValue(t,"background-color")},F.prototype.getColumnColor=function(t){return this.getColumnStyleValue(t,"color")},F.prototype.getColumnStyleValue=function(t,e){var i=this.columnStyleValueObj[t];return null==i?this.getDefaultStyleValue(t,e):i[e]||this.getDefaultStyleValue(t,e)},F.prototype._getColumnStyleStr=function(t){return this.columnStyleValueObj[t].style},F.prototype.getDefaultStyleValue=function(t,e){var i=this.defaultStyleValueObj[t];return null==i?"":i[e]||""},F.prototype._getInitStyleValue=function(t,e){var i=this.initStyleValueObj[t];return null==i?"":i[e]||""},F.prototype._getDefaultStyleStr=function(t){return this.defaultStyleValueObj[t].style},F.prototype.getAdaptiveColumnStyleValue=function(t,e){var i=this.adaptiveColumnStyleValueObj[t];return null==i?"":i[e]||""},F.prototype.setCellBackgroundColor=function(t,e,i,o){this.setCellStyle(t,e,"background-color",i,void 0,o)},F.prototype.setCellColor=function(t,e,i,o){this.setCellStyle(t,e,"color",i,void 0,o)},F.prototype.setCellStyle=function(t,e,i,o,s,a){var r=this.getColumnID(e);if(this.mergeCellBkStatus&&this.mergeCellBkStatus[r]){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);this.mergeCellBkStatus[r][n]=null,delete this.mergeCellBkStatus[r][n]}this.setStyleAll({type:"cell",rowIndex:t,
colIndex:e,styleName:i,styleValue:o,noRefresh:s,useRealRowIndex:a})},F.prototype._refreshCellStyle=function(t){var e=[],i=this.cellStyleValueObj[t];for(var o in i){var s=i[o];"style"!=o&&""!=s&&e.push(o+":"+s)}i.style=e.join(";"),this.cellStyleValueObj[t]=i},F.prototype.setDisabledCellStyle=function(t,e,i,o){e=this.getColumnIndex(e);this._getEditDisabled(t,e)&&this.setStyleAll({type:"disabledCell",rowIndex:t,colIndex:e,styleName:i,styleValue:o})},F.prototype.getCellBackgroundColor=function(t,e){return this.getCellStyleValue(t,e,"background-color")},F.prototype.getCellColor=function(t,e){return this.getCellStyleValue(t,e,"color")},F.prototype.getCellStyleValue=function(t,e,i,o){try{t=this._getGroupbyGroupedRowIndex(t);var a=this.getCellStyleClassName(t,e);return null==a?(!0!==o&&p.k.printLog("[Warning] Is not exist cell!["+this.id+"]"),""):this.cellStyleValueObj[a][i]||""}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype._getCellStyleStr=function(t){return this.cellStyleValueObj[t].style},F.prototype.setHeaderCellStyle=function(t,e,i){try{var o=this.getHeaderLayer(t);WebSquare.style.setStyle(o,e,i)}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setHeaderBackgroundColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"background-color",e),this.headerCellStyleValueObj[t]={"background-color":e}}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.setHeaderColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"color",e)}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getHeaderCellStyleValue=function(t,e){try{var i=this.getHeaderLayer(t);return WebSquare.style.getStyle(i,e)}catch(t){s.w.printStackTrace(t,null,this)}},F.prototype.getHeaderBackgroundColor=function(t){return this.getHeaderCellStyleValue(t,"background-color")},F.prototype.getHeaderColor=function(t){return this.getHeaderCellStyleValue(t,"color")},F.prototype._setMergeCellBackground=function(t,e,i){var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t),s=this.getColumnID(e),a=this.getColumnIndex(e);if(this.options.groupbyZone&&(this.mergeCellBkStatus||(this.mergeCellBkStatus={}),this.mergeCellBkStatus[s]||(this.mergeCellBkStatus[s]={}),null==this.mergeCellBkStatus[s][o])){var r=this.getCellStyleValue(t,s,"background-color",!0)||this.getColumnStyleValue(a,"background-color");this.mergeCellBkStatus[s][o]=r}var n=this.setCellDefaultStyleClassName(o,a,!0);this.cellStyleValueObj[n]["background-color"]=i,this._refreshCellStyle(n)},F.prototype._clearMergeCellBackground=function(){if(this.mergeCellBkStatus){for(var t in this.mergeCellBkStatus)for(var e in this.mergeCellBkStatus[t]){var i=parseInt(e,10),o=this.mergeCellBkStatus[t][e],s=this.setCellDefaultStyleClassName(i,t,!0);this.cellStyleValueObj[s]["background-color"]=o,this._refreshCellStyle(s),o||delete this.cellStyleValueObj[s]["background-color"]}delete this.mergeCellBkStatus}};var A=function(t){this.statusArr=[],this.mainGrid=null,this.options=null,this.mode=null};A.prototype.initialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(p.k.printLog("경고 : drilldown에서는 filter기능을 사용할 수 없습니다. 개별 filter를 자동으로 전부 해제합니다.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,a=!0,r=parseInt(this.options.showDepth,10),n=0;n<s;n++){var l=t._linkedDataList.initialRowIndexArr[n];this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=r&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),
this.statusArr[l]=!0,a=!1)}if(!0===a)for(l=0;l<s;l++)this.mainGrid._linkedDataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}else{t._dataList.filteredRowIndexArr=[],this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),a=!0,r=parseInt(this.options.showDepth,10),l=0;l<s;l++){this.statusArr[l]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(l,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(l,this.mainGrid.getColumnID(i))))<=r&&(this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0,a=!1)}if(!0===a)for(l=0;l<s;l++)this.mainGrid._dataList.filteredRowIndexArr.push(l),this.statusArr[l]=!0}},A.prototype.getDepth=function(t){return"dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(t,this.mainGrid._dataList.getColumnID(this.options.depthColumn))):parseInt(this.mainGrid.dataList._getData(t,this.mainGrid.getColumnID(this.options.depthColumn)))},A.prototype.isOpen=function(t){var e=this.getDepth(this.mainGrid.getRealRowIndex(t)),i=0;i="linkedDataList"===this.mode?this.mainGrid._linkedDataList.filteredRowIndexArr[t+1]:this.mainGrid._dataList.filteredRowIndexArr[t+1];var o=this.getDepth(i);return!isNaN(e)&&!isNaN(o)&&e<o},A.prototype.hasChild=function(t){if("linkedDataList"===this.mode){var e=this.mainGrid._linkedDataList.filteredRowIndexArr[t],i=this.mainGrid._linkedDataList.getLinkedRowIndex(t),o=this.mainGrid._linkedDataList.initialRowIndexArr[i+1],s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));var a=parseInt(this.mainGrid.dataList._getData(e,s)),r=parseInt(this.mainGrid.dataList._getData(o,s));return a<(r=isNaN(r)?0:r)}o=(e=this.mainGrid.getRealRowIndex(t))+1,s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));a=parseInt(this.mainGrid.dataList._getData(e,s)),r=parseInt(this.mainGrid.dataList._getData(o,s));return a<(r=isNaN(r)?0:r)},A.prototype.getOriginalRowIndex=function(t){return this.openRowIndexArr[t]},A.prototype.getDisplayRowIndex=function(t){if("linkedDataList"===this.mode){if(this.mainGrid._linkedDataList.filteredRowIndexArr)for(var e=0;e<this.mainGrid._linkedDataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid._linkedDataList.filteredRowIndexArr[e])return e}else if(this.mainGrid._dataList.filteredRowIndexArr)for(e=0;e<this.mainGrid._dataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid.getRealRowIndex(e))return e;return t},A.prototype.getChildRowArr=function(t,e){var i=t,o=this.getDepth(t),s=this.mainGrid.getTotalRow(),a=[],r=this.options.depthColumn,n=this.mainGrid.getColumnID(r);if("dataList"==this.options.dataColumn&&(n=this.mainGrid._dataList.getColumnID(r)),"linkedDataList"===this.mode)for(var l=i+1;l<s;l++){var h=this.mainGrid._linkedDataList.initialRowIndexArr[l];if(this.mainGrid.dataList._getData(h,n)==o+1&&a.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&a.push(h),this.mainGrid.dataList._getData(h,n)<=o)break}else for(h=i+1;h<s&&(this.mainGrid.dataList._getData(h,n)==o+1&&a.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&a.push(h),!(this.mainGrid.dataList._getData(h,n)<=o));h++);return a},A.prototype.pasteDrilldownInitialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(p.k.printLog("경고 : drilldown에서는 filter기능을 사용할 수 없습니다. 개별 filter를 자동으로 전부 해제합니다.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[]
;for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,a=0;a<s;a++){var r=t._linkedDataList.initialRowIndexArr[a];this.statusArr[r]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(r,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(r,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(r),this.statusArr[r]=!0)}}else{this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),r=0;r<s;r++)this.statusArr[r]=!0}},A.prototype.getChildrenRowArr=function(t){var e=[];if(this.mainGrid){var i=this.mainGrid.getTotalRow(),o=this.options.depthColumn,s=this.mainGrid.getColumnID(o);if("dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(o)),"linkedDataList"===this.mode){var a=this.mainGrid._linkedDataList.initialRowIndexArr[t+1],r=parseInt(this.mainGrid.dataList._getData(this.mainGrid._linkedDataList.initialRowIndexArr[t],s),10);if(a<i&&this.mainGrid.dataList._getData(a,s)>r){e.push(a);var n=parseInt(this.mainGrid.dataList._getData(a,s),10),l=!0}if(l)for(var h=t+2;h<i;h++){a=this.mainGrid._linkedDataList.initialRowIndexArr[h];if(this.mainGrid.dataList._getData(a,s)<r+1)break;this.mainGrid.dataList._getData(a,s)<n+1&&(e.push(a),n=parseInt(this.mainGrid.dataList._getData(a,s),10))}}else{a=t+1,r=parseInt(this.mainGrid.dataList._getData(t,s),10);if(a<i&&this.mainGrid.dataList._getData(a,s)>r){e.push(a);n=parseInt(this.mainGrid.dataList._getData(a,s),10),l=!0}if(l)for(a=t+2;a<i&&!(this.mainGrid.dataList._getData(a,s)<r+1);a++)this.mainGrid.dataList._getData(a,s)<n+1&&(e.push(a),n=parseInt(this.mainGrid.dataList._getData(a,s),10))}}return e},A.prototype.getParentRowIndex=function(t){if(this.mainGrid){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=parseInt(this.mainGrid.dataList._getData(t,i));if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var a=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(a,i)<o)return a}else for(a=t-1;a>=0;a--)if(this.mainGrid.dataList._getData(a,i)<o)return a}return-1},A.prototype.makeOpenRowIndexArr=function(){if("linkedDataList"===this.mode){this.mainGrid._linkedDataList.filteredRowIndexArr=[];for(var t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._linkedDataList.filteredRowIndexArr.push(t)}else{this.mainGrid._dataList.filteredRowIndexArr=[];for(t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._dataList.filteredRowIndexArr.push(t)}},A.prototype.toggle=function(t){var e=this.isOpen(t),i=[];t="linkedDataList"===this.mode?this.mainGrid._linkedDataList.getLinkedRealRowIndex(t):this.mainGrid.getRealRowIndex(t),i=e?this.getChildRowArr(t,!0):this.getChildrenRowArr(t);for(var o=0;o<i.length;o++)this.statusArr[i[o]]=!e;this.makeOpenRowIndexArr(),u.B.fireEvent(this.mainGrid,"ontoggleclick",e,t)},A.prototype.getAncestorRowArr=function(t){if("number"!=typeof t)return!1;for(var e=[],i=t;i>=0;)e.push(i),i=this.getParentRowIndex(i);return e.shift(),e},A.prototype.drillTo=function(t){if("number"!=typeof t)return!1;var e=this.getAncestorRowArr(t);e.unshift(t);for(var i=0;i<e.length;i++){var o=e[i];if(this.statusArr[o]=!0,0!=i)for(var s=this.getChildrenRowArr(o),a=0;a<s.length;a++)this.statusArr[s[a]]=!0}return this.makeOpenRowIndexArr(),this.getDisplayRowIndex(e[e.length-1])},A.prototype.isLastChild=function(t){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=this.mainGrid.dataList._getData(t,i);if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){
var a=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(a,i)<o)return a}else for(a=t+1;a<this.mainGrid.getTotalRow();a++){if(this.mainGrid.dataList._getData(a,i)==o)return!1;if(this.mainGrid.dataList._getData(a,i)<o)return!0}return!0},A.prototype.getRecursiveRowIndex=function(t){try{for(var e=[],i=this.getChildrenRowArr(t),o=0;o<i.length;o++){var a=i[o];e.push(a),e=e.concat(this.getRecursiveRowIndex(a))}return e}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.getRecursiveRowCount=function(t){try{for(var e=0,i=this.getChildrenRowArr(t),o=0;o<i.length;o++)e+=this.getRecursiveRowCount(i[o]),e++;return e}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.appendChild=function(t,e){try{if(e){var i=t+this.getRecursiveRowCount(t);return this.mainGrid._toggle(this.getDisplayRowIndex(t)),this.mainGrid.dataList.setRowData(i+1,e)}$l("data is null. check data.["+this.id+"]")}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.moveNode=function(t,e){try{var i;if(t<e){if(!this.bodyDrop)i=e-(this.getRecursiveRowCount(t)+1)}else(t>e||t==e)&&(i=e);var o=this.detachNode(t),a=this.appendNode(i,o);return"number"!=typeof i&&(i=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1)),this.bodyDrop=!1,{detachedData:o,insertedData:a,insertedRowIndex:i}}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.appendNode=function(t,e){try{var i,o,a,r=this.mainGrid._dataList.getColumnCount(),n=e.length/r,l=this.mainGrid._dataList.getColumnID(this.options.depthColumn);if(this.options.depthColumn=parseInt(this.options.depthColumn,10),this.bodyDrop){this.bodyDrop=!1;var h=this,d=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1),u=this.getDisplayRowIndex(function t(e){var i=h.getParentRowIndex(e);return i=i>-1?t(i):e}(d));i=parseInt(this.mainGrid.dataList.getCellData(u,l),10),o=parseInt(e[r*(n-1)+parseInt(this.options.depthColumn)],10),t=d+this.getRecursiveRowCount(d)+1,a=i-o}else{u=this.getDisplayRowIndex(t-1);a=(i=parseInt(this.mainGrid.dataList.getCellData(u,l),10))-(o=parseInt(e[r*(n-1)+parseInt(this.options.depthColumn)],10))+1}for(var p=[],c=0;c<n;c++)for(var g=0;g<r;g++){var f=e[r*c+g];g==this.options.depthColumn&&(f-=0,f+=a),p.push(f)}this.mainGrid.dataList._insertData(t,p,-1);var m=this.getDisplayRowIndex(t);return this.isOpen(m)&&this.mainGrid._toggle(m),p}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.detachNode=function(t){try{for(var e=[],i=this.mainGrid.dataList.removeRow(t,{skipNotify:!0}),o=0;o<i.length;o++)e=e.concat(i[o]);return e}catch(t){s.w.printStackTrace(t,null,this)}},A.prototype.insertNextSibling=function(t,e){try{this.options.depthColumn=parseInt(this.options.depthColumn,10);var i=this.mainGrid.dataList.getColumnCount(),o=e.length/this.mainGrid.dataList.getColumnCount(),a=this.mainGrid.getDisplayRowIndex(t),r=parseInt(this.mainGrid.dataList.getCellData(a,this.options.depthColumn),10)-parseInt(e[i*(o-1)+parseInt(this.options.depthColumn)],10),n=[];t+=this.getRecursiveRowCount(t)+1;for(var l=0;l<o;l++)for(var h=0;h<i;h++){var d=e[i*l+h];h==this.options.depthColumn&&(d-=0,d+=r),n.push(d)}if(this.mainGrid.dataList._insertData(t,n,-1),this.mainGrid.options.closeDrillDownSibling)for(l=0;l<o;l++){var u=this.getDisplayRowIndex(t+l);this.isOpen(u)&&this.mainGrid._toggle(u)}return n}catch(t){s.w.printStackTrace(t,null,this)}};var E=i(4263),M=function(t){this._linkedDataList._grid=t};M.prototype.getLinkedRowIndex=function(t){return this._linkedDataList.getLinkedRowIndex(t)},M.prototype.getRealRowIndex=function(t){return this._linkedDataList.filteredRowIndexArr[t]},M.prototype.getFilteredRowIndex=function(t){return this._linkedDataList.getFilteredRowIndex(t)},M.prototype.getTotalRow=function(){try{return this._linkedDataList.initialRowIndexArr.length}catch(t){s.w.printStackTrace(t)}},M.prototype.getTotalCol=function(){try{return this._linkedDataList._dataList.getTotalCol()}catch(t){s.w.printStackTrace(t)}},M.prototype.getRowCount=function(){try{
return this._linkedDataList.getDataLength()}catch(t){s.w.printStackTrace(t)}},M.prototype.getCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getCellData(i,e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getOriginalCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getOriginalCellData(i,e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getDataLength=function(){return this._linkedDataList.filteredRowIndexArr.length},M.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.w.printStackTrace(t,null,this)}},M.prototype.getRowPosition=function(){try{return this._linkedDataList._dataList.getRowPosition()}catch(t){s.w.printStackTrace(t,null,this)}},M.prototype.getColData=function(t){try{for(var e=[],i=0;i<this._linkedDataList.initialRowIndexArr.length;i++)e.push(this._linkedDataList.getCellData(i,t));return e}catch(t){s.w.printStackTrace(t)}},M.prototype.getRowData=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getRowData(e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getDataRow=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getDataRow(e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getMatchedData=function(t,e,i,o,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var r=[],n=this._linkedDataList.getMatchedIndex(t,e,i,o,a),l=0;l<n.length;l++)r.push(this._linkedDataList.getRowData(n[l]));return r}catch(t){s.w.printStackTrace(t)}},M.prototype.getUnmatchedData=function(t,e,i,o,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var r=[],n=this._linkedDataList.getUnmatchedIndex(t,e,i,o,a),l=0;l<n.length;l++)r.push(this._linkedDataList.getRowData(n[l]));return r}catch(t){s.w.printStackTrace(t)}},M.prototype.getMatchedColumnData=function(t,e,i,o,a,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getMatchedIndex(t,e,o,a,r),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.w.printStackTrace(t)}},M.prototype.getUnmatchedColumnData=function(t,e,i,o,a,r){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getUnmatchedIndex(t,e,o,a,r),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){s.w.printStackTrace(t)}},M.prototype.getFilteredColData=function(t){for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++)e.push(this._linkedDataList.getCellData(this._linkedDataList.filteredRowIndexArr[i],t));return e},M.prototype.getMatchedIndex=function(t,e,i,o,a){try{i=void 0===i||null==i||i,0!=(i=r.D.getBoolean(i))&&(i=!0);var n=this._linkedDataList._dataList.getColumnIndex(t),l=this._linkedDataList.getFilteredColData(n),h=[];"number"!=typeof o&&(o=0),"number"!=typeof a&&(a=l.length),a>l.length&&(a=l.length);for(var d=o;d<a;d++){var u=l[d],p=this._linkedDataList.getRealRowIndex(d);1==i?u===e&&h.push(p):u.indexOf(e)>-1&&h.push(p)}return h}catch(t){s.w.printStackTrace(t)}},M.prototype.getUnmatchedIndex=function(t,e,i,o,a){try{0!=i&&(i=!0);var r=this._linkedDataList._dataList.getColumnIndex(t),n=this._linkedDataList.getFilteredColData(r),l=[];"number"!=typeof o&&(o=0),"number"!=typeof a&&(a=n.length),a>n.length&&(a=n.length);for(var h=o;h<a;h++){var d=n[h],u=this._linkedDataList.getRealRowIndex(h);1==i?d!==e&&l.push(u):d.indexOf(e)<=-1&&l.push(u)}return l}catch(t){s.w.printStackTrace(t)}},M.prototype.getRangeData=function(t,e){try{var i=[];if(t>e){var o=e;e=t,t=o}t<0&&(t=0),e>this._linkedDataList.getDataLength()&&(e=this._linkedDataList.getDataLength());for(var a=t;a<e;a++){var r=this._linkedDataList.getRealRowIndex(a);i=i.concat(this._linkedDataList.getRowData(r))}return i
}catch(t){s.w.printStackTrace(t)}},M.prototype.getAllData=function(){try{return this._linkedDataList._dataList.getAllFilteredData()}catch(t){s.w.printStackTrace(t)}},M.prototype.getAllFilteredData=function(){this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=0;e<this._linkedDataList.getDataLength();e++)t=t.concat(this._linkedDataList.getRowData(e));return t},M.prototype.getColumnDistinctDataArray=function(t){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var e=[],i=[];"string"==typeof t&&(t=this._linkedDataList._dataList.bodyIdColIndexMap[t]);for(var o=this._linkedDataList._dataList.getCellInfo(t),a=this._linkedDataList.getColData(t),r=0;r<a.length;r++){i[a[r]]=1}for(var n in i)e.push(n);return"text"==o.options.dataType?e.sort():e.sort(this._linkedDataList.comparator),e}catch(t){s.w.printStackTrace(t)}},M.prototype.getRangeXML=function(t,e){try{return this._linkedDataList.getRangeXML(t,e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getMatchedXML=function(t,e,i,o,a){try{return this._linkedDataList.getMatchedXML(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},M.prototype.getUnmatchedXML=function(t,e,i,o,a){try{return this._linkedDataList.getUnmatchedXML(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},M.prototype.getRowXML=function(t){try{return this._linkedDataList.getRowXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getAllXML=function(t){try{return this._linkedDataList.getAllXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getAllFilteredXML=function(t){return this._linkedDataList.getAllFilteredXML(t)},M.prototype.getRowJSON=function(t,e){try{return this._linkedDataList.getRowJSON(t,e)}catch(t){s.w.printStackTrace(t)}},M.prototype.getAllJSON=function(t){try{return this._linkedDataList.getAllJSON(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getRangeJSON=function(t,e,i){try{return this._linkedDataList.getRangeJSON(t,e,i)}catch(t){s.w.printStackTrace(t)}},M.prototype.getMatchedJSON=function(t,e,i,o,a){try{return this._linkedDataList.getMatchedJSON(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},M.prototype.getUnmatchedJSON=function(t,e,i,o,a){try{return this._linkedDataList.getUnmatchedJSON(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},M.prototype.getFusionChartData=function(t,e,i,o){return this._linkedDataList.getFusionChartData(t,e,i,o)},M.prototype.getRowStatusValue=function(t){try{return this._linkedDataList.getRowStatusValue(t)}catch(t){s.w.printStackTrace(t,null,this)}},M.prototype.getRowStatus=function(t){try{return this._linkedDataList.getRowStatus(t)}catch(t){s.w.printStackTrace(t,null,this)}},M.prototype.getRowIndexByStatus=function(t){try{for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++){var o=this._linkedDataList.getRealRowIndex(i);t.indexOf(this._linkedDataList._dataList.getRowStatus(o))>-1&&e.push(o)}return e}catch(t){s.w.printStackTrace(t)}},M.prototype.getInsertedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("C")}catch(t){s.w.printStackTrace(t)}},M.prototype.getUpdatedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("U")}catch(t){s.w.printStackTrace(t)}},M.prototype.getDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("DV")}catch(t){s.w.printStackTrace(t)}},M.prototype.getOnlyDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("D")}catch(t){s.w.printStackTrace(t)}},M.prototype.getVoidIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("V")}catch(t){s.w.printStackTrace(t)}},M.prototype.getModifiedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("CUD")}catch(t){s.w.printStackTrace(t)}},M.prototype.getInsertedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getInsertedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]})
;var t=this._linkedDataList.getInsertedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getInsertedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getVoidData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getVoidXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getVoidIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getVoidJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getOnlyDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getOnlyDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getOnlyDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getOnlyDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getUpdatedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getUpdatedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getUpdatedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getUpdatedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getModifiedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.getModifiedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getModifiedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.getModifiedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]})
;for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){s.w.printStackTrace(t)}},M.prototype.setColumnFilter=function(t,e,i,o){return"object"!==(0,l.Z)(t)||r.D.isString(t)||(t.internal=!0),this._linkedDataList.setColumnFilter(t,e,i,o)},M.prototype.removeColumnFilter=function(t){return this._linkedDataList.removeColumnFilter(t,{internal:!0})},M.prototype.clearSortFilter=function(){return this._linkedDataList.clearSortFilter()},M.prototype.removeColumnFilterAll=function(){return this._linkedDataList.removeColumnFilterAll()},M.prototype.setFilter=function(t){return t&&(t.internal=!0),this._linkedDataList.setFilter(t)},M.prototype.removeFilter=function(t,e){return t&&(t.internal=!0),this._linkedDataList.removeFilter(t,e)},M.prototype.clearFilter=function(){return this._linkedDataList.clearFilter()},M.prototype.sort=function(t,e){return this._linkedDataList.sort(t,e)},M.prototype.clearSort=function(){return this._linkedDataList.clearSort()},M.prototype.multisort=function(t){return this._linkedDataList.multisort(t)},M.prototype.getRowArray=function(t){try{return this._linkedDataList.getRowArray(t)}catch(t){s.w.printStackTrace(t)}},M.prototype.removeRow=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._grid._dataList.removeRow(i,e)}catch(t){s.w.printStackTrace(t)}},M.prototype.removeRows=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(this._linkedDataList.getRealRowIndex(t[i]));return this._grid._dataList.removeRows(e)}catch(t){s.w.printStackTrace(t)}},M.prototype.setRowData=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowData(o,e,i)}catch(t){s.w.printStackTrace(t)}},M.prototype.setRowXML=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowXML(o,e,i)}catch(t){s.w.printStackTrace(t)}},M.prototype.insertData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.insertData(i,e)}catch(t){s.w.printStackTrace(t)}};var O=i(3721),N=function(t,e,i){var o;this.options=this._getDefaultOptionsMinimum(),t&&(o=t.getAttribute("escape")),!o&&e.element&&(o=e.element.getAttribute("escape"));var s=r.D.getEscape(o,e.options.pluginName);this.options.escape=s?r.D.getBoolean(s):this.options.escape,this.internal=!1,(i||"TD"==t.getTagName().toUpperCase())&&(this.internal=!0),this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),null!=this.mainGrid.scope_obj&&(this.options._scope_obj_uuid=this.mainGrid.scope_obj.uuid,this.scope_id=this.mainGrid.scope_obj.id),""!=this.options.value&&""==this.options.defaultValue&&(this.options.defaultValue=this.options.value),""==this.options.value&&""!=this.options.defaultValue&&(this.options.value=this.options.defaultValue),this.colID=this.options.col_id,this.id=this.options.col_id,this.options.id=this.options.col_id,this.setController(),this.initFormatter(t),this.initializeCellInfo(t,i),this.expressionStr=null,this.style="",this.heightGap=0;var n=a.v.browserVersion();if(a.v.browserCheck.ie&&"8"!=n&&(this.heightGap=2),""!=this.options.importExp&&(this.options.importExp=this.options.importExp.replace(/[cC][oO][lL][\s]*[(]/g,"_this.columnValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[xX][pP][aA][tT][hH][\s]*[(]/g,"_this.xpathValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.rowIndexValue(obfuscator_i")),(0==this.options.colSpan||isNaN(this.options.colSpan))&&(this.options.colSpan=1),(0==this.options.rowSpan||isNaN(this.options.rowSpan))&&(this.options.rowSpan=1),t){var l=!this.options.groupName||!this.options.groupValue,h=this.options.inputType;if(l&&("button"!=h&&"image"!=h)&&this.mainGrid.successBinding){var d=e._dataList.getCellInfo(this.id);!(!d||!d.element&&d.id!==this.id)||(this.options.readOnly=!0)}}
"radio"==this.options.inputType&&this.options.groupName&&(this.mainGrid.radioGroupRepChk[this.options.groupName]=!0),"$blank"==this.options.NaNFormat&&(this.options.NaNFormat=""),this.changedCellHeight=0,this.dynamicAttrInfo={},"custom"==this.options.inputType&&(this.mainGrid.hasCustomInputType=!0),"expression"===this.options.inputType&&"true"!==this.options.expressionSort&&(this.mainGrid.expressionHeaderInfo[this.mainGrid.bodyToHeaderRelation[this.id]]=!0)};for(var B in N.prototype.defaultOptions={id:"",col_id:"",colIndex:"",colSpan:0,rowSpan:0,defaultValue:"",value:"",inputType:"text",useFilter:!1,blockSelect:!1,dataType:"",valueType:"binary",viewType:"",trueValue:null,falseValue:null,editType:"",applyFormat:"display",displayFormat:"",displayFormatter:"",chooseOptionLabel:"-선택-",chooseOptionValue:"",chooseOption:!1,allOption:!1,title:"",voidNull:!1,adjustMaxLength:!1,useMaxLength:!1,depthColumn:"",showDepth:0,importExp:"",importFormatter:"",expression:"",colMerge:!1,colMergeEdit:!1,upperColumn:"",readOnly:"",imageWidth:"",imageHeight:"",imageClickFunction:"",imageSrc:"",imageSrcDisabled:"",imageSrcReadOnly:"",useImageClick:!1,alt:"",calendarValueType:"yearMonthDate",disabled:"",textAlign:"",exportFormatter:"",imeMode:"",selectSetter:"",ignoreStatus:!1,dateValidCheck:"",embeddedInput:"",groupName:"",escape:"false"!==a.v.getConfiguration("/WebSquare/escape/@value"),setRecursive:!1,showReadOnly:!1,customFormatter:"",escapeFormatter:"",depthType:"nbsp",moveFocusByChoice:"",directItemChoice:"",directOpen:!1,focusOutOnCheckHeaderClick:!0,usePartialCheck:!0,partialCheckNextClick:"",footerDiv:!1,displayRowIndex:!1,NaNFormat:"NaN",disabledClass:"",hiddenClass:"",displayMode:"0",delimiter:"\t",skipKeyMoveEditMode:!1,skipKeyMove:!1,checkboxLabel:"",checkboxLabelPosition:"right",checkboxLabelColumn:"",checkboxLabelFormatter:"",radioLabel:"",radioLabelPosition:"right",radioLabelColumn:"",radioLabelFormatter:"",checkAlways:!1,fixColumnWidth:!1,sortLabel:!1,useIOFormatLength:!1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",tooltipTime:1,minWidth:20,eventPriority:"onviewchange",customModelFormatter:"",customModelUnformatter:"",useMonthYearFormat:!1,editModeEventIcon:"",keepCellClass:!1,inputReadOnly:!1,keyMoveListSync:!1,tableRender:"",copyOption:"",invalidMessageFunc:"",dateValidSetCustom:!1,checkcomboboxUseDrag:!1,checkcomboboxUseEdit:!1,checkcomboboxRangeSeparator:"",checkcomboboxValidateOnInput:!1,checkcomboboxVisibleRowNum:0,checkcomboboxVisibleColNum:1,checkcomboboxVisibleColMax:1,placeholder:"",selectedData:!0,selectedDataDisplay:!0,refInitSync:!1,eventPropagation:!1,autoDecimalPoint:!1,noDisabledOnReadOnly:!1},N.prototype._getDefaultOptionsMinimum=function(){return{id:N.prototype.defaultOptions.id,col_id:N.prototype.defaultOptions.col_id,colIndex:N.prototype.defaultOptions.colIndex,value:N.prototype.defaultOptions.value,defaultValue:N.prototype.defaultOptions.defaultValue,inputType:N.prototype.defaultOptions.inputType,valueType:N.prototype.defaultOptions.valueType,viewType:N.prototype.defaultOptions.viewType,applyFormat:N.prototype.defaultOptions.applyFormat,displayFormat:N.prototype.defaultOptions.displayFormat,chooseOptionLabel:N.prototype.defaultOptions.chooseOptionLabel,chooseOptionValue:N.prototype.defaultOptions.chooseOptionValue,chooseOption:N.prototype.defaultOptions.chooseOption,title:N.prototype.defaultOptions.title,selectedData:N.prototype.defaultOptions.selectedData,selectedDataDisplay:N.prototype.defaultOptions.selectedDataDisplay,depthColumn:N.prototype.defaultOptions.depthColumn,showDepth:N.prototype.defaultOptions.showDepth,importExp:N.prototype.defaultOptions.importExp,expression:N.prototype.defaultOptions.expression,upperColumn:N.prototype.defaultOptions.upperColumn,readOnly:N.prototype.defaultOptions.readOnly,imageWidth:N.prototype.defaultOptions.imageWidth,imageHeight:N.prototype.defaultOptions.imageHeight,alt:N.prototype.defaultOptions.alt,
calendarValueType:N.prototype.defaultOptions.calendarValueType,disabled:N.prototype.defaultOptions.disabled,textAlign:N.prototype.defaultOptions.textAlign,exportFormatter:N.prototype.defaultOptions.exportFormatter,imeMode:N.prototype.defaultOptions.imeMode,selectSetter:N.prototype.defaultOptions.selectSetter,dateValidCheck:N.prototype.defaultOptions.dateValidCheck,escape:N.prototype.defaultOptions.escape,depthType:N.prototype.defaultOptions.depthType,NaNFormat:N.prototype.defaultOptions.NaNFormat,disabledClass:N.prototype.defaultOptions.disabledClass,hiddenClass:N.prototype.defaultOptions.hiddenClass,displayMode:N.prototype.defaultOptions.displayMode,delimiter:N.prototype.defaultOptions.delimiter,skipKeyMove:N.prototype.defaultOptions.skipKeyMove,minWidth:N.prototype.defaultOptions.minWidth,keepCellClass:N.prototype.defaultOptions.keepCellClass,usePartialCheck:N.prototype.defaultOptions.usePartialCheck}},N.prototype._defaultOptionsKeyLowerCase={},N.prototype.defaultOptions)N.prototype._defaultOptionsKeyLowerCase[B.toLowerCase()]=B;N.prototype.setOptions=function(t,e){try{var i=this.mainGrid.options.pluginName,n=t.getAttribute("calendarValueType")||this.options.calendarValueType,l=t.getAttribute("inputType")||"text";this.configOptions=o.x.extend({},a.v.getConfig(i+"/column[@inputType='"+l+"']"));var h=t.getAttribute("dataType")||"text";this.configOptions2=o.x.extend({},a.v.getConfig(i+"/column[@dataType='"+h+"']")),"calendar"==l&&"grid"==i?this.configOptions.displayFormat=a.v.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||a.v.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat/@value'):"calendar"==l&&"gridView"==i&&(this.configOptions.displayFormat=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@value')||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat/@value')||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+n+'"]/@defaultValue')),"textarea"===l&&(this.configOptions.keepCellClass=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/keepCellClass/@value')),this.options=o.x.extendKeepingType(o.x.extendKeepingType(this.options,this.configOptions2),this.configOptions);var d=WebSquare.Parser.parseAttribute(t);for(var u in d){var p=d[u];"class"==u?this.options.className=p:""!=String(p).wq_trim()&&(this._defaultOptionsKeyLowerCase[u]&&(u=this._defaultOptionsKeyLowerCase[u]),"boolean"==typeof this.defaultOptions[u]?p=r.D.getBoolean(p):"number"==typeof this.defaultOptions[u]&&(p=r.D.getNumber(p)),this.options[u]=p,e&&"data-col_id"==u&&(this.options.col_id=p))}if(!(h=this.options.dataType)&&this.mainGrid.successBinding&&(h=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"==h&&!this.options.displayFormat){if(this.options.displayFormatFunc){var c=r.D.getGlobalFunction(this.options.displayFormatFunc,this.scope_id);"function"==typeof c&&(this.options.displayFormat=c.call(this,this.options.calendarValueType))}this.options.displayFormat||(this.options.displayFormat=a.v.getConfiguration("/WebSquare/"+i+"/dataType/date/@displayFormat"))}if("date"==h&&this.options.calendarDisplayFormatFunc&&!this.options.calendarDisplayFormat){var g=r.D.getGlobalFunction(this.options.calendarDisplayFormatFunc,this.scope_id);"function"==typeof g&&(this.options.calendarDisplayFormat=g.call(this,this.options.calendarValueType))}if("time"!=h||this.options.displayFormat||(this.options.displayFormat="HH:mm"),this.mainGrid.options.senseReader&&"false"!==this.options.embeddedInput)switch(this.options.inputType||"text"){case"secret":case"text":"none"==this.mainGrid.options.focusMode&&"false"!=this.options.readOnly&&(this.options.readOnly=!0);case"select":case"checkbox":case"radio":
case"calendar":this.options.embeddedInput=!0}else this.options.embeddedInput=r.D.getBoolean(this.options.embeddedInput);if("textarea"==this.options.inputType&&(this.options.showReadOnly=!0),this.element=t,"expression"==this.options.inputType){var f=this.options.expression;""!=f&&(f=f.replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(")).match("rowStatus")&&this.mainGrid.rowStatusColIDArr.push(this.options.col_id)}this.options.editModeEventIcon||(this.options.editModeEventIcon=this.mainGrid.options.editModeEventIcon);!0!=={onclick:!0,ondblclick:!0}[this.options.editModeEventIcon]&&(this.options.editModeEventIcon="onclick"),this.options.copyOption||(this.options.copyOption=this.mainGrid.options.copyOption)}catch(t){s.w.printStackTrace(t,null,this)}},N.prototype.setController=function(){switch(this.mainGrid.options.useTextMultiLink&&"text"===this.options.inputType&&this.options.customFormatter&&(this.options.inputType="user"),this.options.inputType){case"text":default:o.x.extend(this,WebSquare.uiplugin.cellInfo.text.prototype);break;case"link":o.x.extend(this,WebSquare.uiplugin.cellInfo.link.prototype);break;case"checkbox":o.x.extend(this,WebSquare.uiplugin.cellInfo.checkbox.prototype);break;case"button":o.x.extend(this,WebSquare.uiplugin.cellInfo.button.prototype);break;case"image":o.x.extend(this,WebSquare.uiplugin.cellInfo.image.prototype);break;case"radio":o.x.extend(this,WebSquare.uiplugin.cellInfo.radio.prototype);break;case"select":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.select.prototype);break;case"calendar":o.x.extend(this,WebSquare.uiplugin.cellInfo.calendar.prototype);break;case"textarea":o.x.extend(this,WebSquare.uiplugin.cellInfo.textarea.prototype);break;case"expression":o.x.extend(this,WebSquare.uiplugin.cellInfo.expression.prototype);break;case"drilldown":o.x.extend(this,WebSquare.uiplugin.cellInfo.text.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.drilldown.prototype);break;case"textImage":o.x.extend(this,WebSquare.uiplugin.cellInfo.textImage.prototype);break;case"checkcombobox":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.checkcombobox.prototype);break;case"autoComplete":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.autoComplete.prototype);break;case"spinner":o.x.extend(this,WebSquare.uiplugin.cellInfo.spinner.prototype);break;case"custom":o.x.extend(this,WebSquare.uiplugin.cellInfo.custom.prototype);break;case"user":o.x.extend(this,WebSquare.uiplugin.cellInfo.user.prototype)}},N.prototype.setInnerHTML=function(t,e,i,o,s){t.innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e)+this.mainGrid.dataTagClose},N.prototype.setEditMode=function(t,e){this.mainGrid.editedCell=null,this.mainGrid.editMode=!1},N.prototype.initFormatter=function(t){try{var e=this.options.dataType;if(!e&&this.mainGrid.successBinding&&(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),!e&&this.options.expression){var i=this.options.expression;(i=(i=(i=(i=(i=(i=(i=(i=i.replace(/[sS][uU][mM][\s]*[(]/g,"NUMBER(")).replace(/[aA][vV][gG][\s]*[(]/g,"NUMBER(")).replace(/[mM][aA][xX][\s]*[(]/g,"NUMBER(")).replace(/[mM][iI][nN][\s]*[(]/g,"NUMBER(")).replace(/rowStatus[\s]*[(]/gi,"NUMBER(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"STRING(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"STRING(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"STRING(")).indexOf("NUMBER(")>-1?e="number":i.indexOf("STRING(")>-1&&(e="text")}var o=e,r=this.mainGrid._isNumberType(e);r&&"\t"===this.options.delimiter&&(this.options.delimiter="");var n,l,h=this.options.displayFormat;if("text"==this.options.inputType&&!h)if(r)"euro"==e?(h||(h=this.mainGrid.options.euroMask||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/euroMask/@value')||""),n=".",
l=","):"rupee"==e?(h||(h=this.mainGrid.options.rupeeMask||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/rupeeMask/@value')||""),n=",",l="."):"tenge"==e?(h||(h=this.mainGrid.options.tengeMask||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/tengeMask/@value')||""),n=" ",l=","):"number"!=e&&"float"!=e&&"bigDecimal"!=e||(h||(h=this.mainGrid.options.numberMask||a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/numberMask/@value')||""),n=",",l="."),this.options.displayFormat=h,this.options.delimiter||(this.options.delimiter=n),this.options.decimalDelimiter||(this.options.decimalDelimiter=l),this.options.customModelFormatter||(this.options.customModelFormatter=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelFormatter/@value')||""),this.options.customModelUnformatter||(this.options.customModelUnformatter=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelUnformatter/@value')||"");"date"!=o||"calendar"!=this.options.inputType||this.options.ioFormat||(this.options.ioFormat=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/ioFormat[@valueType="'+this.options.calendarValueType+'"]/@defaultValue'),this.options.ioFormat||("yearMonthDate"==this.options.calendarValueType?this.options.ioFormat="yyyyMMdd":"yearMonth"==this.options.calendarValueType?this.options.ioFormat="yyyyMM":"yearMonthDateTime"==this.options.calendarValueType?this.options.ioFormat="yyyyMMddHHmm":"yearMonthDateTimeSec"==this.options.calendarValueType&&(this.options.ioFormat="yyyyMMddHHmmSS"))),"default"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("numberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("textMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):"reverse"==this.options.maskFormat&&this.options.displayFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("reverseNumberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("reverseTextMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):this.formatter="float"===o||"bigDecimal"===o?WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.mainGrid.scope_id,this.mainGrid.id):WebSquare.format.createFormatter(o,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,null,null,this.mainGrid.scope_id,this.mainGrid.id),this.emptyFormatter=WebSquare.format.createFormatter(o,"",null,null,null,null,this.mainGrid.scope_id,this.mainGrid.id)}catch(t){s.w.printStackTrace(t)}},N.prototype.getDisplayData=function(t){return this.formatter&&(t=this.formatter.format(t)),"secret"==this.options.inputType&&(t=t.replace(/./gi,"●")),t},N.prototype.initializeCellInfo=function(){},N.prototype.handleEndEdit=function(t,e,i){try{if(t=t||{},
i=i||{},this.options.embeddedInput)return!0;if(this.mainGrid.rollbackCommitFlag=!1,this.mainGrid.editedCell&&0==this.mainGrid.editMode&&(this.mainGrid.editMode=!0),this.mainGrid.editMode){var o=this.mainGrid.editedCell;if(o._getEditedValue){var r=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.editRowIndex,l=this.mainGrid._getGroupbyDisplayRowIndex(n),h=o._getEditedValue();if(!0===this._editendCalled)return;if(this._editendCalled=!0,d=u.B.fireEvent(this.mainGrid,"oneditend",l,r,h,t),this._editendCalled=!1,d+""=="false")return this.mainGrid.getInput(this).focus(),u.B.stopEvent(t),!1}if(!o.validate())return u.B.stopEvent(t),!1;if(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,!i.otherClick){c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),this._handleEndEdit(t,e,i));var d=this._afterEndEdit(o,c,i);return o=null,d}var p=null,c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),p=this._handleEndEdit(t,e,i)),a.v.setTimer((function(t,e){null!=this.editTd&&this._handleEndEdit_focus(e),this._afterEndEdit(t,c,i),t=null,e=null}),{key:this.id+"_handleClickEventDocument",caller:this,args:[o,p]}),p=null,o=null}}catch(t){s.w.printStackTrace(t,null,this)}},N.prototype._afterEndEdit=function(t,e,i){i=i||{};var o,s=this.mainGrid.dataList._getCellData(this.editRowIndex,t.options.id),a=this.editRowIndex,n=t.options.id,l=a,h=this.mainGrid.getColumnIndex(n);if(this.editTd){var d=r.D.getDataPrefix("colMerged");o=this.editTd.getAttribute(d)}if("0"==o&&!t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped){var p=function(t,i,o,s){for(var a=t;t+1<this.mainGrid.getDataLength();){t+=1;var r=this.mainGrid.upperGroupingTest(t,i),n=this.mainGrid.dataList._getCellData(t,i);if(!r){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}for(t=a;t-1>=0;){r=this.mainGrid.upperGroupingTest(t,i);t-=1;n=this.mainGrid.dataList._getCellData(t,i);if(!r){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var h,l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}i=this.mainGrid.getColumnIndex(i);this.mainGrid.applyColumnStyleOptions(i)};p.call(this,a,n,h,s);var c=this.mainGrid.upperToLowerColumnRelation[n];if(c)for(var g=0;g<c.length;g++){var f=c[g],m=this.mainGrid.dataList._getCellData(a,f),y=this.mainGrid.getColumnIndex(f),b=this.mainGrid.getCellInfo(f);p.call(b,a,f,y,m)}}t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped&&this.mainGrid.setColMergeCellData(l-this.mainGrid.rowIndex,l,h);var w=this.mainGrid.dataList._getCellData(l,h),v=l+"_"+h;if(null!=this.mainGrid.cellMergeInfo[v]){var C=this.mainGrid.cellMergeInfo[v].rowSpan,I=this.mainGrid.cellMergeInfo[v].colSpan;for(g=0;g<C;g++)for(var _=0;_<I;_++)0===g&&0===_||this.mainGrid.dataList.__setCellData(l+g,h+_,w)}Math.abs(this.changedCellHeight)>3&&this.mainGrid.notifyRowChanged(l);var x=this.mainGrid._getGroupbyDisplayRowIndex(l);if(!this.mainGrid.options.viewChangeAfterEdit||!i.from_fireOnviewchange&&!i.from_handleClickEvent)var S=u.B.fireEvent(this.mainGrid,"onafteredit",x,h,w,this.mainGrid.lastEvent);return this.mainGrid.lastEvent=null,S=0!=S,this.mainGrid.rollbackCommitFlag=!0,S},N.prototype.handleScrollY=function(t,e,i){return this.validate()?this.handleEndEdit(t,void 0,i):this.handleCancelEdit(t)},N.prototype.validate=function(){return!0},N.prototype._handleEndEdit=function(t,e,i){var o=this._handleEndEdit_common(t);if((i=i||{}).otherClick)return o;this._handleEndEdit_focus(o,e,i.focuseChanged)},
N.prototype._handleEndEdit_common=function(t,e){return null},N.prototype._handleEndEdit_focus=function(t){return null},N.prototype.handleCancelEdit=function(t){this.options.embeddedInput||(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,this._handleCancelEdit(t))},N.prototype._handleCancelEdit=function(t){},N.prototype.removeCellData=function(t,e){},N.prototype.doDefaultAction=function(t){},N.prototype.setMergedCol=function(t,e,i,o){var s=t,a=new Array;for(a[t]=!0;t<this.mainGrid.getDataLength();){if(t+=1,!(r=this.mainGrid.upperGroupingTest(t,e)))break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),a[t]=!0}for(t=s;t>0;){var r=this.mainGrid.upperGroupingTest(t,e);if(t-=1,!r)break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),a[t]=!0}e=this.mainGrid.getColumnIndex(e);return this.mainGrid.applyColumnStyleOptions(e),a},N.prototype.getEscape=function(){return""!=this.options.escape?this.options.escape:this.mainGrid.options.escape},N.prototype.getColumnIndex=function(t){return t||(t=this.colID),this.mainGrid.getColumnIndex(t)},N.prototype.setMaxLength=function(t){try{if(this.options.maxlength=this.options.maxLength=t,"autoComplete"==this.options.inputType)this.autoComplete&&this.autoComplete.setMaxLength(t);else if("text"!==this.options.inputType&&"secret"!==this.options.inputType||1!=this.options.embeddedInput){this.mainGrid.getInput(this).setMaxLength(t)}else for(var e=this.mainGrid.tdIdList.length,i=this.mainGrid.getColumnIndex(this.options.id),o=this.mainGrid.getRowCount(),a=0;a<o;a++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[a*e+i]).setMaxLength(t)}catch(t){s.w.printStackTrace(t,null,this)}},N.prototype.setFloatMaxLength=function(t){try{this.options.maxlength=this.options.maxLength="-1",this.mainGrid.getInput(this).setFloatMaxLength(t)}catch(t){s.w.printStackTrace(t,null,this)}},N.prototype.refreshCell=function(){},N.prototype._checkFastScroll=function(t,e,i,o){try{var a="string"!=typeof t||!1===this.mainGrid._regDetectDOM.test(t);return e&&null!=e.textContent&&this.mainGrid.hasClass(e,i)&&a&&!0===o}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl=function(){},N.itemsetControl.prototype.initializeCellInfo=function(t){try{if(this.internal&&this.initializeInfo?this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.initializeInfo.rowIndex+"_"+this.colID+"_"+this.id:this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.colID,"select"===this.options.inputType&&""!=this.options.selectSetter)this.selectSetted=!1,this.resetMatchInfo=!0;else{var e,i="";if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var a=(i=r.D.isIE("6 7")&&this.internal&&t._element.outerHTML?WebSquare.xml.nodeWellFormed(t._element.outerHTML):WebSquare.xml.serialize(t._element)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"",n=this.options.inputType;i=(i=i.wq_replaceAll("<w2:column","<w2:"+n+a)).wq_replaceAll("</w2:column","</w2:"+n);var l=WebSquare.xml.parse(i,!0);this.xml=new WebSquare.Elem(l.documentElement)}o.x.extend(this,O.E.prototype),this.hasRef=!1,"checkcombobox"!==this.options.inputType&&("select"===this.options.inputType?this.options.selectedIndex&&(this.selectedIndex=parseInt(this.options.selectedIndex,10)):this.selectedIndex=void 0===this.options.selectedIndex?-1:parseInt(this.options.selectedIndex,10)),this.options.selectedDataDisplay||(this.options.selectedData=!1),"select"===this.options.inputType?e="SelectBox":"autoComplete"===this.options.inputType?e="AutoComplete":"checkcombobox"===this.options.inputType&&(e="CheckCombobox"),e&&(this.options.chooseOptionLabel="-선택-"===this.options.chooseOptionLabel?WebSquare.language.getMessage(e+"_choose"):this.options.chooseOptionLabel),this.internal?this.itemsetObj=this.initializeInfo.itemSet?this.initializeInfo.itemSet:{nodeset:"",label:"",value:""
}:this.itemsetObj=WebSquare.WebSquareparser.parseItemset(this.xml),this.resetMatchInfo=!0;var h=this.itemsetObj.nodeset.wq_replaceAll(" ","");if(this.internal&&"gridViewItemset"==this.options.itemTableType?this.existGridViewItemsetNode=!0:(this.existGridViewItemsetNode=WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:gridViewItemset")[0],this.existGridViewItemsetNode&&this.options.embeddedInput&&(p.k.printLog("not support embeddedInput in gridViewItemset ["+this.mainGrid.id+"."+this.id+"]"),this.options.embeddedInput=!1)),""!=this.itemsetObj.nodeset&&h.indexOf("ref(")>=0){this.hasRef=!0;var d=this.itemsetObj.nodeset;this.refStr='"'+this.refReplace(d)+'"';for(var u=d.match(/ref\('([^']*)'\)/g),c=0;c<u.length;c++){var g=u[c].slice(5,-2),f=this.mainGrid.getCellInfo(g);f.refArr||(f.refArr=[]),f.refArr.push(this.colID)}if(this.refHash=[],this.refItemArr=[],"select"===this.options.inputType&&this.options.embeddedInput)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset","")}else if(""!=this.itemsetObj.nodeset&&h.indexOf("data:")>=0){var m=this.itemsetObj.nodeset.replace("data:","").split(".");this.dataComp=m[0]}else this.matchInfo=this.setMatchInfo()}this.refArr||(this.refArr=[]),this._initializeCellInfo()}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.getItemText=function(t){try{var e="";if(t>-1&&t<this.itemArr.length){switch(e=this.itemArr[t].orgLabel||this.itemArr[t].label,this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}switch(this.options.displayMode){case"0":break;case"1":e=this.itemArr[t].value+this.options.delimiter+e;break;case"2":e=e+this.options.delimiter+this.itemArr[t].value;break;case"3":e=this.itemArr[t].value}}return e}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype._initDisplayMode=function(t){try{switch(this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.setColumnNodeSet=function(t,e,i,o){try{if(this.internal)this.itemsetObj.nodeset=t,this.itemsetObj.label=e,this.itemsetObj.value=i;else{if("json"===this.xml._elementType){var r=[];r.push({N:"w2:label",T:1,A:{ref:e}}),r.push({N:"w2:value",T:1,A:{ref:i}});var n=WebSquare.Elem.api.getElementsByTagName(this.xml,"itemset",a.v._XML_NAMESPACE.W2)[0];n?(n._element.A.nodeset=t,n._element.E=r):this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:itemset",A:{nodeset:t},E:r}]}]}else{var l=WebSquare.xml.findNode(this.xml,"*['choices'=local-name()]['"+a.v._XML_NAMESPACE.W2+"'=namespace-uri()]");for(null==l&&(l=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,l));l&&l.firstChild;)l.removeChild(l.firstChild);var h="<w2:itemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+t+"'><w2:label ref='"+e+"'></w2:label><w2:value ref='"+i+"'></w2:value></w2:itemset>",d=WebSquare.xml.parse(h,!0).documentElement;WebSquare.xml.appendChild(l,d)}this.itemArr=[],this.initializeCellInfo(this.xml)}var u=this.options.inputType;if(1==this.options.embeddedInput){var p=this.mainGrid.tdIdList.length,c=this.mainGrid.getColumnIndex(this.options.id);if(isNaN(o))for(var g=this.mainGrid.getRowCount(),f=this.mainGrid.rowIndex;f<g;f++){(m=this.mainGrid.data_td_list[(f-this.mainGrid.rowIndex)*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}else{var m,y=o-this.mainGrid.rowIndex;if(y>=0)(m=this.mainGrid.data_td_list[y*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}}else this[u]&&this[u].setNodeSet(t,e,i);t.indexOf("data:")>=0&&(this.dataComp=t.slice(5))}catch(t){
s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.setColumnGridItemset=function(t){try{if("select"!==this.options.inputType&&"autoComplete"!==this.options.inputType)return;var e=t.nodeset,i=t.label,o=t.value;if(this.internal)this.itemsetObj.nodeset=e,this.itemsetObj.label=i,this.itemsetObj.value=o;else{if("json"===this.xml._elementType){var r=[],n={};for(var h in t)"object"!==(0,l.Z)(t[h])&&"function"!=typeof t[h]&&null!=t[h]&&(n[h]=t[h]);for(var d=0;d<t.item.length;d++)r.push({N:"w2:item",T:1,A:t.item[d]});var u=WebSquare.Elem.api.getElementsByTagName(this.xml,"gridViewItemset",a.v._XML_NAMESPACE.W2)[0];if(u){for(var h in n)u._element.A[h]=n[h];u._element.E=r}else this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:gridViewItemset",A:n,E:r}]}]}else{var p=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",a.v._XML_NAMESPACE.W2);for(null==p&&(p=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,p));p&&p.firstChild;)p.removeChild(p.firstChild);if(a.v.isXML(t))WebSquare.xml.appendChild(p,t);else{var c="<w2:gridViewItemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+e+"'></w2:gridViewItemset>",g=WebSquare.xml.parse(c,!0),f=g.documentElement;for(var m in t)if("item"===m)for(d=0;d<t.item.length;d++){var y=WebSquare.xml.createElement(g,"w2:item"),b=t.item[d];for(var w in b)y.setAttribute(w,b[w]);WebSquare.xml.appendChild(f,y)}else"nodeset"!==m&&f.setAttribute(m,t[m]);WebSquare.xml.appendChild(p,f)}}this.initializeCellInfo(this.xml)}if("select"===this.options.inputType&&1==this.options.embeddedInput){var v=this.mainGrid.tdIdList.length,C=this.mainGrid.getColumnIndex(this.options.id),I=this.mainGrid.getRowCount();for(d=0;d<I;d++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[d*v+C]).setGridItemset(t)}this[this.options.inputType]&&this[this.options.inputType].setGridItemset(t),e.indexOf("data:")>=0&&(this.dataComp=e.slice(5))}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.getColumnDataListInfo=function(){try{if(this[this.options.inputType])return this[this.options.inputType].getDataListInfo();var t=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",a.v._XML_NAMESPACE.W2)[0];if(t){var e=WebSquare.WebSquareparser.parseItemset(t),i={};return e&&""!==e.nodeset?(e.nodeset.match("data:")?(i.nodeset=e.nodeset.slice(0),i.id=i.nodeset.wq_replaceAll("data:",""),i.value=e.value,i.label=e.label):(i.nodeset=e.nodeset.slice(0),i.value=e.value,i.label=e.label),i):null}return null}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.getDisplayData=function(t,e,i){var o=this.getData(t,e,i);return null==o&&(o=""),i&&i.emptyValue&&o===i.emptyValue?o="":o!=t&&""==o&&(o=t),o},N.itemsetControl.prototype.setMatchInfo=function(t){this.modelControl=new WebSquare.modelControl(this.colID,this.options.model,this.options.ref,this.options.bind,this.options._scope_obj_uuid),this.existGridViewItemsetNode?this.initializeGridViewItemArr(this.xml):this.initializeItemArr(this.xml),0==this.itemArr.length?this.resetMatchInfo=!0:this.resetMatchInfo=!1;for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].label=this.getItemText(e);var i={};if(1==this.options.allOption){var o=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:o,value:WebSquare.allValue}].concat(this.itemArr)}if(1==this.options.chooseOption&&"checkcombobox"!==this.options.inputType){var s=this.options.chooseOptionLabel;"$blank"==s&&(s=""),this.itemArr=[{label:s,value:this.options.chooseOptionValue}].concat(this.itemArr)}this.hasRef&&(this.refItemArr[this.itemsetObj.nodeset]=this.itemArr);var a=this.options.inputType.toUpperCase();for(e=0;e<this.itemArr.length;e++){var r=this.itemArr[e];i[a+"_"+r.value]=r.label}return i},N.itemsetControl.prototype.getMatchInfo=function(t){var e=[]
;return"select"===this.options.inputType&&""!=this.options.selectSetter?e=this.matchInfo:this.hasRef?e=this.getRefMatchInfo(t):this.hasRef||(this.resetMatchInfo&&(this.matchInfo=this.setMatchInfo(t)),e=this.matchInfo),e},N.itemsetControl.prototype.getRefMatchInfo=function(t){this.targetRowIndex=t;var e=new Function("_this","return "+this.refStr)(this);if(null==this.refHash[e]||this.resetMatchInfo){this.itemsetObj.nodeset=e,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",e);var i=this.setMatchInfo(t);return this.refHash[e]=i,i}return this.refHash[e]},N.itemsetControl.prototype.getRefItemArr=function(t){this.getRefMatchInfo(t);var e=new Function("_this","return "+this.refStr)(this);return this.refItemArr[e]},N.itemsetControl.prototype.getRefValue=function(t){return'"'+this.mainGrid.dataList._getCellData(this.targetRowIndex,t)+'"'},N.itemsetControl.prototype.refReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"\"+_this.getRefValue('$1')+\"");return e!=t?this.refReplace(e):e}catch(t){s.w.printStackTrace(t,null,this)}},N.itemsetControl.prototype.refXmlReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"'+_this.getRefValue('$1')+'");return e!=t?this.refXmlReplace(e):e}catch(t){s.w.printStackTrace(t,null,this)}},N.text=function(){},N.text.prototype.getDisplayData=function(t){(this.formatter&&(t=this.formatter.format(t)),"text"==this.options.inputType&&this.options.editFormat&&""!=t)&&(t=WebSquare.text.dynamicMask(t,this._editFormat,this._editTokens).value);return"secret"==this.options.inputType&&(t=t.replace(/./gi,"●")),t},N.text.prototype.setInnerHTML=function(t,e,i,o,n){var l=this.mainGrid._getGroupbyDisplayRowIndex(i);if(!this.options.embeddedInput||this.mainGrid._getEditDisabled(i,o)||this.mainGrid.___getEditReadOnly(i,o)||this.mainGrid.groupbyStatus.grouped){if(this.mainGrid.options.titleFormatter)try{var h;if("function"!=typeof this.mainGrid.options.titleFormatter){var d=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof d&&(this.mainGrid.options.titleFormatter=d,h=d.call(this,i,o,e))}else h=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",h)}catch(t){s.w.printStackTrace(t,null,this)}else if(this.options.title)t.setAttribute("title",this.options.title);else if(this.mainGrid.options.titleAuto){var u=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";""!==e?t.setAttribute("title",u+" "+e):t.setAttribute("title",u+WebSquare.language.getMessage("Grid_text"))}var p=WebSquare.util.getDataPrefix("editModeEvent");"onclick"===this.options.editModeEvent||"ondblclick"===this.options.editModeEvent||"onsecondclick"===this.options.editModeEvent?t.setAttribute(p,this.options.editModeEvent):t.setAttribute(p,"");var c=null;if(this.options.escapeFormatter)try{"function"==typeof this.options.escapeFormatter?c=this.options.escapeFormatter:"function"==typeof(c=r.D.getGlobalFunction(this.options.escapeFormatter,this.scope_id))&&(this.options.escapeFormatter=c)}catch(t){c=null}j=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?j=this.options.customFormatter:"function"==typeof(j=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=j)}catch(t){j=null}var g=null;if(this.options.customModelUnformatter)try{"function"==typeof this.options.customModelUnformatter?g=this.options.customModelUnformatter:"function"==typeof(g=r.D.getGlobalFunction(this.options.customModelUnformatter,this.scope_id))&&(this.options.customModelUnformatter=g)}catch(t){g=null}var f=e;g&&this.options.customModelUnformatter?(this.useCustomModelFormatter=!0,f=g.call(this.mainGrid,e,l,o)):this.useCustomModelFormatter=!1,this.options.maskFormat&&this.options.displayFormat&&(f=this.mainGrid.getInput(this,t,e).maskFormatModelUnFormat(f)),"function"==typeof c?(this.useEscapeFormatter=!0,f=c.call(this.mainGrid,e,l,o)):this.useEscapeFormatter=!1
;var m=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(m=r.D.getBoolean(m))&&(f=this.useCustomModelFormatter?WebSquare.xml._encode(f+""):WebSquare.xml._encode(e+""));P=f;if(this.options.editFormat&&this.options.editFormat.length>0){var y={"#":{pattern:/\d/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},"!":{escape:!0}},b=this.options.editFormat.split("||").sort((function(t,e){return t.replace(/[^a-z^A-Z^0-9]/g,"").length-e.replace(/[^a-z^A-Z^0-9]/g,"").length}));P=WebSquare.text.dynamicMask(P,b,y).value,this._editFormat=b,this._editTokens=y}z=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat||this._changeDisplayFormat;if(this.formatter&&z&&(P=this.formatter.format(f)),"secret"==this.options.inputType&&(P=P.replace(/./gi,"●")),"function"==typeof j?(this.useCustomFormatter=!0,X=j.call(this.mainGrid,e,P,l,o)):(this.useCustomFormatter=!1,X=P),this.mainGrid.options.plainText&&!1===this.useCustomFormatter&&!this.options.displayFormatter&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=X;else{var w=this.mainGrid.___getEditReadOnly(i,o),v=this.mainGrid._getEditDisabled(i,o),C="",I=[];I.push("w2grid_input"),this.mainGrid.options.checkEditableInputClass&&(w||v)&&(I=[]),"secret"==this.options.inputType&&a.v.browserCheck.ieAllVersion&&I.push("w2grid_secret"),w&&I.push("w2grid_input_readonly"),v&&I.push("w2grid_input_disabled");var _=t.firstChild,x=this._checkFastScroll(X,_,"w2grid_input",n&&!0===n.scroll);if(_&&(!v&&_.className.indexOf("w2grid_input_disabled")>-1||v&&-1===_.className.indexOf("w2grid_input_disabled")||!w&&_.className.indexOf("w2grid_input_readonly")>-1||w&&-1===_.className.indexOf("w2grid_input_readonly"))&&(x=!1),x&&m){var S="string"==typeof X?WebSquare.xml.__decode2(X):X;_.textContent=S}else{"span"==this.mainGrid.options.dataTag&&I.push("w2grid_span"),C=" class='",C+=I.join(" "),C+="'";var D=!1,R=t.firstChild;m&&R&&("NOBR"===R.tagName||"SPAN"===R.tagName&&R.className.indexOf("w2grid_span")>-1)&&" class='"+R.getAttribute("class")+"'"===C&&1===R.attributes.length&&(D=!0),D?t.firstChild.innerHTML=X:t.innerHTML="<"+this.mainGrid.options.dataTag+" "+C+">"+X+this.mainGrid.dataTagClose}this.mainGrid.hasClass(t,"w2grid_input_table")||(t.className="w2grid_input_table "+t.className)}}else{var L=this.mainGrid.getInput(this,t,e);null==L.render.parentNode&&(t.innerHTML="",t.appendChild(L.render)),L.blur();var T=r.D.getDataPrefix("rowindex");L.render.setAttribute(T,i);var k=!1;if(this.mainGrid.options.autoResizeEmbeddedInput){var F=!1;this.mainGrid.__bResizeObj?(F=this.mainGrid.__bResizeObj.width!==this.mainGrid.resizeObj.width||this.mainGrid.__bResizeObj.height!==this.mainGrid.resizeObj.height,this.mainGrid.__bResizeObj.width=this.mainGrid.resizeObj.width,this.mainGrid.__bResizeObj.height=this.mainGrid.resizeObj.height):this.mainGrid.__bResizeObj={width:this.mainGrid.resizeObj.width,height:this.mainGrid.resizeObj.height},k=!0!==L._autoResizeEmbeddedInput&&!1===F||this.mainGrid.__bResizeObj.isColumnResizing}if(!0===k){var A=0,E=0,M=!1,O=(this.mainGrid.oneRowLength,this.mainGrid._bodyIdMultiRowIndexMap[this.colID]);if("none"==t.parentNode.style.display){for(var N=O,B=t.parentNode;N>0;)"none"==B.previousElementSibling.style.display&&(B.previousElementSibling.style.display=""),B=B.previousElementSibling,N--;t.parentNode.style.display="",M=!0}null==L.render.parentNode&&(t.innerHTML="",t.appendChild(L.render)),this.mainGrid.embeddedStyleObj||(this.mainGrid.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(L.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(L.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(L.render,"padding-left"),10),
inputRight:parseInt(WebSquare.style.getStyle(L.render,"padding-right"),10)});var H=parseInt(WebSquare.style.getStyle(L.render,"border-top-width"),10),G=parseInt(WebSquare.style.getStyle(L.render,"border-bottom-width"),10),W=parseInt(WebSquare.style.getStyle(L.render,"border-left-width"),10),V=parseInt(WebSquare.style.getStyle(L.render,"border-right-width"),10);A=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),A-=this.mainGrid.embeddedStyleObj.top+this.mainGrid.embeddedStyleObj.bottom,A-=H+G;var q=o;if(this.mainGrid.embeddedWidthObj[q]&&!this.mainGrid.embeddedWidthObj[q].isChanged||(this.mainGrid.embeddedWidthObj[q]={isChanged:!1,width:t.clientWidth}),E=this.mainGrid.embeddedWidthObj[o].width,E-=this.mainGrid.embeddedStyleObj.left+this.mainGrid.embeddedStyleObj.right,E-=W+V,E-=this.mainGrid.embeddedStyleObj.inputLeft+this.mainGrid.embeddedStyleObj.inputRight,M){for(N=O,B=t.parentNode;N>0;)B.previousElementSibling.style.display="none",B=B.previousElementSibling,N--;t.parentNode.style.display="none"}else(r.D.isIE("6 7")||r.D.isSpartan())&&(A-=2);r.D.isOpera()&&(A+=2),L.setSize(E-2,A-(this.mainGrid.embeddedStyleObj.inputTop+this.mainGrid.embeddedStyleObj.inputBottom)),L.setStyle("lineHeight",A+"px"),L._autoResizeEmbeddedInput=!0}else null==L.render.parentNode&&(t.innerHTML="",t.appendChild(L.render));"all"==this.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(e=this.getDisplayData(e));var j=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?j=this.options.customFormatter:"function"==typeof(j=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=j)}catch(t){j=null}var P=e,z=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&z&&(P=this.formatter.format(P)),L.setValue(e),"function"==typeof j){this.useCustomFormatter=!0;var X=j.call(this.mainGrid,e,P,l,o);L.render.value=X}this.options.textAlign?L.setStyle("text-align",this.options.textAlign):L.setStyle("text-align",""),t.removeAttribute("tabIndex"),t.removeAttribute("title")}},N.text.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,this.options.maskFormat&&this.options.displayFormat||(i.formatter="all"==this.options.applyFormat||!0===this._changeDisplayFormat||"date"==this.options.dataType?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat);var o=this.mainGrid.dataList._getCellData(e,this.colID);if("all"===this.options.applyFormat&&this.options.displayFormat&&"text"!=this.options.dataType&&"date"!=this.options.dataType&&"time"!=this.options.dataType){var a=this.options.decimalDelimeter||".",n=(o+"").split(a);n[1]&&0==parseInt(n[1])&&(o=n[0])}i.setValue(o),document.activeElement!=i.render&&i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(r.D.isIEAllVersion()||r.D.isFF()||r.D.isSpartan())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){s.w.printStackTrace(t,null,this)}},N.text.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(r.D.isFF()?t={top:-1,left:0,width:0,height:0}:r.D.isOpera()?t={top:0,left:0,width:0,height:1}:r.D.isIEAllVersion("9 10 11")?t={top:-1,left:-1,width:0,height:0}:r.D.isSpartan()&&(t={top:0,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll()){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}else!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop())
;var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,a=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}this.mainGrid.hasClass("w2grid_adaptive_crosstab")&&(s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,l.render.style.lineHeight=n+"px");l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=a+"px",l.render.style.height=n+"px",r.D.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},N.text.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},N.text.prototype._handleEndEdit_common=function(t){try{if(!this.options.embeddedInput){var e=this.mainGrid.getInput(this);return this.setEditData(e),e}}catch(t){s.w.printStackTrace(t,null,this)}},N.text.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t&&t.hide()},N.text.prototype._getEditedValue=function(t){return"bigDecimal"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")?WebSquare.bigDecimal(this.mainGrid.getInput(this).getValue()).toString():this.mainGrid.getInput(this).getValue()},N.text.prototype._handleCancelEdit=function(t){try{var e,i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide(),e=window.getSelection?window.getSelection():document.selection;var o=document.createRange();o.selectNodeContents(this.editTd),e.removeAllRanges(),e.addRange(o),e.collapseToStart()}catch(t){s.w.printStackTrace(t,null,this)}},N.text.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.text.prototype.setEditData=function(t){try{var e=t.getValue();if("number"==(o=this.mainGrid.getColumnOption(this.id,"dataType"))||"float"==o){var i=e.wq_trim();"."!==i&&"-"!==i&&"+"!==i||(e="")}e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var o=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==o&&""!=e&&(e=Number(e));var a={};a[this.mainGrid.id]=!0;var n=r.D.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof n){this.useCustomModelFormatter=!0;var l=this.getDisplayData(e);e=n.call(this.mainGrid,e,l,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;if(e=this.maskFormatModelFormat(e),"float"===o&&e[e.length-1]===t.options.decimalDelimiter){var h=e.split(t.options.decimalDelimiter);e=h[0]}this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,a)}catch(t){s.w.printStackTrace(t,null,this)}},N.text.prototype.maskFormatModelFormat=function(t){try{if(!t)return t;var e="";if(this.options.maskFormat&&this.options.displayFormat)if(this.options.maskFormatModelExcludeChar)for(var i=this.options.maskFormatModelExcludeChar.split(""),o=0;o<t.length;o++){for(var a=!1,r=0;r<i.length;r++)if(t[o]==i[r]){a=!0;break}a||(e+=t[o])}else e=t;else e=t;return e}catch(t){s.w.printStackTrace(t,null,this)}},N.link=function(){},N.link.prototype.setInnerHTML=function(t,e,i,o,a){var n=" tabIndex='-1' "
;"none"==this.mainGrid.options.focusMode?n=" tabIndex='0' ":1==this.mainGrid.options.keyMoveEditMode&&(n="");var l=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(l=r.D.getBoolean(l))&&(e=WebSquare.xml._encode(e+""));var h,d,u=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id),p=this.getDisplayData(e);if("function"==typeof u?(this.useCustomFormatter=!0,h=u.call(this.mainGrid,e,p,i,o)):(this.useCustomFormatter=!1,h=p),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var c=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof c&&(this.mainGrid.options.titleFormatter=c,d=c.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.w.printStackTrace(t,null,this)}var g="";(d?g=" title='"+d+"'":this.options.title&&(g=" title='"+this.options.title+"'"),g)||this.mainGrid.options.titleAuto&&(g=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+WebSquare.language.getMessage("Grid_link")+"'");var f=this.options.voidNull?"javascript:void(null);":"";t.innerHTML=h||g?this.mainGrid.dataTagOpen+"<a href='"+f+"' onclick='event.returnValue=false; return false;'"+n+" "+g+">"+h+"</a>"+this.mainGrid.dataTagClose:this.mainGrid.dataTagOpen+this.mainGrid.dataTagClose},N.link.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=u.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.D.getDataPrefix("col_id"),a=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),a=n.focusedColIndex}this.mainGrid._getEditDisabled(i,a)||this.mainGrid.___getEditReadOnly(i,a)||u.B.fireEvent(this.mainGrid,"oncellclick",o,a,this.options.id)},N.checkbox=function(){},N.checkbox.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":"$blank"==this.options.trueValue&&(this.options.trueValue=""),"$blank"==this.options.falseValue&&(this.options.falseValue=""),this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.embeddedInput&&(this.mainGrid.options.preventMultipleClick=!1),this.options.checkboxLabelColumn)for(var e=this.options.checkboxLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},N.checkbox.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},N.checkbox.prototype.setInnerHTML=function(t,e,i){var o,a=e+""==this.options.trueValue,n=r.D.getDataPrefix("col_id"),l=r.D.getDataPrefix("rowindex");if(o=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(n)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(n)),this.options.embeddedInput){var h=this.mainGrid.getInput(this,t,a);h.setAttribute(l,i),h.checked=a,h.disabled=o}else{var d,c;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var g=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof g&&(this.mainGrid.options.titleFormatter=g,c=this.mainGrid.getColumnIndex(this.options.id),d=g.call(this,i,c,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,c,e)}catch(t){s.w.printStackTrace(t,null,this)}var f=d||this.options.title||"";if(f)f=" title='"+f+"'";else if(this.mainGrid.options.titleAuto){var m=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";f=a?" title='"+m+WebSquare.language.getMessage("Grid_title")+"'":" title='"+m+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}
var y="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",b=a?" checked":"",w=o?" disabled='true'":"",v=this.options.visibleFunc,C="";if(this.options.checkboxLabel||this.options.checkboxLabelColumn||this.options.checkboxLabelFormatter){var I=this.mainGridId+"_checkbox_"+this.id,_=I+"_"+i,x=this.options.checkboxLabel||"";if(this.options.checkboxLabelColumn){for(var S=this.options.checkboxLabelColumn.split(","),D="",R=this.options.checkboxLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",L=0;L<S.length;L++){var T=this.mainGrid.bodyToHeaderRelation[S[L]];if(L===S.length-1)this.mainGrid.options.showCheckboxLabelUserFormat?D+=" "+this.mainGrid.getHeaderValue(T)+" "+this.mainGrid._getCellDisplayData(i,S[L],{removeTag:!0}):D+=this.mainGrid._getCellDisplayData(i,S[L],{removeTag:!0});else if(this.mainGrid.options.showCheckboxLabelUserFormat)D+=(0===L?i+1+"행"+R:"")+" "+this.mainGrid.getHeaderValue(T)+" "+this.mainGrid._getCellDisplayData(i,S[L],{removeTag:!0})+R;else D+=this.mainGrid._getCellDisplayData(i,S[L],{removeTag:!0})+R}x=x?D+R+x:D}if(this.options.checkboxLabelFormatter)try{var k=r.D.getGlobalFunction(this.options.checkboxLabelFormatter,this.scope_id);"function"==typeof k&&(x=k.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),x))}catch(t){p.k.printLog(this.mainGrid.id+"_"+this.id+" checkboxLabelFormatter error : "+t.message)}x&&this.mainGrid.options.titleAuto&&!this.options.title&&(f=f.substring(0,f.length-1)+" "+x+"'"),C="<INPUT type='checkbox' "+f+y+b+w+" id='"+_+"' name='"+I+"'/>";var F="<label class='w2checkbox_label ' for='"+_+"'>"+x+"</label>";"left"===this.options.checkboxLabelPosition?C=F+C:C+=F}else C="<INPUT type='checkbox' "+f+y+b+w+" />";if(v){var A,E=r.D.getGlobalFunction(v,this.scope_id);"function"==typeof E&&(A=E(i)),t.innerHTML=A?C:""}else t.innerHTML=C;if(this.options.noDisabledOnReadOnly)(M=t.getElementsByTagName("input")[0])&&(u.B.addListener(M,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&u.B.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(M,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(M,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventMultipleClick){var M=t.getElementsByTagName("input")[0],O=t.getElementsByTagName("label")[0];this.labelClicked=!1,M&&u.B.addListener(M,"onclick",function(t,e,i){return function(o){t.options.eventPropagation||u.B.stopPropagation(o);var s=!1,a=t.colID;t.mainGrid.getColumnIndex(a);if(!0===t.mainGrid.options.useShiftKeyCheck&&o.shiftKey){var r={td:e[1],rowIndex:e[0],checked:this.checked};t.mainGrid._ShiftKeyMultiCheck(t.mainGrid,r,e[1]),s=!0}e[2]=o.detail,e[3]=s,i.apply(t,e,o)}}(this,[i,t],(function(t,e,i,o){i=this.labelClicked?0:1,this.labelClicked=!1;var s,a,r,n,l,h,d,p=null!=this.mainGrid.editedCell;p&&(s=this.mainGrid.editedCell.editRowIndex,a=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),d=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),r=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.mainGrid._grid.getRealRowIndex(s),l=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+a],h=d.comp&&d.comp.selectedIndex);var g,f,m,y=e.getElementsByTagName("input")[0];if(y&&(g=y.checked,f=this.options.falseValue,g&&(f=this.options.trueValue),""!=(m=this.mainGrid.dataList._getCellData(t,this.colID))||g||(f=m)),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):!0!==o&&this.mainGrid._addFocus(e)),this.handleClick(e,t,!0),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode
})):!0!==o&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),!0===this.mainGrid.options.useShiftKeyCheck&&(this.mainGrid.beforeChecked={td:e,rowIndex:t,checked:y.checked}),t=this.mainGrid._getGroupbyDisplayRowIndex(t),y&&m!=f){var b=this.mainGrid.getColumnIndex(this.options.id),w={oldValue:m,newValue:f,rowIndex:t,colIndex:b,colId:this.mainGrid.getColumnID(b)};u.B.fireEvent(this.mainGrid,"onviewchange",w)}if(this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,c)&&u.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:g}),p){var v=this.mainGrid._dataList.dataArr[n*this.mainGrid._dataList.getColumnCount()+a];if(l!=v){var C={oldValue:l,newValue:v,rowIndex:s,colIndex:r,colId:this.mainGrid.getColumnID(r)};isNaN(h)||(C.oldSelectedIndex=h,C.newSelectedIndex=d&&d.comp&&d.comp.selectedIndex),u.B.fireEvent(this.mainGrid,"onviewchange",C)}}}))),O&&u.B.addListener(O,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},N.checkbox.prototype.getDisplayData=function(t){return t},N.checkbox.prototype.handleClick=function(t,e,i){var o=r.D.getDataPrefix("col_id");if(this.mainGrid.__getEditReadOnly(t,e)||this.mainGrid._getEditDisabled(e,t.getAttribute(o))||!this.options.embeddedInput&&this.mainGrid.options.preventMultipleClick&&!i&&!this.mainGrid.options.checkOnCellClick)return!0;null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var s=t.getElementsByTagName("input")[0];if(s){var a=this.options.id,n=s.checked,l=this.options.falseValue;n&&(l=this.options.trueValue);var h=this.mainGrid.dataList._getCellData(e,this.colID);""!=h||n||(l=h);var d=null;(d={})[this.mainGrid.id]=!0,this.mainGrid._isGridViewItemTable()||this.mainGrid.dataList.__setCellData(e,this.colID,l,null,null,null,d);var p=r.D.getDataPrefix("colMerged");if("0"==t.getAttribute(p)&&this.setMergedCol(e,a,h,l),h!=l&&!i){var c=this.mainGrid.getColumnIndex(this.options.id),g={oldValue:h,newValue:l,rowIndex:e,colIndex:c,colId:this.mainGrid.getColumnID(c)};u.B.fireEvent(this.mainGrid,"onviewchange",g)}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}return!0},N.checkbox.prototype.checkHeader=function(){try{return this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}catch(t){s.w.printStackTrace(t,null,this)}},N.checkbox.prototype.doDefaultAction=function(t){if(!this.options.embeddedInput){var e=u.B.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(e.focus();e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID}else i=this.mainGrid.getLastFocusedCell().focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID;var a=!1;if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var r,n,l=e.getElementsByTagName("input")[0];if(l&&(l.checked?(r=this.options.falseValue,l.checked=!1):(r=this.options.trueValue,l.checked=!0),n=this.mainGrid.dataList._getCellData(i,s)),this.handleClick(e,i,!0),r!=n){var h=this.mainGrid.getColumnIndex(s);u.B.fireEvent(this.mainGrid,"onviewchange",{oldValue:n,newValue:r,rowIndex:o,colIndex:h,colId:this.mainGrid.getColumnID(h)})}a=!0}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID]),this.mainGrid.options.preventMultipleClick&&a&&u.B.fireEvent(this.mainGrid,"oncellclick",i,this.mainGrid.getColumnIndex(s),this.options.id,{checked:l.checked})}},N.checkbox.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){
s.w.printStackTrace(t,null,this)}},N.button=function(){},N.button.prototype.setInnerHTML=function(t,e,i){try{var o=r.D.getDataPrefix("col_id"),a=(this.mainGrid._getEditDisabled(i,t.getAttribute(o))," tabIndex='-1'");"none"==this.mainGrid.options.focusMode?a=" tabIndex='0'":1==this.mainGrid.options.keyMoveEditMode&&(a="");var n,l=this.mainGrid.getColumnIndex(t.getAttribute(o));if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var h=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof h&&(this.mainGrid.options.titleFormatter=h,n=h.call(this,i,l,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,l,e)}catch(t){s.w.printStackTrace(t,null,this)}var d=n||this.options.title||"";if(d)d=" title='"+d+"'";else if(this.mainGrid.options.titleAuto)d=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+WebSquare.language.getMessage("Grid_button")+"'";var p=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;if((p=r.D.getBoolean(p))&&(e=WebSquare.xml._encode(e+"")),t.innerHTML="<button type='button' style='width:100%;height:100%' "+a+d+">"+this.getDisplayData(e)+"</button>",1==this.internal){var c=t.childNodes[0];if(0==c.clientHeight){var g=t.clientHeight-2;WebSquare.style.setSize(c,"height",g)}}this._listener=(f=this,m=[i,l,t],y=function(t,e,i,o){null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit(),this.mainGrid._getEditDisabled(e,i)||this.mainGrid.___getEditReadOnly(e,i)||this.options.blockSelect||this.mainGrid.__setFocusedCell(t,o,{editMode:"none"==this.options.focusMode}),this.mainGrid._getEditDisabled(e,i)||u.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(e),i,this.options.id)},function(t){y.apply(f,[t||window.event].concat(m))}),u.B.addListener(t.getElementsByTagName("button")[0],"onclick",this._listener)}catch(t){s.w.printStackTrace(t,null,this)}var f,m,y},N.button.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=u.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.D.getDataPrefix("col_id"),a=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),a=n.focusedColIndex}this.mainGrid._getEditDisabled(i,a)||this.mainGrid.___getEditReadOnly(i,a)||u.B.fireEvent(this.mainGrid,"oncellclick",o,a,this.options.id)},N.image=function(){},N.image.prototype.setInnerHTML=function(t,e,i,o,a){var n="";""!=this.options.imageWidth&&(n+=";width:"+parseInt(this.options.imageWidth)+"px"),""!=this.options.imageHeight&&(n+=";height:"+parseInt(this.options.imageHeight)+"px"),t.removeAttribute("alt");var l="";""!=this.options.alt&&(l="alt='"+this.options.alt+"' ");var h=r.D.getDataPrefix("col_id"),d=this.mainGrid._getEditDisabled(i,t.getAttribute(h)),p="";d&&(p=" disabled='true' "),null==e||""==e?e=this.options.imageSrc?this.options.imageSrc.startsWith("javascript:void")?this.options.imageSrc:this.mainGrid.getImageURL(this.options.imageSrc):"":"string"!=typeof e||e.startsWith("javascript:void")||(e=this.mainGrid.getImageURL(e));var c="";try{this.options.onerror&&(c=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.w.printStackTrace(t,null,this)}var g,f=this.options.imageTabIndex?" tabIndex='"+this.options.imageTabIndex+"'":"";if(this.mainGrid.options.senseReader&&this.mainGrid.options.focusImage?t.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(d?" w2grid_image_disabled":"")+"' style='"+n+"' "+l+p+c+f+"tabIndex='0' />":t.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(d?" w2grid_image_disabled":"")+"' style='"+n+"' "+l+p+c+f+" />",this.options.imageClickFunction&&(g=this.mainGrid._getEditDisabled(i,o)),this.options.imageClickFunction&&(this.options.useImageClick||0==g)){
var m=t.firstChild,y=function(t,e,i){return function(o){u.B.stopPropagation(o),t._setFocusedCell(e,i),t.fireImageClick(e,i)}}(this.mainGrid,i,this.colID);u.B.addListener(m,"onclick",y)}if(this.mainGrid.options.titleFormatter)try{var b;o=this.mainGrid.getColumnIndex(t.getAttribute(h));if("function"!=typeof this.mainGrid.options.titleFormatter){var w=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,b=w.call(this,i,o,e))}else b=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",b)}catch(t){s.w.printStackTrace(t,null,this)}},N.image.prototype.getDisplayData=function(t){return t},N.radio=function(){},N.radio.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.groupRef&&(this.options.groupValue=WebSquare.ModelUtil.getInstanceValue(this.options.groupRef,null,this.scope_id)),this.options.radioLabelColumn)for(var e=this.options.radioLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},N.radio.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},N.radio.prototype.setInnerHTML=function(t,e,i){var o=r.D.getDataPrefix("col_id"),a=r.D.getDataPrefix("rowindex"),n=this.mainGridId+"_radio_"+(this.options.groupName?this.options.groupName+"_"+i:this.colID);this.options.cellGroupName&&(n=this.mainGridId+"_radio_"+this.options.cellGroupName);var l,h,d,c,g=e+""==this.options.trueValue;if(l=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute(o)):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute(o)),this.options.embeddedInput){var f=this.mainGrid.getInput(this,t,g);f.setAttribute(a,i),f.checked=!1,f.name=n,f.checked=g,f.disabled=l}else{var m,y;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var b=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof b&&(this.mainGrid.options.titleFormatter=b,y=this.mainGrid.getColumnIndex(this.options.id),m=b.call(this,i,y,e))}else m=this.mainGrid.options.titleFormatter.call(this,i,y,e)}catch(t){s.w.printStackTrace(t,null,this)}var w=m||this.options.title||"";if(w)w=" title='"+w+"'";else if(this.mainGrid.options.titleAuto){var v=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";w=g?" title='"+v+WebSquare.language.getMessage("Grid_title")+"'":" title='"+v+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var C="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",I=g?" checked":"",_=l?" disabled='true'":"",x="";if(this.options.radioLabel||this.options.radioLabelColumn||this.options.radioLabelFormatter){var S=this.mainGridId+"_radio_"+this.id+"_"+i,D=this.options.radioLabel||"";if(this.options.radioLabelColumn){for(var R=this.options.radioLabelColumn.split(","),L="",T=this.options.radioLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",k=0;k<R.length;k++){var F=this.mainGrid.bodyToHeaderRelation[R[k]];if(k===R.length-1)this.mainGrid.options.showRadioLabelUserFormat?L+=" "+this.mainGrid.getHeaderValue(F)+" "+this.mainGrid._getCellDisplayData(i,R[k],{removeTag:!0}):L+=this.mainGrid._getCellDisplayData(i,R[k],{removeTag:!0});else if(this.mainGrid.options.showRadioLabelUserFormat)L+=(0===k?i+1+"행"+T:"")+" "+this.mainGrid.getHeaderValue(F)+" "+this.mainGrid._getCellDisplayData(i,R[k],{removeTag:!0})+T;else L+=this.mainGrid._getCellDisplayData(i,R[k],{removeTag:!0})+T}D=D?L+T+D:L}if(this.options.radioLabelFormatter)try{var A=r.D.getGlobalFunction(this.options.radioLabelFormatter,this.scope_id)
;"function"==typeof A&&(D=A.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),D))}catch(t){p.k.printLog(this.mainGrid.id+"_"+this.id+" radioLabelFormatter error : "+t.message)}D&&this.mainGrid.options.titleAuto&&!this.options.title&&(w=w.substring(0,w.length-1)+" "+D+"'"),x="<INPUT type='radio' "+w+C+I+_+" id='"+S+"' name='"+n+"'/>";var E="<label class='w2radio_label ' for='"+S+"'>"+D+"</label>";"left"===this.options.radioLabelPosition?x=E+x:x+=E}else x="<INPUT type='radio' name='"+n+"'"+w+C+I+_+" />";if(t.innerHTML=x,this.options.noDisabledOnReadOnly)(M=t.getElementsByTagName("input")[0])&&(u.B.addListener(M,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&u.B.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(M,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(M,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventDuplicateFocusedCell&&this.mainGrid.options.preventMultipleClick){var M=t.getElementsByTagName("input")[0],O=t.getElementsByTagName("label")[0];this.labelClicked=!1,M&&u.B.addListener(M,"onclick",(h=this,d=[i,t],c=function(t,e,i){i=this.labelClicked?0:1,this.labelClicked=!1;var o,s,a,r,n,l,h,d=null!=this.mainGrid.editedCell;if(d&&(o=this.mainGrid.editedCell.editRowIndex,s=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),h=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),r=this.mainGrid._grid.getRealRowIndex(o),n=this.mainGrid._dataList.dataArr[r*this.mainGrid._dataList.getColumnCount()+s],l=h.comp&&h.comp.selectedIndex),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):this.mainGrid._addFocus(e)),this.handleClick(e,t),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,y)&&u.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:g}),d){var p=this.mainGrid._dataList.dataArr[r*this.mainGrid._dataList.getColumnCount()+s];if(n!=p){var c={oldValue:n,newValue:p,rowIndex:o,colIndex:a,colId:this.mainGrid.getColumnID(a)};isNaN(l)||(c.oldSelectedIndex=l,c.newSelectedIndex=h&&h.comp&&h.comp.selectedIndex),u.B.fireEvent(this.mainGrid,"onviewchange",c)}}},function(t){h.options.eventPropagation||u.B.stopPropagation(t),d[2]=t.detail,c.apply(h,d,t)})),O&&u.B.addListener(O,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},N.radio.prototype.getDisplayData=function(t){return t},N.radio.prototype.handleClick=function(t,e){var i=t.getElementsByTagName("input")[0];if(!i)return!0;if(this.options.noDisabledOnReadOnly&&this.mainGrid._getEditReadOnly(e,this.colID))return!0;this.mainGrid.options.preventDuplicateFocusedCell&&null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var o=this.mainGrid.dataList._getCellData(e,this.colID),s=o;if(o==this.options.trueValue)return!0;i.checked&&(s=this.options.trueValue,this.resetOthers(e),this.options.groupName&&this.mainGrid.radioGroupRepChk[this.options.groupName]&&this.mainGrid.dataList.__setCellData(e,this.options.groupName,this.options.groupValue)),this.mainGrid.dataList.__setCellData(e,this.colID,s);var a=r.D.getDataPrefix("colMerged");if("0"!=t.getAttribute(a)||this.mainGrid.groupbyStatus.grouped||this.setMergedCol(e,this.colID,o,s),o!=s){
var n=this.mainGrid.getColumnIndex(this.options.id),l={oldValue:o,newValue:s,colIndex:n,rowIndex:e,colId:this.mainGrid.getColumnID(n)};u.B.fireEvent(this.mainGrid,"onviewchange",l)}return!0},N.radio.prototype.resetOthers=function(t){if(this.options.groupName)for(var e=this.mainGrid.getColumnCount(),i=0;i<e;i++){"custom"==(s=this.mainGrid.getCellInfo(i)).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(t)]),s!=this&&"radio"==s.options.inputType&&s.options.groupName==this.options.groupName&&this.mainGrid.dataList.__setCellData(t,i,s.options.falseValue)}else if(this.options.cellGroupName)for(var o=0;o<this.mainGrid.getDataLength();o++){var s;"custom"==(s=this.mainGrid.getCellInfo(this.getColumnIndex(this.colID))).options.inputType&&(s=s.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(o)]);"radio"==s.options.inputType&&s.options.cellGroupName==this.options.cellGroupName&&this.mainGrid.dataList._getCellData(o,this.colID)+""==s.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,s.options.falseValue)}else if(this.mainGrid.isDrillDown&&this.mainGrid._dataList.options.depthColumn)for(o=0;o<this.mainGrid.getTotalRow();o++)this.mainGrid._dataList.getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid._dataList.setCellData(o,this.colID,this.options.falseValue);else for(o=0;o<this.mainGrid.getDataLength();o++)this.mainGrid.dataList._getCellData(o,this.colID)+""==this.options.trueValue&&this.mainGrid.dataList.__setCellData(o,this.colID,this.options.falseValue)},N.radio.prototype.doDefaultAction=function(t){var e=u.B.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(;e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=r.D.getDataPrefix("col_id"),s=this.mainGrid.getColumnIndex(e.getAttribute(o))}else{var a=this.mainGrid.getLastFocusedCell();i=a.focusedRowIndex,s=a.focusedColIndex;this.options.embeddedInput&&"INPUT"==e.tagName.toUpperCase()&&(e=a.focusedTd)}if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var n=this.mainGrid.dataList._getCellData(i,this.colID);("INPUT"==e.tagName.toUpperCase()?e:e.getElementsByTagName("input")[0]).checked=n==this.options.trueValue?this.options.falseValue:this.options.trueValue,this.handleClick(e,i)}},N.radio.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){s.w.printStackTrace(t,null,this)}},N.select=function(){},N.select.prototype._initializeCellInfo=function(){try{this.col_index=this.mainGrid.getColumnIndex(this.colID),"auto"===this.options.renderType&&r.D.isMobile()&&!0!==this.options.embeddedInput&&(this.options.embeddedInput=!0)}catch(t){s.w.printStackTrace(t,null,this)}},N.select.prototype._createComponent=function(t){try{if(this.comp)return;var e=this;if(this.xml.setAttribute("class",this.mainGridId+"_select_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("chooseOptionValue",this.options.chooseOptionValue),this.xml.setAttribute("allOption",this.options.allOption+""),this.xml.setAttribute("tableRender",this.options.tableRender),this.xml.setAttribute("submenuSize",this.options.submenuSize?this.options.submenuSize:"auto"),this.xml.setAttribute("direction","auto"),this.xml.setAttribute("style",this.style),this.setFirst=!0,this.hasRef&&!this.useLinkedDataList)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.setFirst=!1,this.configOptions.chooseOption=this.options.chooseOption,this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel,
this.configOptions.labelWidthAuto=!1,this.configOptions.displayMode=this.options.displayMode,this.configOptions.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay,this.configOptions.itemTooltipFormatter=this.options.itemTooltipFormatter,this.options.itemTooltipFormatter&&(this.configOptions._rowIndex=t,this.configOptions._colIndex=this.mainGrid.getColumnIndex(this.colID)),this.configOptions.tooltipTime=this.options.tooltipTime,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.configOptions.tableRender=this.options.tableRender,this.internal&&(this.options.visibleRowNum&&(this.configOptions.visibleRowNum=this.options.visibleRowNum),this.options.textAlign&&(this.configOptions.textAlign=this.options.textAlign),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions));var i=this.internal?this.mainGridId+"_selectbox_"+t+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;this.internal&&this.options.emptyItem&&(this.configOptions.emptyItem=this.options.emptyItem),this.select=new WebSquare.uiplugin.selectbox(i,this.configOptions,this.xml),this.mainGrid.dom[this.select.id]=this.select,this.comp=this.select,this.select.setSelectedIndex1=function(t,i){void 0!==i&&null!=i||(i={});var o=this.selectedIndex,s=this.getValue(),a=e.mainGrid.getColumnIndex(e.mainGrid.editedCell.id);if(this.setSelectedIndex(t),e.mainGrid._setSelectedIndex(e.editRowIndex,a,t),"oneditend"===e.options.eventPriority){if(!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit()),o!=this.selectedIndex){var r=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:r,colIndex:a,colId:e.mainGrid.getColumnID(a)};u.B.fireEvent(e.mainGrid,"onviewchange",n)}}else{if(o!=this.selectedIndex){r=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:r,colIndex:a,colId:e.mainGrid.getColumnID(a)};u.B.fireEvent(e.mainGrid,"onviewchange",n)}!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit())}},this.existGridViewItemsetNode&&(this.select._setSubLayer=this.select.setSubLayer,this.select.setSubLayer=function(t){this._setSubLayer(t),this.itemTable.addKeyDownEventListener((function(t){if(27===t.keyCode)e.handleCancelEdit(t)}))}),this.select.__openSubLayer=this.select.openSubLayer,this.select.openSubLayer=function(){this.__openSubLayer()},this.select.__closeSubLayer=this.select.closeSubLayer,this.select.closeSubLayer=function(t){this.__closeSubLayer(t),e.mainGrid._setFocusedCell()},this.select._handleClickEvent=this.select.handleClickEvent,this.select.handleClickEvent=function(t){this._handleClickEvent(t),u.B.stopEvent(t),e.handleEndEdit()},this.select._refreshItemset=this.select.refreshItemset,this.select.refreshItemset=function(t){e.resetMatchInfo=!0,!0!==this.refreshStopItemTable&&this._refreshItemset(t)}}catch(t){s.w.printStackTrace(t,null,this)}},N.select.prototype.createSelectbox=function(t,e){this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this._createComponent(e),t.innerHTML=this.select.toHTML();try{!this.select.modelControl.isBinded()&&-1===this.select.selectedIndex&&this.select.getItemCount()>0&&!this.select.options.chooseOption&&this.select.options.allOption}catch(t){s.w.printStackTrace(t,null,this)}if(this.select.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),""!=this.options.selectSetter)for(var i=0;i<this.itemArr.length;i++)this.select.addItem(this.itemArr[i].value,this.itemArr[i].label);this._setSize(t),
this.select.render.style.border="1px solid "+this.mainGrid.options.selectedCellColor},N.select.prototype._setSize=function(t){try{var e={top:0,left:0,bottom:0,right:0};if(r.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(e.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),e.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),e.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),e.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else{var i=WebSquare.style.getComputedStyle(t);i&&(i.padding||i.paddingTop||i.paddingBottom||i.paddingLeft||i.paddingRight)&&(e.left=parseInt(i.paddingLeft,10),e.right=parseInt(i.paddingRight,10),e.top=parseInt(i.paddingTop,10),e.bottom=parseInt(i.paddingBottom,10))}this.select.setSize(t.clientWidth-(2+e.left+e.right),t.clientHeight-(2+e.top+e.bottom))}catch(t){s.w.printStackTrace(t,null,this)}},N.select.prototype.createItemTable=function(t,e){var i=this;this.existGridViewItemsetNode&&this.select._openOtherLayer(),this.select.setSubLayer();var o=this.select.itemTable;o.addClickEventListener((function(t,e){i.select.setSelectedIndex1(e);var o=i.mainGrid.getLastFocusedCell();if(i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell(),i.options.moveEditModeByChoice){var s=i.options.moveEditModeByChoice;switch(s){case"down":i.mainGrid.moveVertical({},s,true);break;case"right":i.mainGrid.moveHorizontal({byApi:!0},s,true)}}})),this.existGridViewItemsetNode?o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t);var e=i.mainGrid.getLastFocusedCell();i.editRowIndex==e.focusedRowIndex&&i.col_index==e.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode));break;case 27:i.handleCancelEdit(t)}})):o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:if("ul"==this.options.tableRender){var e=this.getSelectedIndex();e=parseInt(e),this.endReached&&(this.endReached=!1,i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid._setFocusedCell())}else{this.fireClick(t);var o=i.mainGrid.getLastFocusedCell();i.editRowIndex==o.focusedRowIndex&&i.col_index==o.focusedColIndex&&("down"==i.mainGrid.options.tabKeyMove?i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode):"none"==i.mainGrid.options.tabKeyMove||i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode))}break;case 13:o=i.mainGrid.getLastFocusedCell();i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||(i.mainGrid.options.fastEditMode?"none"==i.mainGrid.options.enterKeyMove||("right"==i.mainGrid.options.enterKeyMove?i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode):i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode)):i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell());break;case 27:i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell()}})),r.D.isOpera()&&o.event.addListener(o.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||u.B.preventDefault(t)})),this.mainGrid._moveKeyEdit(o.uuid,"keyDownFunc",{itemTable:!0}),WebSquare.WebSquaredoc.itemsetElement.length>0&&WebSquare.WebSquaredoc.itemsetElement[WebSquare.WebSquaredoc.itemsetElement.length-1].id==this.mainGridId+"_selectbox_"+this.colID&&WebSquare.WebSquaredoc.itemsetElement.pop()},N.select.prototype.setInnerHTML=function(t,e,i,o,a){var n=r.D.getDataPrefix("col_id"),l=r.D.getDataPrefix("rowindex"),h=this.mainGrid._getGroupbyDisplayRowIndex(i);if(this.options.embeddedInput&&!this.mainGrid.groupbyStatus.grouped){
var d=this.mainGrid.getInput(this,t,e);if(d.render.setAttribute(l,i),""==this.options.selectSetter||this.dataComp||(this.initSelectSetter(),d.itemArr=this.itemArr,d.setSelectOptions()),this.hasRef&&!this.dataComp){var p=this.mainGrid.getElemRowIndex(t);d.itemArr=this.getRefItemArr(p),d.setSelectOptions()}if(this.dataComp){var c=this.mainGrid.modelControl.getDataComp(this.dataComp);if("linkedDataList"===c.initializeType&&null!=c.conditionInfo&&c.conditionInfo.filterInfo.useRef){var g=c.conditionInfo.targetInfo,f={};for(var m in g){var y=this.mainGrid.modelControl.getDataComp(m);if(y&&null!=y.initializeType&&"dataMap"!==y.initializeType){var b=y.getRowPosition();b!=i&&(f[m]=b,"linkedDataList"===y.initializeType?y._dataList.rowPosition=y.filteredRowIndexArr[i]:y.rowPosition=i)}}for(var w in d.stopRefreshItemTable(!0),c.syncWithParent(),d.stopRefreshItemTable(!1),f){var v=this.mainGrid.modelControl.getDataComp(w);"linkedDataList"===v.initializeType?v._dataList.rowPosition=v.filteredRowIndexArr[f[w]]:v.rowPosition=f[w]}for(var C=c.getAllJSON(),I=[],_=0;_<C.length;_++)I.push({label:C[_][this.itemsetObj.label],value:C[_][this.itemsetObj.value]});if(d.setNodeSet("",this.itemsetObj.label,this.itemsetObj.value),d.itemArr=I,1==d.options.allOption&&(d.itemArr=[{label:d.defaultAllOptionLabel,value:WebSquare.allValue}].concat(d.itemArr)),1==d.options.chooseOption){var x=d._getChooseOptionLabel();x=WebSquare.xml.decode(x).replace("&nbsp;"," "),d.itemArr=[{label:x,value:d.options.chooseOptionValue}].concat(d.itemArr)}d.setSelectOptions()}}if(d.setValue(e),!d.setValueNM(e)&&!this.dataComp){var S={};S[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(d.render.getAttribute(l),o,d.getValue(),null,null,null,S)}var D=!1;this.mainGrid._getEditDisabled(i,o)?(d.setDisabled(!0),D=!0):d.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?(d.setReadOnly(!0),D=!0):d.setReadOnly(!1),d.dom.select.disabled=!!D,t.removeAttribute("tabIndex")}else{this.initSelectSetter();p=i;null==e&&(e="");var R=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;R=r.D.getBoolean(R);var L,T=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof T){this.useCustomFormatter=!0;x=this.getDisplayData(e,p);R&&(x=WebSquare.xml._encode(x+"")),L=T.call(this.mainGrid,e,x,h,o)}else this.useCustomFormatter=!1,L=this.getData(e,p),R&&(L=WebSquare.xml._encode(L+""));var k,F=this.internal?this.mainGridId+"_selectbox_"+i+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var A=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof A&&(this.mainGrid.options.titleFormatter=A,k=A.call(this,i,o,e))}else k=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.w.printStackTrace(t,null,this)}var E=k||this.options.title||"";if(E)t.setAttribute("title",E);else if(this.mainGrid.options.titleAuto){var M=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";E=""!==e?" title='"+M+" "+e+"'":" title='"+M+WebSquare.language.getMessage("Grid_select")+"'"}if(r.D.isSafari()&&-1!=navigator.userAgent.indexOf("Windows"))if(this.mainGrid.options.plainText&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=L;else{t.innerHTML="";var O=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(O.className="w2grid_span"),O.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:100%;","ul"==this.options.tableRender?O.innerHTML="<a href='#"+F+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+E+">"+L+"</a>":O.textContent=L,t.appendChild(O)}else if(this.mainGrid.options.plainText&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=L;else if("icon"==this.options.viewType){t.innerHTML=""
;O=document.createElement(this.mainGrid.options.dataTag);"span"==this.mainGrid.options.dataTag&&(O.className="w2grid_span"),O.style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:auto;","ul"==this.options.tableRender?O.innerHTML="<a href='#"+F+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+E+">"+L+"</a>":O.innerHTML=L,t.appendChild(O)}else{var N="";if("span"==this.mainGrid.options.dataTag&&(N=" w2grid_span"),"ul"==this.options.tableRender)t.innerHTML="<"+this.mainGrid.options.dataTag+"style='overflow : hidden; text-overflow:ellipsis; display:block; width:auto;'><a href='#"+F+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main"+N+"'"+E+">"+L+"</a>"+this.mainGrid.dataTagClose;else{var B=t.firstChild,H="w2grid_select"+N;if(this._checkFastScroll(L,B,H,a&&!0===a.scroll)){var G="string"==typeof L?WebSquare.xml.__decode(L):L;B.textContent=G}else t.innerHTML="<"+this.mainGrid.options.dataTag+" class='"+H+"'>"+L+this.mainGrid.dataTagClose}}var W=this.mainGrid.dataList.getRealRowIndex(i),V=this.mainGrid.getCellOption(W,o,"viewType"),q=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),j=r.D.getDataPrefix("editModeEvent");if("icon"==V||""==V&&"own"==q?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(j,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent||"ondblclick"==this.options.editModeEvent||"onsecondclick"==this.options.editModeEvent?t.setAttribute(j,this.options.editModeEvent):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute(j,"")),"ul"==this.options.tableRender){var P=this;this.mainGrid.event.addListener(t,"onfocus",this.mainGrid.event.bindAsEventListener(this.mainGrid,(function(t){var e=u.B.getTarget(t);P.mainGrid.lastEvent=t;var o=P.mainGrid.getLastFocusedCell();if((0!=o.focusedColIndex||0!=o.focusedRowIndex)&&(!r.D.isIEAllVersion()||!o.focusedRowIndex||o.focusedRowIndex==i)&&(o.focusedTd==e||P.mainGrid.focusedByApi||P.mainGrid._setFocusedCell(i,e.getAttribute(n)),P.mainGrid.focusedByApi=!1,e.childNodes[0]&&e.childNodes[0].childNodes[0])){var s=e.childNodes[0].childNodes[0];"A"==s.tagName&&s.focus()}})))}}},N.select.prototype.setColumnChooseOption=function(t,e){this.options.chooseOption=!0,this.options.chooseOptionValue=t,this.options.chooseOptionLabel=e,this.select&&this.select.changeChooseOption(t,e)},N.select.prototype.showChooseOption=function(t){this.options.chooseOption=t,this.matchInfo=this.setMatchInfo(),this.select&&t?this.select.showChooseOption(t):this.select&&!t&&(this.select.showChooseOption(t),this.select.itemArr.length>1&&0!=this.select.selectedIndex?this.select.selectedIndex-=1:this.select.selectedIndex=0,this.editTd.innerHTML=this.mainGrid.dataTagOpen+this.getData(this.select.getValue(),this.select.selectedIndex)+this.mainGrid.dataTagClose)},N.select.prototype.getData=function(t,e,i){try{var o,r="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u);if(p&&null!=p.initializeType&&"dataMap"!==p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in this.select&&this.select.stopRefreshItemTable(!0),o.syncWithParent(),this.select&&this.select.stopRefreshItemTable(!1),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,
y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var w=m.getTotalRow();y=[];for(var v=0;v<w;v++)y.push(v)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}var C=!1;if("linkedDataList"===o.initializeType&&this.select){var I=this.select.getItemCount(),_=this.select.itemArr;0===I?C=!0:1!=I||_[0].label!==this.select._getChooseOptionLabel()&&_[0].label!==this.select.defaultAllOptionLabel?2==I&&_[0].label===this.select._getChooseOptionLabel()&&_[1].label===this.select.defaultAllOptionLabel&&(C=!0):C=!0}if((!this.select||C)&&null!=m)try{var x,S;r="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)x=this.itemsetObj.label,S=this.itemsetObj.value;else{var D=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",a.v._XML_NAMESPACE.W2),R=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",a.v._XML_NAMESPACE.W2);D.length>0&&R.length>0&&(x=WebSquare.Elem.api.getAttribute(D[0],"ref"),S=WebSquare.Elem.api.getAttribute(R[0],"ref"))}var L=null!=x?m.bodyIdColIndexMap[x]:m.bodyIdColIndexMap[this.itemsetObj.label],T=null!=S?m.bodyIdColIndexMap[S]:m.bodyIdColIndexMap[this.itemsetObj.value];for(v=0;v<y.length;v++){var k=y[v]*m.cellIdList.length;if(t==m.dataArr[k+T])return r=m.dataArr[k+L],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?r=t+this.options.delimiter+r:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?r=r+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(r=t),i&&i.emptyValue&&(""===r||"$blank"==r)?r=i.emptyValue:void 0!==r&&"$blank"!=r||(r=""),r}var F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],A=this.selectedIndex||this.mainGrid._getSelectedIndex(e,F);if(A>=0&&A<b.length&&!this.options.chooseOption){r=m.dataArr[b[A]*m.cellIdList.length+L],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?r=t+this.options.delimiter+r:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?r=r+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(r=t);k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var E=this.mainGrid._dataList.cellIdList.length,M=(F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],m.dataArr[y[A]*m.cellIdList.length+T]);this.mainGrid._dataList.dataArr[k*E+F]=M}else if(this.options.allOption&&t==WebSquare.allValue){r=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)r=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)r="";else{k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];E=this.mainGrid._dataList.cellIdList.length,F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[k*E+F]="",r=""}else r=this.options.selectedDataDisplay?t:"";return i&&i.emptyValue&&(""===r||"$blank"==r)?r=i.emptyValue:void 0!==r&&"$blank"!=r||(r=""),r}catch(e){return s.w.printStackTrace(e,null,this),t}var O=!1;for(v=0;v<this.select.itemArr.length;v++)if((t||-1!=N)&&this.select.itemArr[v].value==t){O=!0,r=this.select.itemArr[v].label;break}var N=this.mainGrid._getSelectedIndex(e,this.mainGrid._dataList.bodyIdColIndexMap[this.colID]);if(!O&&o.options&&o.options.validateAllItemsetData)for(v=0;v<this.select.allItemArr.length;v++)if(this.select.allItemArr[v].value==t){O=!0,r=this.select.allItemArr[v].label;break}if(!O)if(""!=t||-1==N||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){r=WebSquare.language.getMessage("Grid_all")||"-all-"
}else this.options.chooseOption&&t==this.options.chooseOptionValue?r=this.options.chooseOptionLabel:this.options.selectedData||(r=this.options.selectedDataDisplay?t:"");else this.select.itemArr.length>0?(r=this.select.itemArr[N].label,this.mainGrid.dataList.__setCellData(e,this.colID,r)):r=t}else{var B=this.getMatchInfo(e);N=this.mainGrid._getSelectedIndex(e,this.mainGrid.bodyIdColIndexMap[this.colID]);""!=t||-1==N||this.options.chooseOption?r=B["SELECT_"+t]:(this.mainGrid.dataList.__setCellData(e,t),r=B["SELECT_"+this.itemArr[N].label])}if(i&&i.emptyValue&&(""===r||"$blank"==r))r=i.emptyValue;else if(void 0===r||"$blank"==r)return"";return r}catch(t){s.w.printStackTrace(t,null,this)}},N.select.prototype.initSelectSetter=function(){if(0==this.selectSetted&&""!=this.options.selectSetter&&!this.dataComp){this.selectSetted=!0;var t=[];try{this.options.selectSetter=this.options.selectSetter.wq_trim(),this.options.selectSetter.indexOf("(")<0&&(this.options.selectSetter+="()"),t=new Function("return "+this.options.selectSetter)()}catch(t){s.w.printStackTrace(t)}this.itemArr=t,this.matchInfo=[];for(var e=0;e<t.length;e++){var i=t[e];null==i.value&&(i.value=""),this.matchInfo["SELECT_"+i.value]=i.label}}},N.select.prototype.setEditMode=function(t,e){if(!this.options.embeddedInput){if(this.dataComp){var i=this.mainGrid.modelControl.getDataComp(this.dataComp);i&&"linkedDataList"===i.initializeType&&null!=i.conditionInfo&&i.conditionInfo.filterInfo.useRef&&i.syncWithParent()}if(!0!==this._init?(this.createSelectbox(t,e),this._init=!0):(t.innerHTML="",this.mainGrid.cellMergeInfo&&this._setSize(t),t.appendChild(this.select.render),this.options.itemTooltipFormatter&&(this.select.options._rowIndex=e)),this.mainGrid.directItemChoiceKeyObj.select){this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID));var o=this.select.findItemStartedWithKeyChar(this.mainGrid.directItemChoiceKeyObj.select);if(this.mainGrid.dataList.__setCellData(e,this.colID,this.select.getValue()),this.mainGrid.directItemChoiceKeyObj.select=null,this.options.moveFocusByChoice&&o&&this.moveFocus(this.editRowIndex,this.colID),o)return;this.mainGrid.editedCell=this.mainGrid.getCellInfo(t),t.innerHTML="",t.appendChild(this.select.render)}if(this.select.itemTable||this.mainGrid.directItemChoiceKeyObj.select||(this.existGridViewItemsetNode&&(this.editTd=t),this.createItemTable(t,e)),this.hasRef&&!this.dataComp){var s=this.mainGrid.getElemRowIndex(t);this.select.itemArr=this.getRefItemArr(s),this.select.itemTable.show(),this.select.setSelectOptions()}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),0==this.select.getItemCount()&&(this.select.selectedIndex=-1,this.select.dom.label.innerHTML=""),this.existGridViewItemsetNode&&this.select.gridViewOptions.width)this.select.openSubLayer();else{var a=t.clientWidth-2,n={top:0,left:0,bottom:0,right:0};if(r.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(n.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),n.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),n.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),n.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(n.left=parseInt(u.paddingLeft,10),n.right=parseInt(u.paddingRight,10),n.top=parseInt(u.paddingTop,10),n.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+n.left+n.right),t.clientHeight-(2+n.top+n.bottom)),this.select.itemTable.setStyle("width",t.clientWidth-4+"px"),this.select.openSubLayer()
;var l=this.mainGrid.render.offsetWidth,h=this.select.itemTable.render.offsetWidth,d=this.select.itemTable.render.firstChild.offsetWidth;if(h-2>a&&(a=h-2),this.select.itemTable.render.clientHeight>=this.select.itemTable.render.scrollHeight||this.select.getItemCount()<=this.select.options.visibleRowNum)this.select.itemTable.render.firstChild.style.width=a+"px",l>h&&d<h&&this.select.itemTable.render.firstChild.firstChild&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=a&&this.select.itemTable.setStyle("width",a+"px");else{this.select.itemTable.render.firstChild.style.width=a-17+"px";var u;n={top:0,left:0,bottom:0,right:0};if(r.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(n.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),n.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),n.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),n.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(n.left=parseInt(u.paddingLeft,10),n.right=parseInt(u.paddingRight,10),n.top=parseInt(u.paddingTop,10),n.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+n.left+n.right),t.clientHeight-(2+n.top+n.bottom)),l>h&&d+17<=h-2&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=a&&this.select.itemTable.setStyle("width",a+"px")}}t.style.textOverflow="ellipsis"}},N.select.prototype._handleEndEdit_common=function(t){try{this.select.closeSubLayer();var e=this.select.getValue();try{this.select.render.parentNode&&this.editTd.removeChild(this.select.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.select.prototype._handleEndEdit_focus=function(){this.options.moveFocusByChoice&&this.moveFocus(this.editRowIndex,this.colID)},N.select.prototype._getEditedValue=function(t){return this.select.getValue()},N.select.prototype._handleCancelEdit=function(t){this.select.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.editTd.removeChild(this.select.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID))},N.select.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.select.prototype.moveFocus=function(t,e){if(this.options.moveFocusByChoice)switch(this.options.moveFocusByChoice){case"down":this.mainGrid._setFocusedCell(t+1,e,!1);break;case"right":var i=this.mainGrid.getColumnIndex(e)+1;this.mainGrid._setFocusedCell(t,i,!1)}},N.select.prototype.refreshCell=function(){try{if(!this.options.selectedData)return;if(!this.dataComp)return;var t=this.mainGrid.modelControl.getDataComp(this.dataComp);if(!t)return;var e,i=null,o=null;if("linkedDataList"===t.initializeType?(i=t._dataList,o=t.initialRowIndexArr):"dataList"===t.initializeType&&(o=(i=t).filteredRowIndexArr),null==i)return;if(this.internal)this.itemsetObj.label,e=this.itemsetObj.value;else{var r=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",a.v._XML_NAMESPACE.W2),n=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",a.v._XML_NAMESPACE.W2);r.length>0&&n.length>0&&(WebSquare.Elem.api.getAttribute(r[0],"ref"),e=WebSquare.Elem.api.getAttribute(n[0],"ref"))}var h,d=null!=e?i.bodyIdColIndexMap[e]:i.bodyIdColIndexMap[this.itemsetObj.value];h=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var u=this.mainGrid._dataList.cellIdList.length,p=this.mainGrid._dataList.bodyIdColIndexMap[this.id],c=0;c<h.length;c++){var g=h[c];if("object"!==(0,l.Z)(g)){
var f=this.mainGrid._dataList.dataArr[g*u+p];if(!(this.options.allOption&&f==WebSquare.allValue||this.options.chooseOption&&f==this.options.chooseOptionValue||!(""!==f||this.selectedIndex>=0))){var m=!1;if("linkedDataList"===t.initializeType&&null!=t.conditionInfo&&t.conditionInfo.filterInfo.useRef){var y=t.conditionInfo.targetInfo,b={};for(var w in y){var v=this.mainGrid.modelControl.getDataComp(w);if(null!=v.initializeType&&"dataMap"!=v.initializeType){var C=v.getRowPosition();C!=c&&(b[w]=C,"linkedDataList"===v.initializeType?v._dataList.rowPosition=v.filteredRowIndexArr[c]:v.rowPosition=c)}}var I=t.getBroadcast();for(var _ in t.setBroadcast(!1),t.syncWithParent(),t.setBroadcast(I),b){var x=this.mainGrid.modelControl.getDataComp(_);"linkedDataList"===x.initializeType?x._dataList.rowPosition=x.filteredRowIndexArr[b[_]]:x.rowPosition=b[_]}o=t.initialRowIndexArr}for(var S=0;S<o.length;S++)if(f==i.dataArr[o[S]*i.cellIdList.length+d]){m=!0;break}if(!m){var D="";this.selectedIndex>=0&&this.selectedIndex<o.length&&!this.options.chooseOption&&(D=i.dataArr[o[this.selectedIndex]*i.cellIdList.length+d]),this.mainGrid._dataList.dataArr[g*u+p]=D}}}}}catch(t){s.w.printStackTrace(t,null,this)}},N.checkcombobox=function(){},N.checkcombobox.prototype._initializeCellInfo=function(){try{this.separator=this.options.separator||" "}catch(t){s.w.printStackTrace(t,null,this)}},N.checkcombobox.prototype.setInnerHTML=function(t,e,i,o,a){try{null==e&&(e="");var n=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;n=WebSquare.util.getBoolean(n);var l=this.getData(e,i);n&&(l=WebSquare.xml._encode(l+"")),t.innerHTML=this.mainGrid.dataTagOpen+l+this.mainGrid.dataTagClose;var h,d=this.mainGrid.dataList.getRealRowIndex(i),u=this.mainGrid.getCellOption(d,o,"viewType"),p=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),c=r.D.getDataPrefix("editModeEvent");if("icon"==u||""==u&&"own"==p?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute(c,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(c,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute(c,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var g=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof g&&(this.mainGrid.options.titleFormatter=g,h=g.call(this,i,o,e))}else h=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",h)}catch(t){s.w.printStackTrace(t,null,this)}}catch(t){WebSquare.exception.printStackTrace(t,null,this)}},N.checkcombobox.prototype.getData=function(t,e,i){try{var o="";t=t.split(this.separator);var r,n,l=[],h=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var d=this.itemsetObj.nodeset;d.indexOf("data:")>=0&&(h=d.slice(5))}if(h&&(n=this.mainGrid.modelControl.getDataComp(h)),h&&n){if("linkedDataList"===n.initializeType&&null!=n.conditionInfo&&n.conditionInfo.filterInfo.useRef){var u=n.conditionInfo.targetInfo,p={};for(var c in u){var g=this.mainGrid.modelControl.getDataComp(c);if(null!=g.initializeType&&"dataMap"!=g.initializeType){var f=g.getRowPosition();f!=e&&(p[c]=f,"linkedDataList"===g.initializeType?g._dataList.rowPosition=g.filteredRowIndexArr[e]:g.rowPosition=e)}}for(var m in this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!0),n.syncWithParent(),this.checkcombobox&&this.checkcombobox.stopRefreshItemTable(!1),p){var y=this.mainGrid.modelControl.getDataComp(m);"linkedDataList"===y.initializeType?y._dataList.rowPosition=y.filteredRowIndexArr[p[m]]:y.rowPosition=p[m]}}var b=null,w=null;if("linkedDataList"===n.initializeType?(b=n._dataList,w=n.initialRowIndexArr):"dataList"===n.initializeType&&(w=(b=n).filteredRowIndexArr),!this.checkcombobox&&null!=b)try{var v,C;o=""
;if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)v=this.itemsetObj.label,C=this.itemsetObj.value;else{var I=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",a.v._XML_NAMESPACE.W2),_=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",a.v._XML_NAMESPACE.W2);0!=I.length&&0!=_.length&&(v=WebSquare.Elem.api.getAttribute(I[0],"ref"),C=WebSquare.Elem.api.getAttribute(_[0],"ref"))}for(var x=b.bodyIdColIndexMap[v],S=b.bodyIdColIndexMap[C],D=0;D<w.length;D++)for(var R=w[D]*b.cellIdList.length,L=0;L<t.length;L++)t[L]==b.dataArr[R+S]&&(o=b.dataArr[R+x],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?o=t[L]+this.options.delimiter+o:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?o=o+this.options.delimiter+t[L]:"value"!==this.options.displayMode&&3!=this.options.displayMode||(o=t[L]),i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),l.push(o));if(l.length>0)return l.join(this.separator);if(this.options.allOption&&t==WebSquare.allValue)o=WebSquare.language.getMessage("Grid_all")||"-all-";else if(this.options.chooseOption&&t==this.options.chooseOptionValue)o=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)o="";else{R=0;R=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var T=this.mainGrid._dataList.cellIdList.length,k=this.mainGrid._dataList.bodyIdColIndexMap[this.id];this.mainGrid._dataList.dataArr[R*T+k]="",o="",this.options.chooseOption&&!this.options.chooseOptionValue&&(o=this.options.chooseOptionLabel)}else o=t;return i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o}catch(e){return s.w.printStackTrace(e,null,this),t}var F=!1;r={};for(D=0;D<this.checkcombobox.itemArr.length;D++)for(L=0;L<t.length;L++)this.checkcombobox.itemArr[D].value==t[L]&&(l.push(this.checkcombobox.itemArr[D].label),r[D+"_"]=!0,F=!0);if(!F){if(""==l&&1==this.options.chooseOption){if(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(E=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(o=E);o=WebSquare.xml.decode(o).replace("&nbsp;"," ")}else this.options.selectedData||(o=t);l.push(o),r=null}o=l.join(this.separator)}else{var A=this.getMatchInfo(e);for(F=!1,D=0;D<t.length;D++)void 0!==(o=A["CHECKCOMBOBOX_"+t[D]])&&(l.push(o),F=!0);if(F){if(this.options.checkcomboboxRangeSeparator&&this.checkcombobox){r={};for(D=0;D<this.checkcombobox.itemArr.length;D++)for(L=0;L<t.length;L++)this.checkcombobox.itemArr[D].value==t[L]&&(r[D+"_"]=!0)}}else{if(""==l&&1==this.options.chooseOption){var E;if(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(E=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(o=E);o=WebSquare.xml.decode(o).replace("&nbsp;"," ")}else this.options.selectedData||(o=t);l.push(o)}o=l.join(this.separator)}if(i&&i.emptyValue&&(""===o||"$blank"==o))o=i.emptyValue;else if(void 0===o||"$blank"==o)return"";return this.options.checkcomboboxRangeSeparator&&this.checkcombobox&&r?this.checkcombobox._getRangeText(this.checkcombobox.itemArr,this.checkcombobox.itemArr.length,this.separator,r):o}catch(t){s.w.printStackTrace(t,null,this)}},N.checkcombobox.prototype._createComponent=function(t){try{if(this.comp)return;this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_checkcombobox_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("allOption",this.options.allOption+""),"column"===this.options.submenuSize?this.xml.setAttribute("submenuSize","column"):this.xml.setAttribute("submenuSize","auto"),
this.xml.setAttribute("style",this.style),this.xml.setAttribute("disabled",this.mainGrid.getDisabled("cell",this.mainGrid._getGroupbyDisplayRowIndex(t),this.colID)),this.xml.setAttribute("useDrag",this.options.checkcomboboxUseDrag),this.xml.setAttribute("useEdit",this.options.checkcomboboxUseEdit),this.xml.setAttribute("rangeSeparator",this.options.checkcomboboxRangeSeparator),this.xml.setAttribute("validateOnInput",this.options.checkcomboboxValidateOnInput),this.options.checkcomboboxVisibleRowNum>1&&this.xml.setAttribute("visibleRowNum",this.options.checkcomboboxVisibleRowNum),this.options.checkcomboboxVisibleColNum>1&&this.xml.setAttribute("visibleColNum",this.options.checkcomboboxVisibleColNum),this.options.checkcomboboxVisibleColMax>1&&this.xml.setAttribute("visibleColMax",this.options.checkcomboboxVisibleColMax),this.configOptions.separator=this.separator,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.internal&&(this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions)),this.checkcombobox=new WebSquare.uiplugin.checkcombobox(this.mainGridId+"_checkcombobox_"+this.id,this.configOptions,this.xml),this.comp=this.checkcombobox;var e=this;this.checkcombobox.__closeSubLayer=this.checkcombobox.closeSubLayer,this.checkcombobox.closeSubLayer=function(){this.__closeSubLayer(),e.handleEndEdit()},this.checkcombobox.toggle=function(){if(this.isOpen){var i=this.getValue(),o=this.getInfoArray();this.__closeSubLayer();var s=this.getValue(),a=e.mainGrid.getColumnIndex(e.options.id);if(i!=s){var r={oldInfo:o,newInfo:this.getInfoArray(),oldValue:i,newValue:s,rowIndex:t,colIndex:a,colId:e.mainGrid.getColumnID(a)};u.B.fireEvent(e.mainGrid,"onviewchange",r)}e.handleEndEdit()}else this.openSubLayer()},this.checkcombobox._parent_uuid=this.mainGrid.uuid}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.checkcombobox.prototype.setEditMode=function(t,e){try{if(this.dataComp){var i=this.mainGrid.modelControl.getDataComp(this.dataComp);i&&"linkedDataList"===i.initializeType&&null!=i.conditionInfo&&i.conditionInfo.filterInfo.useRef&&i.syncWithParent()}if(!0!==this._init){if(this._createComponent(e),t.innerHTML=this.checkcombobox.toHTML(),this.checkcombobox.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setSubLayer(),!this.existGridViewItemsetNode){var o=this.checkcombobox.itemTable,a=this;o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:a.checkcombobox.closeSubLayer(),a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode);break;case 13:a.mainGrid.options.fastEditMode?"none"==a.mainGrid.options.enterKeyMove||("right"==a.mainGrid.options.enterKeyMove?a.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",a.mainGrid.options.keyMoveEditMode):a.mainGrid.moveVertical(t,t.shiftKey?"up":"down",a.mainGrid.options.keyMoveEditMode)):a.checkcombobox.closeSubLayer();break;case 27:a.mainGrid.editedCell.handleCancelEdit(t)}})),this.mainGrid._moveKeyEdit(o.uuid,"keyDownFunc",{itemTable:!0})}this._init=!0}else t.innerHTML="",this.mainGrid.cellMergeInfo&&this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),t.appendChild(this.checkcombobox.render);if(this.hasRef&&!this.dataComp){var r=this.mainGrid.getElemRowIndex(t);this.checkcombobox.itemArr=this.getRefItemArr(r),this.checkcombobox.setSelectOptions()}this.existGridViewItemsetNode?(this.checkcombobox.openSubLayer(),
this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID))):(this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.checkcombobox.openSubLayer()),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t);var n=this.checkcombobox.itemTable.render.firstChild.clientWidth;n<t.clientWidth-2&&(n=t.clientWidth-2),n<this.checkcombobox.itemTable.render.offsetWidth-2&&(n=this.checkcombobox.itemTable.render.offsetWidth-2),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setItemTable(),t.style.textOverflow="ellipsis"}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.checkcombobox.prototype._handleEndEdit_common=function(t){try{this.checkcombobox.__closeSubLayer&&this.checkcombobox.__closeSubLayer();var e=this.checkcombobox.getValue();try{this.editTd.removeChild(this.checkcombobox.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.checkcombobox.prototype._handleEndEdit_focus=function(){this.mainGrid._setFocusedCell()},N.checkcombobox.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.checkcombobox.prototype._handleCancelEdit=function(t){this.checkcombobox.__closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},N.checkcombobox.prototype._getEditedValue=function(t){return this.checkcombobox.getValue()},N.checkcombobox.prototype.refreshItemArr=function(t){var e=WebSquare.WebSquareparser.parseChoices(this.xml,"");if(e.length>0?this.itemArr=e:this.itemArr=this.modelControl.getItemsetData(),1==this.options.allOption){var i=WebSquare.language.getMessage("Grid_all")||"-all-";this.itemArr=[{label:i,value:WebSquare.allValue}].concat(this.itemArr)}},N.autoComplete=function(){},N.autoComplete.prototype.setInnerHTML=function(t,e,i,o,a){try{var n;null==e&&(e="");var l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;h=r.D.getBoolean(h);var d=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof d){this.useCustomFormatter=!0;var p=this.getDisplayData(e,i);h&&(p=WebSquare.xml._encode(p+"")),n=d.call(this.mainGrid,e,p,l,o)}else{this.useCustomFormatter=!1,n=this.getData(e,i),h&&(n=WebSquare.xml._encode(n+""));var c=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;n&&this.formatter&&c&&(n=this.formatter.format(n))}var g=this.mainGrid.dataList.getRealRowIndex(i),f=this.mainGrid.getCellOption(g,o,"viewType"),m=r.D.getDataPrefix("col_id"),y=r.D.getDataPrefix("rowIndex"),b=r.D.getDataPrefix("colIndex");if(this.options.embeddedInput){var w=this.mainGrid.getInput(this,t,e),v=0,C=0,I=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",I=!0),this.mainGrid.embeddedAutoCompleteStyleObj||(this.mainGrid.embeddedAutoCompleteStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),v=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),v-=this.mainGrid.embeddedAutoCompleteStyleObj.top+this.mainGrid.embeddedAutoCompleteStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),C=this.mainGrid.embeddedWidthObj[o].width,
C-=this.mainGrid.embeddedAutoCompleteStyleObj.left+this.mainGrid.embeddedAutoCompleteStyleObj.right,I?t.parentNode.style.display="none":WebSquare.util.isIE("6 7")&&(v-=2),w._setSize(C-2,v),w.render.setAttribute(y,i),w.setValue(e),""!==n&&(w.dom.label.innerHTML=n),this.mainGrid._getEditDisabled(i,o)?w.setDisabled(!0):w.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?w.setReadOnly(!0):w.setReadOnly(!1),t.removeAttribute("tabIndex")}else if("icon"==f&&"true"==this.options.viewTypeIconImage){t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+m+"='"+this.colID+"' "+y+"='"+i+"' "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose,"</td>","<td "+m+"='"+this.colID+"' "+y+"='"+i+"'  "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_div_img' />","</td>","</table>"].join("");var _=this,x=t,S=t.getElementsByTagName("div")[0];u.B.addListener(S,"onclick",(function(t){_.mainGrid._getEditDisabled(i,o)||_.mainGrid.___getEditReadOnly(i,o)||(_.autoCompleteImageClicked=!0,_.options.directOpen&&(_.mainGrid.__setFocusedCell(t,x),_.mainGrid.setEditMode(x)))}))}else{t.innerHTML=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;var D,R=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),L=r.D.getDataPrefix("editModeEvent");if("icon"==f||""==f&&"own"==R?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute(L,this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute(L,"onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute(L,"")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var T=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof T&&(this.mainGrid.options.titleFormatter=T,D=T.call(this,i,o,e))}else D=this.mainGrid.options.titleFormatter.call(this,i,o,n);t.setAttribute("title",D)}catch(t){s.w.printStackTrace(t,null,this)}}}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype.getInput=function(t,e,i,o){try{var a=o.titleStr,r=o.input_id,n=o.dataRowIndex,l=o.dataCol_id,h=t.mainGrid,d=a||t.options.title||"";if(h.options.titleAuto&&!d){var p=h.getHeaderValue(h.bodyToHeaderRelation[t.id])||"";d=""!==i&&null!=i?p+" "+(h.changeItemValue("label",t.id,[i])[0]||i):p+WebSquare.language.getMessage("Grid_autoComplete")}var c=new WebSquare.uiplugin.autoComplete(r,{className:"w2grid_embedded_select",style:"$blank",pluginName:"autoComplete",renderType:"native",title:d,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,accessibility:this.mainGrid.options.accessibility,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute(n),10),i=this.render.parentNode.getAttribute(l),o=h.getColumnIndex(i);WebSquare.event.fireEvent(h,"oncellclick",e,o,i)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:case 13:return void u.B.stopPropagation(t)}}}}]},t.xml);e.innerHTML=c.toHTML();var g=WebSquare.uiplugin.autoComplete.prototype.setSelectedIndex1;if(c.setSelectedIndex1=function(t,e,i){var o=this.render.parentNode.getAttribute(l),s=parseInt(this.render.getAttribute(n),10),a=h._getGroupbyDisplayRowIndex(s),r=h.getColumnIndex(o),d=this.selectedIndex,p=this.getValue();if(g.call(this,t,e,i),h.dataList.__setCellData(s,o,this.getValue()),h._dataList.setRowPosition(s),d!=this.selectedIndex){var c={oldValue:p,newValue:this.getValue(),oldSelectedIndex:d,newSelectedIndex:this.selectedIndex,rowIndex:s,colIndex:r,colId:h.getColumnID(r)};u.B.fireEvent(h,"onviewchange",c)}
u.B.fireEvent(h,"onafteredit",a,r,this.getValue())},c.activate(),!0!==this.mainGrid.options.accessibility){var f=c.uuid;c.event.addListener2(c.dom.input,"onfocus",(function(t){h.lastEvent=t;var e=WebSquare.idCache[f];h.getLastFocusedCell().focusedTd==e.render.parentNode||h.focusedByApi||h._setFocusedCell(e.render.getAttribute(n),e.render.parentNode.getAttribute(l)),h.focusedByApi=!1}))}return c}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype._initializeCellInfo=function(t){try{"useData"==this.options.noResult&&(this.useDataInfo={})}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype.getData=function(t,e,i){try{var o,r="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice(5))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u);if(null!=p.initializeType&&"dataMap"!=p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in o.syncWithParent(),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var w=m.getTotalRow();y=[];for(var v=0;v<w;v++)y.push(v)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}if(!this.autoComplete&&null!=m)try{var C,I;r="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)C=this.itemsetObj.label,I=this.itemsetObj.value;else{var _=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",a.v._XML_NAMESPACE.W2),x=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",a.v._XML_NAMESPACE.W2);_.length>0&&x.length>0&&(C=WebSquare.Elem.api.getAttribute(_[0],"ref"),I=WebSquare.Elem.api.getAttribute(x[0],"ref"))}var S=null!=C?m.bodyIdColIndexMap[C]:m.bodyIdColIndexMap[this.itemsetObj.label],D=null!=I?m.bodyIdColIndexMap[I]:m.bodyIdColIndexMap[this.itemsetObj.value];for(v=0;v<y.length;v++){var R=y[v]*m.cellIdList.length;if(t==m.dataArr[R+D])return r=m.dataArr[R+S],"value delim label"===this.options.displayMode||1==this.options.displayMode?r=t+this.options.delimiter+r:"label delim value"===this.options.displayMode||2==this.options.displayMode?r=r+this.options.delimiter+t:"value"!==this.options.displayMode&&3!=this.options.displayMode||(r=t),i&&i.emptyValue&&(""===r||"$blank"==r)?r=i.emptyValue:void 0!==r&&"$blank"!=r||(r=""),r}if(this.selectedIndex>=0&&this.selectedIndex<b.length&&!this.options.chooseOption)r=m.dataArr[b[this.selectedIndex]*m.cellIdList.length+S],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?r=t+this.options.delimiter+r:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?r=r+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(r=t);else if(this.options.allOption&&t==WebSquare.allValue){r=WebSquare.language.getMessage("Grid_all")||"-all-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)r=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)r="";else{R=0;R=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var L=this.mainGrid._dataList.cellIdList.length,T=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[R*L+T]="",r=""}else r=t
;return i&&i.emptyValue&&(""===r||"$blank"==r)?r=i.emptyValue:void 0!==r&&"$blank"!=r||(r=""),r}catch(e){return s.w.printStackTrace(e,null,this),t}var k=!1;for(v=0;v<this.autoComplete.itemArr.length;v++)if(this.autoComplete.itemArr[v].value==t){k=!0,r=this.autoComplete.itemArr[v].label;break}if(!k&&o.options&&o.options.validateAllItemsetData)for(v=0;v<this.autoComplete.allItemArr.length;v++)if(this.autoComplete.allItemArr[v].value==t){k=!0,r=this.autoComplete.allItemArr[v].label;break}if(!k)if(""!=t||-1==this.selectedIndex||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){r=WebSquare.language.getMessage("Grid_all")||"-all-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?r=this.options.chooseOptionLabel:this.options.selectedData||(r=t);else r=this.autoComplete.itemArr[this.selectedIndex].label,this.mainGrid.dataList.__setCellData(e,this.colID,r)}else{var F=this.getMatchInfo(e);"useData"==this.options.noResult&&(this.useDataInfo["AUTOCOMPLETE_"+t]||(this.useDataInfo["AUTOCOMPLETE_"+t]=t),F["AUTOCOMPLETE_"+t]||(this.matchInfo["AUTOCOMPLETE_"+t]=t,this.itemArr=[{label:t,value:""}].concat(this.itemArr))),r=F["AUTOCOMPLETE_"+t]}if(i&&i.emptyValue&&(""===r||"$blank"==r))r=i.emptyValue;else if(void 0===r||"$blank"==r)return"";return r}catch(t){s.w.printStackTrace(t,null,this)}return t},N.autoComplete.prototype._createComponent=function(t){try{if(this.comp)return;if(this.options.disableEdit?this.style="position:relative;left:0px;top:0px;":this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_autoComplete_"+this.colID),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.interactionMode&&(this.configOptions.interactionMode=this.options.interactionMode),this.options.submission&&(this.configOptions.submission=this.options.submission),this.options.sortOption&&(this.configOptions.sortOption=this.options.sortOption),this.options.displayMode&&(this.configOptions.displayMode=this.options.displayMode),this.options.search&&(this.configOptions.search=this.options.search),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.submenuSize&&(this.configOptions.submenuSize=this.options.submenuSize),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.allOption&&(this.configOptions.allOption=this.options.allOption),this.options.chooseOptionLabel&&(this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel),this.options.noResult&&(this.configOptions.noResult=this.options.noResult),this.options.disableEdit&&(this.configOptions.disableEdit=this.options.disableEdit),this.options.findItemFirstKey&&(this.configOptions.findItemFirstKey=this.options.findItemFirstKey),this.options.findItemKor&&(this.configOptions.findItemKor=this.options.findItemKor),this.options.maxlength&&(this.configOptions.maxlength=this.options.maxlength),r.D.isIEAllVersion()&&this.xml.removeAttribute("readOnly"),this.internal&&(this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions),this.options.caseSensitive&&(this.configOptions.caseSensitive=this.options.caseSensitive)),this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.hasRef)this.targetRowIndex=t,
WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.autoComplete=new WebSquare.uiplugin.autoComplete(this.mainGridId+"_autoComplete_"+t+"_"+this.colID+"_"+this.id,this.configOptions,this.xml),this.autoComplete.options.disabled=!1,this.comp=this.autoComplete,this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setItemSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value);var e=this;this.autoComplete._handleClickEvent=this.autoComplete.handleClickEvent,this.autoComplete.handleClickEvent=function(t){this._handleClickEvent(t),u.B.stopEvent(t)},this.existGridViewItemsetNode?(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit()}))}):(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),"down"==e.mainGrid.options.tabKeyMove?e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode):"none"==e.mainGrid.options.tabKeyMove||e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 13:e.mainGrid.options.fastEditMode&&("none"==e.mainGrid.options.enterKeyMove||("right"==e.mainGrid.options.enterKeyMove?e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode):e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode)));break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit(),e.options.directOpen&&e.mainGrid._setFocusedCell()})),e.mainGrid._moveKeyEdit(i.uuid,"keyDownFunc",{itemTable:!0})}),this.autoComplete.showEditMode=function(t){try{t?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible")}catch(t){s.w.printStackTrace(t,null,this)}},this.autoComplete._inputKeyDown=this.autoComplete.inputKeyDown,this.autoComplete.inputKeyDown=function(t,i){27==t.keyCode||(e.autoComplete._inputKeyDown(t,i),13===t.keyCode&&e.options.directOpen&&(e.mainGrid._setFocusedCell(),u.B.stopPropagation(t)))},this.mainGrid._moveKeyEdit(this.autoComplete.uuid,"_inputKeyDown",{skipVertical:!0}),this.autoComplete.setSelectedIndex1=function(t){var i=this.selectedIndex,o=this.getValue();if(this.setSelectedIndex(t),i!=this.selectedIndex){
var s=e.mainGrid.getColumnIndex(e.options.id),a=e.editRowIndex,r={oldValue:o,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:s,colId:e.mainGrid.getColumnID(s)};u.B.fireEvent(e.mainGrid,"onviewchange",r)}this.closeSubLayer(),e.editTd&&e.handleEndEdit(),e.existGridViewItemsetNode&&e.options.directOpen&&e.mainGrid._setFocusedCell()},this.autoComplete._refreshItemset=this.autoComplete.refreshItemset,this.autoComplete.refreshItemset=function(t){"gridViewItemset"!==this.options.itemTableType&&(e.matchInfo=e.setMatchInfo()),this._refreshItemset(t)},this.autoComplete.options.handleOtherClick=!1}catch(t){s.w.printStackTrace(t,null,this)}},N.autoComplete.prototype.setEditMode=function(t,e){try{if(!0!==this._init?(this._createComponent(e),t.innerHTML=this.autoComplete.toHTML(),this.autoComplete.activate(),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this._init=!0,this.options.placeholder&&this.autoComplete.dom.input.setAttribute("placeholder",this.options.placeholder)):(t.innerHTML="",this.mainGrid.cellMergeInfo&&this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),t.appendChild(this.autoComplete.render)),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this.hasRef){var i=this.mainGrid.getElemRowIndex(t);this.autoComplete.itemArr=this.getRefItemArr(i)}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.autoComplete.itemArr.length>0||this.autoComplete.allItemArr.length>0){var o=this.mainGrid.dataList._getCellData(e,this.colID);if(this.autoComplete.setValue(o),!0===this.autoComplete.options.disableEdit||!0===this.autoCompleteImageClicked){if(this.autoCompleteImageClicked&&this.options.directOpen)if(this.autoComplete.viewArr=[],this.existGridViewItemsetNode);else for(var a=0;a<this.autoComplete.itemArr.length;a++)this.autoComplete.viewArr.push({label:this.autoComplete.itemArr[a].label,value:this.autoComplete.itemArr[a].value,orgLabel:this.autoComplete.itemArr[a].orgLabel,index:a,_hidden:this.autoComplete.itemArr[a]._hidden});this.autoComplete.openSubLayer(),this.autoCompleteImageClicked=!1}else this.autoComplete.setInputFocus()}else this.autoComplete.options.disableEdit||this.autoComplete.setInputFocus(),this.autoComplete.dom.input.value="";0==this.autoComplete.getItemCount()&&(this.autoComplete.selectedIndex=-1,this.autoComplete.dom.label.innerHTML="")}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype.setColumnDisableEdit=function(t){try{this.options.disableEdit=!0,this.autoComplete&&this.autoComplete.disableEdit(t)}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype._handleEndEdit_common=function(t){try{this.autoComplete.endEdit({noEvent:!0}),this.autoComplete.closeSubLayer();var e=this.autoComplete.getValue();try{this.editTd.removeChild(this.autoComplete.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i),this.options.directOpen&&(this.autoComplete.editmode=!1)}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.autoComplete.prototype._handleEndEdit_focus=function(t,e,i){!1===i&&this.mainGrid._setFocusedCell()},N.autoComplete.prototype._handleCancelEdit=function(t){this.autoComplete.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.mainGrid.getRealRowIndex(this.editRowIndex),this.colID);this.editTd.removeChild(this.autoComplete.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},N.autoComplete.prototype._getEditedValue=function(t){return this.autoComplete.getValue()},N.autoComplete.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.calendar=function(){},N.calendar.prototype.initializeCellInfo=function(t){try{
this.options.useIOFormatLength&&this.refreshDataArr()}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype.setInnerHTML=function(t,e,i,o,a){if(this.options.embeddedInput){var n=this.mainGrid.getInput(this,t,e);null==n.render.parentNode&&(t.innerHTML="",t.appendChild(n.render));var l=0,h=0,d=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",d=!0),this.mainGrid.embeddedCalendarStyleObj||(this.mainGrid.embeddedCalendarStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),l=t.getBoundingClientRect().height-parseFloat(WebSquare.style.getStyle(t,"border-top-width"))-parseFloat(WebSquare.style.getStyle(t,"border-bottom-width")),l-=this.mainGrid.embeddedCalendarStyleObj.top+this.mainGrid.embeddedCalendarStyleObj.bottom,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),h=this.mainGrid.embeddedWidthObj[o].width,h-=this.mainGrid.embeddedCalendarStyleObj.left+this.mainGrid.embeddedCalendarStyleObj.right,d?t.parentNode.style.display="none":r.D.isIE("6 7")&&(l-=2);var p=r.D.getDataPrefix("rowindex");n.setSize(h-2,l),n.render.setAttribute(p,i),"all"==this.options.applyFormat||this.options.displayFormat||(e=this.getDisplayData(e)),n._setValue(e,{skipValidate:!0}),this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,o)?n.setDisabled(!0):n.setDisabled(!1),t.removeAttribute("tabIndex")}else{var c=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(c=r.D.getBoolean(c))&&(e=WebSquare.xml._encode(e+"")),this.options.useMonthYearFormat&&(e=WebSquare.date.getIOFormatDate(e,this.options.ioFormat,this.options.calendarValueType));var g=this.getDisplayData(e),f=this.mainGrid._dataList.filteredRowIndexArr[i],m=this.mainGrid.getCellOption(f,o,"viewType"),y=r.D.getDataPrefix("rowIndex"),b=r.D.getDataPrefix("colIndex"),w=r.D.getDataPrefix("col_id");if("icon"==m&&"true"==this.options.viewTypeIconImage){t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+w+"='"+this.colID+"' "+y+"='"+i+"' "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+g+this.mainGrid.dataTagClose,"</td>","<td "+w+"='"+this.colID+"' "+y+"='"+i+"'  "+b+"='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_calendar_div_img' />","</td>","</table>"].join("");var v=this,C=t.getElementsByTagName("div")[0];u.B.addListener(C,"onclick",(function(t){v.mainGrid._getEditDisabled(i,o)||v.mainGrid.___getEditReadOnly(i,o)||(v.calendarImageClicked=!0)}))}else{var I=r.D.getDataPrefix("editModeEvent");t.innerHTML=this.mainGrid.dataTagOpen+g+this.mainGrid.dataTagClose,"icon"==m||""==m&&"own"==this.options.dataType?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_calendar"),t.setAttribute(I,this.options.editModeEventIcon)):this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar")}}var _;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var x=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof x&&(this.mainGrid.options.titleFormatter=x,_=x.call(this,i,o,e))}else _=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){s.w.printStackTrace(t,null,this)}var S=_||this.options.title||"";S&&t.setAttribute("title",S)},N.calendar.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;if("true"==this.options.viewTypeIconImage){var i=t.getElementsByTagName("div")[0];this.mainGrid.removeClass(i,this.mainGrid.options.bodyTdClass+"_calendar_div_img")
}else this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar");this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var o=this.mainGrid.getInput(this);this.comp=o;for(var a=t.firstChild;null!=a;a=a.nextSibling)if("NOBR"==a.nodeName.toUpperCase()||"SPAN"==a.nodeName.toUpperCase()&&a.className.indexOf("w2grid_span")>-1){WebSquare.style.setStyle(a,"visibility","hidden");break}if(1==o.options.renderDiv||"true"==o.options.renderDiv){var r=document.getElementById(this.mainGridId+this.id),n=t.offsetWidth-6,l=t.offsetHeight,h=document.getElementById(this.mainGridId+this.id+"_div_input"),d=n-18-5,u=l-3,p=document.getElementById(this.mainGridId+this.id+"_input"),c=d-(parseInt(WebSquare.style.getStyle(p,"border-right-width"),10)+parseInt(WebSquare.style.getStyle(p,"border-left-width"),10)+parseInt(WebSquare.style.getStyle(p,"padding-right"),10)+parseInt(WebSquare.style.getStyle(p,"padding-left"),10)),g=u-2,f=document.getElementById(this.mainGridId+this.id+"_img"),m=u/2-f.offsetHeight/2;if(1==this.options.useAnchor||"true"==this.options.useAnchor){var y=document.getElementById(this.mainGridId+this.id+"_a");WebSquare.style.setStyle(y,"top",m+"px")}else WebSquare.style.setStyle(f,"top",m+"px");WebSquare.style.setStyle(r,"width",Math.max(n,0)+"px"),WebSquare.style.setStyle(h,"width",Math.max(d,0)+"px"),WebSquare.style.setStyle(p,"width",Math.max(c,0)+"px"),WebSquare.style.setStyle(r,"height",Math.max(l-3,0)+"px"),WebSquare.style.setStyle(h,"height",Math.max(u,0)+"px"),WebSquare.style.setStyle(p,"height",Math.max(g,0)+"px")}var b=this.mainGrid.dataList._getCellData(e,this.colID);this.options.useMonthYearFormat&&(b=WebSquare.date.getIOFormatDate(b,this.options.ioFormat,this.options.calendarValueType)),o._setValue(b,{noFormat:!0,skipValidate:!0}),"icon"==this.options.viewType&&"true"==this.options.viewTypeIconImage&&1==this.calendarImageClicked?(this.calendarImageClicked=!1,o.toggle()):(o.focus(),"select"==o.options.editType&&o.select()),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0)}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};if(r.D.isIE(8)?t={top:1,left:0,width:0,height:0}:r.D.isFF()?t={top:0,left:-1,width:0,height:0}:r.D.isChrome()||r.D.isSafari()?t={top:1,left:0,width:0,height:0}:r.D.isOpera()&&(t={top:1,left:0,width:0,height:1}),!0===this.mainGrid._isNativeScroll()){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}else!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+t.top,a=i.offsetLeft+1+t.left,n=i.clientWidth-5+t.width,l=i.clientHeight-3+t.height,h=l-1;if(this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))a-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var u=this.mainGrid.getInput(this);u.show(),u.render.style.top=o+"px",u.render.style.left=a+"px",u.render.style.width=n+"px",u.render.style.height=l+"px",u.render.firstChild.style.height=l+"px",u.dom.input.style.height=h+"px",u.dom.input.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,r.D.isIE()&&(u.dom.input.style.lineHeight=l+"px"),!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(u.render.id,3)}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},N.calendar.prototype._handleEndEdit_common=function(t){try{
var e=this.mainGrid.getInput(this);e.hideCalendar();var i=e.getValue();i=e.validator.validateString(i),this.options.useIOFormatLength||(i=e.sub_validator.validateString(i)),this.options.useMonthYearFormat&&(i=WebSquare.date.getIOUnFormatDate(i,e.options.ioFormat,e.options.calendarValueType)),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};return o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype._handleEndEdit_focus=function(t,e){!0!==e&&t.hide()},N.calendar.prototype.validate=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue(),o=WebSquare.historyManager.get(e.options.pluginName,e.id);if(this.options.disableDateValidSet&&e.disableValidate(i))null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur();else{if(e.validate())return!0;if(""==i)return!0;if(this.options.dateValidSet&&(e._skipDateValidSet=!0),this.options.dateValidSet&&this.options.dateValidSetCustom)this.mainGrid.getInput(this).blur();else if(this.options.dateValidSet&&null!=o.value&&e._setValue(o.value,{skipValidate:!0}),this.mainGrid.getInput(this).blur(),"false"!==this.options.displaymessage){var a=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"Invalid date format.";e.options.invalidMessageFunc||alert(a)}}return this.mainGrid.getInput(this).focus(),!1}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},N.calendar.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.w.printStackTrace(t,null,this)}},N.calendar.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.calendar.prototype.refreshDataArr=function(){try{var t;t=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var e=this.mainGrid._dataList.cellIdList.length,i=this.mainGrid._dataList.bodyIdColIndexMap[this.id],o=this.mainGrid.getInput(this),a=0;a<t.length;a++){var r=t[a],n=this.mainGrid._dataList.dataArr[r*e+i],l=o.sub_validator.validateString(n);this.mainGrid._dataList.dataArr[r*e+i]=l}}catch(t){s.w.printStackTrace(t,null,this)}},N.expression=function(){},N.expression.prototype.initializeCellInfo=function(){var t=this.options.expression;if(this.mainGrid.useExpression=!0,this.expIdArr=[],""!=t){var e=t.match(/(sum|avg|max|min|display|rowindex|rowstatus|datalist)[\s]*[(][\S\s]*?[)]/gi);if(null!=e){t="";for(var i=0;i<e.length;i++)t+=e[i],i<e.length-1&&(t+="+")}t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"_this.getCalcExpressionTarget(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/rowStatus[\s]*[(]/gi,"_this.getExpressionTarget(")}try{new Function("_this",t)(this)}catch(t){s.w.printStackTrace(t,null,this)}},N.expression.prototype.getExpressionTarget=function(){for(var t=0;t<arguments.length;t++)null==this.expIdArr[arguments[t]]&&(this.expIdArr[arguments[t]]=arguments[t],this.mainGrid.setExpressionAssociation(arguments[t],this.colID));return 1},N.expression.prototype.getCalcExpressionTarget=function(t){
var e=t.wq_replaceAll("(",",").wq_replaceAll(")",",").wq_replaceAll("+",",").wq_replaceAll("-",",").wq_replaceAll("*",",").wq_replaceAll("/",",").wq_replaceAll("%",",").wq_replaceAll(" ","");e=e.split(",");for(var i=0;i<e.length;i++)""!==e[i]&&null==this.expIdArr[e[i]]&&(this.expIdArr[e[i]]=e[i],this.mainGrid.setExpressionAssociation(e[i],this.colID));return 1},N.expression.prototype.setInnerHTML=function(t,e,i,o,a){try{var n,l=this.mainGrid.dataList.getRealRowIndex(i),h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id),u=this.getDisplayData(null,l);"function"==typeof d?(this.useCustomFormatter=!0,n=d.call(this.mainGrid,e,u,h,o)):(this.useCustomFormatter=!1,n=u);var p=t.innerHTML.replace(/\r(\n)?/,"\n"),c=this.mainGrid.dataTagOpen+n+this.mainGrid.dataTagClose;p!==c&&(t.innerHTML=c.replace("NaN",this.options.NaNFormat),this.mainGrid.drawFooter(this.colID))}catch(t){s.w.printStackTrace(t,null,this)}},N.expression.prototype.getDisplayData=function(t,e,i){return t=this.getExpressionValue(e),this.formatter&&!0!==i?this.formatter.format(t):t},N.expression.prototype.getExpressionValue=function(t){if(this.rowIndex=t,!this.options.expressionFunc){var e=this.options.expression;""!=e&&(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[sS][uU][mM][\s]*[(]/g,"this.colsum(rowIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"this.colavg(rowIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.colmax(rowIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.colmin(rowIndex,")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"this.colcalc(rowIndex,")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"this.display(rowIndex,")).replace(/[dD][aA][tT][aA][lL][iI][sS][tT][\s]*[(]/g,"this.datalist(rowIndex,")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"this.getRowIndex(rowIndex")).replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(rowIndex"),e=r.D.scopingFuncBody(e,this.scope_id)),this.options.expressionFunc=Function("rowIndex",e),this.options.expressionFunc.changeCount=0}var i=this.mainGrid.changeCount,o="";return this.options.expressionFunc[t]&&i==this.options.expressionFunc[t].changeCount?o=this.options.expressionFunc[t].oldValue:(this.options.expressionFunc[t]||(this.options.expressionFunc[t]={}),this.options.expressionFunc[t].changeCount=i,o=this.options.expressionFunc.call(this,t),this.options.expressionFunc[t].oldValue=o),o},N.expression.prototype.colsum=function(){for(var t=arguments[0],e=0,i=1;i<arguments.length;i++){var o=this.mainGrid.getColumnIndex(arguments[i]),s=this.options.dataType;"gridView"==this.mainGrid.options.pluginName&&(s=this.mainGrid._dataList.getCellInfo(this.options.col_id).options.dataType),"bigDecimal"===s?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,o)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,o))||0}return e},N.expression.prototype.colavg=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);"bigDecimal"===i?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,s))||0}return"bigDecimal"===i?e=WebSquare.bigDecimal(e).divide(WebSquare.bigDecimal(arguments.length-1)).toString():e/=arguments.length-1,e},N.expression.prototype.colmax=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0;else{var a=parseFloat(this.mainGrid.dataList._getData(t,s))||0;a>e&&(e=a)}}return e},N.expression.prototype.colmin=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o])
;if("bigDecimal"===i)e="0"===WebSquare.bigDecimal(e).toString()?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)):WebSquare.bigDecimal(e),e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)),!0)||0;else{var a=parseFloat(this.mainGrid.dataList._getData(t,s))||0;(1==o||a<e)&&(e=a)}}return e},N.expression.prototype.colcalc=function(t,e){function i(t,e){t[t.length]=e}function o(t){var e=t[t.length-1];return delete t[t.length-1],t.length--,e}function a(t){return!r(t)&&"("!=t&&")"!=t}function r(t){return"+"==t||"-"==t||"*"==t||"/"==t||"^"==t||"%"==t}function n(t){return t[t.length-1]}function l(t){return 0==t.length}function h(t){return"^"==t?5:"*"==t||"/"==t||"%"==t?4:"+"==t||"-"==t?3:"("==t?2:")"==t?1:void 0}function d(t,e,i){var o;try{return"+"==i&&(o=t.plus(e)),"-"==i&&(o=t.minus(e)),"*"==i&&(o=t.times(e)),"/"==i&&(o=t.divide(e)),"^"==i&&(o=t.pow(e)),"%"==i&&(o=t.mod(e)),o}catch(t){s.w.printStackTrace(t)}}var u=function(t,e,s){e=new Array;var d=new Array,u=0;t=function(t){for(var e=t.split(""),i="",o=new Array,s=0,n=0;n<e.length;n++)a(e[n])&&null==e[n].match(/\s/)&&(i+=e[n]),(r(e[n])||")"==e[n]||"("==e[n])&&(""!=i&&(o[s]=i,s++),i="",o[s]=e[n],s++),n==e.length-1&&""!=i&&(o[s]=i);return o}(t);for(var p=0;p<t.length;p++){if(a(t[p])&&(e[u]=t[p],u++),r(t[p])){if("^"!=t[p])for(;!l(d)&&h(t[p])<=h(n(d));)e[u]=n(d),o(d),u++;else for(;!l(d)&&h(t[p])<h(n(d));)e[u]=n(d),o(d),u++;i(d,t[p])}if("("==t[p]&&i(d,t[p]),")"==t[p]){for(;"("!=n(d);)e[u]=o(d),u++;o(d)}}for(;!l(d);)"("==n(d)?o(d):e[e.length]=o(d);var c="";for(p=0;p<e.length;p++)c+=e[p];return 0==s?c:e}(e);for(var p in u){var c=this.mainGrid.getColumnIndex(u[p]);u[p]=null!=c?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,c)):u[p]}return function(t){for(var e,s,r=new Array,l=0;l<t.length;l++)if(a(t[l]))i(r,t[l]);else{(e=new Function("return "+n(r))()).constructor!=WebSquare.bigDecimalObj&&(e=WebSquare.bigDecimal(e)),o(r),(s=new Function("return "+n(r))()).constructor!=WebSquare.bigDecimalObj&&(s=WebSquare.bigDecimal(s));var h=d(s,e,t[l]);o(r),i(r,h)}return n(r)}(u)},N.expression.prototype.display=function(){var t=arguments[0],e=this.mainGrid.getColumnIndex(arguments[1]);return this.mainGrid.dataList._getData(t,e)},N.expression.prototype.datalist=function(t,e){return e=this.mainGrid._dataList.getColumnIndex(e),this.mainGrid._dataList._getCellData(t,e,!0)},N.expression.prototype.getRowIndex=function(){var t=arguments[0];return this.mainGrid.getDisplayRowIndex(t)},N.expression.prototype.rowStatus=function(){var t=arguments[0];switch(this.mainGrid.dataList.getRowStatusValue(t)){case 0:return"R";case 1:return"U";case 2:return"C";case 3:return"D";case 4:return"V"}},N.textarea=function(){},N.textarea.prototype.initializeCellInfo=function(t){try{if(t){var e=t.getAttribute("showReadOnly");if(e)this.options.showReadOnly=r.D.getBoolean(e);else{var i=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/showReadOnly/@value')||"true";this.options.showReadOnly=r.D.getBoolean(i)}}}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype.setInnerHTML=function(t,e,i,o,a){try{if(this.options.embeddedInput){var n=this.mainGrid.getInput(this,t);n.show(),t.innerHTML="",t.appendChild(n.render);var l=r.D.getDataPrefix("rowindex");n.render.setAttribute(l,i),n.render.style.top="0",n.render.style.left="0",n.render.style.width="100%",n.render.style.height="100%",n.render.style.imeMode=this.options.imeMode,this.options.placeholder&&(n.render.placeholder=this.options.placeholder),n.setValue(this.mainGrid.dataList._getCellData(i,this.id)),this.mainGrid._getEditDisabled(i,o)?n.setDisabled(!0):n.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?n.setReadOnly(!0):n.setReadOnly(!1)}else{var h;!0!==this.mainGrid._isBrowserScroll()?(h=t.clientWidth-8)<0&&(h=this.mainGrid.getColumnWidth(o,!0)-8):h=this.mainGrid.getColumnWidth(o,!0)
;var d=h>=0?" width:"+h+"px; ":" ",u=this.getDisplayData(e),p=this.mainGrid._getGroupbyDisplayRowIndex(i),c=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id),g=u,f=this.options.textAlign?"text-align:"+this.options.textAlign+";":"",m="pre-wrap";r.D.isIEAllVersion("6 7")&&(m="normal");var y="all"===this.options.displayType?"word-break:break-all;white-space:"+m+";":"";"function"==typeof c?(this.useCustomFormatter=!0,g=c.call(this.mainGrid,e,u,p,o)):this.useCustomFormatter=!1,t.innerHTML="<div class='w2grid_textarea' style='"+f+d+y+"' >"+(this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(g+"")):this.getDisplayData(g))+"</div>"}var b;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var w=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof w&&(this.mainGrid.options.titleFormatter=w,b=w.call(this,i,o,e))}else b=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",b)}catch(t){s.w.printStackTrace(t,null,this)}if("all"===this.options.displayType&&"all"===this.mainGrid.options.visibleRowNum&&!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.getRowCount()>0){var v=this.mainGrid.getElementById(this.mainGrid.id+"_body_table"),C=this.mainGrid.getElementById(this.mainGrid.id+"_foot_table"),I=v.offsetHeight;C&&(I+=C.offsetHeight),this.mainGrid.render.offsetHeight!=I&&this.mainGrid.setSize(null,I)}}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this._setEditMode(t,e)}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype._setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.options.disabled||i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),this.options.disabled||"select"!=this.options.editType&&"select"!=this.mainGrid.options.editType||i.select()}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};r.D.isIE(8)?t={top:-1,left:-1,width:0,height:0}:r.D.isFF()?t={top:-2,left:0,width:0,height:0}:r.D.isOpera()?t={top:0,left:0,width:0,height:1}:r.D.isChrome()&&(t={top:0,left:0,width:0,height:0});var e=this.editTd;if(!0===this.mainGrid._isNativeScroll()){var i=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=i.scrollTop,t.left-=i.scrollLeft}else!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var o=e.offsetTop+1+t.top,a=e.offsetLeft+1+t.left,n=e.clientWidth>150?e.clientWidth-5+t.width:150,l=e.clientHeight>60?e.clientHeight-2+t.height:60;if(this.mainGrid.options.groupbyZone){var h=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(h=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=h}if(this.mainGrid.gridWidth<a+n){var d=(e.clientWidth>150?0:5+t.width)-2;a-=a+n-(e.offsetLeft+e.clientWidth)+d}var u=this.mainGrid.scrollX_right;if(!0!==this.mainGrid._isBrowserScroll()&&this.mainGrid.render.offsetHeight-u.offsetHeight<o+l){var p=e.clientHeight>60?0:2-t.top;(o-=o+l-(e.offsetTop+e.clientHeight)+p)<0&&(o=1+t.top),l>this.mainGrid.render.offsetHeight&&(l=this.mainGrid.render.offsetHeight-6+t.height)}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))a-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var c=this.mainGrid.getInput(this);this.comp=c,c.show(),c.render.style.top=o+"px",c.render.style.left=a+"px",c.render.style.width=n+"px",c.render.style.height=l+"px",
c.render.style.imeMode=this.options.imeMode,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(c.render.id,3)}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},N.textarea.prototype.showReadonly=function(t,e){this.mainGrid._endEdit();var i=this.mainGrid.getInput(this),o=r.D.getDataPrefix("col_id"),s=t.getAttribute(o);(this.options.disabled||this.mainGrid._getEditDisabled(e,s))&&i.setDisabled(!0),(this.options.readOnly||this.mainGrid.___getEditReadOnly(e,s))&&i.setReadOnly(!0),this._setEditMode(t,e),this.mainGrid.editedCell=this},N.textarea.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();"number"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")&&""!=i&&(i=Number(i));var o=this.editTd.offsetHeight;this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var a=this.editTd.offsetHeight;this.changedCellHeight=a-o;var r={};return r[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,r),e}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype._handleEndEdit_focus=function(t){t.hide(),t.setDisabled(!1),t.setReadOnly(!1)},N.textarea.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},N.textarea.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getInput(this);i.hide(),i.setDisabled(!1),i.setReadOnly(!1)}catch(t){s.w.printStackTrace(t,null,this)}},N.textarea.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.drilldown=function(){},N.drilldown.prototype.setInnerHTML=function(t,e,i){var o=i,s=100,a=this.options.depthColumn;if("linkedDataList"===this.mode){if(null!=this.mainGrid._linkedDataList.filteredRowIndexArr&&this.mainGrid._linkedDataList.filteredRowIndexArr.length>0){o=this.mainGrid._linkedDataList.filteredRowIndexArr[i];var n=this.mainGrid._linkedDataList.filteredRowIndexArr.length-1;s=o<this.mainGrid._linkedDataList.filteredRowIndexArr[n]?parseInt(this.mainGrid.dataList._getCellData(i+1,a),10):null}}else null!=this.mainGrid._dataList.filteredRowIndexArr&&this.mainGrid._dataList.filteredRowIndexArr.length>0&&(s=(o=this.mainGrid.dataList.getRealRowIndex(i))<this.mainGrid.dataList.getRealRowIndex(this.mainGrid.getDataLength()-1)?parseInt(this.mainGrid.dataList._getCellData(i+1,a),10):null);for(var l=parseInt(this.mainGrid.dataList._getCellData(i,a),10),h="",d=o,u=1;u<l;u++)"div"==this.options.depthType?h+="<div class='w2grid_depthBlank'></div>":"line"==this.options.depthType?(h="<div class='w2grid_depth"+(1===u?this.mainGrid.drilldown.isLastChild(d)?"_line_L":"_line_T":this.mainGrid.drilldown.isLastChild(d)?"Blank":"_line_I")+"'></div>"+h,d=this.mainGrid.drilldown.getParentRowIndex(d)):"none"==this.options.depthType?h+="":h+="&nbsp;&nbsp;";var p=0,c="w2grid_plus";null!=s&&l<s?(p=1,c="w2grid_minus"):this.mainGrid.hasChild(i)||(p=2,c="w2grid_leaf"),1==l&&(c+=" w2grid_root");var g="",f=r.D.getDataPrefix("openStatus");g=r.D.isMobile()?"<span class='"+c+"' style='display:inline-block;' "+f+"='"+p+"' ontouchstart='this.clicked=true'></span>":"<span class='"+c+"' style='display:inline-block;' "+f+"='"+p+"' onclick='this.clicked=true'></span>";var m="<div class='w2grid_depthBlank";"1"==l&&(m+=" w2grid_depthBlank_root"),2===p&&(m+=" w2grid_depthBlank_leaf"),m+="'>";var y=this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(e+"")):this.getDisplayData(e),b="";"span"==this.mainGrid.options.dataTag&&(b=" w2grid_span"),"div"==this.options.depthType?(g=m+g+"</div>",t.innerHTML="<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+h+g+y+this.mainGrid.dataTagClose):"line"==this.options.depthType?(g=m+g+"</div>",
t.innerHTML=h+g+"<"+this.mainGrid.options.dataTag+" class='w2grid_drilldown_nobr"+b+"'>"+y+this.mainGrid.dataTagClose):(this.options.depthType,t.innerHTML=this.mainGrid.dataTagOpen+h+g+y+this.mainGrid.dataTagClose)},N.drilldown.prototype.handleClick=function(t,e){for(var i,o=t.getElementsByTagName("span"),s=0;s<o.length;s++)if(-1==o[s].className.indexOf("w2grid_span")){i=o[s];break}if(1==i.clicked){i.clicked=!1;var a=r.D.getDataPrefix("openStatus");return"2"!=i.getAttribute(a)&&this.mainGrid._toggle(e,!0),!0}return!1},N.drilldown.prototype.setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.setPosition();var i=this.mainGrid.getInput(this);i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),document.activeElement!=i.render&&i.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType&&i.select()}catch(t){s.w.printStackTrace(t,null,this)}},N.drilldown.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(r.D.isFF()?t={top:-1,left:-1,width:0,height:0}:r.D.isOpera()?t={top:0,left:0,width:0,height:1}:r.D.isIE(9)&&(t={top:-1,left:-1,width:0,height:0}),!0===this.mainGrid._isNativeScroll()){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}else!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,a=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=a+"px",l.render.style.height=n+"px",r.D.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(l.render.id,3)},N.drilldown.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},N.drilldown.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);return this.setEditData(e),e}catch(t){s.w.printStackTrace(t,null,this)}},N.drilldown.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t.hide()},N.drilldown.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},N.drilldown.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){s.w.printStackTrace(t,null,this)}},N.drilldown.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.drilldown.prototype.setEditData=function(t){try{var e=t.getValue();e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==i&&""!=e&&(e=Number(e));var o={};o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,o)}catch(t){s.w.printStackTrace(t,null,this)}},N.textImage=function(){},N.textImage.prototype.setInnerHTML=function(t,e,i,o,a){
var n=this.mainGrid.getElemRowIndex(t),l=this.mainGrid.dataList.getRealRowIndex(n),h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=this.mainGrid.getColumnIndex(this.colID),p=this.mainGrid.getCellOption(l,d,"viewType"),c=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"",g=this.mainGrid.getColumnID(o),f=!1,m=!1;this.mainGrid._getEditDisabled(i,g)?(f=!0,this.options.imageSrcDisabled&&(c=this.mainGrid.getImageURL(this.options.imageSrcDisabled))):this.mainGrid.___getEditReadOnly(i,g)&&(m=!0,this.options.imageSrcReadOnly&&(c=this.mainGrid.getImageURL(this.options.imageSrcReadOnly)));var y=e,b=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id),w=r.D.getGlobalFunction(this.options.customModelUnformatter,this.scope_id);"function"==typeof w&&(y=w.call(this.mainGrid,e,h,o));var v=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(v=r.D.getBoolean(v))&&(y=WebSquare.xml._encode(y+""));var C,I,_=this.getDisplayData(y);if("function"==typeof b?(this.useCustomFormatter=!0,C=b.call(this.mainGrid,e,_,h,o)):(this.useCustomFormatter=!1,C=_),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var x=r.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof x&&(this.mainGrid.options.titleFormatter=x,I=x.call(this,i,o,e))}else I=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",I)}catch(t){s.w.printStackTrace(t,null,this)}if("icon"==p||""==p&&"own"==this.options.dataType){var S="";try{this.options.onerror&&(S=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.w.printStackTrace(t,null,this)}var D="w2grid_textImage_image";f?D+=" w2grid_textImage_disabled":m&&(D+=" w2grid_textImage_readonly");var R=r.D.getDataPrefix("tdIndex"),L=r.D.getDataPrefix("col_id"),T=r.D.getDataPrefix("rowIndex"),k=r.D.getDataPrefix("colIndex"),F=t.getAttribute(R);t.removeAttribute("alt");var A="";""!=this.options.alt&&(A=" alt='"+this.options.alt+"' "),t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td "+L+"='"+this.colID+"' "+T+"='"+i+"' "+k+"='"+o+"' tdIndex='"+F+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>",this.mainGrid.dataTagOpen+C+this.mainGrid.dataTagClose,"</td>","<td "+L+"='"+this.colID+"' "+T+"='"+i+"'  "+k+"='"+o+"' class='"+D+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+c+"' "+S+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+A+" />","</td>","</table>"].join("");var E=this,M=t.getElementsByTagName("img")[0];u.B.addListener(M,"onclick",(function(t){u.B.stopPropagation(t);var s=E.mainGrid._getEditDisabled(i,o);if(E.options.useImageClick||0==s){if(E.mainGrid.editedCell){var a=E.mainGrid._getGroupbyDisplayRowIndex(E.mainGrid.editedCell.editRowIndex),n=E.mainGrid.editedCell.colID,d=E.mainGrid._dataList.getCellData(a,n);E.mainGrid.editedCell.handleEndEdit();var p=E.mainGrid._dataList.getCellData(a,n),c=E.mainGrid.getColumnIndex(n);p!=d&&u.B.fireEvent(E.mainGrid,"onviewchange",{oldValue:d,newValue:p,rowIndex:a,colIndex:c,colId:E.mainGrid.getColumnID(c)})}var g=E.getDisplayData(e),f=r.D.getGlobalFunction(E.options.imageClickFunction,E.scope_id);u.B.fireEvent(E.mainGrid,"ontextimageclick",i,o),E.mainGrid._setFocusedCell(i,o),"function"==typeof f&&(E.options.displayRowIndex?f.call(E.mainGrid,h,E.colID,g):f.call(E.mainGrid,l,E.colID,g))}}))}else t.innerHTML=this.mainGrid.dataTagOpen+C+this.mainGrid.dataTagClose},N.textImage.prototype.setEditMode=function(t,e){try{var i="";try{this.options.onerror&&(i=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){s.w.printStackTrace(t,null,this)}
var o=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"";t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px;'><td></td><td>","<img src='"+o+"' "+i+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","' />","</td></table>"].join("");var a=t.getElementsByTagName("td")[1].firstChild,n=this.mainGrid.getElemRowIndex(t),l=this.mainGrid.getColumnIndex(this.colID),h=this.mainGrid._dataList.filteredRowIndexArr[n],d=this;u.B.addListener(a,"onclick",(function(t){if(u.B.stopPropagation(t),d.mainGrid.editedCell){var i=d.mainGrid._getGroupbyDisplayRowIndex(d.mainGrid.editedCell.editRowIndex),o=d.mainGrid.editedCell.colID,s=d.mainGrid._dataList.getCellData(i,o);d.mainGrid.editedCell.handleEndEdit();var a=d.mainGrid._dataList.getCellData(i,o),n=d.mainGrid.getColumnIndex(o);a!=s&&u.B.fireEvent(d.mainGrid,"onviewchange",{oldValue:s,newValue:a,rowIndex:i,colIndex:n,colId:d.mainGrid.getColumnID(n)})}var p=d.mainGrid.getInput(d).getValue(),c=r.D.getGlobalFunction(d.options.imageClickFunction,d.scope_id);u.B.fireEvent(d.mainGrid,"ontextimageclick",e,l),"function"==typeof c&&(d.options.displayRowIndex?c.call(d.mainGrid,e,d.colID,p):c.call(d.mainGrid,h,d.colID,p))})),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var p=this.mainGrid.getInput(this);this.comp=p,p.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,p.options.applyFormat=this.options.applyFormat,p.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),p.focus(),!0!==this.mainGrid._isBrowserScroll()&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==p.options.editType?p.select():"focus"==p.options.editType&&(r.D.isIE()||r.D.isFF())&&WebSquare.text.setCaretPos(p.render,p.render.value.length)}catch(t){s.w.printStackTrace(t,null,this)}},N.textImage.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0,tdWidth:0};if(r.D.isFF()?t={top:-1,left:-1,width:0,height:0,tdWidth:0}:r.D.isOpera()&&(t={top:0,left:0,width:0,height:1,tdWidth:0}),!0===this.mainGrid._isNativeScroll()){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}else!0===this.mainGrid._isHybridScroll()&&(t.top-=this.mainGrid._getHybridVisibleTop());var i=this.editTd,o=i.getElementsByTagName("td"),a=o[1].firstChild,n=i.clientWidth-a.offsetWidth-1+t.tdWidth,l=i.offsetTop+1+t.top,h=i.offsetLeft+1+t.left,d=i.clientWidth-a.offsetWidth-6+t.width,u=i.clientHeight-2+t.height;if(this.mainGrid.options.groupbyZone){var p=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(p=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),l+=p}o[0].style.width=n+"px";var c=this.mainGrid.getInput(this);if(""!=this.options.imeMode)c.render.style.imeMode=this.options.imeMode;else{var g=this.mainGrid.getColumnOption(this.options.col_id,"dataType");c.render.style.imeMode="number"==g?"disabled":""}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))l-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,c.render.style.lineHeight=u+"px";c.show(),c.render.style.top=l+"px",c.render.style.left=h+"px",c.render.style.width=d+"px",c.render.style.height=u+"px",c.render.style.lineHeight=u+"px",c.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,!0===this.mainGrid._isHybridScroll()&&this.mainGrid._adjustHybridEditedPosition(c.render.id,3)}catch(t){s.w.printStackTrace(t,null,this)}},N.textImage.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},N.textImage.prototype._handleEndEdit_common=function(t){try{
var e=this.mainGrid.getInput(this),i=e.getValue();i=e.validator.validateString(i),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};o[this.mainGrid.id]=!0;var a=r.D.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof a){this.useCustomModelFormatter=!0;var n=this.getDisplayData(i);i=a.call(this.mainGrid,i,n,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;return this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){s.w.printStackTrace(t,null,this)}},N.textImage.prototype._handleEndEdit_focus=function(t){t.setDisabled(!1),t.setReadOnly(!1),t.hide()},N.textImage.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},N.textImage.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.getInput(this),i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),e.hide()}catch(t){s.w.printStackTrace(t,null,this)}},N.textImage.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.textImage.prototype.showReadonly=function(t,e){this.setEditMode(t,e);var i=this.mainGrid.getInput(this);i.setDisabled(!0),i.setReadOnly(!0),this.mainGrid.editedCell=this},N.prototype.setDataListCellRefresh=function(t){try{if(t){this.initFormatter(t);var e=this.options.dataType;e||(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"!=e||this.options.displayFormat||(this.options.displayFormat=a.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/dataType/date/@displayFormat")),"time"!=e||this.options.displayFormat||(this.options.displayFormat="HH:mm");var i=!this.options.groupName||!this.options.groupValue,o=this.options.inputType;if(i&&("button"!=o&&"image"!=o)){var r=this.mainGrid._dataList.getCellInfo(this.colID),n=!(!r||!r.element&&r.id!==this.id);this.options.readOnly=!n||t.getAttribute("readOnly")}}}catch(t){s.w.printStackTrace(t,null,this)}},N.spinner=function(){},N.spinner.prototype.initializeCellInfo=function(t){try{if(!this.xml)if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var e="",i=(e=r.D.isIE("6 7")&&this.internal?WebSquare.xml.nodeWellFormed(t.outerHTML):WebSquare.xml.serialize(t)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"";e=(e=e.wq_replaceAll("<w2:column","<w2:spinner"+i)).wq_replaceAll("</w2:column","</w2:spinner");var o=WebSquare.xml.parse(e,!0);this.xml=o.documentElement}}catch(t){s.w.printStackTrace(t,null,this)}},N.spinner.prototype.setInnerHTML=function(t,e,i,o,s){null==e&&(e=""),this.spinner&&this.spinner.render&&t.firstChild==this.spinner.render&&t.removeChild(this.spinner.render),t.innerHTML=this.mainGrid.dataTagOpen+this.getDisplayData(e,i)+this.mainGrid.dataTagClose;var a=this.mainGrid.dataList.getRealRowIndex(i),n=this.mainGrid.getCellOption(a,o,"viewType"),l=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),h=r.D.getDataPrefix("editModeEvent");("icon"==n||""==n&&"own"==l)&&(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_spinner"),t.setAttribute(h,this.options.editModeEventIcon))},N.spinner.prototype.setEditMode=function(t,e){try{if(""==this.style){var i=r.D.getDataPrefix("tdindex");this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_spinner_"+this.id),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.dataType&&(this.configOptions.dataType=this.options.dataType),this.options.buttonSize&&(this.configOptions.buttonSize=this.options.buttonSize),this.options.dateIncrementType&&(this.configOptions.dateIncrementType=this.options.dateIncrementType),this.options.displayFormat&&(this.configOptions.displayFormat=this.options.displayFormat),
this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.increment&&(this.configOptions.increment=this.options.increment),this.options.min&&(this.configOptions.min=this.options.min),this.options.max&&(this.configOptions.max=this.options.max),this.options.editType&&(this.configOptions.editType=this.options.editType);var o=t.getAttribute(i);this.mainGrid._getEditDisabled(e,o)?this.configOptions.disabled=!0:this.configOptions.disabled=!1,this.configOptions.xmlEvents=[{name:"ondblclick",action:"script",param:{handler:function(t){u.B.stopPropagation(t)}}}],this.spinner=new WebSquare.uiplugin.spinner(this.mainGridId+"_spinner_"+this.id,this.configOptions,this.xml),this.spinner.isGridCellComponent=!0;var a=this;this.spinner._handleClickEvent=this.spinner.handleClickEvent,this.spinner.handleClickEvent=function(t){var e=a.mainGrid.getElemRowIndex(this.render.parentElement),o=a.mainGrid._getGroupbyDisplayRowIndex(e),s=this.render.parentElement.getAttribute(i);if(this.options.customFormatter){try{var n=null,l={};if("function"==typeof(n=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id)))for(var h in l=n(o,s))this.options.hasOwnProperty(h)&&(this.options[h]=l[h])}catch(t){n=null}this._handleClickEvent(t)}else this._handleClickEvent(t);u.B.stopEvent(t)},this.spinner._inputKeyDown=this.spinner.inputKeyDown,this.spinner.inputKeyDown=function(t,e){27==t.keyCode||a.spinner._inputKeyDown(t,e)},t.innerHTML=this.spinner.toHTML(),this.spinner.activate(),this.spinner.setSize(t.clientWidth-2,t.clientHeight-2)}else t.innerHTML="",t.appendChild(this.spinner.render),this.spinner.show();this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),this.editColIndex=this.mainGrid.getColumnIndex(this.id),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.spinner.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),"select"!=this.options.editType&&"focus"!=this.options.editType||this.spinner.focus()}catch(t){s.w.printStackTrace(t,null,this.mainGrid)}},N.spinner.prototype._handleEndEdit_common=function(t){try{var e=this.spinner.getValue();if("number"==this.spinner.options.dataType){Number(e);this.options.customFormatter?(this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)):!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)}else this.spinner.options.dataType;this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.colID),this.spinner.hide()}catch(t){s.w.printStackTrace(t,null,this)}},N.spinner.prototype._handleCancelEdit=function(t){},N.spinner.prototype._handleEndEdit_focus=function(){try{return null}catch(t){s.w.printStackTrace(t,null,this)}},N.spinner.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},N.custom=function(){},N.custom.prototype.initializeCellInfo=function(t,e){try{this.parseTypeGetter(),this.isValidTypeGetter?(this.cellManagerHashByID={},this.cellManagerHashByRowIndex={},this.cellManagerIDByRowIndex={}):(this.cellManagerHashByRowIndex=[],this.cellManagerIDByRowIndex=[],this.cellManagerInfoByRowIndex=[])}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.initializeCellManager=function(t,e){try{var i=e.inputType?e.inputType:e.tagName;if(t.id=e.id,t.colID=this.id,t._position={colIndex:this.mainGrid.getColumnIndex(this.colID),colID:this.id,realRowIndex:e.realRowIndex,displayRowIndex:e.displayRowIndex},t.parentColumnInfo=this,t.options.inputType=i,t.initializeInputType=this.getTagName(i),
t.initializeInfo=e,"gridViewItemset"===e.itemTableType&&!e.itemSet)for(var o in t.initializeInfo.itemSet={nodeset:e.nodeset,label:e.label,value:e.value},t.options.itemSet=t.initializeInfo.itemSet,t.options.item=e.item,t.options.gridViewOptions={},t.options.itemTableType="gridViewItemset",e)t.options.gridViewOptions[o]=e[o];for(var o in e.options)t.options[o]=e.options[o];t.initFormatter()}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.getMapping=function(t,e){try{switch(t){case"text":default:return o.x.extend(e,WebSquare.uiplugin.cellInfo.text.prototype),!0;case"link":return o.x.extend(e,WebSquare.uiplugin.cellInfo.link.prototype),!0;case"checkbox":return o.x.extend(e,WebSquare.uiplugin.cellInfo.checkbox.prototype),!0;case"button":return o.x.extend(e,WebSquare.uiplugin.cellInfo.button.prototype),!0;case"image":return o.x.extend(e,WebSquare.uiplugin.cellInfo.image.prototype),!0;case"radio":return o.x.extend(e,WebSquare.uiplugin.cellInfo.radio.prototype),!0;case"select":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.select.prototype),!0;case"calendar":return o.x.extend(e,WebSquare.uiplugin.cellInfo.calendar.prototype),!0;case"textarea":return o.x.extend(e,WebSquare.uiplugin.cellInfo.textarea.prototype),!0;case"expression":return o.x.extend(e,WebSquare.uiplugin.cellInfo.expression.prototype),!0;case"textImage":return o.x.extend(e,WebSquare.uiplugin.cellInfo.textImage.prototype),!0;case"checkcombobox":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.checkcombobox.prototype),!0;case"autoComplete":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.autoComplete.prototype),!0;case"spinner":return o.x.extend(e,WebSquare.uiplugin.cellInfo.spinner.prototype),!0}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.getTagName=function(t){try{switch(t){case"text":return"input";case"link":return"anchor";case"button":return"trigger";case"select":return"selectbox";default:return t}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.parseTypeGetter=function(){try{this.options.typeGetter?(this.typeGetter=r.D.getGlobalFunction(this.options.typeGetter,this.scope_id),this.isValidTypeGetter=!0):(this.isValidTypeGetter=!1,0==this.options.setCellInputTypeCustom&&$l("An error occurred while creating a custom type grid. property typeGetter is undefined.  gridView ["+this.mainGrid.id+"] column:["+this.id+"]"))}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.updateCellManagerHash=function(t,e,i,o,a){try{this.isValidTypeGetter?(this.cellManagerHashByID[t]=i,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t):(this.cellManagerInfoByRowIndex[e]=a,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t),o&&i.itemsetObj&&o.nodeset!==i.itemsetObj.nodeset&&i.setColumnNodeSet(o.nodeset,o.label,o.value)}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.createCellManager=function(t,e){try{var i=e.id,a=e.realRowIndex,r=o.x.extend({},this);if(r.internal=!0,r.options=o.x.extend({},this.options),r.options["data-col_id"]&&(r.options.col_id=r.options["data-col_id"]),r.initializeCellInfo=function(){},this.mainGrid.options.senseReader&&"false"!==r.options.embeddedInput&&("secret"!=e.inputType&&"text"!=e.inputType&&"select"!=e.inputType&&"checkbox"!=e.inputType&&"radio"!=e.inputType&&"calendar"!=e.inputType||(r.options.embeddedInput=!0,e.options&&(e.options.embeddedInput=!0))),"radio"==e.inputType&&e.options.groupName&&e.options.groupValue&&(this.mainGrid.radioGroupRepChk[e.options.groupName]=!0,this.options.readOnly&&!e.options.readOnly&&e.td&&(this.options.readOnly=!1,this.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.options.readOnlyClass),this.mainGrid.options.readOnlyClass&&this.mainGrid.removeClass(e.td,this.mainGrid.options.readOnlyClass))),
this.getMapping(e.inputType,r)){if(this.initializeCellManager(r,e),r.initializeCellInfo(t,e.options),r.isLocked=!0,this.updateCellManagerHash(i,a,r,null,e),!0===r.options.embeddedInput){var n=e.itemSet;n&&"function"==typeof r.setColumnNodeSet&&r.setColumnNodeSet(n.nodeset,n.label,n.value,e.displayRowIndex)}return this.cellManagerHashByRowIndex[a]}var l=this.options.id,h=this.mainGrid.getColumnIndex(l);return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] inputType:["+e.inputType+"] realRowIndex:["+a+"] colIndex["+h+"]"),!1}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.getCellManager=function(t){try{var e=t.managerID,i=t.element,o=t.rowIndex,a=t.realRowIndex,r=this.options.id,n=this.mainGrid.getColumnIndex(r),l=this.mainGrid.dataList.getCellData(o,n),h={colID:r,colIndex:n,rowIndex:o,displayRowIndex:t.rowIndex,realRowIndex:t.realRowIndex,value:l};try{var d,u;if(1!=this.mainGrid.options.setCellInputTypeCustom||this.isValidTypeGetter){if(this.cellManagerHashByID&&this.cellManagerHashByID[e])return this.cellManagerHashByID[e];if(this.isValidTypeGetter){var p=!1;(u=this.typeGetter(h))&&u.options&&null!=u.options.readOnly&&this.mainGrid.setCellReadOnly(a,this.id,u.options.readOnly),u&&u.options&&null!=u.options.disabled&&this.mainGrid.setCellDisabled(a,this.id,u.options.disabled);g=this.cellManagerIDByRowIndex[a];var c=this.cellManagerHashByRowIndex[a];if(c&&c.options.embeddedInput&&t.td&&(t.td.firstChild?t.td.firstChild&&t.td.firstChild.id!==this.mainGrid.id+"_"+g&&(p=!0):p=!0),(!u||g!==u.id||p)&&g){f=this.mainGridId+"_"+g;this.mainGrid._removeDom(f),delete this.cellManagerHashByID[g],delete this.cellManagerHashByRowIndex[a],delete this.cellManagerIDByRowIndex[a]}}else this.parseTypeGetter(),this.isValidTypeGetter&&(u=this.typeGetter(h))}else if(1==t.dynamicInputType){if((u=t.options).id="dynamic_"+u.inputType+"_"+o+"_"+n,u.td=t.td,u.dynamicInputType=!0,this.cellManagerHashByRowIndex[a]){var g=this.cellManagerIDByRowIndex[a],f=this.mainGridId+g;this.mainGrid._removeDom(f),delete this.cellManagerIDByRowIndex[a],delete this.cellManagerHashByRowIndex[a]}}else if(this.cellManagerHashByRowIndex[a]&&!t.dynamicInputType)return this.cellManagerHashByRowIndex[a];return u?(u.isUDC||((d=1==this.mainGrid.options.setCellInputTypeCustom?this.cellManagerHashByRowIndex[a]:this.cellManagerHashByID[u.id])?(this.updateCellManagerHash(u.id,a,d,u.itemSet),d.isLocked):(u.realRowIndex=a,u.rowIndex=o,u.displayRowIndex=o,d=this.createCellManager(i,u))),1!=this.mainGrid.options.setCellInputTypeCustom&&(d.customValue=u.value)):d=this.createCellManager(i,{id:this.colID+"_"+a+"__default",inputType:"text",td:t.td,realRowIndex:a}),d}catch(t){return $l("An error occurred while creating a custom type grid. gridView ["+this.mainGrid.id+"] column:["+this.id+"] realRowIndex:["+a+"] colIndex["+n+"]"),!1}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.setInnerHTML=function(t,e,i,o,a){try{var r=this.mainGrid.getRealRowIndex(i);if(this.mainGrid.options.setCellInputTypeCustom&&!this.isValidTypeGetter&&this.mainGrid.options.senseReader){this.cellManagerInfoByRowIndex[r];if(this.cellManagerIDByRowIndex&&!this.cellManagerIDByRowIndex[r]&&this.cellManagerInfoByRowIndex[r])return void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[r]);var n=this.cellManagerHashByRowIndex[r];if(n&&n.options.embeddedInput){var l=this.cellManagerIDByRowIndex[r],h=this.mainGrid.id+"_"+l;if(!t.firstChild||t.firstChild&&t.firstChild.id!=h)return this.mainGrid._removeDom(h),this.cellManagerHashByRowIndex[r]=null,this.cellManagerIDByRowIndex[r]=null,void this.mainGrid._setCellInputType(i,o,null,this.cellManagerInfoByRowIndex[r])}}var d=this.getCellManager({element:this.element,rowIndex:i,realRowIndex:r,td:t});if(!1===d)t.innerHTML=this.mainGrid.dataTagOpen+e+this.mainGrid.dataTagClose;else{this.clearStyle(d,t);var u="class"
;!0===this.isValidTypeGetter&&d.options[u]&&this.mainGrid.addClass(t,d.options[u]),d.setInnerHTML(t,e,i,o),null!=d.customValue&&(e=d.customValue,this.mainGrid.dataList.__setCellData(i,this.colID,e)),this.useCustomFormatter=d.useCustomFormatter,this.useCustomModelFormatter=d.useCustomModelFormatter,this.useEscapeFormatter=d.useEscapeFormatter}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.setEditMode=function(t,e){try{if(!this.internal){var i=this.mainGrid.getRealRowIndex(e),o=this.cellManagerHashByRowIndex[i];o&&o.setEditMode(t,e)}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.setPosition=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];e&&e.setPosition()}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype._handleEndEdit_common=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];if(i)return i._handleEndEdit_common(t)}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype._handleEndEdit_focus=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];i&&i._handleEndEdit_focus(t)}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype._handleCancelEdit=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i._handleCancelEdit()}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.doDefaultAction=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i.doDefaultAction()}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.clearStyle=function(t,e){try{var i=r.D.getDataPrefix("editModeEvent");"calendar"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_calendar")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_calendar"),e.setAttribute(i,"")),"select"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_select")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_select"),e.setAttribute(i,"")),"autoComplete"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete"),e.setAttribute(i,"")),"checkcombobox"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox"),e.setAttribute(i,""))}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.validate=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];return!e||("calendar"!==e.options.inputType||e.validate())}}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype._getEditedValue=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];if(e&&e._getEditedValue)return e._getEditedValue()}return""}catch(t){s.w.printStackTrace(t,null,this)}},N.custom.prototype.refreshCellManagerHash=function(){try{for(var t=this.mainGrid.getRowCount(),e=0;e<t;e++)this.getCellManager({element:this.element,rowIndex:e,realRowIndex:this.mainGrid.getRealRowIndex(e)})}catch(t){s.w.printStackTrace(t,null,this)}},N.user=function(){},N.user.prototype.setInnerHTML=function(t,e,i,o,s){var a,n=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id),l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=this.getDisplayData(e);"function"==typeof n?(this.useCustomFormatter=!0,a=n.call(this.mainGrid,e,h,l,o)):(this.useCustomFormatter=!1,a=h),t.innerHTML=this.mainGrid.dataTagOpen+a+this.mainGrid.dataTagClose},
N.user.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=u.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.D.getDataPrefix("col_id"),a=this.mainGrid.getColumnIndex(e.getAttribute(s))}else{var n=this.mainGrid.getLastFocusedCell();i=n.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),a=n.focusedColIndex}this.mainGrid._getEditDisabled(i,a)||this.mainGrid.___getEditReadOnly(i,a)||u.B.fireEvent(this.mainGrid,"oncellclick",o,a,this.options.id)};var H=function(t,e,i){n.s.call(this,t,e,i)};o.x.extend(H.prototype,n.s.prototype),H.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.gridView",pluginName:"gridView",serializable:!0,userEvents:["oncellclick","oncelldblclick","onrightbuttonclick","ontextimageclick","ondateselect","oneditdblclick","oncellindexchange","onrowindexchange","oncolumnindexchange","onfilereadend","onscrollend","onscrollstart","onbeforeedit","oneditend","oneditkeydown","onafteredit","onscrolly","onscrollx","onsort","onbeforesort","onheaderclick","onheaderrightbuttonclick","onheaderdblclick","onheadermouseover","onheadermouseout","onheadertextimageclick","onfooterclick","onsubtotalclick","onsubtotaldblclick","onbodymouseover","onbodymouseout","ongroupby","ontoggleclick","onclick","onblankclick","onkeydown","onkeyup","onviewchange","onbeforepaste","onafterpaste","oncolumnwidthchange","onbeforecolumnmove","onaftercolumnmove","onaftercolumnresize","ondatadragstart","ondatadragover","ondatadrop","oncontextopen","oncontextclick","oneditkeyup"],rowNumVisible:!1,rowNumRowSpan:!0,rowNumHeaderValue:"",rowNumLocaleRef:"",rowNumBackgroundColor:"",rowNumRowMouseOverColor:!1,rowNumStatusResize:!1,cellStatusVisible:!1,cellStatusIconPosition:"right",rowStatusVisible:!1,rowStatusRowSpan:!0,rowStatusColSpan:!1,rowStatusHeaderValue:"",rowStatusLocaleRef:"",overflowX:"auto",overflowY:"auto",fixedColumn:0,fixedColumnWithHidden:!0,fixedColumnNoBGColor:!1,fixedColumnScrollHidden:!1,fixedColumnNoMove:!1,fixedColumnScrollReset:!0,fixedColumnLineDiv:!1,fixedColumnLineDivStart:"tbody",rowNumStatusFixed:!0,fixedRightColumn:0,fixedRow:0,lastFixedRow:0,lastFixedRowStartIndex:0,resize:!0,rowResize:!1,baseNode:"vector",repeatNode:"data/INFO",valueNode:"",focusMode:"cell",selectedCellColor:"#FCA73C",selectedRowColor:"#FCA73C",oddEvenColorDisplay:!1,oddRowBackgroundColor:"#EFF7FF",evenRowBackgroundColor:"#FFFFFF",rowMouseOver:!1,rowMouseOverColor:"#ffff80",selectedCellOverColor:"",selectedRowOverColor:"",editModeEvent:"ondblclick",editModeEventIcon:"onclick",keyMoveEditMode:!1,enterKeyMove:"down",skipMultiRowMove:!1,sortable:!1,sortHeaderDiv:!1,sortOrderReverse:!1,noSortInit:!1,showSortableImage:!1,preventMultisort:!1,useCtrlOnMultisort:!0,useCtrlKey:!0,sortedImagePosition:"",sortedIconPosition:"",sortEvent:"ondblclick",headerTooltipDisplay:!1,rowStatusTooltipDisplay:!1,tabKeyMove:"right",tooltipDisplay:!1,tooltipDisplayTime:0,tooltipClass:"",tooltipStyle:"",tooltipHide:"click",tooltipShowAlways:!1,tooltipShowAlwaysColumns:"",tooltipHeaderShowAlways:!1,tooltipFormatter:"",tooltipFormatterHeader:"",tooltipPositionX:"20",tooltipPositionY:"3+cellHeight",tooltipDisplayColumn:"",tooltipHeader:!1,showImageTooltip:!1,captionTitle:"",captionAuto:!1,noResultMessageVisibleAlways:!1,noResultMessageVisible:!1,noResultMessageExclude:"",noResultMessage:"",noResultMessageClass:"",noResultMessageStyle:"",noResultMessageStylePriority:!1,useNoResultMessageURL:!1,noResultMessageURL:"",hiddenClass:"",readOnly:"",readOnlyPriority:"",readOnlyBackgroundColor:"",readOnlyBackgroundImg:"",readOnlyBackgroundImgCSS:"",readOnlyTabIgnore:!1,ignoreNonEditableCell:!1,ignoreNonEditableCellTabEnter:!1,disabledPriority:"",disabledBackgroundColor:"",disabledFontColor:"",summary:"",footerCaption:"",footerCaptionAuto:!1,footerSummary:"",footerSummaryAuto:!1,drawLimitTime:70,drawLimitRow:4,loadCount:0,autoFit:"",
autoFitMinWidth:"",autoFitFixYScroll:!1,fastScroll:"",lazyDrawHiddenColumn:!1,defaultCellHeight:-1,defaultHeaderCellHeight:-1,hideHeader:!1,dataDragDrop:!1,dataDragDropOther:!1,dataDragDropSelf:!1,dataDragDropStatus:!1,dataDragSelect:!1,dataDragSelectAutoScroll:!1,dataDragSelectAutoScrollDPI:5,dataDragSelectAutoScrollPeriod:70,dataDragSelectAutoScrollDelay:50,dataDragSelectAutoScrollLevel:1300,dragDisplayColumn:"",dragStartFunction:"",dragEndFunction:"",headFiller:!1,focusMove:"true",focusFlow:"default",scrollMsg:"",visibleRowNum:"",visibleRowNumFix:!1,fixHeight:!1,fastEditMode:!1,iScrollMoveEffectTime:500,iScrollSlideTime:800,iScrollSlidePeriod:100,rollbackCommit:!0,numberCasting:!1,backgroundColorMode:"lazy",senseReader:!1,senseReaderLinkFocus:!1,useStartEndDiv:!0,showLastRow:!1,autoScope:!1,autoResizeEmbeddedInput:!1,servletPopup:!1,excelUploadPopupURL:"",advancedExcelUploadPopupURL:"",advancedExcelMultiUploadPopupURL:"",advancedExcelDownloadPopupURL:"",excelUploadURL:"",excelDownloadURL:"",csvDownloadURL:"",csvUploadPopupURL:"",csvUploadURL:"",advancedExcelUploadURL:"",advancedExcelDownloadURL:"",drilldownRealRowIndex:!0,drilldownRealRowIndexAll:!1,drilldownToggleScrollFix:!1,escape:!0,fixPrint:!1,xmlEncode:!1,wheelRows:3,wheelStop:!1,scrollByColumn:!1,scrollByColumnAdaptive:!1,rowNumWidth:"",rowStatusWidth:"",keepDefaultColumnWidth:!1,columnMove:!1,columnMoveWithFooter:!1,columnOrder:"",copyAmount:"",copyOption:"",copyType:"default",pasteOption:"",rowCopy:!1,customPasteFormatter:"",checkReadOnlyOnPaste:!1,checkDisabledOnPaste:!1,checkReadOnlyOnCut:!0,checkDisabledOnCut:!0,checkBlankRowOnPaste:!1,checkEditableInputClass:!1,checkEditOnPaste:!1,checkOnCellClick:!1,setDefaultValueOnPaste:!1,preventAddRowOnPaste:!1,preventCopy:!1,preventPaste:!1,groupbyZone:!1,groupbyZoneSearch:!1,groupbyListVisibleRowNum:10,groupbyZoneMessage:"",groupbyZoneHeight:"50",groupbyMaxCount:-1,groupbyDisplayRowIndex:!1,groupbyFilterIcon:!1,plainText:!1,excludeDeletedRows:!1,excludeModifiedRows:!1,initFixedHeightByRowNum:-1,moveKeyEditMode:!1,moveKeyEditModeAll:!1,keepBeforeDisplayData:!1,touchScrollDelta:5,dataList:"",useFilterSearch:!1,useSearchFilter:!1,useFilterList:!1,useFilterListSync:!1,useFilterListFormat:!1,useResizeFilterList:!1,filterListRowHeight:20,filterListVisibleRowNum:0,filterListWidth:0,caseSensitive:!1,displayValueOnUseFilterList:!1,customFilterListVisibleRowNum:10,showAllFilterList:!1,useFilterEmptyMsg:"",filterDisplayMode:"label",filterSearchTarget:"label",filterShowAlways:!1,duplicateColumnId:!1,filterFocusMode:"",focusOnSetData:!1,focusDefaultColumn:!1,focusAutoRemove:!1,scrollFix:!1,scrollRowHeight:!1,applyAllColumnStyle:!1,disabledScrollHidden:!1,hammerEnabled:!1,hammerPressTime:351,dynamic:!1,ignoreCellClick:!1,ignoreToggleOnDisabled:!1,adaptive:"",autoFitFilterList:!1,summaryAuto:!1,summaryOnlyAuto:!1,arrowMove:!1,filterBoxvisibleRowNum:4,groupbyFilterBox:!1,groupbyFilterBoxLocation:"bottom",groupbyFilterBoxLabelSize:3,customFilterBox:!1,customFilterFrameModal:!1,fixAdaptive:!1,groupbyFilterBoxFormatter:"",showSortableUseFilter:!1,customFormatterRealRowIndex:!1,oddEvenColorMerged:!1,showCustomFilterReset:!1,setCellInputTypeCustom:!1,useHeaderCheckboxLabelFor:!0,returnTrueFalseValue:!1,keepEditMode:!1,initStyle:!1,mergeCol:"",mergeRow:"",mergeCells:"never",noImageTooltip:!1,mergeCellsFixedCols:"never",mergeCellsFixedRows:"never",mergeExcludeValue:"",rowNumStatusUniqueId:!1,checkHeaderOnly:!1,checkAllType:"include",useDefaultStyle:!1,foldAll:!1,contextMenu:!1,useHeaderContextMenu:!1,contextMenuRowHeight:20,contextMenuAltClick:!1,titleAuto:!1,syncScroll:!1,disabledClass:"w2grid_default_disabled",readOnlyClass:"w2grid_default_readonly",selectByLabel:!1,syncWithScrollTrack:!1,aliasDataCollection:"",editInputClass:"",directEdit:!1,numberMask:"",euroMask:"",rupeeMask:"",tengeMask:"",useMaxLength:!1,noSelect:!1,scrollFocus:!1,postMsg:!1,useXHR:!1,preventDuplicateFocusedCell:!1,alwaysTriggerScrollStart:!1,CellClickFixScrollX:!1,
drawType:"virtual",mergeRefreshAlways:!0,subtotalStyleFormatter:"",mergeCellsFixedColsFirst:!1,useImageClick:!1,hideSortIconOnNoData:!1,hideFilterIconOnNoData:!1,showCheckboxLabelUserFormat:!1,showRadioLabelUserFormat:!1,useMoreButton:!1,moreButtonTitle:"",useTextMultiLink:!1,dataTag:"nobr",ctrlShiftKey:!1,scrollXNative:!1,scrollXNativeMobile:"",accessibility:!1,contentCellClick:!1,useDataDragDropGuideLine:!1,viewChangeAfterEdit:!1,hybridRowNum:50,useMobileTooltip:!1,useShiftKeyCheck:!1},H.prototype.initialize=function(t){if(this.initializeType="gridView",isNaN(parseInt(this.options.visibleRowNum,10))||(this.options.initFixedHeightByRowNum=-1),this.options.initFixedHeightByRowNum>0&&""===this.options.visibleRowNum&&(this.options.visibleRowNum=this.options.initFixedHeightByRowNum),this.firstEmbeddedInputResize=!0,"none"===this.options.autoFit&&(this.options.autoFit=""),this._isNativeScroll()&&(this.options.visibleRowNum="all"),"native"===this.options.copyType&&(this.options.noSelect=!1),t){for(var e=!1,i=!1,s=t.getChildNodes(),a=0;a<s.length;a++)"w2:header"!=s[a].getTagName()?"w2:gBody"!=s[a].getTagName()||(e=!0):i=!0;if(!e||!i)return this.uncompleted=!0,void(this.options.dynamic||$l(" gridView error : cannot find <w2:header> or <w2:gBody>.["+this.id+"]"))}if(this.options.dataList=this.options.dataList.wq_replaceAll("data:",""),this._dataList=null,this.options.dataList&&(this._dataList=this.modelControl.getDataComp(this.options.dataList,{type:"aliasDataCollection"})),this._dataList)switch(this._grid=this,this._dataList.addChild(this),this._dataList=WebSquare.DataCollection.api.getObj(this._dataList),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.x.extend(this,WebSquare.uiplugin.linkedMappingController.prototype),o.x.extend(this.dataList,WebSquare.uiplugin.linkedMappingController.prototype),this.dataList._linkedDataList=this._linkedDataList):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}else $l(" gridView error : invalid dataList("+this.options.dataList+").["+this.id+"]"),this.successBinding=!1,this._dataList={};this.skipPreActivate=!0;var n=this.options.dataList;null!=this.scope_obj&&(n=this.scope_obj.id+"_"+this.options.dataList),WebSquare.DataCollection.api.addRelation(this.id,n,!1),this.skipPreActivate=!1,this.myhelper=new WebSquare.korHelper,(r.D.isIEAllVersion()||r.D.isSpartan())&&(this.options.useResizeFilterList=!1),(this.options.useSearchFilter||this.options.useResizeFilterList)&&(this.options.useFilterSearch=!1),this.options.useNoResultMessageURL&&(this.options.noResultMessageStyle="",this.options.noResultMessageClass="",this.options.noResultMessageExclude="",this.options.noResultMessageVisibleAlways=!1,this.options.noResultMessage="",this.options.noResultMessageStylePriority=!1,this.options.noResultMessageVisible=!0,this.options.noResultMessageURL||(this.options.noResultMessageURL=o.x._resourceURI+"message/noResultMessage/gridView_noResultMessage.xml")),this._initialize()},H.prototype._initialize=function(t){if(this.focusedCellInfo={},this.extraData={grid:{},row:[],col:[],cell:[]},this.drilldown=new WebSquare.uiplugin.drilldown,"false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove||(this.options.enterKeyMove="none"),this.options.groupbyFilterBox&&(this.groupbyFilterBox_select=null,this.groupbyFilterBox_history=[]),!0===this.options.accessibility){this.options.senseReader=!0,this.options.focusMove="false",this.options.keyMoveEditMode=!0,this.options.autoResizeEmbeddedInput=!0,this.options.scrollFocus=!0,this.options.titleAuto=!0,this.options.sortHeaderDiv=!0,this.options.drawType="native";var e=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum
;e>0&&(this.options.initFixedHeightByRowNum=e,this.options.visibleRowNumFix=!0),this.options.visibleRowNum="all"}this.date=new Date,this.isDrillDown=!1,this.depthColumn="",this.showDepth="",this.removed=!1,this.useExpression=!1,this.colWidthList=[],this.gridWidth=0,this.resizeStarted=!1,this.headerHeight=0,this.footerHeight=0,this.hgap=[],this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autofitDone=!1,this.resizeStatus="init",this.scrollWidthSize=18,this.scrollLayerWidthSize=18,this.hiddenList=[],this.headerFocus=!1,this.headerObjArr=[],this.tmpSelectbox=null,this.noevent=!1,this.rowIndex=-1,this.lastIndex=-1,this.oelIndex=-1,this.initializeDrawController(),this.drawedRowLength=0,this.maxRowLength=0,this.drawSizeChanged=!1,this.drawSizeAdded=!1,this.isExistTextarea=!1,this.bodyHeight=0,this.scrollEvent=!0,this.isColMerge=!1,this.isColMergeAnd=!1,this.upperToLowerColumnRelation={},this.hasSubtotal=!1,this.startRowNumber=0,this.dataRowList=[],this.subtotalRowHash={},this.subtotalDataArr={},this.subtotalObj={},this.drawSetTimeoutKey=[],this.overElem=null,this.outElem=null,this.hasFooter=!1,this.footerDataObj=null,this.drawFooterStatus=!0,this.bScrollTop=-1,this.bScrollY=0,this.drawedTime=0,this.defaultColCnt=0,this.options.rowNumVisible&&this.defaultColCnt++,this.options.rowStatusVisible&&this.defaultColCnt++,this.loadCheck=[],this.beforeDataLength=-1,this.beforeMaxRowLength=-1,this.checkScrollStart=!0,this.editEnd=!1,this.lastOverSrc=null,this.headerInfoHash={},this.headerInfoHash2={},this.cellInfoHash={},this.cellInfoHash2={},this.expressionAssArr=[],this.labelColumnAssArr=[],this.rowStyleValueObj={},this.columnStyleValueObj={},this.cellStyleValueObj={},this.defaultStyleValueObj={},this.initStyleValueObj={},this.adaptiveColumnStyleValueObj={},this.rowStyleFixedValueObj={},this.rowStyleDataValueObj={},this.columnStyleFixedValueObj={},this.columnStyleDataValueObj={},this.disabledCellStyleObj={},this.headerCellStyleValueObj={},this.headerCellClassObj={},this.rowStyleIndex=0,this.cellStyleIndex=0,this.rowStyleFixedIndex=0,this.rowStyleDataIndex=0,this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.tdCellClassArr=[],this._cellSelectedIndex=[],this.columnClassObj={},this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.focusedCell=[],this.focusedRow=[],this.headerToBodyRelation={},this.bodyToHeaderRelation={},this.passiveColSpanRelation={},this.colMoveBolockedHeaderObj={},this.backupHeaderHTML={},this.expressionHeaderInfo={},this.columnOrder=[],this.isIE6=r.D.isIE("6"),"BackCompat"==document.compatMode&&(this.isIE6=!0),this.isIE7=r.D.isIE("7"),this.isIE6or7=this.isIE6||this.isIE7,this.isMobile=r.D.isMobile(),this.isWebKit=/webkit/.test(navigator.userAgent.toLowerCase()),this.tmpCnt=0,this.initFlag=!1,this.options.rowNumBackgroundColor=this.options.rowNumBackgroundColor.wq_trim(),this.options.selectedCellColor=this.options.selectedCellColor.wq_trim(),this.options.selectedRowColor=this.options.selectedRowColor.wq_trim(),this.options.oddRowBackgroundColor=this.options.oddRowBackgroundColor.wq_trim(),this.options.evenRowBackgroundColor=this.options.evenRowBackgroundColor.wq_trim(),this.options.rowMouseOverColor=this.options.rowMouseOverColor.wq_trim(),this.options.readOnlyBackgroundColor=this.options.readOnlyBackgroundColor.wq_trim(),this.options.disabledBackgroundColor=this.options.disabledBackgroundColor.wq_trim(),this.options.disabledFontColor=this.options.disabledFontColor.wq_trim(),r.D.getBoolean(this.options.focusOnSetData)&&(this.options.focusOnSetData=!0),this.options.senseReader&&(this.options.focusFlow="linear","all"===this.options.visibleRowNum&&(this.options.showLastRow=!0),this.element&&"false"!=this.element.getAttribute("autoScope")&&(this.options.autoScope=!0),this.senseReaderMode=!0),this.embeddedWidthObj={},
this.options.sortable&&this.options.sortHeaderDiv&&(this.options.showSortableImage=!0,this.options.sortEvent="onclick"),this.radioGroupRepChk={},this.options.excelUploadPopupURL=this.options.excelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/fileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/fileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadPopupURL=this.options.advancedExcelUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.html"),{baseURI:!0})),this.options.advancedExcelMultiUploadPopupURL=this.options.advancedExcelMultiUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedMultiUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedMultiUpload.html"),{baseURI:!0})),this.options.advancedExcelDownloadPopupURL=this.options.advancedExcelDownloadPopupURL||this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/download/advancedfileDownload.html"),{baseURI:!0}),this.options.excelUploadURL=this.options.excelUploadURL||WebSquare.baseServletURI+"excelToGrid.wq",this.options.excelDownloadURL=this.options.excelDownloadURL||WebSquare.baseServletURI+"xmlToExcel.wq",this.options.csvDownloadURL=this.options.csvDownloadURL||WebSquare.baseServletURI+"xmlToCSV.wq",this.options.csvUploadURL=this.options.csvUploadURL||WebSquare.baseServletURI+"csvToXML.wq",this.options.csvUploadPopupURL=this.options.csvUploadPopupURL||(this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/csvfileUpload.jsp"),{baseURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.html"),{baseURI:!0})),this.options.advancedExcelUploadURL=this.options.advancedExcelUploadURL||WebSquare.baseServletURI+"excelToGrid2.wq",this.options.advancedExcelDownloadURL=this.options.advancedExcelDownloadURL||WebSquare.baseServletURI+"xmlToExcel2.wq",this.groupbyStatus={},this.groupbyZoneStatus={},this.groupbyDisplayOptions={},this.directItemChoiceKeyObj={},this.rowStatusColIDArr=[],this.cellIdList=[],this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.beforeEditedCellInfo=null,this.hiddenAdaptiveList=[],this.adaptiveEmbeddedInputIdList=[],this.hideThresholdObj={},this.orgBodyHeightObj={},this.orgHeaderHeightObj={},this.orgFooterHeightObj={},this.orgSubtotalHeightArr=[],this.oldOptions={},this.adaptiveGridType=0,this.tooltipPositionParse=!1,this.oneRowScrollHeight=20,this._manager=null,this.beforeEditedCellInfo=null,this.options.noResultMessage=this.options.noResultMessage||WebSquare.language.getMessage("Grid_noResultMessage")||"No search result.",this.options.scrollMsg=this.options.scrollMsg||WebSquare.language.getMessage("Grid_scrollMsg")||"Updating...",this.cellMergeInfo={},this.cellMergeRealInfo={},this.tdMergeInfo={},this.mergeColObj={},this.mergeRowObj={},this.hiddenRowObj={length:0,extraRow:0,row:{},init:!1},this.hiddenCellObj={length:0,init:!1},!0===this.options.moveKeyEditModeAll&&(this.options.moveKeyEditMode=!0),this.filterEmptyStr=this.options.useFilterEmptyMsg||WebSquare.language.getMessage("GRID_useFilterEmptyMsg"),this.useFilterEmptyValueInfo={"":!0};var i=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];i.push("");for(var o=0;o<i.length;o++)i[o]=i[o].trim(),this.useFilterEmptyValueInfo[i[o]]=!0;this._regDetectDOM=new RegExp("<[^<]+>","i"),this._regRemoveDOM=new RegExp("<[/]{0,1}[^></]+[/]{0,1}>","g"),this._bindDrag=!1,this._subtotalDisplayFormat="",this._dynamicVisibleRowNum=-1,"span"==this.options.dataTag?(this.dataTagOpen="<span class='w2grid_span'>",this.dataTagClose="</span>"):(this.dataTagOpen="<"+this.options.dataTag+">",
this.dataTagClose="</"+this.options.dataTag+">"),WebSquare.util.isMobile()&&this.options.scrollXNativeMobile&&(this.options.scrollXNative=r.D.getBoolean(this.options.scrollXNativeMobile)),this._setOverflowYScrollFlag=!1,this._setOverflowYHiddenFlag=!1,this._editendCalled=!1,this._hybridScrollYPos=0,this._hybridRowIndex=0,this._hybridScrollHeight=20,this._hybridScrollDupHeight=0,this._hybridScrollLastTop=NaN,this._hybridScrollHash={},this._hybridWheelCntX=0,this._hybridWheelCntY=0,this._hybridMobileStartX=0,this._hybridMobileStartY=0,this._hybridRefreshCnt=0,this._hybridRefreshMax=2,!0===this._isHybridScroll()&&(this.options.initFixedHeightByRowNum=-1)},H.prototype.setPreAction=function(){try{var t=this.render.offsetWidth,e=this.render.offsetHeight;this.resizeObj={width:t,height:e,scrollLeft:0,scrollTop:0,clientWidth:this.render.clientWidth};var i=this.getElementById(this.id+"_head_table").getElementsByTagName("tr"),o=i[i.length-1],a=this.getElementById(this.id+"_body_table");this.gridLastTrBottomFix=a.offsetHeight-o.offsetTop-o.offsetHeight,this.setTableLayout(),this._handleScrollX(),this.setCellInfo(),this.setDataListCellInfo(),1==this.isDrillDown&&this.initDrilldown(),!0!==this.options.preventCopy&&!0!==this.options.noSelect||this.addClass("w2noselect")}catch(t){s.w.printStackTrace(t,null,this)}},H.prototype.setAction=function(){try{if(this.initializeEvent(),this.options.columnOrder&&this.setColumnOrder(this.options.columnOrder),this.options.mergeCol){for(var t=this.getColumnCount(),e=0;e<t;e++)this.mergeColObj[e]=!1;var i=this.options.mergeCol.split(",");for(e=0;e<i.length;e++){var o=i[e];isNaN(o)||(o=Number(o)),this.mergeCol(i[e],!0)}}this._noResultMessageDivTop=WebSquare.util.getStyleProperty(this.getElementById(this.id+"_noresult"),"top");for(e=0;e<this.oneRowDataLength;e++){var a=this.getColumnID(e),n=this.getCellInfo(e);if(""!=this.options.hiddenClass||""!=n.options.hiddenClass){var l=this.options.hiddenClass;""!=n.options.hiddenClass&&(l=n.options.hiddenClass);var h=this._getRealColIndex("body",a)+this.defaultColCnt,d=null!=this.bodyToHeaderRelation[a]?this.getHeaderLayer(this.bodyToHeaderRelation[a]):null;this.hiddenList[h]?null==d||this.hasClass(d,l)||this.addClass(d,l):null!=d&&this.hasClass(d,l)&&this.removeClass(d,l)}}!this.startedDisplayNone&&this.getRowCount&&this.getRowCount()>0?this.notifyDataChanged({refreshScroll:!0}):!0===this._isHybridScroll()&&this.setScrollYHeightHybrid(),!this.startedDisplayNone&&this.options.focusOnSetData&&this._setFocusedCell(0,0),this.successBinding&&this._dataList&&this._dataList.options.initRowPosition&&this._dataList.broadcast({linkedDataList:["notifyRowPositionChanged"]});var u=WebSquare.BootLoader.fullViewed||!1,p=r.D.fullViewed||!1;if(u||p||!this.startedDisplayNone&&this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),1==this.options.summaryAuto&&!0!==r.D.isHTML5()){var c=this.getHeaderValueList(),g="",f="";for(e=0;e<c.length;e++)g.length>0&&(f=","),g=g+f+c[e];this.setSummary(g)}if(this.changeCount=0,r.D.getBoolean(this.options.captionAuto)){for(c=this.getHeaderValueList(),g="",f="",e=0;e<c.length;e++)g.length>0&&(f=","),g=g+f+c[e];this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+g+WebSquare.language.getMessage("Grid_caption")):this.setCaption(g+WebSquare.language.getMessage("Grid_caption"))}if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var m=document.getElementById(this.id).style.cssText,y=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:m,className:y}}if(this.startedDisplayNone||this._setVisibleRowNumFix(),
this.options.noResultMessageVisibleAlways&&this.displayNoResultMessage(),this.options.groupbyZone){if(this.delayedDraw({}))return;this._drawGroupbyZone()}}catch(t){s.w.printStackTrace(t,null,this)}},H.prototype.setDataList=function(){try{if(!this.successBinding&&(this._dataList=this.modelControl.getDataComp(this.options.dataList),this._dataList)){switch(this._grid=this,this._dataList.addChild(this),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.x.extend(this,WebSquare.uiplugin.linkedMappingController.prototype)):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}for(var t=0;t<this.oneRowDataLength;t++)this.getCellInfo(t).setDataListCellRefresh(this.getCellInfo(t).element);this.render&&this.notifyDataChanged({refreshScroll:!0})}}catch(t){s.w.printStackTrace(t,null,this)}},H.prototype.resetDataList=function(){try{this.successBinding=!1,this.setDataList()}catch(t){s.w.printStackTrace(t,null,this)}},H.prototype.serialize=function(){return this.focusedCell},H.prototype.restore=function(t){try{for(var e=0,i=t.length;e<i;e++)this._setFocusedCell(t[e].focusedRowIndex,t[e].focusedColIndex,null,{useShiftKey:!0})}catch(t){return s.w.printStackTrace(t),!1}return!0},H.prototype.onComplete=function(){this.uncompleted||(this._setRedrawTextAreaColumn(),this.displayFixedColumnLine(),n.s.prototype.onComplete.call(this))},o.x.extend(H.prototype,h.prototype),o.x.extend(H.prototype,c.prototype),o.x.extend(H.prototype,g.prototype),o.x.extend(H.prototype,f.prototype),o.x.extend(H.prototype,m.prototype),o.x.extend(H.prototype,C.prototype),o.x.extend(H.prototype,I.prototype),o.x.extend(H.prototype,_.prototype),o.x.extend(H.prototype,x.prototype),o.x.extend(H.prototype,D.prototype),o.x.extend(H.prototype,R.prototype),o.x.extend(H.prototype,L.prototype),o.x.extend(H.prototype,k.prototype),o.x.extend(H.prototype,F.prototype)},4263:function(t,e,i){i.d(e,{v:function(){return l}});var o=i(1002),s=(i(9122),i(1160)),a=i(5841),r=i(8754),n=i(6079),l=function(t){this._grid=t};l.prototype.getRealRowIndex=function(t){try{var e;if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var i in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[i])return this._grid._dataList.getRealRowIndex(t);e=this._grid.groupbyStatus.groupedRowIndexArr[t]}else e=this._grid._dataList.getRealRowIndex(t);return e}catch(t){s.w.printStackTrace(t)}},l.prototype.getTotalRow=function(){try{return this._grid._dataList.getTotalRow()}catch(t){s.w.printStackTrace(t)}},l.prototype.getTotalCol=function(){try{return this._grid.oneRowDataLength}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowCount=function(){try{return this._grid._dataList.getDataLength()}catch(t){s.w.printStackTrace(t)}},l.prototype._getData=function(t,e){try{e=this._grid.getColumnID(e);var i=this._grid.cellInfoHash[e]||{options:{}};if((1!=this._grid.options.moveKeyEditModeAll||"checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)&&this._grid.editEndBeforeGetData(),i&&"expression"==i.options.inputType)return i.getExpressionValue(t);var o=this._grid._dataList._getData(t,e);return null==o&&(o=""),o}catch(t){s.w.printStackTrace(t)}},l.prototype.getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);return"2"==(i=null==i||void 0===i?"0":i+"")?this._getCellData(t,e,i):this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?this._getCellData(t,e,"0"===i?3:i):this._getCellData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype._getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);if("2"==(i=null==i||void 0===i?"0":i+""))return this._grid._getCellDisplayData(t,e)
;var o=this._grid.getRealRowIndex(t);return"3"!=i&&null!=o&&(t=o),this._getData(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getOriginalCellData=function(t,e){try{e=this._grid.getColumnID(e);return this._grid._dataList.getOriginalCellData(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.getColData=function(t,e){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColData(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowData=function(t,e){try{for(var i=[],o=0;o<this._grid.getColumnCount();o++)"displayData"!=e?i.push(this.getCellData(t,o)):i.push(this._grid._getCellDisplayData(t,o));return i}catch(t){s.w.printStackTrace(t)}},l.prototype._getRowData=function(t,e){try{for(var i=[],o=0;o<this._grid.getColumnCount();o++)"displayData"!=e?i.push(this._getData(t,o)):i.push(this._grid._getDisplayData(t,o));return i}catch(t){s.w.printStackTrace(t)}},l.prototype.getDataRow=function(t){try{return this._grid._dataList.getDataRow(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedData=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedData(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedData=function(t,e,i,o,a){try{return this._grid._dataList.getUnmatchedData(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedColumnData=function(t,e,i,o,a,r){try{return this._grid._dataList.getMatchedColumnData(t,e,i,o,a,r)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedColumnData=function(t,e,i,o,a,r){try{return this._grid._dataList.getUnmatchedColumnData(t,e,i,o,a,r)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedIndex=function(t,e,i,o,a){try{return this._grid._dataList.getMatchedIndex(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedIndex=function(t,e,i,o,a){try{return this._grid._dataList.getUnmatchedIndex(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRangeData=function(t,e,i){try{var o=[];if(t>e){var a=e;e=t,t=a}t<0&&(t=0),e>this._grid.getDataLength()&&(e=this._grid.getDataLength());for(var r=t;r<e;r++)o=o.concat(this.getRowData(r,i));return o}catch(t){s.w.printStackTrace(t)}},l.prototype.getAllData=function(){try{return this._grid._dataList.getAllData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getColumnDistinctDataArray=function(t){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColumnDistinctDataArray(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRangeXML=function(t,e){try{return this._grid._dataList.getRangeXML(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedXML=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedXML(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedXML=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedXML(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowXML=function(t){try{return this._grid._dataList.getRowXML(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getAllXML=function(){try{return this._grid._dataList.getAllXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowJSON=function(t){try{return this._grid._dataList.getRowJSON(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getAllJSON=function(){try{return this._grid._dataList.getAllJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRangeJSON=function(t,e){try{return this._grid._dataList.getRangeJSON(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedJSON=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedJSON(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedJSON=function(t,e,i,o,a){try{t=this._grid.getColumnID(t)
;return this._grid._dataList.getUnmatchedJSON(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowArray=function(t){try{return this._grid._dataList.getRowArray(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getAllArray=function(){try{return this._grid._dataList.getAllArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRangeArray=function(t,e){try{return this._grid._dataList.getRangeArray(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.getMatchedArray=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedArray(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.getUnmatchedArray=function(t,e,i,o,a){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedArray(t,e,i,o,a)}catch(t){s.w.printStackTrace(t)}},l.prototype.setCellData=function(t,e,i,o,a,r,n,l){try{e=this._grid.getColumnID(e);if(this._grid._linkedDataList){var h=this._grid._linkedDataList.filteredRowIndexArr[t];"number"!=typeof t&&(t=h)}this._setCellData(t,e,i,null,o,a,r,n,l)}catch(t){s.w.printStackTrace(t)}},l.prototype._setCellData=function(t,e,i,r,n,l,h,d,u){try{var p=!1;if("object"==(0,o.Z)(t)&&null!=t){e=t.colID,i=t.data,r=t.noDraw,n=t.direction,l=t.skipBroadCast,h=t.noEvent,d=t.excludeId,u=t.skipInstance,p=t.useRealRowIndex;var c=t.filteredRowIndex;t=null,t=c}null==i&&(i=""),null==this._grid.editedCell||this._grid.getCellOption(t,e,"embeddedInput")||this._grid.editedCell.handleCancelEdit();var g,f=this._grid._dataList.getTotalRow(),m=this._grid._dataList.getTotalCol();g=!0===p||this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?t:this._grid.getRealRowIndex(t);var y=t,b="",w=(e=this._grid.getColumnID(e),this._grid.getColumnIndex(e)),v=this._grid._dataList.getColumnIndex(e),C=this._grid._linkedDataList||this._grid.groupbyStatus.grouped?g:t;if(this._grid.isDrillDown&&this._grid._dataList.options.depthColumn?b=this.getCellData(g,e,"3"):C>=0&&C<f&&v>=0&&v<m&&(b=this.getCellData(t,e)),C>=0&&C<f&&v>=0&&v<m){var I=this._grid.cellInfoHash[this._grid.tdIdList[w]]||{options:{}},_=I.options.inputType||"text";if(("text"==_||"textImage"==_||"drilldown"==_)&&"all"==I.options.applyFormat&&!I.options.embeddedInput){var x=this._grid.getInput(I);b=I.formatter.format(b),b=x.validator.validateString(b)}var S=this._grid.getColumnOption(I.options.col_id,"dataType");if("bigDecimal"==S&&"string"==typeof i?i=WebSquare.bigDecimal(i).toString():"bigDecimal"==S&&($l("If dataType is bigDecimal, data must be entered to String.["+this.id+"]"),i=WebSquare.bigDecimal(i).toString()),i.toString().replace(/\r(\n)?/,"\n")!==b.toString().replace(/\r(\n)?/,"\n")){var D=t;if((this._grid._linkedDataList||this._grid.isDrillDown&&this._grid._dataList.options.depthColumn)&&(D=g),this._grid.groupbyStatus.grouped?this._grid._dataList._setCellData({filteredRowIndex:g,colID:e,value:i,direction:n,skipBroadCast:l,noEvent:h,excludeId:d,realRowIndex:!0,notifyRowIndex:t,skipInstance:u}):this._grid._dataList._setCellData(D,e,i,n,l,h,d,u),null==this._grid._dataList.getColumnID(e)&&this._grid.notifyCellChanged(y,w),a.B.fireEvent(this._grid,"onchange",t,w,i,b),"radio"==I.options.inputType&&I.options.groupName&&I.options.trueValue==i&&(I.resetOthers(t),this._grid.radioGroupRepChk[I.options.groupName]&&this.setCellData(t,I.options.groupName,I.options.groupValue)),this._grid.radioGroupRepChk[I.options.id]){for(var R=this._grid.getColumnCount(),L=0;L<R;L++){var T=this._grid.cellInfoHash[this._grid.tdIdList[L]]||{options:{}};if("radio"==T.options.inputType&&T.options.groupName==I.options.id&&T.options.groupValue==i){this.setCellData(t,L,T.options.trueValue,n,l,h,d,u);break}}L==R&&this._grid._resetRadioGroup(t,I.id,!1)}if(this._grid.isDrillDown)if(this._grid.drilldown.options.depthColumn==w)this._grid.notifyDataChanged({keepTop:!0}),0==this._grid.getDataLength()&&this._grid.removeFocusedCell(),
this._grid.setScrollYHeight();else if("checkbox"==I.options.inputType&&I.options.setRecursive)for(var k=this._grid.drilldown.getChildRowArr(t,!0),F=0;F<k.length;F++)this._getData(k[F],w)!=i&&this._setCellData(k[F],w,i,r,n,l,h,d,u)}else null==this._grid.editedCell||r||this._grid.notifyCellChanged(y,w)}}catch(t){s.w.printStackTrace(t)}},l.prototype.__setCellData=function(t,e,i,o,a,r,n){try{var l;e=this._grid.getColumnID(e);this._grid._linkedDataList?(l=this._grid._linkedDataList.filteredRowIndexArr[t],"number"!=typeof t&&(t=l)):l=this._grid.dataList.getRealRowIndex(t),this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList&&(t=l),this._setCellData(t,e,i,null,o,a,r,n)}catch(t){s.w.printStackTrace(t)}},l.prototype.setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList.setOriginalCellData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype._setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList._setOriginalCellData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.setColumnDefaultValue=function(t,e){try{t=this._grid.getColumnID(t);this._grid._dataList.setColumnDefaultValue(t,e)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.setRowData=function(t,e,i){try{this._grid._dataList.setRowData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.setDataFile=function(t,e){try{t=this._grid._dataList.toArray(t);for(var i,o=[],a=0;a<this._grid.oneRowDataLength;a++){"expression"==(n=this._grid.getCellInfo(a)).options.inputType&&o.push(a)}i=t.length/this._grid.oneRowDataLength;for(a=0;a<o.length;a++)for(var r=0;r<i;r++){t[u=r*this._grid.oneRowDataLength+parseInt(o[a],10)]=""}for(a=0;a<this._grid.oneRowDataLength;a++){var n,l=(n=this._grid.getCellInfo(a)).options.dataType;if("select"==n.options.inputType){var h=[];for(r=0;r<n.itemArr.length;r++){h[(d=n.itemArr[r]).label]=d.value}for(r=0;r<i;r++){t[u=r*this._grid.oneRowDataLength+a]=h[t[u]]}}else if("checkcombobox"==n.options.inputType){for(h=[],r=0;r<n.itemArr.length;r++){var d;h[(d=n.itemArr[r]).label]=d.value}for(r=0;r<i;r++){for(var u=r*this._grid.oneRowDataLength+a,p=[],c=t[u].split(n.separator),g=0;g<c.length;g++)p.push(h[c[g]]);t[u]=p.join(n.separator)}}if(""!=n.options.displayFormat)for(r=0;r<i;r++){var f,m=t[u=r*this._grid.oneRowDataLength+a],y=n.options.displayFormat;f="number"==l||"bigDecimal"==l?WebSquare.text.unformatCurrency(y,m):"date"==l?WebSquare.text.unformatDate(y,m):"time"==l?WebSquare.text.unformatTime(y,m):WebSquare.text.unformatText(y,m),t[u]=f}}this._grid._dataList.setData(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.setData=function(t,e,i){try{this._grid._dataList.setData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.insertData=function(t,e){try{this._grid._dataList.insertData(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype._insertData=function(t,e,i){try{this._grid._dataList._insertData(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.getDataLength=function(){try{var t;if(this._grid.successBinding)if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var e in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[e])return this._grid._dataList.getDataLength();t=this._grid.groupbyStatus.groupedRowIndexArr.length}else t=this._grid._dataList.getDataLength();else t=0;return t}catch(t){s.w.printStackTrace(t)}},l.prototype.setRowXML=function(t,e,i){try{this._grid._dataList.setRowXML(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.setXML=function(t,e,i){try{if("grid"==this._grid.initializeType&&i&&i.ref&&(this._grid.options.ref=i.ref,this._grid._dataList.options.ref=i.ref,i.baseNode&&(this._grid.options.baseNode=i.baseNode,this._grid._dataList.options.baseNode=i.baseNode),i.repeatNode&&(this._grid.options.repeatNode=i.repeatNode,this._grid._dataList.options.repeatNode=i.repeatNode),
i.aliasDataCollection&&(this._grid.options.aliasDataCollection=i.aliasDataCollection,this._grid._dataList.options.aliasDataCollection=i.aliasDataCollection),this._grid._setRef(),this._grid._dataList.repeatNodeTagName=this.repeatNodeTagName),null==t)return void n.k.printLog("[WebSquare.uiplugin.mappingController.setXML] XML is null["+this.id+"]");var o=this._grid.xmlData2ArrData(t);if(void 0===o)return void n.k.printLog("[WebSquare.uiplugin.mappingController.setXML] DataArray which converted from XML is undefined.["+this.id+"]");this.setData(o,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.insertXML=function(t,e){try{this._grid._dataList.insertXML(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.setJSON=function(t,e){try{if(null==t)return void n.k.printLog("[WebSquare.uiplugin.mappingController.setJSON] JSON is null["+this.id+"]");var i=this._grid.jsonData2ArrData(t);if(void 0===i)return void n.k.printLog("[WebSquare.uiplugin.mappingController.setJSON] DataArray which converted from JSON is undefined.["+this.id+"]");this.setData(i,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.setRowJSON=function(t,e,i){try{this._grid._dataList.setRowJSON(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.insertJSON=function(t,e){try{this._grid._dataList.insertJSON(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.rowMoveUp=function(t){try{this._grid._dataList.rowMoveUp(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.rowMoveDown=function(t){try{this._grid._dataList.rowMoveDown(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.rowMoveUpFiltered=function(t){try{this._grid._dataList.rowMoveUpFiltered(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.rowMoveDownFiltered=function(t){try{this._grid._dataList.rowMoveDownFiltered(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.insertRow=function(t,e){try{e=e||{};return this._grid.options.insertIntoSortedRow&&(e.insertIntoSortedRow=this.options.insertIntoSortedRow),"grid"==this.initializeType&&this.options.ref&&1==this.repeatNodeTagNameFilter&&(t=null),this._grid._dataList.insertRow(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.removeRow=function(t,e){try{return this._grid._dataList.removeRow(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.removeRows=function(t){try{return this._grid._dataList.removeRows(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.removeAll=function(){try{return this._grid._dataList.removeAll()}catch(t){s.w.printStackTrace(t)}},l.prototype.removeRange=function(t,e){try{return this._grid._dataList.removeRange(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.reform=function(){try{this._grid._dataList.reform()}catch(t){s.w.printStackTrace(t)}},l.prototype.undoRow=function(t){try{this._grid._dataList.undoRow(t)}catch(t){s.w.printStackTrace(t)}},l.prototype._undoRow=function(t){try{this._grid._dataList._undoRow(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.undoAll=function(){try{this._grid._dataList.undoAll()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowStatusValue=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatusValue(e)}catch(t){s.w.printStackTrace(t)}},l.prototype._getRowStatusValue=function(t){try{return this._grid._dataList._getRowStatusValue(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowStatus=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatus(e)}catch(t){s.w.printStackTrace(t)}},l.prototype._getRowStatus=function(t){try{return this._grid._dataList._getRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getRowIndexByStatus=function(t){try{return this._grid._dataList.getRowIndexByStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.getInsertedIndex=function(){try{return this.getRowIndexByStatus("C")}catch(t){s.w.printStackTrace(t)}},l.prototype.getUpdatedIndex=function(){try{return this.getRowIndexByStatus("U")}catch(t){s.w.printStackTrace(t)}},l.prototype.getDeletedIndex=function(){try{
return this.getRowIndexByStatus("DV")}catch(t){s.w.printStackTrace(t)}},l.prototype.getOnlyDeletedIndex=function(){try{return this.getRowIndexByStatus("D")}catch(t){s.w.printStackTrace(t)}},l.prototype.getVoidIndex=function(){try{return this.getRowIndexByStatus("V")}catch(t){s.w.printStackTrace(t)}},l.prototype.getModifiedIndex=function(){try{return this.getRowIndexByStatus("CUD")}catch(t){s.w.printStackTrace(t)}},l.prototype.getInsertedData=function(){try{return this._grid._dataList.getInsertedData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getInsertedXML=function(){try{return this._grid._dataList.getInsertedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getInsertedJSON=function(){try{return this._grid._dataList.getInsertedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getInsertedArray=function(){try{return this._grid._dataList.getInsertedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getDeletedData=function(){try{return this._grid._dataList.getDeletedData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getDeletedXML=function(){try{return this._grid._dataList.getDeletedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getDeletedJSON=function(){try{return this._grid._dataList.getDeletedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getDeletedArray=function(){try{return this._grid._dataList.getDeletedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRemovedXML=function(){try{return this._grid._dataList.getRemovedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRemovedJSON=function(){try{return this._grid._dataList.getRemovedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getRemovedArray=function(){try{return this._grid._dataList.getRemovedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getVoidData=function(){try{return this._grid._dataList.getVoidData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getVoidXML=function(){try{return this._grid._dataList.getVoidXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getVoidJSON=function(){try{return this._grid._dataList.getVoidJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getVoidArray=function(){try{return this._grid._dataList.getVoidArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getOnlyDeletedData=function(){try{return this._grid._dataList.getOnlyDeletedData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getOnlyDeletedXML=function(){try{return this._grid._dataList.getOnlyDeletedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getOnlyDeletedJSON=function(){try{return this._grid._dataList.getOnlyDeletedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getOnlyDeletedArray=function(){try{return this._grid._dataList.getOnlyDeletedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getUpdatedData=function(){try{return this._grid._dataList.getUpdatedData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getUpdatedXML=function(){try{return this._grid._dataList.getUpdatedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getUpdatedJSON=function(){try{return this._grid._dataList.getUpdatedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getUpdatedArray=function(){try{return this._grid._dataList.getUpdatedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype.getModifiedData=function(){try{return this._grid._dataList.getModifiedData()}catch(t){s.w.printStackTrace(t)}},l.prototype.getModifiedXML=function(){try{return this._grid._dataList.getModifiedXML()}catch(t){s.w.printStackTrace(t)}},l.prototype.getModifiedJSON=function(){try{return this._grid._dataList.getModifiedJSON()}catch(t){s.w.printStackTrace(t)}},l.prototype.getModifiedArray=function(){try{return this._grid._dataList.getModifiedArray()}catch(t){s.w.printStackTrace(t)}},l.prototype._setRowStatus=function(t,e){try{return this._grid._dataList._setRowStatus(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype._initRowStatus=function(t){try{this._grid._dataList._initRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.initRowStatus=function(t){try{
this._grid._dataList.initRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype._createRowStatus=function(t){try{this._grid._dataList._createRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype._updateRowStatus=function(t){try{this._grid._dataList._updateRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.removeRowStatus=function(t){try{return this._grid._dataList.removeRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.deleteRow=function(t){try{this._grid._dataList.deleteRow(t)}catch(t){s.w.printStackTrace(t)}},l.prototype._deleteRowStatus=function(t){try{this._grid._dataList._deleteRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.undeleteRow=function(t){try{this._grid._dataList.undeleteRow(t)}catch(t){s.w.printStackTrace(t)}},l.prototype._undeleteRowStatus=function(t){try{this._grid._dataList._undeleteRowStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.modifyAllStatus=function(t){try{this._grid._dataList.modifyAllStatus(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.modifyRangeStatus=function(t,e,i){try{var o=[],r=this.getDataLength()+1;if(0<=t&&e<r)for(var n=t;n<e;n++){var l=this.getRealRowIndex(n),h=this._setRowStatus(l,i);i!=h&&o.push({rowIndex:n,newRowStatus:i,oldRowStatus:h})}a.B.fireEvent(this,"onrowstatuschange",o),this.broadcast({gridView:["notifyModifyRangeStatus",[t,e,i]]})}catch(t){s.w.printStackTrace(t)}},l.prototype.modifyMatchedStatus=function(t,e,i){try{this._grid._dataList.modifyMatchedStatus(t,e,i)}catch(t){s.w.printStackTrace(t)}},l.prototype.modifyRowStatus=function(t,e){try{this._grid._dataList.modifyRowStatus(t,e)}catch(t){s.w.printStackTrace(t)}},l.prototype.setColumnFilter=function(t,e,i,a){try{"object"!==(0,o.Z)(t)||r.D.isString(t)||(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.setColumnFilter(t,e,i,a):this._grid._dataList.setColumnFilter(t,e,i,a)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.removeColumnFilter=function(t){try{t=this._grid.getColumnID(t);this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilter(t,{internal:!0}):this._grid._dataList.removeColumnFilter(t,{internal:!0})}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.clearSortFilter=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSortFilter():this._grid._dataList.clearSortFilter()}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.removeColumnFilterAll=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilterAll():this._grid._dataList.removeColumnFilterAll()}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.setFilter=function(t){try{if(this._grid._linkedDataList)t.internal=!0,this._grid._linkedDataList.setFilter(t);else{if(t){var e=this._grid.getColumnID(t.sortIndex),i=this._grid.cellInfoHash[e]||{options:{}};if(t.isExpressionArr=[],t.cellInfoArr=[],t.gridId=this._grid.id,i&&"expression"==i.options.inputType&&"gridView"==this._grid.initializeType&&isNaN(this._grid._dataList.getColumnIndex(t.sortIndex))&&(t.fakeExpressionArr=this._grid.getFakeExpressionArr()),e){var o=e.split(" "),a=[];t.isCustomCol=[],t.sortLabel=[];for(var r=0;r<o.length;r++){i=this._grid.cellInfoHash[o[r]];var n=!1;if("custom"!=i.options.inputType||i.internal?"expression"==i.options.inputType?(t.isExpression=!0,t.isExpressionArr.push(!0)):t.isExpressionArr.push(!1):(n=!0,t.isExpressionArr.push(!1)),t.cellInfoArr.push(o[r]),n)if(t.isCustomCol.push(!0),t.customSortItemsetIdObj=[],i.options.sortLabel){for(var l=this.getTotalRow(),h={},d={},u=0;u<l;u++){var p=i.cellManagerHashByRowIndex[u]?i.cellManagerHashByRowIndex[u]:i;if("select"==p.options.inputType||"autoComplete"==p.options.inputType){var c=p.dataComp;if(c&&!h[c])"linkedDataList"==(g=this._grid.modelControl.getDataComp(c)).initializeType?h[c]=g._dataList.getAllJSON():h[c]=g.getAllJSON();d[u]=c,t.customSortItemsetIdObj[u]={label:p.itemsetObj.label,value:p.itemsetObj.value}}else d[u]=""}t.customCellDataListInfo=d,t.customDataListInfoHash=h,
t.sortLabel.push(!0)}else a[r]=[],t.sortLabel.push(!1);else if(t.isCustomCol.push(!1),!i.options.sortLabel||"select"!=i.options.inputType&&"autoComplete"!=i.options.inputType)a[r]=[],t.sortLabel.push(!1);else{var g;if(i.dataComp)"linkedDataList"==(g=this._grid.modelControl.getDataComp(i.dataComp)).initializeType?a[r]=g._dataList.getAllJSON():a[r]=g.getAllJSON();else a[r]=i.getItemArray();t.sortItemsetIdObj={label:i.itemsetObj.label,value:i.itemsetObj.value},t.sortLabel.push(!0)}}a.length>0&&(t.sortItemArr=a)}}t.internal=!0,this._grid._dataList.setFilter(t),"outfocus"==t.focuseMode&&this._grid.setScrollTop(0)}}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.removeFilter=function(t,e){try{t&&(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.removeFilter(t,e):this._grid._dataList.removeFilter(t,e)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.clearFilter=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.clearFilter(t):this._grid._dataList.clearFilter(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.sort=function(t,e){try{this._grid._linkedDataList?this._grid._linkedDataList.sort(t,e):this._grid._dataList.sort(t,e)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.clearSort=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSort():(this._grid._dataList.clearSort(),"outfocus"==this._grid.options.filterFocusMode&&this._grid.setScrollTop(0))}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.multisort=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.multisort(t):this._grid._dataList.multisort(t)}catch(t){s.w.printStackTrace(t,null,this)}},l.prototype.setMatchIgnoreCase=function(t){try{return this._grid._dataList.setMatchIgnoreCase(t)}catch(t){s.w.printStackTrace(t)}},l.prototype.mappingCommonAPI=function(){try{this._grid._getData=this._getData,this._grid._getRowData=this._getRowData,this._grid._setCellData=this._setCellData,this._grid._setOriginalCellData=this._setOriginalCellData,this._grid._insertData=this._insertData,this._grid._undoRow=this._undoRow,this._grid._getRowStatusValue=this._getRowStatusValue,this._grid._getRowStatus=this._getRowStatus,this._grid._setRowStatus=this._setRowStatus,this._grid._createRowStatus=this._createRowStatus,this._grid._updateRowStatus=this._updateRowStatus,this._grid._deleteRowStatus=this._deleteRowStatus,this._grid._undeleteRowStatus=this._undeleteRowStatus,this._grid.getRowJSON=this.getRowJSON,this._grid.getRowCount=this.getRowCount,this._grid.getCellData=this.getCellData,this._grid._getCellData=this._getCellData,this._grid.getOriginalCellData=this.getOriginalCellData,this._grid.getColData=this.getColData,this._grid.getRowData=this.getRowData,this._grid.getDataRow=this.getDataRow,this._grid.getMatchedData=this.getMatchedData,this._grid.getUnmatchedData=this.getUnmatchedData,this._grid.getMatchedColumnData=this.getMatchedColumnData,this._grid.getUnmatchedColumnData=this.getUnmatchedColumnData,this._grid.getMatchedIndex=this.getMatchedIndex,this._grid.getUnmatchedIndex=this.getUnmatchedIndex,this._grid.getRangeData=this.getRangeData,this._grid.getAllData=this.getAllData,this._grid.getColumnDistinctDataArray=this.getColumnDistinctDataArray,this._grid.getRangeXML=this.getRangeXML,this._grid.getMatchedXML=this.getMatchedXML,this._grid.getUnmatchedXML=this.getUnmatchedXML,this._grid.getRowXML=this.getRowXML,this._grid.getAllXML=this.getAllXML,this._grid.getRowJSON=this.getRowJSON,this._grid.getAllJSON=this.getAllJSON,this._grid.getRangeJSON=this.getRangeJSON,this._grid.getMatchedJSON=this.getMatchedJSON,this._grid.getUnmatchedJSON=this.getUnmatchedJSON,this._grid.getRowStatusValue=this.getRowStatusValue,this._grid.getRowStatus=this.getRowStatus,this._grid.getRowIndexByStatus=this.getRowIndexByStatus,this._grid.getInsertedIndex=this.getInsertedIndex,this._grid.getUpdatedIndex=this.getUpdatedIndex,this._grid.getDeletedIndex=this.getDeletedIndex,
this._grid.getModifiedIndex=this.getModifiedIndex,this._grid.getInsertedData=this.getInsertedData,this._grid.getInsertedXML=this.getInsertedXML,this._grid.getInsertedJSON=this.getInsertedJSON,this._grid.getDeletedData=this.getDeletedData,this._grid.getDeletedXML=this.getDeletedXML,this._grid.getDeletedJSON=this.getDeletedJSON,this._grid.getVoidData=this.getVoidData,this._grid.getVoidXML=this.getVoidXML,this._grid.getVoidJSON=this.getVoidJSON,this._grid.getOnlyDeletedData=this.getOnlyDeletedData,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedJSON=this.getOnlyDeletedJSON,this._grid.getUpdatedData=this.getUpdatedData,this._grid.getUpdatedXML=this.getUpdatedXML,this._grid.getUpdatedJSON=this.getUpdatedJSON,this._grid.getModifiedData=this.getModifiedData,this._grid.getModifiedXML=this.getModifiedXML,this._grid.getModifiedJSON=this.getModifiedJSON,this._grid.setMatchIgnoreCase=this.setMatchIgnoreCase}catch(t){s.w.printStackTrace(t,null,this)}}}}]);