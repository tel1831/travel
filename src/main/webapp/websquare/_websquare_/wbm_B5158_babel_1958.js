"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[1958],{1958:function(e,t,i){i.r(t),i.d(t,{treeview_virtual:function(){return u}});var o=i(1002),s=i(9122),a=i(8754),h=i(6079),n=function(){this.index=0,this.depthIndex=1,this.id="",this.label="",this.orgLabel="",this.value="",this.element=null,this.depth=-1,this.parentNode=null,this.childNodes=[],this._isRoot=null,this._hasChild=null,this._isLastChild=null,this.image="",this.selectedImage="",this.expandedImage="",this.checked=!1,this.folder=null,this.expandedNodes=[],this._isExpanded=!1};n.prototype.appendChild=function(e){if(e){var t=this;do{if(e==t)return!1;t=t.parentNode}while(t);if(e.parentNode){for(var i=0;i<e.parentNode.expandedNodes.length;i++){if(e==e.parentNode.expandedNodes[i]){e.parentNode.expandedNodes.splice(i,1);break}}e.parentNode.removeChild(e)}return e.parentNode=this,this.childNodes.push(e),!0}},n.prototype.removeChild=function(e){if(e){for(var t=[],i=0;i<this.childNodes.length;i++){var o=this.childNodes[i];o!=e&&t.push(o)}this.childNodes=t}},n.prototype.isRoot=function(){return this._isRoot=null,this._isRoot=null==this.parentNode,this._isRoot},n.prototype.hasChild=function(){return this._hasChild=null,this.folder?this.folder:(this._hasChild=0!=this.childNodes.length,this._hasChild=0!=this.childNodes.length,this._hasChild)},n.prototype.isLeaf=function(){return!this.hasChild()},n.prototype.isFirstChild=function(){var e=!1;return this.parentNode?(this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},n.prototype.isLastChild=function(){if(this._isLastChild=null,!this.parentNode)return!0;var e=this.parentNode.childNodes;return e[e.length-1]==this&&(this._isLastChild=!0),1!=this._isLastChild&&(this._isLastChild=!1),this._isLastChild},n.prototype.hasSibling=function(){return this._isLastChild=null,!!this.parentNode&&1!=this.parentNode.childNodes.length},n.prototype.isExpanded=function(){if(this._isExpanded=!1,this.hasChild()){for(var e=0;e<this.parentNode.expandedNodes.length;e++)if(this.index==this.parentNode.expandedNodes[e].index){this._isExpanded=!0;break}return this._isExpanded}return!1},n.prototype.isFirstChildByRoot=function(){var e=!1;return this.parentNode?(0!=this.parentNode.depth||this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},n.prototype._getAncestor=function(){for(var e=this;null!=e;e=e.parentNode)if(e.depth<=1)return e},(n.nodeIterator=function(e,t){this.node=e,this.status=0,this.options=s.x.extend({type:"dfs",pruning:null},s.x.extend({},t)),this.stack=[]}).prototype.next=function(){return!!this.node&&(0==this.status?(this.status=1,!0):("dfs"==this.options.type?(this.stack=this.node.childNodes.concat(this.stack),this.node=this.stack.shift()):"bfs"==this.options.type&&(this.stack=this.stack.concat(this.node.childNodes),this.node=this.stack.shift()),!!this.node))},n.nodeIterator.prototype.stop=function(){this.status=2},n.nodeIterator.prototype.getNode=function(){return this.node};var l=function(){this.nodeCount=0,this.rootNode=null,this.hash_index_node={},this.useXPath=!1,this.useCheckbox=!1,this.useImage=!1;var e="w2:";this.xpath={nodeset:"",label:e+"label",value:e+"value",depth:e+"depth",nodeName:e+"node",checkbox:"",folder:e+"folder"},this.dataPath={},this.imageXPath={image:"",iconImage:"",leafImage:"",selectedImage:"",expandedImage:""},this.checkbox={xpath:"",trueValue:"",falseValue:"",checkboxDisabled:"",checkboxDisabledTrueValue:"",checkboxDisabledFalseValue:"",checkboxDisabledAll:""},this.valueAttribute="",this.displayMode="0",this.delimiter="\t",this.customFormatter="",this.treeView="",this.maxDepth=-1,this.isInstance=!1};l.prototype.getNodeset=function(){if(""!=this.xpath.nodeset)return this.xpath.nodeset},l.prototype.setXPath=function(e,t,i,o,s,a,h){""!=e&&(this.useXPath=!0,this.xpath.nodeset=e,this.xpath.label=t,this.xpath.value=i,this.xpath.depth=o,this.xpath.nodeName=s,this.xpath.folder=a,this.xpath.auth=h)},
l.prototype.setDataPath=function(e,t,i,o,s,a){this.dataPath.label=e,this.dataPath.value=t,this.dataPath.depth=i,this.dataPath.nodeName=o,this.dataPath.folder=s,this.dataPath.checkbox=a},l.prototype.setCheckbox=function(e,t,i,o,s,a,h,n,l,d,r){""!=e&&(this.useCheckbox=!0,this.checkbox.xpath=e,this.checkbox.trueValue=t,this.checkbox.falseValue=i,this.checkbox.checkboxDisabled=o,this.checkbox.checkboxDisabledTrueValue=s,this.checkbox.checkboxDisabledFalseValue=a,this.checkbox.checkboxDisabledAll=h,this.checkbox.refreshCheckboxModel=n,this.checkbox.refreshCheckboxDisableModel=l,this.checkbox.hierarchy=d,this.checkbox.colID=r)},l.prototype.setDisplayMode=function(e,t){this.displayMode=e,this.delimiter=t},l.prototype.setImage=function(e,t,i,o,s,a){this.useImage=!0,this.imageXPath.image=e||"",this.imageXPath.iconImage=t||"",this.imageXPath.leafImage=i||"",this.imageXPath.selectedImage=o||"",this.imageXPath.expandedImage=s||"",this.imageXPath.imageTitle=a||""},l.prototype.setXML=function(e){e&&(this.nodeCount=0,this.rootNode=null,this.hash_index_node={},1==this.isInstance?(this.rootNode=this.parseNodeInstance(e,0,0),1==this.useImage&&this.parseImageInstance(this.rootNode)):(this.rootNode=this.parseNode(e,0,0),1==this.useImage&&this.parseImage(this.rootNode)))},l.prototype.setDataList=function(e){var t=a.D.getComponentById(e);if(t){this.rootNode=new n,this.nodeCount=0,this.hash_index_node[this.rootNode.index]=this.rootNode,this.dataType="list";for(var i=t.getAllFilteredJSON(),o=this.rootNode,s=0;s<i.length;s++){var l=i[s],d=parseInt(l[this.dataPath.depth],10)||0,r=o.depth,c=new n;c.index=++this.nodeCount,c.depth=d,c.element=l,c.orgLabel=l[this.dataPath.label],c.label=l[this.dataPath.label],c.value=l[this.dataPath.value],c.folder=l[this.dataPath.folder];var p=c.label;switch(this.displayMode){case"0":default:c.label=p;break;case"1":c.label=c.value+this.delimiter+p;break;case"2":c.label=p+this.delimiter+c.value}if(1==this.useCheckbox&&l[this.dataPath.checkbox])if(l[this.dataPath.checkbox].wq_trim()==this.checkbox.trueValue?(c.checked=!0,1==this.checkbox.refreshCheckboxModel&&t.setCellData(s,this.dataPath.checkbox,this.checkbox.trueValue)):(c.checked=!1,1==this.checkbox.refreshCheckboxModel&&t.setCellData(s,this.dataPath.checkbox,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){var u=l[this.checkbox.checkboxDisabled].wq_trim();1==this.checkbox.checkboxDisabledAll?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(s,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledTrueValue)):(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(s,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledFalseValue)),u==this.checkbox.checkboxDisabledTrueValue?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(s,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledTrueValue)):u==this.checkbox.checkboxDisabledFalseValue&&(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(s,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledFalseValue))}if("function"==typeof this.customFormatter){var f=this.customFormatter,m=this.getCloneNode(c);c.label=f.call(this.treeview,c.orgLabel,c.label,m)||c.label}if(d<=0&&h.k.printLog("["+e+"] depth 값은 양의정수여야 합니다. (1 이상)"),r<d)o.appendChild(c);else if(r==d)o.parentNode.appendChild(c);else if(r>d){o=o.parentNode;for(var g=0;g<r-d&&null!=o.parentNode;g++)o=o.parentNode;o.appendChild(c)}o=c}this.nodeCount++;(function e(t,i,o){if(o){o.depthIndex=i,o.depth=t,t>this.maxDepth&&(this.maxDepth=t);for(var s=1,a=0;a<o.childNodes.length;a++)e.call(this,t+1,s,o.childNodes[a]),s++;this.hash_index_node[o.index]=o}}).call(this,0,0,this.rootNode),1==this.useImage&&this.parseDataListImage(this.rootNode)}},l.prototype.setData=function(e){if(e&&null!=e.data)switch(this.nodeCount=0,this.rootNode=null,this.hash_index_node={},e.type){case"dataList":this.setDataList(e.data);break
;case"xmlInstance":case"inlineXML":this.setXML(e.data)}},l.prototype.appendXML=function(e,t){if(e){var i=this.findNodeByIndex(t),o=i.element,s=1;if(1==this.isInstance){for(var a=e.firstChild;null!=a;a=e.firstChild)1==a.nodeType&&a.tagName==this.xpath.nodeName&&i.appendChild(this.parseNodeInstance(a,i.depth+1,s++,i)),o.appendChild(e.removeChild(a));1==this.useImage&&this.parseImageInstance(i)}else{for(var h=e.getChildNodes(),n=0;n<h.length;n++)1==(a=h[n]).nodeType&&a.getTagName()==this.xpath.nodeName&&i.appendChild(this.parseNode(a,i.depth+1,s++,i)),o.appendChild(e.removeChild(a));1==this.useImage&&this.parseImage(i)}return i}},l.prototype.parseNode=function(e,t,i,o){if(!e)return null;var s=WebSquare.jsonUtil.getValue(e._element,this.xpath.label,this.valueAttribute),a=null,h=this.xpath.auth&&WebSquare.jsonUtil.getValue(e._element,this.xpath.auth,this.valueAttribute);if(this.xpath.folder)a=WebSquare.jsonUtil.getValue(e._element,this.xpath.folder,this.valueAttribute);for(var l="",d=this.xpath.value.split(" "),r=0;r<d.length;r++)0!=r&&(l+="$$"),l+=WebSquare.jsonUtil.getValue(e._element,d[r],this.valueAttribute);var c=new n;switch(c.index=this.nodeCount++,c.depthIndex=i,this.displayMode){case"0":default:c.label=s;break;case"1":c.label=l+this.delimiter+s;break;case"2":c.label=s+this.delimiter+l}if(c.orgLabel=c.label,c.value=l,c.element=e,c.depth=t,c.folder=a,c.auth=h,t>this.maxDepth&&(this.maxDepth=t),1==t?this.xpath.value?c.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+c.value+"']":c.xpath=this.xpath.nodeset:t>1&&("recursive"==this.dataType?this.xpath.value?c.xpath=o.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+c.value+"']":c.xpath=o.xpath+"/"+this.xpath.nodeName:this.xpath.value?c.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+c.value+"']":c.xpath=this.xpath.nodeset),1==this.useCheckbox){var p=WebSquare.jsonUtil.getValue(e._element,this.checkbox.xpath,this.valueAttribute);if(c.checkboxXPath=c.xpath+"/"+this.checkbox.xpath,p==this.checkbox.trueValue?(c.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxXPath,this.checkbox.trueValue)):(c.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){c.checkboxDisableXPath=c.xpath+"/"+this.checkbox.checkboxDisabled;var u=WebSquare.jsonUtil.getValue(e._element,this.checkbox.checkboxDisabled,this.valueAttribute);1==this.checkbox.checkboxDisabledAll?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),u==this.checkbox.checkboxDisabledTrueValue?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):u==this.checkbox.checkboxDisabledFalseValue&&(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}var f=1,m=e.getChildNodes();for(r=0;r<m.length;r++){var g=m[r];1==g.nodeType&&g.getTagName()==this.xpath.nodeName&&c.appendChild(this.parseNode(g,t+1,f++,c))}if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var b=0,x=!1;for(r=0;r<c.childNodes.length;r++){var v=c.childNodes[r];1==v.checked?b++:1==v.partial&&(x=!0)}1==x||0<b&&b<c.childNodes.length?c.partial=!0:b>0&&b==c.childNodes.length?(c.checked=!0,c.checkboxDom||(c.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+c.index)),c.checkboxDom&&(c.checkboxDom.checked=!0)):c.partial=!1}if(this.hash_index_node[c.index]=c,"function"==typeof this.customFormatter){
var y=this.customFormatter,N=this.getCloneNode(c),_=y.call(this.treeview,c.orgLabel,c.label,N)||c.label;c.label=_}return c},l.prototype.parseNodeInstance=function(e,t,i,o){if(!e)return null;var s=WebSquare.xml.getValue(e,this.xpath.label).wq_trim(),h=null,l=this.xpath.auth&&WebSquare.xml.getValue(e,this.xpath.auth).wq_trim();this.xpath.folder&&(h=a.D.getBoolean(WebSquare.xml.getValue(e,this.xpath.folder).wq_trim()));for(var d="",r=this.xpath.value.split(" "),c=0;c<r.length;c++)0!=c&&(d+="$$"),d+=WebSquare.xml.getValue(e,r[c]).wq_trim();var p=new n;switch(p.index=this.nodeCount++,p.depthIndex=i,this.displayMode){case"0":default:p.label=s;break;case"1":p.label=d+this.delimiter+s;break;case"2":p.label=s+this.delimiter+d}if(p.orgLabel=p.label,p.value=d,p.element=e,p.depth=t,p.folder=h,p.auth=l,t>this.maxDepth&&(this.maxDepth=t),1==t?this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset:t>1&&("recursive"==this.dataType?this.xpath.value?p.xpath=o.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+p.value+"']":p.xpath=o.xpath+"/"+this.xpath.nodeName:this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset),1==this.useCheckbox){var u=WebSquare.xml.getValue(e,this.checkbox.xpath).wq_trim();if(p.checkboxXPath=p.xpath+"/"+this.checkbox.xpath,u==this.checkbox.trueValue?(p.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.trueValue)):(p.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){p.checkboxDisableXPath=p.xpath+"/"+this.checkbox.checkboxDisabled;var f=WebSquare.xml.getValue(e,this.checkbox.checkboxDisabled).wq_trim();1==this.checkbox.checkboxDisabledAll?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),f==this.checkbox.checkboxDisabledTrueValue?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):f==this.checkbox.checkboxDisabledFalseValue&&(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}for(var m=0,g=e.firstChild;null!=g;g=g.nextSibling)1==g.nodeType&&g.tagName==this.xpath.nodeName&&p.appendChild(this.parseNodeInstance(g,t+1,m++,p));if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var b=0,x=!1;for(c=0;c<p.childNodes.length;c++){var v=p.childNodes[c];1==v.checked?b++:1==v.partial&&(x=!0)}1==x||0<b&&b<p.childNodes.length?p.partial=!0:b>0&&b==p.childNodes.length?(p.checked=!0,p.checkboxDom||(p.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+p.index)),p.checkboxDom&&(p.checkboxDom.checked=!0)):p.partial=!1}if(this.hash_index_node[p.index]=p,"function"==typeof this.customFormatter){var y=this.customFormatter,N=this.getCloneNode(p),_=y.call(this.treeview,p.orgLabel,p.label,N)||p.label;p.label=_}return p},l.prototype.parseNodeByNode=function(e,t,i,o){if(!e)return null;var s=new n;s.index=++this.nodeCount,s.depthIndex=i,s.parentNode=o,s.label=e.label,s.orgLabel=s.label,s.value=e.value,s.element=this.getCloneNodeElemnt(e.element),s.depth=t,s.folder=e.folder,s.xpath="",s.checkboxXPath="",s.selectedImage=e.selectedImage,s.expandedImage=e.expandedImage,s.image=e.image,s.imageTitle=e.imageTitle,s.labelStyle=e.labelStyle,s.expandedNodes=e.expandedNodes.splice(0),void 0!==e.checked&&(s.checked=e.checked),s.checkboxDisableXPath="",void 0!==e.checkboxDisabled&&(s.checkboxDisabled=e.checkboxDisabled)
;for(var a=1,h=0;h<e.childNodes.length;h++)s.appendChild(this.parseNodeByNode(e.childNodes[h],t+1,a++,s,o));return this.hash_index_node[s.index]=s,s},l.prototype.parseImage=function(e){var t="",i="",o="",s="",a="",h=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(h)?this.imageXPath.image:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.image,this.valueAttribute)),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(h)?this.imageXPath.iconImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.iconImage,this.valueAttribute)),""!=this.imageXPath.selectedImage&&(o=this.imageXPath.selectedImage.match(h)?this.imageXPath.selectedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.selectedImage,this.valueAttribute)),""!=this.imageXPath.expandedImage&&(s=this.imageXPath.expandedImage.match(h)?this.imageXPath.expandedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.expandedImage,this.valueAttribute)),""!=this.imageXPath.leafImage&&(a=this.imageXPath.leafImage.match(h)?this.imageXPath.leafImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.leafImage,this.valueAttribute)),""!=a&&1==e.isLeaf()&&(t=a),""!=i&&(t=i,o=i,s=i),""==o&&(o=t),""==s&&(s=t),e.image=t,e.selectedImage=o,e.expandedImage=s,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.imageTitle,this.valueAttribute);for(var n=0;n<e.childNodes.length;n++)this.parseImage(e.childNodes[n])},l.prototype.parseImageInstance=function(e){var t="",i="",o="",s="",a="",h=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(h)?this.imageXPath.image:WebSquare.xml.getValue(e.element,this.imageXPath.image).wq_trim()||""),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(h)?this.imageXPath.iconImage:WebSquare.xml.getValue(e.element,this.imageXPath.iconImage).wq_trim()||""),""!=this.imageXPath.selectedImage&&(o=this.imageXPath.selectedImage.match(h)?this.imageXPath.selectedImage:WebSquare.xml.getValue(e.element,this.imageXPath.selectedImage).wq_trim()||""),""!=this.imageXPath.expandedImage&&(s=this.imageXPath.expandedImage.match(h)?this.imageXPath.expandedImage:WebSquare.xml.getValue(e.element,this.imageXPath.expandedImage).wq_trim()||""),""!=this.imageXPath.leafImage&&(a=this.imageXPath.leafImage.match(h)?this.imageXPath.leafImage:WebSquare.xml.getValue(e.element,this.imageXPath.leafImage).wq_trim()||""),""!=a&&1==e.isLeaf()&&(t=a),""!=i&&(t=i,o=i,s=i),""==o&&(o=t),""==s&&(s=t),e.image=t,e.selectedImage=o,e.expandedImage=s,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.xml.getValue(e.element,this.imageXPath.imageTitle);for(var n=0;n<e.childNodes.length;n++)this.parseImageInstance(e.childNodes[n])},l.prototype.parseDataListImage=function(e,t){var i="",o="",s="",a="",h="",n=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;if(""!=this.imageXPath.image&&(i=this.imageXPath.image.match(n)?this.imageXPath.image:e.element?e.element[this.imageXPath.image].wq_trim():""),""!=this.imageXPath.iconImage&&(o=this.imageXPath.iconImage.match(n)?this.imageXPath.iconImage:e.element?e.element[this.imageXPath.iconImage].wq_trim():""),""!=this.imageXPath.selectedImage&&(s=this.imageXPath.selectedImage.match(n)?this.imageXPath.selectedImage:e.element?e.element[this.imageXPath.selectedImage].wq_trim():""),""!=this.imageXPath.expandedImage&&(a=this.imageXPath.expandedImage.match(n)?this.imageXPath.expandedImage:e.element?e.element[this.imageXPath.expandedImage].wq_trim():""),""!=this.imageXPath.leafImage&&(h=this.imageXPath.leafImage.match(n)?this.imageXPath.leafImage:e.element?e.element[this.imageXPath.leafImage].wq_trim():""),""!=h&&1==e.isLeaf()&&(i=h),""!=o&&(i=o,s=o,a=o),""==s&&(s=i),""==a&&(a=i),e.image=i,e.selectedImage=s,e.expandedImage=a,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.imageTitle,this.valueAttribute),
!0!==t)for(var l=0;l<e.childNodes.length;l++)this.parseDataListImage(e.childNodes[l])},l.prototype.parseListToTree=function(e){for(var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=WebSquare.xmljs.xml2json(t).E[0],o=0;o<e.length;o++)e[o]._element.parent=i;var s=i,a=0;this.dataType="list";for(o=0;o<e.length;o++){s=new WebSquare.Elem(s);var h=e[o],n=parseInt(WebSquare.jsonUtil.getValue(h._element,this.xpath.depth,this.valueAttribute))||0;a=parseInt(WebSquare.jsonUtil.getValue(s._element,this.xpath.depth,this.valueAttribute))||0;if(0===n&&0!==a&&(h.setNodeValue(this.xpath.depth,a),n=a),a<n)h._element.parent=s._element,h=s.appendChild(h._element);else if(a==n&&0==o)h._element.parent=s._element,h=s.appendChild(h._element);else if(a==n){h._element.parent=s.getParentNode()._element,h=s.getParentNode().appendChild(h._element)}else if(a>n){s=s.getParentNode();for(var l=0;l<a-n;l++)null!=s._element.parent&&(s=s.getParentNode());s.element&&(s=s._element),h._element.parent=s._element,h=s.appendChild(h._element)}s=h}return new WebSquare.Elem(i)},l.prototype.parseListToTreeInstance=function(e){var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=t.documentElement,o=0;this.dataType="list";for(var s=0;s<e.length;s++){var a=e[s].cloneNode(!0),h=parseInt(WebSquare.xml.getValue(a,this.xpath.depth))||0;o=parseInt(WebSquare.xml.getValue(i,this.xpath.depth))||0;if(0===h&&0!==o&&(WebSquare.xml.setValue(a,this.xpath.depth,o),h=o),o<h)a=WebSquare.xml.appendChild(i,a),o=h;else if(o==h&&0==s)a=WebSquare.xml.appendChild(i,a);else if(o==h){var n=i.parentNode;a=WebSquare.xml.appendChild(n,a)}else if(o>h){i=i.parentNode;for(var l=0;l<o-h;l++)null!=i.parentNode&&(i=i.parentNode);i.documentElement&&(i=i.documentElement),a=WebSquare.xml.appendChild(i,a)}i=a}return t.documentElement},l.prototype.parseRecursiveToTree=function(e){this.dataType="recursive";var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0);if(e[0]instanceof WebSquare.Elem){for(var i=new WebSquare.Elem(WebSquare.xmljs.xml2json(t).E[0]),o=0;o<e.length;o++){var s=null;s=e[o],i.appendChild(s._element)}return i}for(o=0;o<e.length;o++){s=null;s=a.D.isOpera()?WebSquare.xml.parse(e[o]).firstChild:e[o].cloneNode(!0),WebSquare.xml.appendChild(t.documentElement,s)}return t.documentElement},l.prototype.parseTreeToList=function(){var e=this.xpath.nodeset;if(e.indexOf("/")>-1){var t=e.split("/");e=t[t.length-2]}e&&""!=e||(e="Treeview");var i=WebSquare.xml.parse("<"+e+' xmlns:w2="http://www.inswave.com/websquare" />',!0),o=i.documentElement,s=this.getNodeIterator({type:"dfs"});for(s.next();s.next();){var a=s.getNode();o.appendChild(a.element)}return i.documentElement},l.prototype.getNodeIterator=function(e){return e=s.x.extend({rootNode:null},e||{}),new n.nodeIterator(e.rootNode||this.rootNode,e)},l.prototype.size=function(){return this.nodeCount},l.prototype.findNodeByValue=function(e){for(var t=null,i=this.getNodeIterator(),o=0;i.next();){var s=i.getNode();if(!s.parentNode||1!=s.depth&&!0!==s.parentNode._isExpanded||o++,s.value==e){t=s;break}}return t&&(t._nodePosition=o),i=null,t},l.prototype.findNodeByIndex=function(e){var t=this.hash_index_node[e];return t||null},l.prototype.IterateFindNodeByIndex=function(e){for(var t=null,i=this.getNodeIterator(),o=0;i.next();){var s=i.getNode();if(!s.parentNode||1!=s.depth&&!0!==s.parentNode._isExpanded||o++,s.index==e){t=s;break}}return t&&(t._nodePosition=o),i=null,t},l.prototype.setRender=function(e,t){e.rendered=t;for(var i=0;i<e.childNodes.length;i++)this.setRender(e.childNodes[i],t)},l.prototype.getCloneNode=function(e){var t={};return t.checkboxDisabled=e.checkboxDisabled,t.checked=e.checked,t.folder=e.folder,t.image=e.image,t.imageTitle=e.imageTitle,t.rendered=e.rendered,t.id=e.id,t.index=e.index,t.value=e.value,t.label=e.label,t.labelStyle=e.labelStyle,t},l.prototype.getCloneNodeElemnt=function(e){var t={};return t.depth=e.depth,t.label=e.label,
t.value=e.value,t.rowStatus=e.rowStatus,t},l.prototype.clearNode=function(e,t){try{if(e.element=null,e.parentNode){this._removeNode(e.parentNode.expandedNodes,e),this._removeNode(e.parentNode.childNodes,e);for(var i=e.depthIndex-1;i<e.parentNode.childNodes.length;i++)e.parentNode.childNodes[i].depthIndex=i+1}e.parentNode=null,e.childNodes=[];var o=document.getElementById(t+"_node_"+e.index);o&&s.x.removeNode(o),delete this.hash_index_node[e.index]}catch(e){h.k.printLog("virtualTree.clearNode error : "+e.message)}},l.prototype.changeNodeIndex=function(e,t){var i=this.hash_index_node[e];i.index=t,delete this.hash_index_node[e],this.hash_index_node[t]=i,this.changeDomIndex("node",e,t,!0),this.changeDomIndex("checkbox",e,t),this.changeDomIndex("label",e,t),i.checkboxDom&&(i.checkboxDom=null,delete i.checkboxDom)},l.prototype.changeDomIndex=function(e,t,i,o){var s=document.getElementById(this.treeview.id+"_"+e+"_"+t);if(null!=s&&(s.setAttribute("id",this.treeview.id+"_"+e+"_"+i),o)){var h=a.D.getDataPrefix("index");s.setAttribute(h,i)}},l.prototype.getLastChildIndex=function(e){var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.size();for(var o=t;!o.isRoot()&&o.depthIndex==o.parentNode.childNodes.length;)o=o.parentNode;o.isRoot()||o.depthIndex==o.parentNode.childNodes.length||(i=o.parentNode.childNodes[o.depthIndex].index-1)}return i},l.prototype._removeNode=function(e,t){try{if(!(e instanceof Array&&t))return;for(var i=e.length-1;i>=0;i--)if(e[i]===t){e.splice(i,1);break}}catch(e){h.k.printLog("virtualTree._removeNode error : "+e.message)}},l.prototype._insertNode=function(e,t,i,o){try{if(!(e instanceof Array&&t&&i))return;for(var s=!0===o?1:0,a=e.length-1;a>=0;a--)if(e[a]===t){e.splice(a+s,0,i);break}}catch(e){h.k.printLog("virtualTree._insertNode error : "+e.message)}};var d=i(7827),r=i(1160),c=i(5841),p=i(5316),u=function(e,t,i){p.s.call(this,e,t,i)};s.x.extend(u.prototype,p.s.prototype),u.prototype.defaultOptions={pluginType:"uiplugin.treeview",pluginName:"treeview",renderType:"virtual",userEvents:["onclick","ondblclick","onchange","onrightbuttonclick","ondrop","oncheckboxclick","onlabelclick","onlabelover","ontoggleclick","onviewchange","oneditend"],toggleEvent:"ondblclick",useConfig:!0,hierarchy:!1,refreshCheckboxModel:!1,refreshCheckboxDisableModel:!1,displayMode:"0",delimiter:"\t",folderOpenToggleImage:s.x._resourceURI+"uiplugin/treeview/images/plus.png",folderCloseToggleImage:s.x._resourceURI+"uiplugin/treeview/images/minus.png",leafToggleImage:s.x._resourceURI+"uiplugin/treeview/images/middle.gif",lastToggleImage:s.x._resourceURI+"uiplugin/treeview/images/last.gif",middleToggleImage:s.x._resourceURI+"uiplugin/treeview/images/middle.gif",labelclass:"",labelonClickClass:"treeview_select_node",labelForCheckbox:!1,title:"",escape:!0,rowHeight:20,useDrag:!1,accordion:!1,dynamicAppend:!1,dataType:"recursive",lineShow:!0,alwaysDraw:!1,showTreeDepth:0,showCheckbox:!1,trueValue:"true",falseValue:"false",checkAllChildNodes:!1,checkboxDisabled:"",checkboxDisabledTrueValue:"true",checkboxDisabledFalseValue:"false",checkboxDisabledAll:!1,scrollFix:!1,tooltipDisplay:!1,tooltipShowAlways:!1,tooltipStyle:"border:2px solid #7BAFE4; background-color:#ffffff;cursor:default;",tooltipClass:"",tooltipTime:1,tooltipGroupClass:!0,redrawInterval:3,useHirarchySelect:!1,iwsSupport:!1},u.prototype.initialize=function(e){try{switch(this.inlineElement=!1,this.useDataCollection=!1,this.successBinding=!1,this.nativeScrollWidth=18,this.tooltip=null,this.timeShowTooltip=null,this.timeHideTooltip=null,this.tree=new l,this.tree.treeview=this,this.selectedInfo={groupDom:null,dom:null,node:null},this.resizeObj={width:0,height:0},this.tree.setData(this._getDataObj(e)),this._request=null,this._expandedNodes=[this.tree.rootNode],this._items=[],1==this.options.accordion&&(this.options.showTreeDepth=0),this._setExpandedLevel(),this._arrowDownPressed=!1,this._arrowUpPressed=!1,this._forceRedraw=!1,this.isMobile=a.D.isMobile(),this.touchDelta={x:0,y:0},
!0===this.options.hierarchy&&(this.options.checkAllChildNodes=!0),this.options.displayMode){case"0":case"1":case"2":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;default:this.options.displayMode="0"}this.tree.setDisplayMode(this.options.displayMode,this.options.delimiter),this.editModeComp=null,this.options=WebSquare.cssManager.styleToClass(this.id,this.options),1==this.options.showCheckbox&&(1==a.D.isOpera()?this.checkboxStyle="left:-1px;top:-1px":this.checkboxStyle="left:0px;top:0px"),this.options.useHirarchySelect&&(this.selectedInfoStack=[]),this._extraRow=0,this._bExtraRowRedraw=!1,this._epsilon=2,this._initMaxRowHeight(),this._bSkipScrollY=!1}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.finalize=function(){null!=this.editModeComp&&WebSquare.idCache[this.editModeComp.uuid]&&this.editModeComp.remove(),this._request=null;for(var e=0,t=this._items.length;e<t;e++)this._items[e]=null;this._items=null;for(e=0,t=this.dom.length;e<t;e++)this.dom[e]=null;for(var i in this.dom=null,this.selectedInfo)this.selectedInfo.hasOwnProperty(i)&&(this.selectedInfo[i]=null);this.selectedInfo=null;for(e=0,t=this.tree.size();e<t;e++)this.tree.hash_index_node[e]=null;for(var i in this.tree)this.tree.hasOwnProperty(i)&&(this.tree[i]=null);this.tree=null,p.s.removeCheckResize(this.uuid),p.s.prototype.finalize.call(this)},u.prototype._getData=function(e,t,i){try{for(var o=[],s=0,a=e.length;s<a;s++){var h=[];h=this.tree.hash_index_node[e[s].parent].childNodes.slice(0),o.push({parent:e[s].parent,items:h.splice(e[s].offset,e[s].limit)})}this._setData(t,i,o)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._setData=function(e,t,i){for(var o=[],s=0,a=i.length;s<a;s++){for(var h=i[s],n=-1,l=0,d=o.length;l<d;l++)if(o[l].index===h.parent){n=l;break}o=n>-1?o.slice(0,n+1).concat(h.items).concat(o.slice(n+1)):h.items.concat(o)}this._items=o,this._redraw(o,e,t)},u.prototype._expandNode=function(e){e.expandedNodes||(e.expandedNodes=[]);var t=e.parentNode;t&&!e.isExpanded()&&(t.expandedNodes.push(e),t._isExpanded=!0)},u.prototype._collapseNode=function(e){var t=e.parentNode;if(t&&e.isExpanded()){for(var i=-1,o=0,s=t.expandedNodes.length;o<s;o++){var a=t.expandedNodes[o];if(e.index===a.index){i=o;break}}t.expandedNodes.splice(i,1),t._isExpanded=!1}},u.prototype.redraw=function(e,t){var i=this.render.clientHeight||parseInt(this.render.style.height,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"height"),10),o=Math.floor(i/this.options.rowHeight)+this._extraRow,s=Math.ceil(this.getElementById(this.id+"_scrollY_div").scrollTop/this.options.rowHeight),a=this._buildTree(s,o);this._getData(a,e,t),this._items.length>0&&(this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight})},u.prototype._buildTree=function(e,t){var i=[];this._sortAllExpandedNodes(this._expandedNodes),this._calculateExpandedNodes(this._expandedNodes,0);return function o(s,a){for(var h=0,n=s.length;h<n;h++){var l=s[h];if(f=e,m=e+t,g=l._start,b=l._end,g<f&&b<f||g>m&&b>m)e>l._end&&a&&(a.offset-=l._end-l._start+1);else{var d=Math.max(e,l._start),r=Math.min(e+t-1,l._end),c=Math.max(0,Math.min(r-d+1,t));if(a&&(a.limit-=c,e>l._start)){var p=l._end-l._start+1-c;p>0&&(a.offset-=p)}var u={parent:l.index,offset:e>l._start?e-l._start:0,limit:Math.min(c,t)};i.push(u),o(l.expandedNodes,u)}}var f,m,g,b}(this._expandedNodes),i},u.prototype._iterateAllExpandedNodes=function(e,t){try{for(var i=0,o=e.length;i<o;i++)t(e[i]),this._iterateAllExpandedNodes(e[i].expandedNodes,t)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._findExpandedNodeByIndex=function(e){var t=null;return this._iterateAllExpandedNodes(this._expandedNodes,(function(i){i.index===e&&(t=i)})),t},u.prototype._sortAllExpandedNodes=function(e){try{e.sort((function(e,t){return e.depthIndex-t.depthIndex}));for(var t=0;t<e.length;t++)this._sortAllExpandedNodes(e[t].expandedNodes)}catch(e){r.w.printStackTrace(e,null,this)}},
u.prototype._calculateExpandedNodes=function(e,t){try{for(var i=0;i<e.length;i++){var o,s=e[i],a=e[i-1];o=a?a._end+1+(s.depthIndex-a.depthIndex):t+s.depthIndex,s._start=o;var h=s.childNodes.length;this._iterateAllExpandedNodes(s.expandedNodes,(function(e){h+=e.childNodes.length})),s._end=s._start+h-1,this._calculateExpandedNodes(s.expandedNodes,s._start)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._setExpandedLevel=function(){try{var e=0,t=null;if(1==this.options.alwaysDraw)for(e=0;e<this.tree.size();e++)t=this.tree.hash_index_node[e],this._expandNode(t);else for(e=0;e<this.tree.size();e++)(t=this.tree.hash_index_node[e]).depth<=this.options.showTreeDepth&&this._expandNode(t)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.toHTML=function(){try{var e=[],t=this.nativeScrollWidth+"px",i=""==this.options.style?"":"style='"+this.options.style+"'",o="style='right:"+t+";'",s="style='right:"+t+"; height:"+t+";'",a="style='width:"+t+";'";return e.push("<div id='"+this.id+"' tabindex='0'"+i+" class='w2treeview_virtual "+this.options.className+"'>"),e.push("  <div id='"+this.id+"_main_div' "+o+" class='w2treeview_virtual_main_div' >"),e.push("  </div>"),e.push("  <div id='"+this.id+"_scrollX_div' "+s+" class='w2treeview_virtual_scrollX_div'>"),e.push("      <div id='"+this.id+"_scrollX_scrollbar' style='width:1px; height:1px; visibility:hidden;'></div>"),e.push("  </div>"),e.push("  <div id='"+this.id+"_scrollY_div' "+a+" class='w2treeview_virtual_scrollY_div' >"),e.push("      <div id='"+this.id+"_scrollY_scrollbar' style='width:1px; height:1px; visibility:hidden;'></div>"),e.push("  </div>"),e.push("</div>"),e.join("")}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setAction=function(){try{var e;if(this.useDataCollection&&(e=this.modelControl.getDataComp())&&e._getDelayedRefreshComponent&&e._getDelayedRefreshComponent(this.id)&&(this.refreshItemset(),e._setDelayedRefreshComponent(this.id,!1)),this.dom[this.id+"_main_div"]=document.getElementById(this.id+"_main_div"),this.dom[this.id+"_scrollX_div"]=document.getElementById(this.id+"_scrollX_div"),this.dom[this.id+"_scrollX_scrollbar"]=document.getElementById(this.id+"_scrollX_scrollbar"),this.dom[this.id+"_scrollY_div"]=document.getElementById(this.id+"_scrollY_div"),this.dom[this.id+"_scrollY_scrollbar"]=document.getElementById(this.id+"_scrollY_scrollbar"),this.tree.rootNode?this.redraw(!0):this._updateScroll(),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblclickEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),this.event.addListener2(this.dom[this.id+"_main_div"],"onmousewheel",this.handleMouseWheelEvent,this),this.event.addListener2(this.dom[this.id+"_main_div"],"onscroll",this.fixScrollTop,this),this.options.iwsSupport?this.addClass("w2noselect"):this.event.addListener(this.render,"onselectstart",(function(e){c.B.stopEvent(e)})),this.event.addListener(this.render,"oncontextmenu",this.event.bindAsEventListener(this,this.handleContextmenuEvent)),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.activateDrag)),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener2(this.dom[this.id+"_scrollX_div"],"onscroll",this.handleScrollXEvent,this),this.event.addListener2(this.dom[this.id+"_scrollY_div"],"onscroll",this.handleScrollYEvent,this),this.refreshStop=!1,this.useDataCollection)(e=this.modelControl.getDataComp()).bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck));p.s.addCheckResize(this.uuid,"checkResize")}catch(e){r.w.printStackTrace(e,null,this)}},
u.prototype._redraw=function(e,t,i){try{for(var o=[],s=0,a=e.length;s<a;s++)o.push(this.nodeToHTML(e[s]));if(document.getElementById(this.id+"_main_div").innerHTML=o.join(""),1==t){var h=0;this._forceRedraw=!0,this._iterateAllExpandedNodes(this._expandedNodes,(function(e){h+=e.childNodes.length})),this._updateScroll(h)}i&&i.call(this)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._getNativeScrollWidth=function(){var e=document.createElement("div");e.style="overflow-y:scroll; visibility:hidden; width:100px;",document.body.appendChild(e);var t=document.createElement("div");e.appendChild(t);var i=100-t.offsetWidth;return document.body.removeChild(e),i},u.prototype._updateScroll=function(e){var t=this.getElementById(this.id+"_main_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_scrollX_div"),s=this.getElementById(this.id+"_scrollY_scrollbar"),a=this.getElementById(this.id+"_scrollX_scrollbar"),h=t.clientWidth,n=t.scrollWidth,l=this._getVisibleInfo(),d=l.height,r=h<n,c=r?this.nativeScrollWidth:0,p=e>t.childNodes.length||d>=t.offsetHeight-c,u=0;if(p){var f=Math.floor((t.offsetHeight-d)/this._minRowHeight);if(this._extraRow<f&&(this._extraRow=f,!0!==this._bExtraRowRedraw))return this._bExtraRowRedraw=!0,this.redraw(!0);var m=Math.max(t.offsetHeight-d-c,0),g=Math.floor(m/this.options.rowHeight);if((u=e-l.rowCount-g)<=0&&(u=0,p=!1,e-t.childNodes.length>0&&0===i.scrollTop)){var b=this._buildTree(0,e);return this._getData(b)}}this._bExtraRowRedraw=!1,i.style.visibility=p?"visible":"hidden",t.style.right=p?this.nativeScrollWidth+"px":0,o.style.visibility=r?"visible":"hidden",o.style.right=p?this.nativeScrollWidth+"px":0;var x=u*this.options.rowHeight+t.offsetHeight,v=p?n+this.nativeScrollWidth:n;s.style.height=x+"px",a.style.width=v+"px"},u.prototype.expandNode=function(e,t,i){try{var o=null;if(o="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e),this._expandNode(o),t)for(var s=0,a=o.childNodes.length;s<a;s++)this.expandNode(o.childNodes[s].index,t);this.refreshStop||!0===i||this.redraw(!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.collapseNode=function(e,t){try{var i=null;if(i="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e),this._collapseNode(i),t)for(var o=0,s=i.childNodes.length;o<s;o++)this.collapseNode(i.childNodes[o].index,t);this.redraw(!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.findNodeByValue=function(e,t){try{var i=this.tree.findNodeByValue(e);if(!0===t&&i){var o=i._nodePosition*this.options.rowHeight,s=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight,a=this.dom[this.id+"_scrollY_div"].scrollTop;return s<o?(a+s<o||a>=o)&&(this.dom[this.id+"_scrollY_div"].scrollTop=o-s+parseInt(this.render.offsetHeight/2)):(a+s<o||a>=o)&&(this.dom[this.id+"_scrollY_div"].scrollTop=0),this.selectNode(e,null),this.getSelectedNode()}return i}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.findNodeByIndex=function(e,t){try{if(!0===t){if(!this.tree.findNodeByIndex(e))return;var i=this.tree.IterateFindNodeByIndex(e)._nodePosition*this.options.rowHeight,o=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight,s=this.dom[this.id+"_scrollY_div"].scrollTop;return o<i?(s+o<i||s>=i)&&(this.dom[this.id+"_scrollY_div"].scrollTop=i-o+parseInt(this.render.offsetHeight/2)):(s+o<i||s>=i)&&(this.dom[this.id+"_scrollY_div"].scrollTop=0),this.selectNode(null,e),this.getSelectedNode()}return this.tree.findNodeByIndex(e)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.toggleChild=function(e,t,i){try{var o;if(null==t&&(t=-1),null!=e&&(o=this.tree.findNodeByValue(e))&&(t=o.index),o=this.tree.findNodeByIndex(t),1==this.options.accordion)for(var s=o._getAncestor(),a=1,h=this.tree.size();a<h;a++)this.tree.hash_index_node[a]._getAncestor()!=s&&this._collapseNode(this.tree.hash_index_node[a]);switch(i){case!0:this._expandNode(o);break;case!1:this._collapseNode(o);break;default:
o.isExpanded()?this._collapseNode(o):this._expandNode(o)}this.redraw(!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.appendData=function(e,t,i){try{if(0==this.options.dynamicAppend&&$l("treeview를 동적으로 처리하는 경우에는  dynamicAppend='true'로 설정하는 것을 권장합니다.["+this.id+"]"),void 0===e||null==e||!t)return;i=void 0!==i&&i;var o=this.tree.findNodeByIndex(e);if(!i&&o.childNodes&&o.childNodes[0]&&o.childNodes[0].rendered)return;var s=null;"recursive"==this.options.dataType?s=this.tree.parseRecursiveToTree(t):"listed"==this.options.dataType&&(s=this.tree.parseListToTree(t)),this.tree.appendXML(s,e),0==e?(o.hasChild(),this.redraw()):o.childNodes.length>0&&(o.childNodes[0].rendered=!1,this.toggleChild(null,o.index,!0))}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.spanAll=function(e){try{if(1==this.options.accordion)return void $l("treeview의 accordion 모드에서는 spanAll API를 지원하지 않습니다.["+this.id+"]");var t=this.tree.size();if(1==e)for(var i=0;i<t;i++)this._expandNode(this.tree.hash_index_node[i]);else if(0==e)for(i=t-1;i>=0;i--)this.tree.hash_index_node[i].expandedNodes=[];this.redraw(!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.spanNode=function(e,t,i){try{return null==e&&null==t&&null==i?void 0:null==t&&null==i&&"object"===(0,o.Z)(e)?this._spanNode(e):null==i&&"object"===(0,o.Z)(e)&&"boolean"==typeof t?this._spanNode(e,t):this._spanNode({index:e,applyChildNodes:i},t)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._spanNode=function(e,t){try{if(1==this.options.accordion)return void $l("treeview의 accordion 모드에서는 spanNode API를 지원하지 않습니다.["+this.id+"]");var i=e.index,o=e.depth,s=e.applyChildNodes;if(0==i||i){var a=(d=this.findNodeByIndex(i)).childNodes;if(1==t){if(1==s)for(var h=0;h<a.length;h++)a[h].childNodes.length>0&&this.spanNode(a[h].index,t,s)}else if(0==t&&1==s)for(h=a.length-1;h>=0;h--)a[h].childNodes.length>0&&this.spanNode(a[h].index,t,s);this.toggleChild(null,i,t)}else if(0==o||o)for(var n=0,l=this.tree.nodeCount;n<l;n++){var d;if((d=this.tree.hash_index_node[n]).depth===o){if("boolean"==typeof s)for(var c=d.childNodes,p=(h=0,c.length);h<p;h++)c[h].childNodes.length>0&&this.spanNode(c[h].index,t,s);this.toggleChild(null,d.index,t)}}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.selectNode=function(e,t,i,s,h){try{"object"===(0,o.Z)(h)&&null!=h||(h={});i=void 0===i||i;var n=a.D.getBoolean(this.options.useHirarchySelect),l=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,d=null;if(null!=e?d=this.tree.findNodeByValue(e):null!=t&&(d=this.tree.findNodeByIndex(t)),this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor,""!=this.selectedInfo.node.image)){var p=this.selectedInfo.node,u=document.getElementById(this.id+"_icon_"+p.index),f=p.isExpanded()?p.expandedImage:p.image;if(u){var m=this.getURL(f);u.style="background-image:url("+m+")"}}if(n&&this.selectedInfoStack.length>0){for(var g=0;g<this.selectedInfoStack.length;g++){var b=this.selectedInfoStack[g];b.dom&&(this.removeClass(b.dom,this.options.labelonClickClass),b.dom.style.backgroundColor=b.org.background,b.dom.style.color=b.org.color)}this.selectedInfoStack=[]}if(null!=l&&null!=d?l.index!=d.index&&c.B.fireEvent(this,"onchange",l,d):(null==l&&null!=d||null!=l&&null==d)&&c.B.fireEvent(this,"onchange",l,d),this.selectedInfo.node=d,null!=this.selectedInfo.node&&i){for(var x=this.selectedInfo.node.parentNode,v=[];x;){t=x.index;v.push(t),x=x.parentNode}for(var g in v.reverse(),v)this._expandNode(this.findNodeByIndex(v[g]));this.redraw(!0)}if(this.selectedInfo.dom=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),this.selectedInfo.groupDom=document.getElementById(this.id+"_node_"+this.selectedInfo.node.index),this.addClass(this.selectedInfo.dom,this.options.labelonClickClass),
""!=this.selectedInfo.node.image&&""!=this.selectedInfo.node.selectedImage){u=document.getElementById(this.id+"_icon_"+this.selectedInfo.node.index);this.originalIconImage=u.style;m=this.getURL(this.selectedInfo.node.selectedImage);u.style="background-image:url("+m+")"}if(this.selectedInfo.dom){if(this.originalBackgroundColor=this.selectedInfo.dom.style.backgroundColor,this.originalColor=this.selectedInfo.dom.style.color,n){for(x=this.selectedInfo.node;x;){var y=document.getElementById(this.id+"_label_"+x.index);this.selectedInfoStack.push({node:x,groupDom:document.getElementById(this.id+"_node_"+x.index),dom:y,org:{background:y?y.style.backgroundColor:null,color:y?y.style.color:null}}),this.selectedInfoStack[this.selectedInfoStack.length-1].dom&&(this.addClass(this.selectedInfoStack[this.selectedInfoStack.length-1].dom,this.options.labelonClickClass),this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.backgroundColor="",this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.color=""),x=x.parentNode}this.selectedInfoStack.reverse()}this.selectedInfo.dom.style.backgroundColor="",this.selectedInfo.dom.style.color=""}if(!0!==s){if(this.options.scrollFix)this.render.focus();else if(this.selectedInfo.groupDom&&(this.selectedInfo.groupDom.setAttribute("tabindex",0),this.selectedInfo.groupDom.focus(),this.selectedInfo.groupDom.setAttribute("tabindex",-1),!0!==h.skipScrollTop)){var N=this.getElementById(this.id+"_main_div"),_=this.selectedInfo.groupDom.offsetTop+this.selectedInfo.groupDom.offsetHeight-N.offsetHeight;_>0&&(this.dom[this.id+"_scrollY_div"].scrollTop+=Math.ceil(_/this.options.rowHeight)*this.options.rowHeight)}if(this.useDataCollection&&this.successBinding){var k=this.modelControl.getDataComp();if(null!=this.selectedInfo.node){for(var I in k.refCompHash){var w=k.refCompHash[I];null!=w&&WebSquare.idCache[w.uuid]&&"input"==w.options.pluginName&&w.setValue(w.getValue())}k.setRowPosition(this.selectedInfo.node.index-1)}else k.setRowPosition(null)}}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.selectNode1=function(e,t,i,o,s){try{if(null!=this.selectedInfo.node){var a=this.tree.getCloneNode(this.selectedInfo.node),h=a.index;if(this.selectNode(e,t,i,o,s),null!=this.selectedInfo.node)if(h!=this.selectedInfo.node.index){var n={oldNode:a,newNode:this.tree.getCloneNode(this.selectedInfo.node)};c.B.fireEvent(this,"onviewchange",n)}}else if(this.selectNode(e,t,i,o,s),null!=this.selectedInfo.node){n={oldNode:{},newNode:this.tree.getCloneNode(this.selectedInfo.node)};c.B.fireEvent(this,"onviewchange",n)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.isOpen=function(e){try{if(e>=this.tree.size()||e<1)return;return this.findNodeByIndex(e).isExpanded()}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedNode=function(){try{return this.selectedInfo?this.selectedInfo.node:null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedDom=function(){try{return this.selectedInfo?this.selectedInfo.dom:null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedLabel=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.label:""}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedValue=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.value:""}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedIndex=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.index:""}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getSelectedElement=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.element:null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setLabelStyle=function(e,t,i,s){var a;"object"===(0,o.Z)(e)&&"number"==typeof e.index?a=e:"number"==typeof e?a=this.tree.findNodeByIndex(e):"string"==typeof e&&(a=this.tree.findNodeByValue(e)),this._setLabelStyle(a,t,i,s)},
u.prototype._setLabelStyle=function(e,t,i,o){if(null!=e){for(t in null==e.labelStyle&&(e.labelStyle={}),e.labelStyleStr="",e.labelStyle[t]=i,this.originalBackgroundColor=e.labelStyle["background-color"]||this.originalBackgroundColor,this.originalColor=e.labelStyle.color||this.originalColor,e.labelStyle)e.labelStyleStr+=t+":"+e.labelStyle[t]+";";if(e.rendered){var s=document.getElementById(this.id+"_label_"+e.index);if(s){for(var a="",h=0,n=t.length;h<n;h++)"-"===t.charAt(h)?(a+=t.charAt(h+1).capitalize(),h++):a+=t.charAt(h);s.style[a]=i}}if(!0===o)for(h=0,n=e.childNodes.length;h<n;h++){var l=e.childNodes[h];this._setLabelStyle(l,t,i,o)}}},u.prototype.disableCheckboxByValue=function(e,t,i){try{var o=this.tree.findNodeByValue(e);o&&this.disableCheckbox(o,t,i)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setLabelByIndex=function(e,t,i){this.setLabel(this.tree.findNodeByIndex(e),t,i)},u.prototype.setLabelByValue=function(e,t,i){this.setLabel(this.tree.findNodeByValue(e),t,i)},u.prototype.setLabel=function(e,t,i){try{if(e){var o=this.refreshStop;if(this.refreshStop=!0,this.useDataCollection||(this.modelControl.useItemset&&WebSquare.ModelUtil.setInstanceValue(e.xpath+"/"+this.tree.xpath.label,t),WebSquare.xml.setValue(e.element,"label",t)),"function"==typeof this.tree.customFormatter){var s=this.tree.getCloneNode(e);t=this.tree.customFormatter.call(this,t,t,s)}if(e.label=t,e.orgLabel=t,e.rendered){var a=document.getElementById(this.id+"_label_"+e.index);a&&(a.innerHTML=t)}if(this.refreshStop=o,this.useDataCollection){var h=this.modelControl.getDataComp();null!=h&&h.setCellData(e.index-1,this.tree.dataPath.label,t,null,i)}}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.checkNode=function(e,t,i,o,s){try{var a=this.tree.findNodeByIndex(e);a.checked=t;var h=document.getElementById(this.id+"_checkbox_"+e);if(h&&(h.checked=t),1==this.options.refreshCheckboxModel){if(this.stopRefresh(!0),this.useDataCollection&&this.tree.checkbox.colID){var n=this.modelControl.getDataComp(),l=t?this.options.trueValue:this.options.falseValue;null!=n&&n.setCellData(e-1,this.tree.checkbox.colID,l,null,s)}else 1==t?a.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(a.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(a.checkboxXPath,this.options.trueValue):a.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(a.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(a.checkboxXPath,this.options.falseValue);this.stopRefresh(!1)}if(!1!==i&&(1==i||1==this.options.hierarchy||1==this.options.checkAllChildNodes))for(var d=0,c=a.childNodes.length;d<c;d++){var p=a.childNodes[d];this.checkNode(p.index,t,!0,!1)}if(1==this.options.hierarchy&&this.partialSelection(a),!1!==o&&a.parentNode.parentNode&&1==this.options.hierarchy){var u=!0;for(d=0,c=a.parentNode.childNodes.length;d<c;d++){if(1!=(p=a.parentNode.childNodes[d]).checked){u=!1;break}}1==u?this.checkNode(a.parentNode.index,!0,!1):this.checkNode(a.parentNode.index,!1,!1)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.checkByIndex=function(e,t,i){try{var o=this.tree.findNodeByIndex(e);if(!o)return;this.checkNode(o.index,t,i)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.checkByValue=function(e,t,i){try{var o=this.tree.findNodeByValue(e);if(!o)return;this.checkNode(o.index,t,i)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getCheckedNodeByType=function(e,t){try{"object"===(0,o.Z)(e)&&null!=e||(e={});for(var i=[],s=this.tree.getNodeIterator({type:"bfs"});s.next();){var a=s.getNode();(1==a.checked||e.hierarchy&&1==a.partial&&!a.isRoot())&&(e.excludeRoot&&!a.isRoot()||!e.excludeRoot)&&i.push(a[t])}return i}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getCheckedValues=function(e){return this.getCheckedNodeByType(e,"value")},u.prototype.getCheckedLabels=function(e){return this.getCheckedNodeByType(e,"label")},u.prototype.getCheckedIndexes=function(e){return this.getCheckedNodeByType(e,"index")},u.prototype.getCheckedNodes=function(e){
return this.getCheckedNodeByType(e,"element")},u.prototype.disableCheckbox=function(e,t,i){try{if(t=a.D.getBoolean(t),e.checkboxDisabled=t,1==this.options.refreshCheckboxDisableModel&&(this.stopRefresh(!0),1==t?null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledTrueValue):null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledFalseValue),this.stopRefresh(!1)),!0===i||!1===i)for(var o=0,s=e.childNodes.length;o<s;o++){var h=e.childNodes[o];this.disableCheckbox(h,t,i)}this.redraw(!1)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.partialSelection=function(e){try{var t=0,i=!1;if(0==e.childNodes.length)return;for(var o=0,s=e.childNodes.length;o<s;o++){var a=e.childNodes[o];1==a.checked?t++:1==a.partial&&(i=!0)}1==i||0<t&&t<e.childNodes.length?(e.partial=!0,this.addClass(e.checkboxDom,"treeview_partialselect")):(e.partial=!1,this.removeClass(e.checkboxDom,"treeview_partialselect"))}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getParentValue=function(e){try{var t="",i=this.tree.findNodeByValue(e);return i&&i.parentNode&&(t=i.parentNode.value),t}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getChildData=function(e){try{for(var t=this.tree.findNodeByValue(e),i=[],o=0,s=t.childNodes.length;o<s;o++)1==this.options.dynamicAppend||this.useDataCollection?i.push(t.childNodes[o].element):i.push(WebSquare.ModelUtil.findInstanceNode(t.childNodes[o].xpath));return i}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setCustomFormatter=function(e){if("function"==typeof e){for(var t=this.tree.getNodeIterator();t.next();){var i=t.getNode();if(!i.isRoot()){var o=this.tree.getCloneNode(i),s=e.call(this,i.orgLabel,i.label,o)||i.label;if(i.label=s,i.rendered){var a=document.getElementById(this.id+"_label_"+i.index);a&&(a.firstChild.nodeValue=i.label)}}}t=null,this.tree.customFormatter=e}},u.prototype.appendNode=function(e,t){try{if(0==this.options.dynamicAppend&&$l("treeview를 동적으로 처리하는 경우에는  dynamicAppend='true'로 설정하는 것을 권장합니다.["+this.id+"]"),1==this.options.dynamicAppend){var i=e.childNodes?e.childNodes.length+1:1,o=t.parentNode,s=this.tree.parseNodeByNode(t,e.depth+1,i,e);e.appendChild(s),o.removeChild(t);for(var a=0,h=o.expandedNodes.length;a<h;a++){var n=o.expandedNodes[a];if(t.index===n.index){o.expandedNodes.splice(a,1);break}}for(a=0,h=e.childNodes.length;a<h;a++)this.tree.setRender(e.childNodes[a],!1);e.childNodes.length>0&&(e.childNodes[0].rendered=!1,e.expandedNodes.push(s),this.toggleChild(null,e.index,!0))}else e.appendChild(t),e.expandedNodes.push(t),this.toggleChild(null,e.index,!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.removeNode=function(e){try{if(!e)return;var t=e.parentNode;t&&(e.isExpanded()&&this._collapseNode(e),t.removeChild(e),this.redraw(!0))}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.removeNodeList=function(e){try{for(var t=0;t<e.length;t++)if(e[t]){var i=e[t].parentNode;i&&i.removeChild(e[t])}this.drawContents()}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.moveNode=function(e,t,i){try{if(!this.useDataCollection)return!1;if(e==t)return!1;if(e<t&&this.getLastChildIndex(e)>=t)return h.k.printLog("treeview moveNode : Invalid argument. [destIndex] must not be child of [srcIndex].["+this.id+"]"),!1;for(var o=this.modelControl.getDataComp(),s=e-1,a=t-1,n=this.findNodeByIndex(e),l=this.findNodeByIndex(t),d=this.getLastChildIndex(s+1)-1,c=o.getRowCount(),p=[],u=this.tree.dataPath.depth,f=0,m=s;m<=d;m++){var g=o.getRowJSON(m);g[u]=i?Number(g[u])+(l.depth-n.depth+1):Number(g[u])+(l.depth-n.depth),"number"!==o.getColumnInfo(u).dataType&&(g[u]=g[u]+""),p.push(g),f++,delete this.tree.hash_index_node[m+1]}this.stopRefresh(!0),o.removeRange(s,d),s<a&&(a+=s-d-1);var b=0;if(!i){var x=this.getLastChildIndex(t);b=x-t,t<=s&&x>=d&&(b-=f)}var v=a+1+b;o.insertJSON(v,p),
this.stopRefresh(!1);var y=n.parentNode;if(y){this.tree._removeNode(y.expandedNodes,n),this.tree._removeNode(y.childNodes,n);for(m=n.depthIndex-1;m<y.childNodes.length;m++)y.childNodes[m].depthIndex=m+1}for(m=d+2;m<=c;m++)this.tree.changeNodeIndex(m,m-f);var N=!1;if(i){n.parentNode===l?this.tree._removeNode(l.childNodes,n):N=!0,n.parentNode=l,l.expandedNodes.unshift(n),l.childNodes.unshift(n);for(m=0;m<l.childNodes.length;m++)l.childNodes[m].depthIndex=m+1}else if(l.parentNode){n.parentNode=l.parentNode,l.parentNode.childNodes.splice(l.depthIndex,0,n);for(m=0;m<l.parentNode.childNodes.length;m++)l.parentNode.childNodes[m].depthIndex=m+1;var _=l.parentNode.expandedNodes;for(m=_.length-1;m>=0;m--)if(_[m]===l){_.splice(m,0,n);break}}for(m=c-f;m>v;m--)this.tree.changeNodeIndex(m,m+f);var k=l.depth-n.depth,I=[n];for(m=v+1;m<=v+f;m++){var w=I.pop();if(w.index=m,w.depth=N?w.depth+k+1:w.depth+k,this.tree.hash_index_node[m]=w,w.hasChild())for(var C=w.childNodes.length-1;C>=0;C--)I.push(w.childNodes[C])}return this.redraw(!0),this.selectNode(null,v+1),!0}catch(e){return r.w.printStackTrace(e,null,this),!1}},u.prototype.getLastChildIndex=function(e){try{var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.tree.nodeCount-1;for(var o=t;!o.isRoot()&&o.depthIndex==o.parentNode.childNodes.length;)o=o.parentNode;o.isRoot()||o.depthIndex==o.parentNode.childNodes.length||(i=o.parentNode.childNodes[o.depthIndex].index-1)}return i}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.activateDrag=function(e){try{this.options.iwsSupport||c.B.stopEvent(e);var t=a.D.getDataPrefix("index"),i=a.D.getDataPrefix("tdIndex");1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll();var o=this,s=this.event.getTargetIterator(e,this.render);if(s.element.id===this.id)return;for(var h=!1,n=!1,l=!1,d=!1,p=!1;s.next();)if((s.match("treeview_icon_open")||s.match("treeview_icon_close"))&&(n=!0),s.match("treeview_virtual_label")&&(p=!0),(s.match("treeview_icon_navi")||s.match("treeview_icon_navi_img"))&&(h=!0),s.match("treeview_icon_label")&&(l=!0),s.match("treeview_checkbox")&&(d=!0),s.match("treeview_virtual_node")){var u=s.getElement().getAttribute(t);if(null==u){s.stop();break}if("onmousedown"==this.options.toggleButtonEvent){var f=this.tree.findNodeByIndex(u);if(h&&!f.isLeaf()){this.toggleChild(null,u);var m=!!(f.childNodes&&f.childNodes[0]&&f.childNodes[0].rendered);this.inlineElement?c.B.fireEvent(this,"ontoggleclick",null,u,m):c.B.fireEvent(this,"ontoggleclick",f.element,u,m)}}if((p||d||l||h||n)&&this.selectNode1(null,u,!1,!0),1==this.options.useDrag){var g=this.tree.hash_index_node[u].label;WebSquare.dragdrop.gDragManager.activate(e,s.getElement(),{id:this.id+"_drag",className:"w2treeview_drag",contents:g,delay:15,dropClass:"treeview_virtual_node",dragoverClass:"treeview_label",applyMousePosition:!0,onDrop:function(e,s,h,n,l,d,r){if(e){var p=null,u={},f=null,m=null,g=null;for(u=s?new WebSquare.targetIterator(s,o.render):o.event.getTargetIterator(r);u.next();){if(u.match("w2treeview_virtual")){var b=u.getElement().id;a.D.getComponentById(b)&&(p=a.D.getComponentById(b)),u.stop()}if(u.match("w2grid")&&(f=u.getElement().id,u.stop()),!m&&u.match(null,null,"td")){var x=u.getElement();m=parseInt(x.getAttribute(i),10)}}if(u=null,p&&!s&&(s=document.getElementById(p.id+"_node_0")),e&&s&&p){var v=e.getAttribute(t),y=s.getAttribute(t),N=o.tree.findNodeByIndex(v),_=p.tree.findNodeByIndex(y);c.B.fireEvent(p,"ondrop",N,_,o,p,r)}if(null!=f&&(g=(f=a.D.getComponentById(f)).getDataLength(),null!=m&&(g=f.rowIndex+parseInt(m/(f.oneRowDataLength+f.defaultColCnt)))),e&&f){v=parseInt(e.getAttribute(t),10)-1;if(o.useDataCollection)var k=o.modelControl.getDataComp();N=o.tree.findNodeByIndex(v+1);c.B.fireEvent(f,"ondropfromtree",{dataListId:k.id,fromRowIndex:v,toRowIndex:g,dragNode:N})}}},onDragover:function(e,i,s,h,n,l,d){if(e)if(i){for(var r=null,p=new WebSquare.targetIterator(i,o.render);p.next();)if(p.match("w2treeview")){
var u=p.getElement().id;a.D.getComponentById(u)&&(r=a.D.getComponentById(u)),p.stop()}if(p=null,r){var f=e.getAttribute(t),m=i.getAttribute("id"),g=m.substring(m.lastIndexOf("_")+1,m.length),b=o.tree.findNodeByIndex(f),x=r.tree.findNodeByIndex(g);c.B.fireEvent(r,"ondragover",b,x,o,r,d)}}else c.B.fireEvent(o,"ondragleave",d)}})}s.stop()}s=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getNextNode=function(e){for(var t=null,i=e.index,o=0,s=this._items.length;o<s;o++)if(this._items[o].index==i){t=this._items[o+1];break}return t},u.prototype.getPreviousNode=function(e){for(var t=null,i=e.index,o=0,s=this._items.length;o<s;o++)if(this._items[o].index==i){t=this._items[o-1];break}return t},u.prototype.showTooltip=function(e,t,i){try{null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var o=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var s=d.v.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(s){var h=a.D.getGlobalFunction(s,o.scope_id),n=!0;if("function"==typeof h&&(n=h(o)),!n)return}}catch(e){r.w.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2treeview_tooltip "+this.options.tooltipClass}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.options.tooltipGroupClass||this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i})),1e3*this.options.tooltipTime)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&this.tooltip.setStyle("display","none")})),1e3*this.options.tooltipTime)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.onPropertyChange=function(e,t){try{if("disabled"===e)this.options.disabled=t,t?this.addClass(this.render,"w2treeview_disabled"):this.removeClass(this.render,"w2treeview_disabled")}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setDisabled=function(e){e=a.D.getBoolean(e);var t=p.s.prototype.setDisabled.call(this,e);return this.disableCheckbox(this.tree.rootNode,e,!0),t},u.prototype.setEditMode=function(e){try{var t=document.getElementById(this.id+"_label_"+e);if(null==this.editModeComp||null==this.editModeComp.render){this.editModeComp=new WebSquare.uiplugin.input(this.id+"_input"),this.editModeComp.writeTo(t.parentNode),this.editModeComp.activate();var i=this.uuid;this.editModeComp.bind("onblur",(function(){var e=WebSquare.idCache[i],t=e.modelControl.getDataComp();if(t){var o=this._oldValue,s=this.getValue();t.setCellData(this._index-1,e.tree.dataPath.label,s)}else e.setLabelByIndex(this._index-1,s);e.appendChild(this),this.render.style.display="none",document.getElementById(e.id+"_label_"+this._index).style.display="",this.setValueNM(""),c.B.fireEvent(e,"oneditend",{oldValue:o,newValue:s,index:this._index})})),this.editModeComp.bind("onkeydown",(function(e){c.B.stopPropagation(e)})),this.editModeComp.bind("onmousedown",(function(e){c.B.stopPropagation(e)})),this.editModeComp.bind("onselectstart",(function(e){c.B.stopPropagation(e)}))}else this.editModeComp.render.style.display="",t.parentNode.appendChild(this.editModeComp.render);this.editModeComp._index=e,t.style.display="none",this.editModeComp.setVerticalAlign=function(){};var o=this.findNodeByIndex(e);o&&""!=o.label&&(this.editModeComp.setValueNM(o.label),this.editModeComp._oldValue=o.label),this.editModeComp.focus()}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleClickEvent=function(e){try{
for(var t=!1,i=!1,o=!1,s=!1,h=a.D.getDataPrefix("index"),n=a.D.getDataPrefix("value"),l=this.event.getTargetIterator(e,this.render);l.next();)if((l.match("treeview_icon_open")||l.match("treeview_icon_close"))&&(t=!0),l.match("treeview_checkbox")&&(o=!0),l.match("treeview_label")&&(i=!0),l.match("treeview_icon_label")&&(s=!0),l.match("treeview_virtual_node")){var p=l.getElement().getAttribute(h),u=l.getElement().getAttribute(n),f=this.tree.findNodeByIndex(p);if(t&&"onmousedown"!==this.options.toggleButtonEvent){this.toggleChild(null,p);var m=f.childNodes&&f.childNodes[0]&&f.childNodes[0].rendered;this.inlineElement?c.B.fireEvent(this,"ontoggleclick",null,p,m):c.B.fireEvent(this,"ontoggleclick",f.element,p,m)}if(o&&!f.checkboxDisabled){var g=!f.checked;this.checkNode(p,g),this.inlineElement?c.B.fireEvent(this,"oncheckboxclick",u,null,p):1==this.options.dynamicAppend||this.useDataCollection?c.B.fireEvent(this,"oncheckboxclick",u,f.element,p):c.B.fireEvent(this,"oncheckboxclick",u,WebSquare.ModelUtil.findInstanceNode(f.xpath),p)}i&&("onclick"===this.options.toggleEvent&&this.toggleChild(null,p),this.inlineElement?c.B.fireEvent(this,"onlabelclick",u,null,p):c.B.fireEvent(this,"onlabelclick",u,f.element,p)),s&&(this.inlineElement?c.B.fireEvent(this,"onImageclick",u,null,p):c.B.fireEvent(this,"onImageclick",u,f.element,p));var b=d.v.getConfiguration("/WebSquare/treeview/useClickEventToggleButton/@value"),x=a.D.getBoolean(this.options.noFocusOnIconLabelClick||d.v.getConfiguration("/WebSquare/treeview/noFocusOnIconLabelClick/@value"));(i||o||t&&"false"!=b)&&(this.selectNode1(null,p,!1,x),c.B.fireEvent(this,"onclick")),l.stop()}l=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleToggleEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("treeview_label")&&(t=!0),t&&i.match("treeview_virtual_node")){var o=a.D.getDataPrefix("index"),s=i.getElement().getAttribute(o);this.toggleChild(null,s),i.stop()}i=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleScrollXEvent=function(e){var t=this.dom[this.id+"_scrollX_div"].scrollLeft,i=t-this.oldScrollLeft;this.dom[this.id+"_main_div"].scrollLeft+=i,this.oldScrollLeft=t,c.B.stopEvent(e)},u.prototype.handleScrollYEvent=function(e){if(!0!==this._bSkipScrollY){var t=this.uuid,i=function(){var e=WebSquare.idCache[t],i={skipScrollTop:!0};if(e._arrowDownPressed){var o=e.getNextNode(e.selectedInfo.node);o||(o=e.selectedInfo.node),e.selectNode1(null,o.index,!1,!1,i),e._arrowDownPressed=!1}else if(e._arrowUpPressed){var s=e.getPreviousNode(e.selectedInfo.node);s||(s=e.selectedInfo.node),e.selectNode1(null,s.index,!1,!1,i),e._arrowUpPressed=!1}else if(e.selectedInfo.node)for(var a=0;a<e._items.length;a++)if(e._items[a]==e.selectedInfo.node){e.selectNode1(null,e.selectedInfo.node.index,!1,!1,i);break}if(e._checkScrollEnd()){var h=e._getOverflowY();if(h<0){var n=Math.floor(-h/this._minRowHeight),l=Math.max(1,n-this._extraRow);h=Math.min(0,h+e._maxRowHeight*l)}e._resizeY(h)}};this.options.redrawInterval>0?(d.v.clearTimer(this.id+"_redraw"),d.v.setTimer((function(){WebSquare.idCache[t].redraw(!1,i)}),{key:this.id+"_redraw",caller:this,delay:this.options.redrawInterval})):(0==this.options.redrawInterval||this._forceRedraw)&&(this.redraw(!1,i),this._forceRedraw=!1),c.B.stopEvent(e)}},u.prototype.handleMouseWheelEvent=function(e){var t,i=e||window.event,o=i.detail,s=i.wheelDelta,a=1;o=(o=o?s&&(a=s/o)?o/a:-o/1.35:s/120)<1?o<-1?(-Math.pow(o,2)-224)/225:o:(Math.pow(o,2)+224)/225,t=e.deltaY?e.deltaY:-180*Math.min(Math.max(o/2,-1),1),this.dom[this.id+"_scrollY_div"].scrollTop+=t,c.B.stopEvent(e)},u.prototype.handleKeydownEvent=function(e){try{var t,i=e.charCode?e.charCode:e.keyCode,o=a.D.getDataPrefix("index");this.selectedInfo.node?(this.selectedInfo.groupDom,t=this.selectedInfo.node.index):t=(e.srcElement||e.target).getAttribute(o),t||(t=0);var s=this.tree.findNodeByIndex(t);if(37===i||39===i||13===i){var h=37!==i
;13===i?this.toggleChild(null,t,null):this.toggleChild(null,t,h);var n=this;this.redraw(!1,(function(){n.selectNode1(null,n.selectedInfo.node.index,!1,!1)}));var l=!!(s.childNodes&&s.childNodes[0]&&s.childNodes[0].rendered);this.inlineElement?c.B.fireEvent(this,"ontoggleclick",null,t,l):c.B.fireEvent(this,"ontoggleclick",s.element,t,l),c.B.stopEvent(e)}else if(38===i){if(this.options.scrollFix)return void(this.dom[this.id+"_scrollY_div"].scrollTop-=1.5*this.options.rowHeight);var d=null;0==t?(t=1,d=this.tree.findNodeByIndex(t)):d=this.getPreviousNode(s),d?d.index&&this.selectNode1(null,d.index,!1):(this.dom[this.id+"_scrollY_div"].scrollTop-=2*this.options.rowHeight,this._arrowUpPressed=!0),c.B.stopEvent(e)}else if(40===i){if(this.options.scrollFix)return void(this.dom[this.id+"_scrollY_div"].scrollTop+=1.5*this.options.rowHeight);d=null;0==t?(t=1,d=this.tree.findNodeByIndex(t)):d=this.getNextNode(s),d?d.index&&this.selectNode1(null,d.index,!1):(this.dom[this.id+"_scrollY_div"].scrollTop+=2*this.options.rowHeight,this._arrowDownPressed=!0),c.B.stopEvent(e)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleDblclickEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("treeview_label")&&(t=!0),t&&i.match("treeview_virtual_node")){var o=a.D.getDataPrefix("index"),s=i.getElement().getAttribute(o);t&&("ondblclick"!==this.options.toggleEvent&&""!==this.options.toggleEvent||this.toggleChild(null,s)),c.B.fireEvent(this,"ondblclick"),i.stop()}i=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleMouseoverEvent=function(e){try{this.options.iwsSupport||c.B.stopEvent(e);for(var t=a.D.getDataPrefix("index"),i=a.D.getDataPrefix("value"),o=this.event.getTargetIterator(e,this.render);o.next();)if(o.match("treeview_label")){if(this.addClass(o.getElement(),"treeview_over"),this.options.tooltipDisplay||this.options.tooltipShowAlways){var s=o.getElement(),h=WebSquare.style.getAbsoluteLeft(s),n=WebSquare.style.getAbsoluteTop(s),l=s.firstChild.nodeValue,d=WebSquare.style.getAbsoluteLeft(this.render),p=!1;if(this.options.tooltipDisplay)if(h+s.offsetWidth>d+this.render.clientWidth+this.render.scrollLeft)p=!0;else if(a.D.isIEAllVersion()&&!a.D.isIE(6)&&!a.D.isIE(7)){var u=s.style.display;s.style.display="block",s.clientWidth<s.scrollWidth&&(p=!0),s.style.display=u}if(p||this.options.tooltipShowAlways){var f=a.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if(f&&"function"==typeof f){for(var m=new WebSquare.targetIterator(s,this.render),g=-1;m.next();)m.match("treeview_virtual_node")&&(g=m.getElement().getAttribute(t),m.stop());m=null;try{l=f(l,g,!!p||s.offsetWidth<s.scrollWidth)}catch(e){r.w.printStackTrace(e,null,this)}}""!=l&&this.showTooltip(h,n,l)}}m=new WebSquare.targetIterator(o.getElement(),this.render),g=-1;for(var b="",x=null;m.next();)m.match("treeview_virtual_node")&&(g=m.getElement().getAttribute(t),b=m.getElement().getAttribute(i),x=this.tree.findNodeByIndex(g),m.stop());m=null,c.B.fireEvent(this,"onlabelover",g,x.element,b)}o=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleMouseoutEvent=function(e){try{this.options.iwsSupport||c.B.stopEvent(e),(this.options.tooltipDisplay||this.options.tooltipShowAlways)&&this.hideTooltip();for(var t=this.event.getTargetIterator(e,this.render);t.next();)t.match("treeview_label")&&this.removeClass(t.getElement(),"treeview_over");t=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.handleContextmenuEvent=function(e){try{this.options.iwsSupport||c.B.stopEvent(e);for(var t=!1,i=!1,o=!1,s=!1,h=a.D.getDataPrefix("index"),n=this.event.getTargetIterator(e,this.render);n.next();){if(n.match("treeview_label")&&(s=!0),n.match("treeview_icon_navi")&&(t=!0),n.match("treeview_icon_label")&&(i=!0),n.match("treeview_checkbox")&&(o=!0),n.match("treeview_virtual_node")){var l=n.getElement().getAttribute(h);if(t&&this.toggleChild(null,l),o){var d=document.getElementById(this.id+"_checkbox_"+l).checked
;this.checkNode(l,d)}(s||o||i)&&(this.selectNode1(null,l),c.B.fireEvent(this,"onrightbuttonclick",this.findNodeByIndex(l),c.B.getMouseX(e),c.B.getMouseY(e))),n.stop()}n.match("w2treeview_virtual")&&0===this.tree.nodeCount&&(c.B.fireEvent(this,"onrightbuttonclick",null,c.B.getMouseX(e),c.B.getMouseY(e)),n.stop())}n=null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.nodeToHTML=function(e){if(!e)return"";try{e.rendered=!0;var t=[],i="",o="",s="",h="",n="",l="",d="",c="",p="";if(this.options.customFormatter&&(this.tree.customFormatter=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id)),"function"==typeof this.tree.customFormatter){var u=this.tree.getCloneNode(e),f=this.tree.customFormatter.call(this,e.orgLabel,e.label,u)||e.label;c=this.options.escape?WebSquare.xml._encode(e.label):f,p=this.options.escape?WebSquare.xml._encode(e.value):e.value}else c=this.options.escape?WebSquare.xml._encode(e.label):e.label,p=this.options.escape?WebSquare.xml._encode(e.value):e.value;if(e.hasChild()){var m=e.isExpanded();i=m?"opened":"closed",o=m?"treeview_icon_close":"treeview_icon_open",s=m?"background: url("+this.options.folderCloseToggleImage+") no-repeat center center":"background: url("+this.options.folderOpenToggleImage+") no-repeat center center";var g=e.parentNode.childNodes;g&&g[g.length-1]==e&&(i+=" lastParentSibling")}else i="leaf",o=this.options.lineShow?e.isFirstChildByRoot()?1==e.parentNode.childNodes.length?"treeview_root_single_leaf":"treeview_root_multi_leaf":e.isLastChild()?"treeview_last_sibling":"treeview_leaf":"";var b=a.D.getDataPrefix("index"),x=a.D.getDataPrefix("value"),v=a.D.getDataPrefix("depth");i+=" w2tree_depth_"+e.depth,"string"==typeof e.nodeCss&&e.nodeCss&&(i+=" "+e.nodeCss),t.push("<div id='"+this.id+"_node_"+e.index+"' tabindex='-1' class='treeview_virtual_node "+i+"' "+b+"='"+e.index+"' "+x+"='"+p+"' "+v+"='"+e.depth+"' style='height:"+this.options.rowHeight+"px;'>");var y=!1,N=[];if(this.options.lineShow){var _=e._getAncestor();if(_){n="treeview_guideline",l="width: 16px;";var k=e;for(y=!0,_.isLastChild()&&N.push(!1);k!=_;)N[k.depth-1]=!k.isLastChild(),k=k.parentNode}else n="treeview_no_guideline",l="width:"+16*(e.depth-1)+"px;"}else n="treeview_no_guideline",l="width:"+16*(e.depth-1)+"px;";if(y)for(var I=0;I<e.depth-1;I++)n=0==N[I]?"treeview_no_guideline":"treeview_guideline",t.push("<span class='"+n+"' style='"+l+"'> </span>");else t.push("<span class='"+n+"' style='"+l+"'> </span>");if(t.push("<span class='treeview_icon_navi "+o+"' style='"+s+"'></span>"),""!=e.image){var w=e.isExpanded()?e.expandedImage:e.image,C=this.getURL(w),S=e.imageTitle?"title='"+e.imageTitle+"'":"";t.push("<span id='"+this.id+"_icon_"+e.index+"' class='treeview_icon_label'"+S+" style='background-image:url("+C+")'></span>")}if(1==this.options.showCheckbox){var D=e.checked||e.partial?"checked='true' ":"",T=e.checkboxDisabled?"disabled='true' ":"",E=e.partial?"treeview_partialselect":"";!0===this.options.labelForCheckbox&&(d="for='"+this.id+"_checkbox_"+e.index+"'"),t.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' "+D+T+" id='"+this.id+"_checkbox_"+e.index+"' class='treeview_checkbox "+E+"' />")}return e.labelStyleStr&&(h=e.labelStyleStr),t.push("<label "+d+" class='treeview_label "+this.options.labelclass+"' tabindex='-1' style='"+h+"' id='"+this.id+"_label_"+e.index+"'>"+c+"</label>"),t.push("</div>"),t.join("")}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.isLeaf=function(){try{return!this.selectedInfo||!this.selectedInfo.node||!this.selectedInfo.node.hasChild()}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._getDataObj=function(e){if(e){var t=WebSquare.WebSquareparser.parseItemset(e);this.modelControl.setItemset(t.nodeset,t.label,t.value),0==this.options.modelBinding&&(this.options.refreshCheckboxModel=!1,this.options.refreshCheckboxDisableModel=!1);var i={type:"",data:null},o=null,s=WebSquare.Elem.api.getElementsByTagName(e,"itemset",d.v._XML_NAMESPACE.W2)[0]
;if(s){var a=WebSquare.Elem.api.getValue(s,"@nodeset");this.useDataCollection=a.match("data:");var h=a.replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);h&&(h=h[0]);var n=WebSquare.Elem.api.getElementsByTagName(s,"label",d.v._XML_NAMESPACE.W2)[0],l=WebSquare.Elem.api.getElementsByTagName(s,"value",d.v._XML_NAMESPACE.W2)[0],r=WebSquare.Elem.api.getElementsByTagName(s,"depth",d.v._XML_NAMESPACE.W2)[0],c=WebSquare.Elem.api.getElementsByTagName(s,"folder",d.v._XML_NAMESPACE.W2)[0],p=null==n?"":n.getAttribute("ref"),u=null==l?"":l.getAttribute("ref"),f=null==r?"":r.getAttribute("ref"),m=null==c?"":c.getAttribute("ref"),g={image:"image",iconImage:"iconImage",selectedImage:"selectedImage",expandedImage:"expandedImage",leafImage:"leafImage",checkboxDisabled:"checkboxDisabled",imageTitle:"imageTitle",checkbox:"checkbox"};for(var b in g){var x=WebSquare.Elem.api.getElementsByTagName(s,""+b,d.v._XML_NAMESPACE.W2)[0];g[b]=null==x?"":x.getAttribute("ref")}var v=g.checkbox;this.useDataCollection&&this.tree.setDataPath(p,u,f,h,m,v);var y=g.image,N=g.iconImage,_=g.selectedImage,k=g.expandedImage,I=g.leafImage,w=g.checkboxDisabled,C=g.imageTitle;v=g.checkbox;if(y=this.options.defaultImage?this.options.defaultImage:y,N=this.options.iconImage?this.options.iconImage:N,_=this.options.selectedImage?this.options.selectedImage:_,k=this.options.expandedImage?this.options.expandedImage:k,I=this.options.leafImage?this.options.leafImage:I,w=this.options.checkboxDisabled?this.options.checkboxDisabled:w,this.tree.setXPath(a,p,u,f,h,m),this.tree.setCheckbox(v,this.options.trueValue,this.options.falseValue,w,this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy,g.checkbox),this.tree.setImage(y,N,I,_,k,C),this.useDataCollection)this.modelControl.getDataCollectionItemsetData(this.modelControl.id),null!=(o=this.modelControl.getDataComp())&&(i.type="dataList",i.data=o.id,this.successBinding=!0);else{var S=WebSquare.ModelUtil.findInstanceNodes(a,null,this.scope_id),D=null;null!=S&&("recursive"==this.options.dataType?D=this.tree.parseRecursiveToTree(S):"listed"==this.options.dataType&&(D=this.tree.parseListToTreeInstance(S))),i.type="xmlInstance",i.data=D,this.tree.isInstance=!0}}else{this.inlineElement=!0;var T="w2:";y=T+"image",N=T+"iconImage",_=T+"selectedImage",k=T+"expandedImage",I=T+"leafImage";y=""!=this.options.defaultImage?this.options.defaultImage:y,N=""!=this.options.iconImage?this.options.iconImage:N,_=""!=this.options.selectedImage?this.options.selectedImage:_,k=""!=this.options.expandedImage?this.options.expandedImage:k,I=""!=this.options.leafImage?this.options.leafImage:I,this.tree.setImage(y,N,I,_,k,T+"imageTitle"),this.tree.setCheckbox(T+"checkbox",this.options.trueValue,this.options.falseValue,T+"checkboxDisabled",this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy),i.type="inlineXML",i.data=e}return i}},u.prototype.refreshItemset=function(e){try{if(this.modelControl.isItemsetBinded()&&!this.refreshStop){this._initMaxRowHeight(),this.refreshStop=!0,this._expandedNodes=[];var t=this.tree.getNodeset(),i=!1;if(this.useDataCollection){var o;if(null!=(o=this.modelControl.getDataComp())){if(!this.successBinding){var s=(t=o.options.baseNode+"/"+o.options.repeatNode).replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);s&&(s=s[0]),this.tree.valueAttribute=o.options.valueAttribute?o.options.valueAttribute:"";var a=this.tree.dataPath.label,h=this.tree.dataPath.value,n=this.tree.dataPath.depth,l=this.tree.dataPath.folder,d=this.tree.dataPath.checkbox;this.tree.setDataPath(a,h,n,s,l,d),this.successBinding=!0,i=!0}this.tree.setData({type:"dataList",data:o.id})}}else{var c=WebSquare.ModelUtil.findInstanceNodes(t,null,this.scope_id),p=null
;null!=c&&("recursive"==this.options.dataType?p=this.tree.parseRecursiveToTree(c):"listed"==this.options.dataType&&(p=1==this.tree.isInstance?this.tree.parseListToTreeInstance(c):this.tree.parseListToTree(c))),this.tree.setData({type:"xmlInstance",data:p})}if(this._expandedNodes.push(this.tree.rootNode),this._setExpandedLevel(),i)if(e&&!0===e.setNodeSet){if(this.redraw(!0),this.useDataCollection)(o=this.modelControl.getDataComp()).bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck))}else this.setAction(),this.refreshStop=!0;else this.redraw(!0);if(this.useDataCollection)null!=(o=this.modelControl.getDataComp())&&o.getRowPosition();this.refreshStop=!1}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.refreshItemArr=function(){},u.prototype.setNodeSet=function(e,t){try{var i=t||{},o=e;if(e.indexOf("data:")>=0&&(o=e.replaceAll("data:","")),this.modelControl.getDataComp(o)){for(var s in this.useDataCollection=e.match("data:"),this.modelControl.unbindItemset(),this.modelControl.setItemset("data:"+o,i.label,i.value),this.modelControl.dataCollectionBindItemset(),this.modelControl.getDataCollectionItemsetData(this.modelControl.id),t)this.tree.dataPath[s]=t[s],"checkbox"===s&&(this.tree.checkbox.colID=t[s]);this.successBinding=!1,this.refreshItemset({setNodeSet:!0})}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.stopRefresh=function(e,t){try{this.refreshStop=a.D.getBoolean(e),!0===t&&this.redraw(!0)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyValidCheck=function(e){try{if(e.colID===this.tree.dataPath.depth){var t=this.findNodeByIndex(e.rowIndex+1);if(e.newValue<1)throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be greater than 0."};if(e.oldValue&&e.newValue>e.oldValue&&t.isFirstChild())throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be less than "+(e.oldValue+1)}}return!0}catch(e){return r.w.printStackTrace(e,null,this),!1}},u.prototype.notifyInvalid=function(){},u.prototype.notifySetCellData=function(e,t,i,o){try{if(this.refreshStop||parseInt(o,10)===parseInt(i,10))return;if(t===this.tree.dataPath.label)this.setLabelByIndex(e+1,i,!0);else if(t===this.tree.dataPath.checkbox)i==this.options.trueValue?this.checkNode(e+1,!0):i==this.options.falseValue&&this.checkNode(e+1,!1);else if(t===this.tree.dataPath.depth){if(Math.abs(i-o)>1)return void this.refreshItemset();this.stopRefresh(!0),this.notifyDepthChanged(e+1,i,o),this.stopRefresh(!1);var s=this.findNodeByIndex(e+1);s.parentNode===this.tree.rootNode?this.redraw():this.toggleChild(null,s.parentNode.index,!0)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyDepthChanged=function(e,t,i){try{var o=this.findNodeByIndex(e),s=this.modelControl.getDataComp();if(this._initMaxRowHeight(),t>i){var a=(d=o.parentNode).childNodes[o.depthIndex-2],h=o.childNodes.splice(0,o.childNodes.length);d.childNodes.splice(o.depthIndex-1,1),o.parentNode=a,a.childNodes.push(o),o.depthIndex=a.childNodes.length,a.rendered=!1,o.rendered=!1;for(var n=0;n<h.length;n++)h[n].parentNode=a,a.childNodes.push(h[n]),h[n].depthIndex=a.childNodes.length,h[n].rendered=!1;d.childNodes[0].rendered=!1}else{if(o.hasChild())for(n=o.childNodes.length-1;n>=0;n--){var l=o.childNodes[n];s.setCellData(l.index-1,this.tree.dataPath.depth,l.depth-1),this.notifyDepthChanged(l.index,l.depth-1,l.depth)}var d,c=(d=o.parentNode).parentNode;if(o.depthIndex<d.childNodes.length){var p=d.childNodes.splice(o.depthIndex,d.childNodes.length-o.depthIndex);for(n=0;n<p.length;n++)p[n].parentNode=o,o.childNodes.push(p[n]),p[n].depthIndex=o.childNodes.length,p[n].rendered=!1}d.childNodes.splice(d.childNodes.length-1,1),o.parentNode=c,c.childNodes.splice(d.depthIndex,0,o);for(n=d.depthIndex;n<c.childNodes.length;n++)c.childNodes[n].depthIndex=n+1;c.childNodes[0].rendered=!1}o.depth=t,o.element.setAttribute(s.options.valueAttribute,t)}catch(e){
r.w.printStackTrace(e,null,this)}},u.prototype.notifyInsertRow=function(e){try{if(this.refreshStop)return;this._initMaxRowHeight();var t=this.modelControl.getDataComp(),i=this.findNodeByIndex(e),o=new n;o.index=e+1,o.depthIndex=1,o.depth=i.depth+1,o.rendered=!1,o.parentNode=i;for(var s=t.getRowCount();s>=e+2;s--)this.tree.changeNodeIndex(s-1,s);this.tree.hash_index_node[e+1]=o,t.setCellData(e,this.tree.dataPath.depth,i.depth+1,null,!0);var a=t.getRowJSON(e);o.element=a,i.childNodes.unshift(o);for(s=0;s<i.childNodes.length;s++)i.childNodes[s].depthIndex=s+1;this.toggleChild(null,e,!0),this.tree.nodeCount=t.getRowCount()+1}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyInsertData=function(e,t){try{if(this.refreshStop||"string"!=typeof e||!0===t)return;for(var i=e.split(",").sort((function(e,t){return e-t})),o=i.length,s=Number(i[0]),h=this.findNodeByIndex(s),l=this.tree.nodeCount-1;l>s;l--)this.tree.changeNodeIndex(l,l+o);for(var d=this.modelControl.getDataComp(),c=this.tree.dataPath.depth,p=this.tree.dataPath.label,u=this.tree.dataPath.value,f=this.tree.dataPath.checkbox,m=this.tree.dataPath.folder,g=0;g<o;g++){var b=Number(i[g]),x=d.getRowJSON(b);if((N=new n).element=x,N.index=b+1,N.rendered=!1,N.label=x[p],N.orgLabel=x[p],N.checked=x[f]===this.options.trueValue,N.value=x[u],N.folder=x[m],N.depth=x[c]>0?Number(x[c]):h.depth+1,Number(N.depth)<=Number(h.depth)){for(var v=Number(h.depth)-Number(N.depth),y=0;y<v&&null!=h;y++)h=h.parentNode;if(!h||!h.parentNode)return this.refreshItemset();N.parentNode=h.parentNode,this.tree._insertNode(N.parentNode.childNodes,h,N,!0),this.tree._insertNode(N.parentNode.expandedNodes,h,N,!0);for(y=0;y<N.parentNode.childNodes.length;y++)N.parentNode.childNodes[y].depthIndex=y+1}else{if(!(Number(N.depth)>Number(h.depth)))return this.refreshItemset();N.parentNode=h,g>0?(h.expandedNodes.push(N),h.childNodes.push(N)):(h.expandedNodes.unshift(N),h.childNodes.unshift(N));for(y=0;y<h.childNodes.length;y++)h.childNodes[y].depthIndex=y+1}h=N,this.tree.hash_index_node[s+g+1]=N,1==this.tree.useImage&&this.tree.parseDataListImage(N,!0)}if(this.tree.nodeCount=d.getRowCount()+1,o>0&&this.tree.hash_index_node[s].depth==this.tree.hash_index_node[s+1].depth){h=this.tree.hash_index_node[s];var N=this.tree.hash_index_node[s+1];for(l=0;l<h.childNodes.length;l++)N.childNodes.push(h.childNodes[l]),h.childNodes[l].parentNode=N;for(l=0;l<N.childNodes.length;l++)N.childNodes[l].depthIndex=l+1;for(l=0;l<h.expandedNodes.length;l++)N.expandedNodes.push(h.childNodes[l]);h.childNodes=[],h.expandedNodes=[]}a.D.setTimeout((function(){this.redraw(!0)}),{delay:50,key:this.id+"_notifyInsertData",caller:this})}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyBeforeSetRowData=function(e,t){try{if(this.refreshStop)return;this._initMaxRowHeight();var i=this.modelControl.getDataComp();this.beforeSetRowData=t?{depth:i.getCellData(e,this.tree.dataPath.depth),label:i.getCellData(e,this.tree.dataPath.label),checkbox:i.getCellData(e,this.tree.dataPath.checkbox),overwrite:t}:{depth:Number(i.getCellData(e-1,this.tree.dataPath.depth))+1,label:"",checkbox:"",overwrite:t}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifySetRowData=function(e){try{if(this.refreshStop)return;this._initMaxRowHeight();var t,i=(t=this.modelControl.getDataComp()).getCellData(e,this.tree.dataPath.depth),o=t.getCellData(e,this.tree.dataPath.label),s=t.getCellData(e,this.tree.dataPath.checkbox);if(i!=this.beforeSetRowData.depth)if(this.notifyValidCheck({colID:this.tree.dataPath.depth,oldValue:this.beforeSetRowData.depth,newValue:i}))this.notifySetCellData(e,this.tree.dataPath.depth,i,this.beforeSetRowData.depth);else(t=this.modelControl.getDataComp()).setCellData(e,this.tree.dataPath.depth,this.beforeSetRowData.depth);o!=this.beforeSetRowData.label&&this.notifySetCellData(e,this.tree.dataPath.label,o,this.beforeSetRowData.label),
s!=this.beforeSetRowData.checkbox&&this.notifySetCellData(e,this.tree.dataPath.checkbox,s,this.beforeSetRowData.checkbox),this.beforeSetRowData={},this.tree.nodeCount=t.getRowCount()+1}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyRemoveRow=function(e,t,i){try{if(this.refreshStop)return;"object"===(0,o.Z)(i)&&null!=i||(i={}),isNaN(t)&&(t=1),this._initMaxRowHeight();var s=this.findNodeByIndex(e+1).parentNode;if(this.stopRefresh(!0),this.notifyRemoveRow_allChildren(e,t),this.stopRefresh(!1),0==s.index)s._hasChild=s.folder?null:0!=s.childNodes.length;else{var h=this.findNodeByIndex(e);if(h&&!h.isRoot()){if(h.isLastChild()){var n=document.getElementById(this.id+"_node_"+h.index);this.addClass(n,"w2treeview_last_sibling"),this.removeClass(n,"w2treeview_first_sibling"),h.isLeaf()&&this.addClass(n,"w2treeview_last_leaf")}else if(h.isFirstChild()){n=document.getElementById(this.id+"_node_"+h.index);this.addClass(n,"w2treeview_first_sibling")}if(h.parentNode.isLastChild()){var l=document.getElementById(this.id+"_guideline_"+h.parentNode.index);this.removeClass(l,"w2treeview_guideline"),this.addClass(l,"w2treeview_noguideline")}}}var d=this.modelControl.getDataComp();this.tree.nodeCount=d.getRowCount()+1,!0!==i.skipRedraw&&a.D.setTimeout((function(){this.redraw(!0)}),{delay:50,key:this.id+"_notifyRemoveRow",caller:this})}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyRemoveRow_allChildren=function(e,t){try{this._initMaxRowHeight(),isNaN(t)&&(t=1);var i=this.findNodeByIndex(e+1),o=i.parentNode,s=this.modelControl.getDataComp(),a=e,h=s.getRowCount()+t,n=1;if(i.hasChild()){a=h-1;for(var l=i;!l.isRoot()&&l.depthIndex==l.parentNode.childNodes.length;)l=l.parentNode;l.isRoot()||l.depthIndex==l.parentNode.childNodes.length||(a=l.parentNode.childNodes[l.depthIndex].index-2);for(var d=[],c=e;c<a;c++)d.push(c),this.tree.clearNode(this.tree.findNodeByIndex(c+2),this.id),n++;s.removeRows(d)}o.childNodes.splice(i.depthIndex-1,1);for(c=i.depthIndex-1;c<o.childNodes.length;c++)o.childNodes[c].depthIndex=c+1;this.tree.clearNode(i,this.id);for(c=a+2;c<=h;c++)this.tree.changeNodeIndex(c,c-n);this.tree.nodeCount=s.getRowCount()+1}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyDataChanged=function(e){try{this.stopRefresh(!1),this.refreshItemset()}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.notifyRemovedRows=function(e,t){try{if(this.refreshStop||"string"!=typeof e||!0===t)return;for(var i=e.split(","),o=i.length,s=0;s<o;s++){var h=Number(i[s]);this.notifyRemoveRow(h,o-s,{skipRedraw:!0})}a.D.setTimeout((function(){this.redraw(!0)}),{delay:50,key:this.id+"_notifyRemovedRows",caller:this})}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.getDataListInfo=function(){try{if(this.modelControl.isDataCollectionItemsetBinded){var e={};return e.id=this.modelControl.dataCollectionItemsetInfo.dataComp.id,e.nodeset=this.modelControl.itemsetObj.nodeset,e.label=this.modelControl.itemsetObj.label,e.value=this.modelControl.itemsetObj.value,e}return null}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.deselectNode=function(){try{if(this.selectedInfo&&this.selectedInfo.node){var e=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,t=a.D.getBoolean(this.options.useHirarchySelect);if(this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor),t&&this.selectedInfoStack.length>0){for(var i=0;i<this.selectedInfoStack.length;i++){var o=this.selectedInfoStack[i];o.dom&&(this.removeClass(o.dom,this.options.labelonClickClass),o.dom.style.backgroundColor=o.org.background,o.dom.style.color=o.org.color)}this.selectedInfoStack=[]}c.B.fireEvent(this,"onchange",e,null),this.selectedInfo={groupDom:null,dom:null,node:null}}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setShowCheckBox=function(e){try{
this.options.showCheckbox!=e&&(this.options.showCheckbox=e,this.redraw(!0))}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.checkResize=function(){try{if(this.render){var e=this.render.offsetWidth,t=this.render.offsetHeight;if(this.resizeObj&&e>0&&t>0)if(0==this.resizeObj.width&&0==this.resizeObj.height)this.redraw(!0);else{var i=e-this.resizeObj.width,o=t-this.resizeObj.height;0==i&&0==o||this.redraw(!0)}this.resizeObj={width:e,height:t}}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.fixScrollTop=function(e){try{document.getElementById(this.id+"_main_div").scrollTop=0,WebSquare.event.preventDefault(e)}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._checkScrollEnd=function(){try{var e=document.getElementById(this.id+"_scrollY_div");return e.scrollTop+this._epsilon>=e.scrollHeight-e.offsetHeight}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._getVisibleInfo=function(){try{for(var e=this.getElementById(this.id+"_main_div"),t=0,i=0,o=0;o<e.childNodes.length;o++){var s=e.childNodes[o].offsetHeight;t+=s,this._maxRowHeight=Math.max(this._maxRowHeight,s),this._minRowHeight=Math.min(this._minRowHeight,s),e.offsetHeight>t&&i++}return{height:t,rowCount:i}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._getLastRowHeight=function(){try{var e=this.getElementById(this.id+"_main_div");return e.childNodes[e.childNodes.length-1].offsetHeight}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._getOverflowY=function(){try{var e=this.getElementById(this.id+"_main_div");return this._getVisibleInfo().height-e.offsetHeight}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._resizeY=function(e){try{if(isNaN(e)||0===Number(e))return;var t;t=e>0?Math.ceil(e/this.options.rowHeight)*this.options.rowHeight:Math.floor(e/this.options.rowHeight)*this.options.rowHeight;var i=this.getElementById(this.id+"_scrollY_scrollbar");i.style.height=i.offsetHeight+t+"px";var o=this.id+"_scrollY_div";a.D.requestAnimationFrame((function(){document.getElementById(o).scrollTop+=t}))}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype._initMaxRowHeight=function(){try{this._maxRowHeight=this.options.rowHeight||0,this._minRowHeight=this.options.rowHeight||0}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setNodeClass=function(e,t,i){try{var s;if("object"===(0,o.Z)(e)&&"number"==typeof e.index?s=e:"number"==typeof e?s=this.tree.findNodeByIndex(e):"string"==typeof e&&(s=this.tree.findNodeByValue(e)),!s||!t||"string"!=typeof t)return;if(s.nodeCss=t,s.rendered){var a=document.getElementById(this.id+"_node_"+s.index);this.addClass(a,t)}if(!0===i)for(var h=0,n=s.childNodes.length;h<n;h++){var l=s.childNodes[h];this.setNodeClass(l,t,i)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.removeNodeClass=function(e,t){try{var i;if("object"===(0,o.Z)(e)&&"number"==typeof e.index?i=e:"number"==typeof e?i=this.tree.findNodeByIndex(e):"string"==typeof e&&(i=this.tree.findNodeByValue(e)),!i)return;if(i.rendered&&i.nodeCss){var s=document.getElementById(this.id+"_node_"+i.index);this.removeClass(s,i.nodeCss)}if(i.nodeCss="",!0===t)for(var a=0,h=i.childNodes.length;a<h;a++){var n=i.childNodes[a];this.removeNodeClass(n,t)}}catch(e){r.w.printStackTrace(e,null,this)}},u.prototype.setTopNodeIndex=function(e){try{var t=this.tree.findNodeByIndex(e);null==t._nodePosition&&(t=this.tree.IterateFindNodeByIndex(e));var i=!1;if(t._nodePosition!==t._start){var o=this.tree.findNodeByIndex(t._nodePosition);o&&(this._expandNode(o),i=!0)}var s=Math.max(t._start-1,0)*this.options.rowHeight;this._bSkipScrollY=!0,document.getElementById(this.id+"_scrollY_div").scrollTop=s;var h=this.uuid;return new Promise((function(e,t){a.D.requestAnimationFrame((function(){var t=WebSquare.idCache[h];t.redraw(i),t._bSkipScrollY=!1,e()}))})).catch((function(e){var t=WebSquare.idCache[h];t._bSkipScrollY=!1,r.w.printStackTrace(e,null,t)}))}catch(e){this._bSkipScrollY=!1,r.w.printStackTrace(e,null,this)}}}}]);